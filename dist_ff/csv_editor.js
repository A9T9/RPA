!function(e){function t(t){for(var n,s,a=t[0],c=t[1],l=t[2],h=0,d=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,a=1;a<r.length;a++){var c=r[a];0!==i[c]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},i={4:0},o=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;o.push([1064,1,0]),r()}({1064:function(e,t,r){"use strict";r.r(t);var n=r(19),i=r.n(n),o=r(15),s=r.n(o),a=r(0),c=r.n(a),l=r(18),u=r.n(l),h=r(194),d=(r(183),r(507),r(508),r(509),r(510),r(386),r(1065),r(36)),f=r(13),m=r(32),g=r(4),p=r(20),y=r(118),v=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}Object(y.polyfillTimeoutFunctions)(p.default);var E=document.getElementById("root"),C=function(){return u.a.render(c.a.createElement(P,null),E)},P=function(e){function t(){var e,r,n;x(this,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.state={csvFile:null,ready:!1,sourceText:"",sourceTextModified:""},n.onChangeEditSource=function(e,t,r){n.setState({sourceTextModified:r})},n.saveCSV=function(){return Object(f.getStorageManager)().getCSVStorage().overwrite(n.state.csvFile,new Blob([n.state.sourceTextModified])).then((function(){return s.a.success("Successfully saved")}),(function(e){throw s.a.error("Error: "+e.message),e}))},n.onClickSave=function(){return n.saveCSV()},n.onClickSaveClose=function(){return n.saveCSV().then((function(){return setTimeout((function(){return window.close()}),300)}))},n.onClickCancel=function(){window.close()},S(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),b(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(g.parseQuery)(window.location.search).csv;t&&(document.title=t+" - RPA CSV Editor",Object(f.getStorageManager)().getCSVStorage().read(t,"Text").then((function(r){e.setState({csvFile:t,ready:!0,sourceText:r,sourceTextModified:r})})))}},{key:"render",value:function(){var e=this;return this.state.ready?c.a.createElement("div",{className:"csv-editor"},c.a.createElement(h.UnControlled,{ref:function(t){e.codeMirror=t},value:this.state.sourceText,onChange:this.onChangeEditSource,options:{lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0}}),c.a.createElement("div",{className:"csv-actions"},c.a.createElement(i.a,{type:"primary",onClick:this.onClickSaveClose},"Save & Close"),c.a.createElement(i.a,{onClick:this.onClickSave},"Save"),c.a.createElement(i.a,{onClick:this.onClickCancel},"Cancel"))):c.a.createElement("div",null)}}]),t}(c.a.Component);Promise.all([d.default.get("config").then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return w({storageMode:f.StorageStrategyType.Browser},e)})),Object(m.getXFile)().getConfig()]).then((function(e){var t=v(e,2),r=t[0];t[1],Object(f.getStorageManager)(r.storageMode),C()}),C)},1065:function(e,t,r){var n=r(1066);"string"==typeof n&&(n=[[e.i,n,""]]);var i={transform:void 0};r(133)(n,i);n.locals&&(e.exports=n.locals)},1066:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,".csv-editor{position:absolute;top:0;bottom:0;left:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.csv-editor .react-codemirror2{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative;border-bottom:1px solid #ccc}.csv-editor .react-codemirror2 .CodeMirror{position:absolute;top:0;bottom:0;left:0;right:0;height:auto;font-size:13px}.csv-editor .csv-actions{height:60px;line-height:60px;text-align:center;background:#f0f0f0}.csv-editor .csv-actions button{margin-right:10px}",""])},107:function(e,t,r){"use strict";r.r(t);r(170);var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){var e=window.requestFileSystem||window.webkitRequestFileSystem;if(!e)throw new Error("requestFileSystem not supported");var t=function(t){return t=t||5242880,new Promise((function(r,n){e(window.TEMPORARY,t,r,n)}))},r=function(e,r,n){var i=(Array.isArray(e)?e:e.split("/")).filter((function(e){return e&&e.length}));return(n?Promise.resolve(n):t(1048576)).then((function(e){return function e(t,n){return t&&t.length?new Promise((function(e,i){n.getDirectory(t[0],{create:!!r},(function(t){return e(t)}),(function(e){return i(e)}))})).then((function(r){return e(t.slice(1),r)})):Promise.resolve(n)}(i,e.root)}))},i=function(e,t){var n=e.split("/");return r(n.slice(0,-1),!1,t).then((function(e){return{directoryEntry:e,fileName:n.slice(-1)[0]}}))},o=function(e,r){if(-1===["ArrayBuffer","BinaryString","DataURL","Text"].indexOf(r))throw new Error("invalid readFile type, '"+r+"'");return t().then((function(t){return i(e,t).then((function(e){var t=e.directoryEntry,n=e.fileName;return new Promise((function(e,i){t.getFile(n,{},(function(t){t.file((function(t){var n=new FileReader;switch(n.onerror=i,n.onloadend=function(){e(this.result)},r){case"ArrayBuffer":return n.readAsArrayBuffer(t);case"BinaryString":return n.readAsBinaryString(t);case"DataURL":return n.readAsDataURL(t);case"Text":return n.readAsText(t);default:throw new Error("unsupported data type, '"+r)}}),i)}),i)}))}))})).catch((function(e){throw console.warn("readFile",e.code,e.name,e.message),e}))},s=function(e,r,n){return t(n).then((function(t){return i(e,t).then((function(e){var t=e.directoryEntry,n=e.fileName;return new Promise((function(e,i){t.getFile(n,{create:!0},(function(t){t.createWriter((function(n){n.onwriteend=function(){return e(t.toURL())},n.onerror=i,n.write(r)}))}),i)}))}))})).catch((function(e){throw console.warn(e.code,e.name,e.message),e}))},a=function(e){return t().then((function(t){return i(e,t).then((function(e){var t=e.directoryEntry,r=e.fileName;return new Promise((function(e,n){t.getFile(r,{create:!0},(function(t){t.remove(e,n)}),n)}))}))})).catch((function(e){throw console.warn("removeFile",e.code,e.name,e.message),e}))},c=function(e){return t().then((function(t){return i(e,t).then((function(e){var t=e.directoryEntry,r=e.fileName,i=function(e){return new Promise((function(n){t[e](r,{create:!1},(function(e){n(!0)}),(function(){return n(!1)}))}))},o=i("getFile"),s=i("getDirectory");return Promise.all([o,s]).then((function(e){var t=n(e,2);return{isFile:t[0],isDirectory:t[1]}}))}))})).catch((function(e){if(e&&8===e.code)return{isFile:!1,isDirectory:!1};throw console.warn("fs.exists",e.code,e.name,e.message),e}))};return{list:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";return t(1048576).then((function(t){return new Promise((function(t,n){r(e).then((function(e){var r=[],i=e.createReader();!function e(){i.readEntries((function(n){0===n.length?t(r.sort()):(r=r.concat(Array.from(n)),e())}),n)}()})).catch(n)}))})).catch((function(e){throw console.warn("list",e.code,e.name,e.message),e}))},readFile:o,writeFile:s,removeFile:a,moveFile:function(e,r){return t().then((function(t){return Promise.all([i(e,t),i(r,t)]).then((function(t){var n=t[0].directoryEntry,i=t[0].fileName,c=t[1].directoryEntry,l=t[1].fileName;return new Promise((function(t,u){n.getFile(i,{},(function(n){try{n.moveTo(c,l,t,u)}catch(n){o(e,"ArrayBuffer").then((function(e){return s(r,new Blob([new Uint8Array(e)]))})).then((function(){return a(e)})).then(t,u)}}),u)}))}))}))},copyFile:function(e,r){return t().then((function(t){return Promise.all([i(e,t),i(r,t)]).then((function(t){var n=t[0].directoryEntry,i=t[0].fileName,a=t[1].directoryEntry,c=t[1].fileName;return new Promise((function(t,l){n.getFile(i,{},(function(n){try{n.copyTo(a,c,t,l)}catch(n){o(e,"ArrayBuffer").then((function(e){return s(r,new Blob([new Uint8Array(e)]))})).then(t,l)}}),l)}))}))})).catch((function(e){throw console.warn("copyFile",e.code,e.name,e.message),e}))},getDirectory:r,getMetadata:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t().then((function(t){return e.getMetadata?new Promise((function(t,r){return e.getMetadata(t)})):i(e,t).then((function(e){var t=e.directoryEntry,n=e.fileName;return new Promise((function(e,i){var o=[n,{create:!1},function(t){t.getMetadata(e)},i];r?t.getDirectory.apply(t,o):t.getFile.apply(t,o)}))}))})).catch((function(e){throw console.warn("getMetadata",e.code,e.name,e.message),e}))},ensureDirectory:function(e,t){return r(e,!0,t)},exists:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.type;return c(e).then((function(e){switch(r){case"file":return e.isFile;case"directory":return e.isDirectory;default:return e.isFile||e.isDirectory}}))},existsStat:c,rmdir:function(e,t){return r(e,!1,t).then((function(e){return new Promise((function(t,r){e.remove(t,r)}))}))},rmdirR:function(e,t){return r(e,!1,t).then((function(e){return new Promise((function(t,r){return e.removeRecursively(t,r)}))}))}}}();window.fs=i,t.default=i},118:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(11)),o=window.setTimeout,s=window.clearTimeout;window.setInterval,window.clearInterval;function a(){return Math.floor(1e8*Math.random())}t.polyfillTimeoutFunctions=function(e){const t={};function r(r,n=0,...s){let c=!1;const l=(...e)=>c?null:(c=!0,r(...e)),u=o(l,n,...s);return function(r){const n=null!=r?r:a();return function(r,o=0,...s){return t[n]=!0,e.ask("TIMEOUT",{id:n,timeout:o}).then(e=>{t[e]&&r(...s)}).catch(e=>{i.default.error("Error in setTimeout",e.stack)}),n}}(u)(l,n,...s),u}const n={};var c,l;window.setTimeout=r,window.clearTimeout=(c=function(e){delete t[e]},l=s,(...e)=>{c(...e),l(...e)}),window.setInterval=function(e,t=0,...i){const o=a(),s=()=>{n[o]&&(r(s,t),e(...i))};return n[o]=!0,r(s,t),o},window.clearInterval=function(e){delete n[e]}}},121:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(89),o=n(r(107)),s=r(27),a=r(4),c=r(22),l=n(r(10)),u=r(12);class h extends i.StandardStorage{constructor(e){super({encode:e.encode,decode:e.decode}),this.transformFileName=e=>e;const{extensions:t,shouldKeepExt:r,transformFileName:n,baseDir:i="share"}=e;if(!i||"/"===i)throw new Error(`Invalid baseDir, ${i}`);n&&(this.transformFileName=n),this.baseDir=i,this.extensions=t,this.shouldKeepExt=r,o.default.getDirectory(i,!0)}getLink(e){if(c.isFirefox())return this.read(e,"DataURL");{const t=`filesystem:${l.default.extension.getURL("temporary")}/${this.filePath(e)}`;return Promise.resolve(t+"?"+(new Date).getTime())}}read(e,t){const r=this.filePath(e),n=s.posix.relative(this.dirPath("/"),r);return o.default.readFile(r,t).then(e=>this.decode(e,n,t),t=>{if(-1!==t.message.indexOf("A requested file or directory could not be found"))throw new Error(`File not found: ${e}`);return Promise.reject(t)})}stat(e,t){const r=s.posix.basename(e),n=s.posix.dirname(e),i=t?this.dirPath(e):this.filePath(e),a=s.posix.relative(this.dirPath("/"),i);return o.default.existsStat(i).then(({isFile:e,isDirectory:t})=>e?o.default.getMetadata(i,t).then(o=>({dir:n,name:r,fullPath:i,relativePath:a,isFile:e,isDirectory:t,size:o.size,lastModified:o.modificationTime})):{dir:n,name:r,fullPath:i,relativePath:a,isFile:e,isDirectory:t,size:0,lastModified:new Date(0)})}__list(e="/",t=!1){const r=(e,t)=>this.shouldKeepExt||t?e:this.removeExt(e);return this.ensureBaseDir().then(()=>o.default.list(this.dirPath(e))).then(e=>{const t=e.map(e=>this.stat(e.fullPath,e.isDirectory).then(t=>Object.assign(Object.assign({},t),{name:this.transformFileName(r(t.name,e.isDirectory))})));return Promise.all(t).then(e=>(e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0),this.totalCount=e.length,this.displayedCount=e.length,e))})}__write(e,t){return this.ensureBaseDir().then(()=>this.remove(e)).catch(()=>{}).then(()=>this.encode(t,e)).then(t=>o.default.writeFile(this.filePath(e,!0),t)).then(()=>{})}__overwrite(e,t){return this.__write(e,t)}__removeFile(e){return o.default.removeFile(this.filePath(e))}__removeEmptyDirectory(e){return o.default.rmdir(this.dirPath(e))}__moveFile(e,t){return o.default.moveFile(this.filePath(e),this.filePath(t,!0)).then(()=>{})}__copyFile(e,t){return o.default.copyFile(this.filePath(e),this.filePath(t,!0)).then(()=>{})}__createDirectory(e){return o.default.getDirectory(this.dirPath(e,!0),!0).then(()=>{})}dirPath(e,t=!1){const r=this.getPathLib(),n=(()=>this.isStartWithBaseDir(e)?e:r.join("/",this.baseDir,e))(),i=r.dirname(n),o=r.basename(n),s=t?a.sanitizeFileName(o):o;return r.join(i,s)}isWin32Path(){return!1}filePath(e,t=!1){const r=s.posix.dirname(e),n=s.posix.basename(e),i=t?a.sanitizeFileName(n):n,o=s.posix.extname(n),c=this.extensions[0],l=o&&o.substr(1).toLowerCase()===c.toLowerCase()?i:i+"."+c;return this.isStartWithBaseDir(r)?s.posix.join(r,this.transformFileName(l)):s.posix.join("/",this.baseDir,r,this.transformFileName(l))}isStartWithBaseDir(e){return 0===e.indexOf("/"+this.baseDir)}ensureBaseDir(){return o.default.ensureDirectory(this.baseDir).then(()=>{})}removeExt(e){const t=s.posix.basename(e),r=s.posix.extname(e),n=t.lastIndexOf(r);return t.substring(0,n)}}t.BrowserFileSystemStandardStorage=h,t.getBrowserFileSystemStandardStorage=u.singletonGetterByKey(e=>e&&e.baseDir||"share",e=>new h(e))},122:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12);t.EACCES=n.errorClassFactory("EACCES"),t.EEXIST=n.errorClassFactory("EEXIST"),t.EISDIR=n.errorClassFactory("EISDIR"),t.EMFILE=n.errorClassFactory("EMFILE"),t.ENOENT=n.errorClassFactory("ENOENT"),t.ENOTDIR=n.errorClassFactory("ENOTDIR"),t.ENOTEMPTY=n.errorClassFactory("ENOTEMPTY")},123:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(27)),o=r(89),s=r(4),a=r(60),c=r(128),l=r(12);class u extends o.StandardStorage{constructor(e){super({encode:e.encode,decode:e.decode,listFilter:e.listFilter});const{baseDir:t,rootDir:r,extensions:n,shouldKeepExt:i=!1,allowAbsoluteFilePath:o=!1}=e;if(!t||"/"===t)throw new Error(`Invalid baseDir, ${t}`);this.rootDir=r,this.baseDir=t,this.extensions=n,this.shouldKeepExt=i,this.allowAbsoluteFilePath=o,this.fs=a.getNativeFileSystemAPI()}getLink(e){return this.read(e,"DataURL")}read(e,t){const r=this.filePath(e),n=i.default.relative(this.dirPath("/"),r),o=r=>{if(0!==r.errorCode)throw new c.ErrorWithCode(`${e}: `+c.getErrorMessageForCode(r.errorCode),r.errorCode);const i=r.content,o=(()=>{switch(t){case"Text":case"DataURL":return i;case"ArrayBuffer":return s.dataURItoArrayBuffer(i);case"BinaryString":return s.arrayBufferToString(s.dataURItoArrayBuffer(i))}})();return this.decode(o,n,t)};switch(t){case"Text":return this.fs.readAllTextCompat({path:r}).then(o);default:return this.fs.readAllBytesCompat({path:r}).then(o)}}stat(e,t){const r=i.default.dirname(e),n=i.default.basename(e),o=t?this.dirPath(e):this.filePath(e),s=i.default.relative(this.dirPath("/"),o),a={dir:r,name:n,fullPath:o,relativePath:s,isFile:!1,isDirectory:!1,lastModified:new Date(0),size:0};return(t?this.fs.directoryExists({path:o}):this.fs.fileExists({path:o})).then(e=>e?this.fs.getFileSystemEntryInfo({path:o}).then(e=>({dir:r,name:n,fullPath:o,relativePath:s,isFile:!e.isDirectory,isDirectory:e.isDirectory,lastModified:new Date(e.lastWriteTime),size:e.length}),e=>a):a)}__list(e="/",t=!1){return this.ensureBaseDir().then(()=>this.fs.getEntries({brief:t,path:this.dirPath(e),extensions:this.extensions}).then(t=>{const r=t.entries,n=t.errorCode;if(0!==n)throw new c.ErrorWithCode(c.getErrorMessageForCode(n)+`: ${e}`,n);const o=(e,t)=>this.shouldKeepExt||t?e:this.removeExt(e);return r.map(t=>{const r=this.dirPath(e),n=o(t.name,t.isDirectory),s=i.default.join(r,t.name);return{dir:r,name:n,fullPath:s,relativePath:i.default.relative(this.dirPath("/"),s),isFile:!t.isDirectory,isDirectory:t.isDirectory,lastModified:new Date(t.lastWriteTime),size:t.length}})}))}__write(e,t){return this.ensureBaseDir().then(()=>this.encode(t,e)).then(t=>this.fs.writeAllBytes({content:t,path:this.filePath(e,!0)}).then(t=>{if(!t)throw new Error(`Failed to write to '${e}'`)}))}__overwrite(e,t){return this.write(e,t)}__removeFile(e){return this.ensureBaseDir().then(()=>this.fs.deleteFile({path:this.filePath(e)}).then(()=>{}))}__removeEmptyDirectory(e){return this.ensureBaseDir().then(()=>this.fs.removeDirectory({path:this.dirPath(e)}).then(()=>{}))}__moveFile(e,t){return this.ensureBaseDir().then(()=>this.fs.moveFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}__copyFile(e,t){return this.ensureBaseDir().then(()=>this.fs.copyFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}__createDirectory(e){return this.ensureBaseDir().then(()=>this.fs.createDirectory({path:this.dirPath(e,!0)}).then(()=>{}))}dirPath(e,t=!1){const r=this.getPathLib(),n=(()=>this.isStartWithBaseDir(e)?r.normalize(e):r.normalize(r.join(this.rootDir,this.baseDir,e)))(),i=r.dirname(n),o=r.basename(n),a=t?s.sanitizeFileName(o):o;return r.join(i,a)}filePath(e,t=!1){const r=i.default.dirname(e),n=i.default.basename(e),o=t?s.sanitizeFileName(n):n,a=i.default.extname(n),c=this.extensions[0],l=a&&a.substr(1).toLowerCase()===c.toLowerCase()?o:o+"."+c;return this.isStartWithBaseDir(r)||this.allowAbsoluteFilePath&&this.isAbsoluteUrl(e)?i.default.normalize(i.default.join(r,l)):i.default.normalize(i.default.join(this.rootDir,this.baseDir,r,l))}isWin32Path(){return/^([A-Z]:\\|\/\/|\\\\)/i.test(this.rootDir)}isAbsoluteUrl(e){return this.getPathLib().isAbsolute(e)}isStartWithBaseDir(e){return 0===e.indexOf(this.rootDir)}removeExt(e){const t=i.default.basename(e),r=i.default.extname(e),n=t.lastIndexOf(r);return t.substring(0,n)}ensureBaseDir(){const e=this.fs,t=i.default.normalize(i.default.join(this.rootDir,this.baseDir));return e.directoryExists({path:t}).then(r=>r||e.createDirectory({path:t})).then(()=>{})}}t.NativeFileSystemStandardStorage=u,t.getNativeFileSystemStandardStorage=l.singletonGetterByKey(e=>i.default.join(e.rootDir,e.baseDir),e=>new u(e))},124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicMethodTypes=[1,2,3,4,5,8,9,10,11,12,13,14,15,16,17,18],t.MethodTypeFriendlyNames=["GetVersion","GetFileSystemEntries","GetDirectories","GetFiles","GetFileSystemEntryInfo","GetSpecialFolderPath","DirectoryExists","FileExists","CreateDirectory","RemoveDirectory","CopyFile","MoveFile","DeleteFile","ReadAllText","WriteAllText","AppendAllText","ReadAllBytes","WriteAllBytes","AppendAllBytes","GetMaxFileRange","GetFileSize","ReadFileRange","RunProcess"],t.MethodTypeInvocationNames=["get_version","get_file_system_entries","get_directories","get_files","get_file_system_entry_info","get_special_folder_path","directory_exists","file_exists","create_directory","remove_directory","copy_file","move_file","delete_file","read_all_text","write_all_text","append_all_text","read_all_bytes","write_all_bytes","append_all_bytes","get_max_file_range","get_file_size","read_file_range","run_process"]},125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(97);class i extends n.NativeMessagingHost{constructor(){super(i.HOST_NAME)}}t.KantuFileAccessHost=i,i.HOST_NAME="com.a9t9.kantu.file_access"},126:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.input=e,this.position=0}getNextByte(){if(this.position>=this.input.length)return n.END;const e=255&this.input[this.position];return++this.position,e}getNextContinuationByte(){const e=this.getNextByte();return 128==(192&e)?63&e:n.ERROR}decodeNext(){if(this.position>=this.input.length)return this.position===this.input.length?n.END:n.ERROR;const e=this.getNextByte();if(0==(128&e))return e;if(192==(224&e)){const t=this.getNextContinuationByte();if(t>=0){const r=(31&e)<<6|t;if(r>=128)return r}}else if(224==(240&e)){const t=this.getNextContinuationByte(),r=this.getNextContinuationByte();if((t|r)>=0){const n=(15&e)<<12|t<<6|r;if(n>=2048&&(n<55296||n>57343))return n}}else if(240==(248&e)){const t=this.getNextContinuationByte(),r=this.getNextContinuationByte(),n=this.getNextContinuationByte();if((t|r|n)>=0){const i=(7&e)<<18|t<<12|r<<6|n;if(i>=65536&&i<=1114111)return i}}return n.ERROR}}n.REPLACEMENT_CHARACTER="�",n.END=-1,n.ERROR=-2,function(e){e.isValid=function(e){const t=new n(e);for(;;){switch(t.decodeNext()){case n.END:return!0;case n.ERROR:return!1}}},e.decode=function(e){const t=new n(e);let r="";for(;;){const e=t.decodeNext();if(e===n.END)break;r+=e!==n.ERROR?String.fromCodePoint(e):n.REPLACEMENT_CHARACTER}return r}}(t.utf8||(t.utf8={}))},127:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){const t=new Uint8Array([65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47]),r=new Uint8Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);function n(e,t,n){if(n>4)throw new Error("maxLength should be in range [0, 4].");const i=new Uint8Array(4);for(let o=0;o<n;++o){const n=e.charCodeAt(t+o),s=r[n];if(255===s)return;i[o]=s}return(i[0]<<18)+(i[1]<<12)+(i[2]<<6)+(i[3]<<0)}function i(e,t,r){e[t+0]=r>>16&255,e[t+1]=r>>8&255,e[t+2]=255&r}e.encode=function(e){const r=e.length,n=function(e){let t=4*Math.trunc(e/3);return t+=e%3!=0?4:0,t}(r),i=r%3,o=r-i,s=new Uint8Array(n);let a,c=0;for(a=0;a<o;a+=3)s[c+0]=t[(252&e[a])>>2],s[c+1]=t[(3&e[a])<<4|(240&e[a+1])>>4],s[c+2]=t[(15&e[a+1])<<2|(192&e[a+2])>>6],s[c+3]=t[63&e[a+2]],c+=4;switch(a=o,i){case 2:s[c+0]=t[(252&e[a])>>2],s[c+1]=t[(3&e[a])<<4|(240&e[a+1])>>4],s[c+2]=t[(15&e[a+1])<<2],s[c+3]=61,c+=4;break;case 1:s[c+0]=t[(252&e[a])>>2],s[c+1]=t[(3&e[a])<<4],s[c+2]=61,s[c+3]=61,c+=4}return new TextDecoder("ascii").decode(s)},e.decode=function(e){const t=e.length;if(t%4!=0)return;let r=0;t>0&&61==e.charCodeAt(t-1)&&(++r,t>1&&61==e.charCodeAt(t-2)&&++r);const o=-4&t-r,s=new Uint8Array(6*t/8-r);let a,c=0,l=0;for(;c<o;){if(a=n(e,c,4),void 0===a)return;i(s,l,a),c+=4,l+=3}if(r>0){if(a=n(e,c,4-r),void 0===a)return;switch(r){case 1:s[l+0]=a>>16&255,s[l+1]=a>>8&255;break;case 2:s[l+0]=a>>16&255}}return s}}(t.base64||(t.base64={}))},128:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(76),o=r(60),s=n(r(27)),a=r(4),c=r(12);class l extends i.FlatStorage{constructor(e){super({encode:e.encode,decode:e.decode}),this.listFilter=e=>e,this.displayedCount=0,this.totalCount=0;const{baseDir:t,rootDir:r,extensions:n,shouldKeepExt:i=!1,listFilter:s}=e;if(!t||"/"===t)throw new Error(`Invalid baseDir, ${t}`);this.rootDir=r,this.baseDir=t,this.extensions=n,this.shouldKeepExt=i,s&&(this.listFilter=s),this.fs=o.getNativeFileSystemAPI()}getDisplayCount(){return this.displayedCount}getTotalCount(){return this.totalCount}readAll(e="Text",t){return this.list().then(r=>Promise.all(r.map(t=>this.read(t.fileName,e).then(e=>({content:e,fileName:t.fileName})).catch(e=>({fileName:t.fileName,fullFilePath:this.filePath(t.fileName),error:new Error(`Error in parsing ${this.filePath(t.fileName)}:\n${e.message}`)})))).then(e=>{const r=e.filter(e=>e.error);return t&&t(r),e.filter(e=>e.content)}))}getLink(e){return this.read(e,"DataURL")}__list(){return this.ensureDir().then(()=>this.fs.getEntries({path:s.default.join(this.rootDir,this.baseDir),extensions:this.extensions}).then(e=>{const t=e.entries,r=e.errorCode;if(0!==r)throw new u(h(r),r);const n=e=>this.shouldKeepExt?e:this.removeExt(e),o=t.map(e=>({dir:this.baseDir,fileName:n(e.name),lastModified:new Date(e.lastWriteTime),size:i.readableSize(e.length)}));return Promise.resolve(this.listFilter(o)).then(e=>(this.totalCount=o.length,this.displayedCount=e.length,e))}))}exists(e){return this.fs.fileExists({path:this.filePath(e)})}read(e,t){const r=r=>{if(0!==r.errorCode)throw new u(`${e}: `+h(r.errorCode),r.errorCode);const n=r.content,i=(()=>{switch(t){case"Text":case"DataURL":return n;case"ArrayBuffer":return a.dataURItoArrayBuffer(n);case"BinaryString":return a.arrayBufferToString(a.dataURItoArrayBuffer(n))}})();return this.decode(i,e)};switch(t){case"Text":return this.fs.readAllTextCompat({path:this.filePath(e)}).then(r);default:return this.fs.readAllBytesCompat({path:this.filePath(e)}).then(r)}}__write(e,t){return this.ensureDir().then(()=>this.encode(t,e)).then(t=>this.fs.writeAllBytes({content:t,path:this.filePath(e,!0)}).then(t=>{if(!t)throw new Error(`Failed to write to '${e}'`)}))}__overwrite(e,t){return this.remove(e).catch(()=>{}).then(()=>this.write(e,t))}__clear(){return this.list().then(e=>{const t=e.map(e=>this.remove(e.fileName));return Promise.all(t)}).then(()=>{})}__remove(e){return this.ensureDir().then(()=>this.fs.deleteFile({path:this.filePath(e)}).then(()=>{}))}__rename(e,t){return this.ensureDir().then(()=>this.fs.moveFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}__copy(e,t){return this.ensureDir().then(()=>this.fs.copyFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}filePath(e,t=!1){const r=t?a.sanitizeFileName(e):e,n=s.default.extname(e),i=this.extensions[0],o=n&&n.substr(1).toLowerCase()===i.toLowerCase()?r:r+"."+i;return s.default.join(this.rootDir,this.baseDir,o)}removeExt(e){const t=s.default.basename(e),r=s.default.extname(e),n=t.lastIndexOf(r);return t.substring(0,n)}ensureDir(){const e=this.fs,t=s.default.join(this.rootDir,this.baseDir);return e.directoryExists({path:t}).then(r=>r||e.createDirectory({path:t})).then(()=>{})}}t.NativeFileSystemFlatStorage=l,t.getNativeFileSystemFlatStorage=c.singletonGetterByKey(e=>s.default.join(e.rootDir,e.baseDir),e=>new l(e));class u extends Error{constructor(e,t){super(e),this.name="ErrorWithCode",this.code=t;let r=!0;if("function"==typeof Error.captureStackTrace)try{Error.captureStackTrace(this,this.constructor)}catch(e){r=!1}r||(this.stack=new Error(e).stack)}}function h(e){switch(e){case 0:return"Success";case 1:return"Failed to load";case 2:return"File too large to load";default:return`Unknown error code: ${e}`}}t.ErrorWithCode=u,t.getErrorMessageForCode=h},13:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(81)),o=r(121),s=r(123),a=r(12),c=r(32),l=r(50),u=r(69),h=r(4),d=n(r(27));var f,m,g;!function(e){e.Browser="browser",e.XFile="xfile",e.Nil="nil"}(f=t.StorageStrategyType||(t.StorageStrategyType={})),function(e){e[e.Macro=0]="Macro",e[e.TestSuite=1]="TestSuite",e[e.CSV=2]="CSV",e[e.Screenshot=3]="Screenshot",e[e.Vision=4]="Vision"}(m=t.StorageTarget||(t.StorageTarget={})),function(e){e.StrategyTypeChanged="StrategyTypeChanged",e.RootDirChanged="RootDirChanged",e.ForceReload="ForceReload"}(g=t.StorageManagerEvent||(t.StorageManagerEvent={}));class p extends i.default{constructor(e,t){super(),this.strategyType=f.Nil,this.getMacros=()=>[],this.getMaxMacroCount=e=>Promise.resolve(1/0),this.setCurrentStrategyType(e),t&&t.getMacros&&(this.getMacros=t.getMacros),t&&t.getMaxMacroCount&&(this.getMaxMacroCount=t.getMaxMacroCount),this.getConfig=null==t?void 0:t.getConfig}isXFileMode(){return this.strategyType===f.XFile}isBrowserMode(){return this.strategyType===f.Browser}getCurrentStrategyType(){return this.strategyType}setCurrentStrategyType(e){const t=e!==this.strategyType;return t&&(setTimeout(()=>{this.emit(g.StrategyTypeChanged,e)},0),this.strategyType=e),t}isStrategyTypeAvailable(e){switch(e){case f.Browser:return Promise.resolve(!0);case f.XFile:return c.getXFile().sanityCheck();default:throw new Error(`type '${e}' is not supported`)}}getStorageForTarget(e,t){switch(t||this.strategyType){case f.Browser:switch(e){case m.Macro:{const e=o.getBrowserFileSystemStandardStorage({baseDir:"macros",extensions:["json"],shouldKeepExt:!1,decode:(t,r)=>{const n=l.fromJSONString(t,d.default.basename(r),{withStatus:!0});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{var r,n;const i=l.toJSONString(Object.assign(Object.assign({},e),{commands:e.data.commands}),{withStatus:!0,ignoreTargetOptions:!!(null===(n=null===(r=this.getConfig)||void 0===r?void 0:r.call(this))||void 0===n?void 0:n.saveAlternativeLocators)});return new Blob([i])}});return window.newMacroStorage=e,e}case m.TestSuite:{const e=o.getBrowserFileSystemStandardStorage({baseDir:"testsuites",extensions:["json"],shouldKeepExt:!1,decode:(t,r)=>{console.log("test suite raw content",r,t,this.getMacros());const n=u.parseTestSuite(t,{fileName:d.default.basename(r)});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{const r=u.stringifyTestSuite(e);return new Blob([r])}});return window.newTestSuiteStorage=e,e}case m.CSV:return o.getBrowserFileSystemStandardStorage({baseDir:"spreadsheets",extensions:["csv"],shouldKeepExt:!0,transformFileName:e=>e.toLowerCase()});case m.Screenshot:return o.getBrowserFileSystemStandardStorage({baseDir:"screenshots",extensions:["png"],shouldKeepExt:!0,transformFileName:e=>e.toLowerCase()});case m.Vision:return o.getBrowserFileSystemStandardStorage({baseDir:"visions",extensions:["png"],shouldKeepExt:!0,transformFileName:e=>e.toLowerCase()})}case f.XFile:{const{rootDir:t}=c.getXFile().getCachedConfig();switch(e){case m.Macro:{const e=s.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"macros",extensions:["json"],shouldKeepExt:!1,listFilter:e=>this.getMaxMacroCount(this.strategyType).then(t=>a.forestSlice(t,e)),decode:(t,r)=>{const n=l.fromJSONString(t,d.default.basename(r),{withStatus:!0});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{const r=l.toJSONString(Object.assign(Object.assign({},e),{commands:e.data.commands}),{withStatus:!0});return h.blobToDataURL(new Blob([r]))}});return e}case m.TestSuite:{const e=s.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"testsuites",extensions:["json"],shouldKeepExt:!1,decode:(t,r)=>{const n=u.parseTestSuite(t,{fileName:d.default.basename(r)});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{const r=u.stringifyTestSuite(e);return h.blobToDataURL(new Blob([r]))}});return e}case m.CSV:return s.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"datasources",extensions:["csv"],shouldKeepExt:!0,allowAbsoluteFilePath:!0,encode:(e,t)=>h.blobToDataURL(new Blob([e]))});case m.Vision:return s.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"images",extensions:["png"],shouldKeepExt:!0,decode:y,encode:(e,t)=>h.blobToDataURL(e)});case m.Screenshot:return s.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"screenshots",extensions:["png"],shouldKeepExt:!0,decode:y,encode:(e,t)=>h.blobToDataURL(e)})}}default:throw new Error(`Unsupported strategy type: '${this.strategyType}'`)}}getMacroStorage(){return this.getStorageForTarget(m.Macro)}getTestSuiteStorage(){return this.getStorageForTarget(m.TestSuite)}getCSVStorage(){return this.getStorageForTarget(m.CSV)}getVisionStorage(){return this.getStorageForTarget(m.Vision)}getScreenshotStorage(){return this.getStorageForTarget(m.Screenshot)}}function y(e,t,r){return"DataURL"!==r||"data:image"===e.substr(0,11)?e:"data:image/png;base64,"+e}t.StorageManager=p,t.getStorageManager=a.singletonGetter((e,t)=>new p(e||f.XFile,t))},20:function(e,t,r){"use strict";r.r(t);var n=r(93),i=function(){throw new Error("You are not a top window, not allowed to initialize/use csIpc")},o=window.top===window?Object(n.csInit)():{ask:i,send:i,onAsk:i,destroy:i};t.default=o},22:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4);function i(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{t({$img:n,width:n.width,height:n.height})},n.onerror=e=>{r(e)},n.src=e})}function o(e){return"data:image/svg+xml;base64,"+window.btoa(e)}function s(e){return new Promise((t,r)=>{const n=document.createElement("canvas"),i=n.getContext("2d"),s=document.createElement("img"),a=o(e),c=e.match(/<svg[\s\S]*?width="(.*?)"/m),l=e.match(/<svg[\s\S]*?height="(.*?)"/m),u=parseInt(c[1],10),h=parseInt(l[1],10);s.src=a,s.onload=function(){n.width=u,n.height=h,i.drawImage(s,0,0,u,h),t(n)},s.onerror=function(e){r(e)}})}function a(e,t,r){if(e>255||t>255||r>255)throw"Invalid color component";return(e<<16|t<<8|r).toString(16)}t.getStyle=function(e){if(!e)throw new Error("getStyle: dom does not exist");return getComputedStyle(e)},t.setStyle=function(e,t){if(!e)throw new Error("setStyle: dom does not exist");for(var r=0,n=Object.keys(t),i=n.length;r<i;r++)e.style[n[r]]=t[n[r]];return e},t.pixel=function(e){return-1!==(e+"").indexOf("px")?e:(e||0)+"px"},t.bindDrag=e=>{const{onDragStart:t,onDragEnd:r,onDrag:n,$el:i,preventGlobalClick:o=!0,doc:s=document}=e;let a=!1,c={x:0,y:0};const l=e=>{a=!0,c={x:e.screenX,y:e.screenY},t(e)},u=e=>{if(!a)return;a=!1;const t=e.screenX-c.x,n=e.screenY-c.y;r(e,{dx:t,dy:n})},h=e=>{if(!a)return;const t=e.screenX-c.x,r=e.screenY-c.y;n(e,{dx:t,dy:r}),e.preventDefault(),e.stopPropagation()},d=e=>{e.preventDefault(),e.stopPropagation()};return o&&s.addEventListener("click",d,!0),s.addEventListener("mousemove",h,!0),s.addEventListener("mouseup",u,!0),i.addEventListener("mousedown",l,!0),()=>{s.removeEventListener("click",d,!0),s.removeEventListener("mousemove",h,!0),s.removeEventListener("mouseup",u,!0),i.removeEventListener("mousedown",l,!0)}},t.bindContentEditableChange=e=>{const{onChange:t,doc:r=document}=e;let n=null,i=null;const o=e=>{e.target&&"true"===e.target.contentEditable&&(n=e.target,i=n.innerHTML)},s=e=>{e.target!==n||n&&n.innerHTML!==i&&t(e),n=null,i=null};return r.addEventListener("focus",o,!0),r.addEventListener("blur",s,!0),()=>{r.removeEventListener("focus",o,!0),r.removeEventListener("blur",s,!0)}},t.scrollLeft=function(e){return e.documentElement.scrollLeft},t.scrollTop=function(e){return e.documentElement.scrollTop},t.domText=e=>{const t=e.innerText?e.innerText.trim():"",r=e.textContent,n=r.toUpperCase().indexOf(t.toUpperCase());return-1===n?t:r.substr(n,t.length)},t.isVisible=function(e){if(e===window.document)return!0;if(!e)return!0;const r=window.getComputedStyle(e);return"none"!==r.display&&"0"!==r.opacity&&"hidden"!==r.visibility&&t.isVisible(e.parentNode)},t.cssSelector=function(e){if(!e)return"";if(1!==e.nodeType)return"";if("BODY"===e.tagName)return"body";if(e.id)return"#"+e.id;var r=e.className.split(/\s+/g).filter((function(e){return e&&e.length})),i=Array.from(e.parentNode?e.parentNode.childNodes:[]).filter((function(e){return 1===e.nodeType})),o=i.filter((function(t){return t.tagName===e.tagName})),s=i.filter((function(e){var t=e.className.split(/\s+/g);return n.and(...r.map((function(e){return-1!==t.indexOf(e)})))})),a="";a=1===o.length?"":r.length&&1===s.length?"."+r.join("."):":nth-child("+(1+i.findIndex((function(t){return t===e})))+")";var c=e.tagName.toLowerCase()+a;return t.cssSelector(e.parentNode)+" > "+c},t.isPositionFixed=e=>!(!e||e===document.documentElement||e===document.body)&&("fixed"===getComputedStyle(e).position||t.isPositionFixed(e.parentNode)),t.offset=function(e){if(!e)return{left:0,top:0};var t=e.getBoundingClientRect();return{left:t.left+window.scrollX,top:t.top+window.scrollY}},t.accurateOffset=function e(t){if(!t)return{left:0,top:0};const r=t.ownerDocument;if(!r||t===r.documentElement)return{left:0,top:0};const n=e(t.offsetParent);return{left:n.left+t.offsetLeft,top:n.top+t.offsetTop}},t.preloadImage=i,t.isFirefox=function(){return/Firefox/.test(window.navigator.userAgent)},t.svgNodetoString=function(e){return e.outerHTML},t.svgToBase64=o,t.canvasFromSVG=s,t.imageBlobFromSVG=function(e,t="image/png",r){return s(e).then(e=>new Promise((n,i)=>{try{e.toBlob(n,t,r)}catch(e){i(e)}}))},t.imageDataFromUrl=function(e){return i(e).then(({$img:e,width:t,height:r})=>{const n=document.createElement("canvas");n.width=t,n.height=r;const i=n.getContext("2d");return i.drawImage(e,0,0,t,r),i.getImageData(0,0,t,r)})},t.subImage=function(e,t){return new Promise((r,n)=>{const i=new Image;i.onload=()=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(i,0,0,i.width,i.height,-1*t.x,-1*t.y,i.width,i.height),r(e.toDataURL())},i.src=e})},t.rgbToHex=a,t.getPixel=function(e){const{x:t,y:r,dataUrl:n}=e;return new Promise((e,i)=>{const o=new Image;o.onload=()=>{const n=o.width,s=o.height;if(t<0||r<0||t>n||r>s)return i(new Error(`${t}, ${r} is out of screenshot bound 0, 0 ~ ${n}, ${s}`));const c=document.createElement("canvas");c.width=t+5,c.height=r+5;const l=c.getContext("2d");let u;l.drawImage(o,0,0,t+5,r+5,0,0,t+5,r+5);try{const n=l.getImageData(t,r,1,1).data;u="#"+("000000"+a(n[0],n[1],n[2])).slice(-6),e(u)}catch(e){i(new Error("Failed to get pixel color"+((null==e?void 0:e.message)?`: ${e.message}.`:".")))}},o.src=n})},t.scaleRect=function(e,t){return{x:t*e.x,y:t*e.y,width:t*e.width,height:t*e.height}},t.isEditable=function(e){if("true"===e.contentEditable)return!0;const t=(e.tagName||"").toLowerCase();if(-1===["input","textarea"].indexOf(t))return!1;const r=e.disabled,n=e.readOnly;return!r&&!n},t.hasAncestor=function(e,t){let r=e;for(;r;){if(t(r))return!0;r=r.parentNode}return!1},t.getAncestor=function(e,t){let r=e;for(;r;){if(t(r))return r;r=r.parentNode}return null}},27:function(e,t,r){"use strict";r.r(t);var n=r(55);r.d(t,"win32",(function(){return n.win32})),r.d(t,"posix",(function(){return n.posix}));var i=/windows/i.test(window.navigator.userAgent)?n.win32:n.posix;t.default=i},32:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(90),o=r(60),s=r(12),a=n(r(27));class c extends i.XModule{getName(){return i.XModuleTypes.XFile}getAPI(){return o.getNativeFileSystemAPI()}initConfig(){return this.getConfig().then(e=>{if(!e.rootDir){const e=o.getNativeFileSystemAPI();return e.getSpecialFolderPath({folder:o.SpecialFolder.UserDesktop}).then(t=>{const r=a.default.join(t,"uivision");return e.ensureDir({path:r}).then(e=>{this.setConfig({rootDir:e?r:t})})}).catch(e=>{if(!/Specified native messaging host not found/.test(e))throw e})}})}sanityCheck(e){return Promise.all([this.getConfig(),this.getAPI().getVersion().then(()=>this.getAPI(),()=>this.getAPI().reconnect()).catch(e=>{throw new Error("xFile is not installed yet")})]).then(([t,r])=>{if(e)return!0;if(!t.rootDir)throw new Error("rootDir is not set");return r.directoryExists({path:t.rootDir}).then(e=>{if(!e)throw new Error(`Directory '${t.rootDir}' doesn't exist`);return!0}).then(()=>{const e=a.default.join(t.rootDir,"__kantu__"+Math.round(100*Math.random()));return r.createDirectory({path:e}).then(t=>{if(!t)throw new Error;return r.removeDirectory({path:e})}).then(e=>{if(!e)throw new Error;return!0}).catch(e=>{throw new Error(`Directory '${t.rootDir}' is not writable`)})})})}checkUpdate(){return Promise.reject(new Error("checkUpdate is not implemented yet"))}checkUpdateLink(e,t){return`https://ui.vision/x/idehelp?help=xfileaccess_updatecheck&xversion=${e}&kantuversion=${t}`}downloadLink(){return"https://ui.vision/x/idehelp?help=xfileaccess_download"}infoLink(){return"https://ui.vision/x/idehelp?help=xfileaccess"}}t.XFile=c,t.getXFile=s.singletonGetter(()=>new c)},34:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});n(r(10)).default.isFirefox();t.default={preinstall:{version:"5.8.8",macroFolder:"/Demo"},urlAfterUpgrade:"https://ui.vision/x/idehelp?help=k_update",urlAfterInstall:"https://ui.vision/x/idehelp?help=k_welcome",urlAfterUninstall:"https://ui.vision/x/idehelp?help=k_why",performanceLimit:{fileCount:1/0},xmodulesLimit:{unregistered:{ocrCommandCount:100,xCommandCount:25,xFileMacroCount:10,proxyExecCount:5,upgradeUrl:"https://ui.vision/x/idehelp?help=k_xupgrade"},free:{ocrCommandCount:250,xCommandCount:1/0,xFileMacroCount:20,proxyExecCount:10,upgradeUrl:"https://ui.vision/x/idehelp?help=k_xupgradepro"},pro:{ocrCommandCount:500,xCommandCount:1/0,xFileMacroCount:1/0,proxyExecCount:1/0,upgradeUrl:"https://ui.vision/x/idehelp?help=k_xupgrade_contactsupport"}},xfile:{minVersionToReadBigFile:"1.0.10"},ocr:{apiList:[{id:"1",key:"kantu_only_53b8",url:"https://apipro1.ocr.space/parse/image"},{id:"2",key:"kantu_only_53b8",url:"https://apipro2.ocr.space/parse/image"},{id:"3",key:"kantu_only_53b8",url:"https://apipro3.ocr.space/parse/image"}],apiTimeout:6e4,singleApiTimeout:3e4,apiHealthyResponseTime:2e4,resetTime:864e5},license:{api:{url:"https://license1.ocr.space/api/status"}},icons:{normal:"logo38.png",inverted:"inverted_logo_38.png"},forceMigrationRemedy:!1,iframePostMessageTimeout:500,ui:{commandItemHeight:35},commandRunner:{sendKeysMaxCharCount:1e3}}},36:function(e,t,r){"use strict";r.r(t);var n=r(10),i=r.n(n),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var s=i.a.storage.local,a={get:function(e){return s.get(e).then((function(t){return t[e]}))},set:function(e,t){return s.set(function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,t)).then((function(){return!0}))},remove:function(e){return s.remove(e).then((function(){return!0}))},clear:function(){return s.clear().then((function(){return!0}))},addListener:function(e){i.a.storage.onChanged.addListener((function(t,r){var n=Object.keys(t).map((function(e){return o({},t[e],{key:e})}));e(n)}))}};t.default=a},43:function(e,t,r){"use strict";function n(e){switch(e){case"echo":case"open":case"pause":case"waitForPageToLoad":case"assertAlert":case"assertConfirmation":case"assertPrompt":case"answerOnNextPrompt":case"store":case"storeTitle":case"assertTitle":case"verifyTitle":case"selectWindow":case"captureScreenshot":case"captureDesktopScreenshot":case"refresh":case"deleteAllCookies":case"label":case"gotoLabel":case"csvRead":case"csvReadArray":case"csvSave":case"csvSaveArray":case"captureEntirePageScreenshot":case"onDownload":case"throwError":case"comment":case"onError":case"sourceSearch":case"sourceExtract":case"localStorageExport":case"visionLimitSearchArea":case"visionLimitSearchAreaRelative":case"visualGetPixelColor":case"bringBrowserToForeground":case"bringIDEandBrowserToBackground":case"setWindowSize":case"prompt":case"XRun":case"XRunAndWait":case"XDesktopAutomation":case"setProxy":case"run":case"executeScript":case"executeScript_Sandbox":case"do":case"repeatIf":case"else":case"elseif":case"end":case"if_v2":case"while_v2":case"gotoIf_v2":case"times":case"forEach":return!1;default:return!0}}Object.defineProperty(t,"__esModule",{value:!0}),t.availableCommands=(()=>{const e=["open","click","clickAndWait","select","selectAndWait","addSelection","removeSelection","type","pause","waitForPageToLoad","selectFrame","assertAlert","assertConfirmation","assertPrompt","answerOnNextPrompt","store","storeText","storeTitle","storeAttribute","storeXpathCount","assertText","assertTitle","clickAt","echo","mouseOver","verifyText","verifyTitle","sendKeys","dragAndDropToObject","selectWindow","captureScreenshot","captureDesktopScreenshot","refresh","assert","assertElementPresent","assertElementNotPresent","assertEditable","assertNotEditable","verify","verifyElementPresent","verifyElementNotPresent","verifyEditable","verifyNotEditable","deleteAllCookies","label","gotoLabel","csvRead","csvReadArray","csvSave","csvSaveArray","storeValue","assertValue","verifyValue","storeChecked","captureEntirePageScreenshot","onDownload","throwError","comment","waitForElementVisible","waitForElementNotVisible","waitForElementPresent","waitForElementNotPresent","onError","sourceSearch","sourceExtract","storeImage","localStorageExport","visionLimitSearchArea","visionLimitSearchAreaRelative","visualSearch","visualVerify","visualAssert","visualGetPixelColor","editContent","bringBrowserToForeground","bringIDEandBrowserToBackground","setWindowSize","prompt","XRun","XRunAndWait","XClick","XClickRelative","XType","XMove","XMoveRelative","XMouseWheel","XDesktopAutomation","OCRSearch","OCRExtract","OCRExtractRelative","setProxy","run","executeScript","executeScript_Sandbox","check","uncheck","assertChecked","assertNotChecked","verifyChecked","verifyNotChecked","do","repeatIf","else","elseif","end","if_v2","while_v2","gotoIf_v2","times","forEach","break","continue"];return e.sort((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1),e})(),t.normalizeCommandName=function(e){if(!e)return"";const r=e.toLowerCase(),n=t.availableCommands.map(e=>e.toLowerCase()).findIndex(e=>e===r);return-1===n?e:t.availableCommands[n]},t.commandText=function(e){switch(e){case"if":case"while":case"gotoIf":return e+"_v1_deprecated";case"storeEval":case"endif":case"endwhile":case"resize":return e+"_deprecated";default:return e}},t.isValidCmd=function(e){return-1!==t.availableCommands.indexOf(e)},t.isExtensionResourceOnlyCommand=function(e){switch(e){case"if":case"while":case"gotoIf":case"if_v2":case"while_v2":case"gotoIf_v2":case"executeScript_Sandbox":case"run":case"store":case"echo":case"prompt":case"throwError":case"pause":case"localStorageExport":return!0;default:return!1}},t.canCommandReadImage=function(e){switch(e){case"visualSearch":case"visualVerify":case"visualAssert":case"XClick":case"XClickRelative":case"XMove":case"XMoveRelative":case"OCRExtract":case"OCRExtractRelative":return!0;default:return!1}},t.canCommandReadCsv=function(e){switch(e){case"csvRead":case"csvReadArray":return!0;default:return!1}},t.canCommandRunMacro=function(e){switch(e){case"run":return!0;default:return!1}},t.doesCommandSupportTargetOptions=function(e){switch(e){case"click":case"clickAndWait":case"select":case"selectAndWait":case"type":case"mouseOver":case"verifyText":case"sendKeys":case"dragAndDropToObject":case"assertElementPresent":case"assertEditable":case"assertNotEditable":case"verifyElementPresent":case"verifyEditable":case"verifyNotEditable":case"storeValue":case"assertValue":case"verifyValue":case"storeChecked":case"waitForElementVisible":case"waitForElementPresent":case"XClick":case"XClickRelative":case"XMove":case"XMoveRelative":case"check":case"uncheck":case"assertChecked":case"assertNotChecked":case"verifyChecked":case"verifyNotChecked":return!0;default:return!1}},t.canCommandFind=n,t.canCommandSelect=function(e){const t=n(e);if(t)return t;switch(e){case"visualGetPixelColor":return!0;default:return!1}},t.indentCreatedByCommand=function(e){switch(e){case"if":case"if_v2":case"while":case"while_v2":case"do":case"times":case"forEach":return{selfIndent:0,nextIndent:1};case"else":case"elseif":return{selfIndent:-1,nextIndent:1};case"end":case"endif":case"endwhile":case"repeatIf":return{selfIndent:-1,nextIndent:0};default:return{selfIndent:0,nextIndent:0}}},t.parseImageTarget=function(e){if(!e||!e.length)return null;const t=e.match(/^([^@#]+?\.png)(?:@([\d.]+))?(?:#(\d+))?(?:\[([^\]]+)\])?$/);return t?{fileName:t[1],confidence:t[2]?parseFloat(t[2]):void 0,index:t[3]?parseInt(t[3])-1:void 0,imageUrl:t[4]}:null}},50:function(e,t,r){"use strict";r.r(t),r.d(t,"toHtml",(function(){return f})),r.d(t,"generateEmptyHtml",(function(){return m})),r.d(t,"toHtmlDataUri",(function(){return g})),r.d(t,"fromHtml",(function(){return p})),r.d(t,"fromJSONString",(function(){return y})),r.d(t,"toJSONString",(function(){return v})),r.d(t,"toJSONDataUri",(function(){return w})),r.d(t,"toBookmarkData",(function(){return b})),r.d(t,"generateMacroEntryHtml",(function(){return x}));r(108);var n=r(66),i=r.n(n),o=r(83),s=r.n(o),a=r(104),c=r.n(a),l=r(43),u=r(13),h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function d(e){var t=e.name,r=e.baseUrl,n=e.commandTrs,i=e.noImport;return'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n<head profile="http://selenium-ide.openqa.org/profiles/test-case">\n<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n'+(i?"":'<link rel="selenium.base" href="'+r+'" />')+"\n<title>"+t+"</title>\n</head>\n<body>\n"+(i?"<h3>Starting Browser and UI.Vision...</h3>":'\n    <table cellpadding="1" cellspacing="1" border="1">\n    <thead>\n    <tr><td rowspan="1" colspan="3">'+t+"</td></tr>\n    </thead><tbody>\n    "+n.join("\n")+"\n    </tbody></table>\n  ")+"\n<script>\n(function() {\n  var isExtensionLoaded = function () {\n    const $root = document.documentElement\n    return !!$root && !!$root.getAttribute('data-kantu')\n  }\n  var increaseCountInUrl = function (max) {\n    var url   = new URL(window.location.href)\n    var count = 1 + (parseInt(url.searchParams.get('reload') || 0))\n\n    url.searchParams.set('reload', count)\n    var nextUrl = url.toString()\n\n    var shouldStop = count > max\n    return [shouldStop, !shouldStop ? nextUrl : null]\n  }\n  var run = function () {\n    try {\n      var evt = new CustomEvent('kantuSaveAndRunMacro', {\n        detail: {\n          html: document.documentElement.outerHTML,\n          noImport: "+(i||"false")+",\n          storageMode: '"+Object(u.getStorageManager)().getCurrentStrategyType()+"'\n        }\n      })\n\n      window.dispatchEvent(evt)\n      var intervalTimer = setInterval(() => window.dispatchEvent(evt), 1000);\n\n      if (window.location.protocol === 'file:') {\n        var onInvokeSuccess = function () {\n          clearTimeout(timer)\n          clearTimeout(reloadTimer)\n          clearInterval(intervalTimer)\n          window.removeEventListener('kantuInvokeSuccess', onInvokeSuccess)\n        }\n        var timer = setTimeout(function () {\n          alert('Error #203: It seems you need to turn on *Allow access to file URLs* for Kantu in your browser extension settings.')\n        }, 8000)\n\n        window.addEventListener('kantuInvokeSuccess', onInvokeSuccess)\n      }\n    } catch (e) {\n      alert('Kantu Bookmarklet error: ' + e.toString());\n    }\n  }\n  var reloadTimer = null\n  var main = function () {\n    if (isExtensionLoaded())  return run()\n\n    var MAX_TRY   = 3\n    var INTERVAL  = 1000\n    var tuple     = increaseCountInUrl(MAX_TRY)\n\n    if (tuple[0]) {\n      return alert('Error #204: It seems UI.Vision RPA is not installed yet - or you need to turn on *Allow access to file URLs* for UI.Vision RPA in your browser extension settings.')\n    } else {\n      reloadTimer = setTimeout(function () {\n        window.location.href = tuple[1]\n      }, INTERVAL)\n    }\n  }\n\n  setTimeout(main, 500)\n})();\n<\/script>\n</body>\n</html>\n  "}function f(e){var t=e.name,r=e.commands.map((function(e){return h({},e)})),n=r.find((function(e){return"open"===e.cmd}));return n&&(n.target=n.target),d({name:t,commandTrs:r.map((function(e){return"open"===e.cmd&&(e.target=e.target),"\n      <tr>\n        <td>"+(e.cmd||"")+"</td>\n        <td>"+(e.target||"")+"</td>\n        <td>"+(e.value||"")+"</td>\n      </tr>\n    "})),baseUrl:""})}function m(){return d({name:"UI.Vision Autostart Page",commandTrs:[],baseUrl:"",noImport:!0})}function g(e){return t=f(e),"data:text/html;base64,"+window.btoa(unescape(encodeURIComponent(t)));var t}function p(e){var t=s()("<div>"+e+"</div>"),r=t.find("link"),n=t.find("title"),i=t.find("tbody > tr"),o=r&&r.attr("href"),a=n.text();if(!a||!a.length)throw new Error("fromHtml: missing title");return{name:a,data:{commands:[].slice.call(i).map((function(e){var t=s()(e),r=t[0].outerHtml;t.find("datalist").remove();var n,i,a=t.children(),u=a.eq(0),h=a.eq(1),d=a.eq(2),f=Object(l.normalizeCommandName)(u&&u.text()),m=d&&d.text(),g=h&&h.text();if(!f||!f.length)throw new Error("missing cmd in "+r);return"open"===f&&(g=o&&o.length&&!/:\/\//.test(g)?(n=o,i=g,new c.a(i,n).toString()):g),{cmd:f,target:g,value:m}}))}}}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i()(e.replace(/^\s*/,"")),o=t?t.replace(/\.json$/i,""):n.Name||"__imported__";if(n.macros)throw new Error("This is a test suite, not a macro");if(!Array.isArray(n.Commands))throw new Error("'Commands' field must be an array");var s=n.Commands.map((function(e){var t={cmd:Object(l.normalizeCommandName)(e.Command),target:e.Target,value:e.Value,description:e.Description||""};return Array.isArray(e.Targets)&&(t.targetOptions=e.Targets),t}));return h({name:o,data:{commands:s}},r.withStatus&&n.status?{status:n.status}:{},r.withId&&n.id?{id:n.id}:{})}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(){var e=new Date;return[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-")},n=h({Name:e.name,CreationDate:r(),Commands:e.commands.map((function(e){return{Command:e.cmd,Target:e.target||"",Value:e.value||"",Targets:t.ignoreTargetOptions?e.targetOptions:void 0,Description:e.description||""}}))},t.withStatus&&e.status?{status:e.status}:{},t.withId&&e.id?{id:e.id}:{});return JSON.stringify(n,null,2)}function w(e){return t=v(e),"data:text/json;base64,"+window.btoa(unescape(encodeURIComponent(t)));var t}function b(e){var t=e.path,r=e.bookmarkTitle;if(!t)throw new Error("path is required to generate bookmark for macro");if(!r)throw new Error("bookmarkTitle is required to generate bookmark for macro");return{title:r,url:("javascript:\n      (function() {\n        try {\n          var evt = new CustomEvent('kantuRunMacro', {\n            detail: {\n              name: "+JSON.stringify(t.replace(/\.json$/i,""))+",\n              from: 'bookmark',\n              storageMode: '"+Object(u.getStorageManager)().getCurrentStrategyType()+"',\n              closeRPA: 1\n            }\n          });\n          window.dispatchEvent(evt);\n        } catch (e) {\n          alert('UI.Vision RPA Bookmarklet error: ' + e.toString());\n        }\n      })();\n    ").replace(/\n\s*/g,"")}}function x(e){return'<!doctype html>\n<html lang="en">\n  <head>\n    <title>UI.Vision Shortcut Page</title>\n  </head>\n  <body>\n    <h3>Command line:</h3>\n    <a id="run" href="ui.vision.html?direct=1&savelog=log.txt&macro='+e+'">Click here</a>\n    <br>\n    <br>\n\t\x3c!-- To start another macro just edit this HTML file and change the macro name in the command line above^. --\x3e\n\t\x3c!-- For more command line parameters see https://ui.vision/rpa/docs#cmd --\x3e\n    <script>\n      window.location.href = document.getElementById("run").getAttribute("href");\n    <\/script>\n  </body>\n</html>\n'}},60:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(124),o=r(125),s=r(12),a=n(r(11)),c=n(r(27)),l=r(126),u=r(127),h=r(4),d=n(r(135)),f=n(r(34));!function(e){e[e.UserProfile=0]="UserProfile",e[e.UserDesktop=1]="UserDesktop"}(t.SpecialFolder||(t.SpecialFolder={})),t.getNativeFileSystemAPI=s.singletonGetter(()=>{const e=new o.KantuFileAccessHost;let t=e.connectAsync().catch(e=>{throw a.default.warn("pReady - error",e),e}),r=0;const n=i.MethodTypeInvocationNames.reduce((i,o)=>{const a=s.snakeToCamel(o);return i[a]||(i[a]=i=>t.then(()=>(r+=1,e.invokeAsync(o,i))).then(e=>(r-=1,e),e=>{throw r-=1,n.reconnect().catch(()=>{}),e})),i},{reconnect:()=>s.until("pendingRequestCount === 0",()=>({pass:0===r,result:!0})).then(()=>(a.default("FileSystem - reconnect",(new Error).stack),e.disconnect(),t=e.connectAsync(),t.then(()=>n))),getEntries:e=>{const t=n;return t.getFileSystemEntries(e).then(r=>{const{errorCode:n,entries:i}=r;return e.brief?Promise.resolve({errorCode:n,entries:i.map(e=>({name:e,length:0,isDirectory:!1,lastWriteTime:0}))}):Promise.all(i.map(r=>{const n=c.default.join(e.path,r);return t.getFileSystemEntryInfo({path:n}).then(e=>({name:r,length:e.length,isDirectory:e.isDirectory,lastWriteTime:e.lastWriteTime}))})).then(e=>({errorCode:n,entries:e}))})},ensureDir:e=>{const t=n;return t.directoryExists({path:e.path}).then(r=>!!r||t.ensureDir({path:c.default.dirname(e.path)}).then(r=>!!r&&t.createDirectory({path:e.path}))).catch(e=>!1)},readBigFile:e=>{const t=n;return t.getFileSize(e).then(r=>{if(0===r)return new Uint8Array(0);const n=[],i=o=>t.readFileRange({path:e.path,rangeStart:o}).then(e=>{const t=u.base64.decode(e.buffer);if(t)for(let e=0;e<t.length;e++)n.push(t[e]);return e.rangeEnd<=o||e.rangeEnd>=r?new Uint8Array(n):i(e.rangeEnd)});return i(0)})},isReadBigFileSupported:()=>n.getVersion().then(e=>!d.default.lt(e,f.default.xfile.minVersionToReadBigFile)),readAllTextCompat:e=>{const t=n;return t.isReadBigFileSupported().then(r=>r?t.readBigFile(e).then(e=>({errorCode:0,content:l.utf8.decode(e)})):t.readAllText(e))},readAllBytesCompat:e=>{const t=n;return t.isReadBigFileSupported().then(r=>r?t.readBigFile(e).then(e=>h.blobToDataURL(new Blob([e])).then(e=>({errorCode:0,content:e}))):t.readAllBytes(e))}});return n})},69:function(e,t,r){"use strict";r.r(t),r.d(t,"stringifyTestSuite",(function(){return c})),r.d(t,"parseTestSuite",(function(){return l})),r.d(t,"validateTestSuiteText",(function(){return u})),r.d(t,"toBookmarkData",(function(){return h})),r.d(t,"toHtml",(function(){return d}));r(108);var n=r(66),i=r.n(n),o=r(4),s=r(13),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a({creationDate:Object(o.formatDate)(new Date),name:e.name,macros:e.cases.map((function(e){var t=parseInt(e.loops,10);return{macro:e.testCaseId,loops:t}}))},t.withFold?{fold:!!e.fold}:{},t.withId&&e.id?{id:e.id}:{},t.withPlayStatus&&e.playStatus?{playStatus:e.playStatus}:{});return JSON.stringify(r,null,2)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i()(e.replace(/^\s*/,""));if("string"!=typeof r.name||0===r.name.length)throw new Error("name must be a string");if(!Array.isArray(r.macros))throw new Error("macros must be an array");var n=r.macros.map((function(e){return("number"!=typeof e.loops||e.loops<1)&&(e.loops=1),{testCaseId:e.macro,loops:e.loops}})),o=a({cases:n,name:t.fileName?t.fileName.replace(/\.json$/i,""):r.name},t.withFold?{fold:void 0===r.fold||r.fold}:{},t.withId&&r.id?{id:r.id}:{},t.withPlayStatus&&r.playStatus?{playStatus:r.playStatus}:{});return o},u=l,h=function(e){var t=e.name,r=e.bookmarkTitle;if(!t)throw new Error("name is required to generate bookmark for test suite");if(!r)throw new Error("bookmarkTitle is required to generate bookmark for test suite");return{title:r,url:("javascript:\n      (function() {\n        try {\n          var evt = new CustomEvent('kantuRunTestSuite', {\n            detail: {\n              name: '"+t+"',\n              from: 'bookmark',\n              storageMode: '"+Object(s.getStorageManager)().getCurrentStrategyType()+"',\n              closeRPA: 1\n            }\n          });\n          window.dispatchEvent(evt);\n        } catch (e) {\n          alert('UI.Vision RPA Bookmarklet error: ' + e.toString());\n        }\n      })();\n    ").replace(/\n\s*/g,"")}},d=function(e){var t=e.name;return'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n<head>\n<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n<title>'+t+"</title>\n</head>\n<body>\n<h1>"+t+"</h1>\n<script>\n(function() {\n  var isExtensionLoaded = function () {\n    const $root = document.documentElement\n    return !!$root && !!$root.getAttribute('data-kantu')\n  }\n  var increaseCountInUrl = function (max) {\n    var url   = new URL(window.location.href)\n    var count = 1 + (url.searchParams.get('reload') || 0)\n\n    url.searchParams.set('reload', count)\n    var nextUrl = url.toString()\n\n    var shouldStop = count > max\n    return [shouldStop, !shouldStop ? nextUrl : null]\n  }\n  var run = function () {\n    try {\n      var evt = new CustomEvent('kantuRunTestSuite', { detail: { name: '"+t+"', from: 'html', storageMode: '"+Object(s.getStorageManager)().getCurrentStrategyType()+"' } })\n\n      window.dispatchEvent(evt)\n      var intervalTimer = setInterval(() => window.dispatchEvent(evt), 1000);\n\n      if (window.location.protocol === 'file:') {\n        var onInvokeSuccess = function () {\n          clearTimeout(timer)\n          clearTimeout(reloadTimer)\n          clearInterval(intervalTimer)\n          window.removeEventListener('kantuInvokeSuccess', onInvokeSuccess)\n        }\n        var timer = setTimeout(function () {\n          alert('Error #201: It seems you need to turn on *Allow access to file URLs* for Kantu in your browser extension settings.')\n        }, 8000)\n\n        window.addEventListener('kantuInvokeSuccess', onInvokeSuccess)\n      }\n    } catch (e) {\n      alert('UI.Vision RPA Bookmarklet error: ' + e.toString());\n    }\n  }\n  var main = function () {\n    if (isExtensionLoaded())  return run()\n\n    var MAX_TRY   = 3\n    var INTERVAL  = 1000\n    var tuple     = increaseCountInUrl(MAX_TRY)\n\n    if (tuple[0]) {\n      return alert('Error #202: It seems UI.Vision RPA is not installed yet, *or* you need to turn on *Allow access to file URLs* for UI.Vision RPA.')\n    } else {\n      setTimeout(function () {\n        window.location.href = tuple[1]\n      }, INTERVAL)\n    }\n  }\n\n  main()\n})();\n<\/script>\n</body>\n</html>\n  "}},76:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(81)),o=r(79),s=r(4),a=r(12);var c;!function(e){e.ListChanged="list_changed",e.FilesChanged="files_changed"}(c=t.FlatStorageEvent||(t.FlatStorageEvent={}));class l extends i.default{constructor(e={}){super(),this.encode=(e,t)=>e,this.decode=(e,t)=>e,this.emitListChanged=o(()=>{this.list().then(e=>{this.emit(c.ListChanged,e)})},100),this.changedFileNames=[],this.__emitFilesChanged=o(()=>{const e=this.changedFileNames;return this.changedFileNames=[],Promise.all(e.map(e=>this.read(e,"Text").catch(()=>null))).then(t=>{if(0===t.length)return;const r=t.map((t,r)=>({content:t,fileName:e[r]})).filter(e=>!!e.content);this.emit(c.FilesChanged,r)})},100),e.decode&&(this.decode=e.decode),e.encode&&(this.encode=e.encode)}list(){return this.__list().then(e=>(e.sort((e,t)=>{const r=e.fileName.toLowerCase(),n=t.fileName.toLowerCase();return r<n?-1:r>n?1:0}),e))}readAll(e="Text",t){return this.list().then(t=>Promise.all(t.map(t=>this.read(t.fileName,e).then(e=>({content:e,fileName:t.fileName})))))}bulkWrite(e){return Promise.all(e.map(e=>this.write(e.fileName,e.content))).then(()=>{})}write(e,t){return this.exists(e).then(r=>this.__write(e,t).then(()=>{r||this.emitListChanged(),this.emitFilesChanged([e])}))}overwrite(e,t){return this.__overwrite(e,t).then(()=>{this.emitFilesChanged([e])})}clear(){return this.__clear().then(()=>{this.emitListChanged()})}remove(e){return this.__remove(e).then(()=>{this.emitListChanged()})}rename(e,t){return this.__rename(e,t).then(()=>{this.emitListChanged(),this.emitFilesChanged([t])})}copy(e,t){return(t&&t.length?Promise.resolve(t):a.uniqueName(e,{generate:(e,t=1)=>{const r=/-(\d+)$/;return e.match(r)?e.replace(r,(e,r)=>`-${parseInt(r,10)+t}`):`${e}-${t}`},check:e=>this.exists(e).then(e=>!e),postfixReg:/(_relative)?\.\w+$/})).then(t=>this.__copy(e,t).then(()=>{this.emitListChanged(),this.emitFilesChanged([t])}))}emitFilesChanged(e){this.changedFileNames=e.reduce((e,t)=>(-1===e.indexOf(t)&&e.push(t),e),this.changedFileNames),this.__emitFilesChanged()}}t.FlatStorage=l,t.readableSize=e=>e<1024?e+" byte":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",t.checkFileName=function(e){s.withFileExtension(e,t=>{try{s.validateStandardName(t,!0)}catch(t){throw new Error(`Invalid file name '${e}'. File name `+t.message)}return t})}},89:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(81)),o=r(79),s=r(12),a=r(27),c=r(122);var l,u;!function(e){e.ListChanged="list_changed",e.FilesChanged="files_changed"}(l=t.StorageEvent||(t.StorageEvent={})),function(e){e[e.Unknown=0]="Unknown",e[e.NonExistent=1]="NonExistent",e[e.File=2]="File",e[e.Directory=3]="Directory"}(u=t.EntryStatus||(t.EntryStatus={}));class h extends i.default{constructor(e={}){super(),this.encode=(e,t)=>e,this.decode=(e,t)=>e,this.displayedCount=0,this.totalCount=0,this.listFilter=e=>e,this.emitListChanged=o(()=>{this.list("/").then(e=>{this.emit(l.ListChanged,e)})},100),this.changedFileNames=[],this.__emitFilesChanged=o(()=>{const e=this.changedFileNames;return this.changedFileNames=[],Promise.all(e.map(e=>this.read(e,"Text").catch(()=>null))).then(t=>{if(0===t.length)return;const r=t.map((t,r)=>({content:t,fileName:e[r]})).filter(e=>!!e.content);this.emit(l.FilesChanged,r)})},100),e.decode&&(this.decode=e.decode),e.encode&&(this.encode=e.encode),e.listFilter&&(this.listFilter=e.listFilter)}getPathLib(){return this.isWin32Path()?a.win32:a.posix}relativePath(e,t){const r=t?this.dirPath(e):this.filePath(e),n=this.dirPath("/");return this.getPathLib().relative(n,r)}entryPath(e,t){return t?this.dirPath(e):this.filePath(e)}list(e="/",t=!1){return this.__list(e,t).then(e=>this.sortEntries(e))}listR(e="/"){const t=e=>this.list(e,!1).then(e=>Promise.all(e.map(e=>e.isDirectory?t(e.fullPath):Promise.resolve(null))).then(t=>this.sortEntries(e.map((e,r)=>Object.assign(Object.assign({},e),{children:t[r]||[]})))));return t(e).then(t=>"/"!==e?t:Promise.resolve(this.listFilter(t)).then(e=>(this.totalCount=s.sum(...t.map(s.nodeCount)),this.displayedCount=s.sum(...e.map(s.nodeCount)),e)))}getDisplayCount(){return this.displayedCount}getTotalCount(){return this.totalCount}exists(e){return this.stat(e).then(({isFile:e,isDirectory:t})=>e||t,()=>!1)}fileExists(e){return this.stat(e).then(e=>e.isFile,()=>!1)}directoryExists(e){return this.stat(e,!0).then(e=>e.isDirectory,()=>!1)}readR(e,t="Text",r){return this.listR(e).then(e=>Promise.all(e.map(e=>{if(e.isFile)return this.read(e.fullPath,t).then(t=>[{content:t,filePath:e.fullPath}]);if(e.isDirectory)return this.readR(e.fullPath,t);throw new Error("Not file or directory")})).then(e=>s.flatten(e)))}write(e,t){return this.exists(e).then(r=>this.__write(e,t).then(()=>{r||this.emitListChanged(),this.emitFilesChanged([e])}))}overwrite(e,t){return this.__overwrite(e,t).then(()=>{this.emitFilesChanged([e])})}bulkWrite(e){return Promise.all(e.map(e=>this.write(e.filePath,e.content))).then(()=>{})}removeFile(e){return this.__removeFile(e).then(()=>{this.emitListChanged()})}removeEmptyDirectory(e){return this.__removeEmptyDirectory(e).then(()=>{this.emitListChanged()})}removeDirectory(e){return this.remove(e,!0)}remove(e,t){return this.stat(e,t).then(e=>{if(e.isFile)return this.removeFile(e.fullPath);if(e.isDirectory)return this.list(e.fullPath).then(t=>Promise.all(t.map(e=>this.remove(e.fullPath,e.isDirectory))).then(()=>this.removeEmptyDirectory(e.fullPath)));throw new Error("Not file or directory")})}clear(){return this.list("/").then(e=>Promise.all(e.map(e=>this.remove(e.fullPath))).then(()=>{}))}moveFile(e,t){return this.__moveFile(e,t).then(()=>{this.emitListChanged()})}copyFile(e,t){return this.__copyFile(e,t).then(()=>{this.emitListChanged()})}moveDirectory(e,t){return this.move(e,t,!0,!0)}copyDirectory(e,t){return this.copy(e,t,!0,!0)}move(e,t,r,n){const i=this.entryPath(e,r),o=this.entryPath(t,n);if(i===o)throw new Error("move: src should not be the same as dst");if(this.getPathLib().dirname(i)===o)throw new Error("move: cannot move to original dir");if(r&&n&&this.isTargetInSourceDirectory(t,e))throw new Error("Cannot move a directory into its sub directory");return this.copy(e,t,r,n).then(()=>this.remove(e,r))}copy(e,t,r,n){const i=this.getPathLib().dirname(e)===this.getPathLib().dirname(t);if(e===t)throw new Error("copy: dst should not be the same as src");return Promise.all([this.getEntryStatus(e,r),this.getEntryStatus(t,n),i?Promise.resolve(u.Directory):this.getEntryStatus(this.getPathLib().dirname(t),!0)]).then(r=>{const[n,i,o]=r;if(o!==u.Directory)throw new c.ENOTDIR(this.getPathLib().dirname(t));switch(n){case u.NonExistent:throw new c.ENOENT(e);case u.Unknown:throw new Error(`source (${e}) exists but is neither a file nor a directory`);case u.File:switch(i){case u.File:throw new c.EEXIST(t);case u.Unknown:throw new Error(`dst '${t}' is neither a file nor directory`);case u.Directory:{const r=this.getPathLib().resolve(t,this.getPathLib().basename(e));return this.copyFile(e,r)}case u.NonExistent:return this.copyFile(e,t)}case u.Directory:switch(i){case u.File:throw new Error(`dst '${t}' is an existing file, but src '${e}' is a directory`);case u.Unknown:throw new Error(`dst '${t}' is neither a file nor directory`);case u.Directory:{if(this.isTargetInSourceDirectory(t,e))throw new Error("Cannot copy a directory into its sub directory");const r=this.getPathLib().resolve(t,this.getPathLib().basename(e));return this.ensureDirectory(r).then(()=>this.copyAllInDirectory(e,r))}case u.NonExistent:return this.ensureDirectory(t).then(()=>this.copyAllInDirectory(e,t))}}})}createDirectory(e){return this.mkdir(e,!1)}ensureDirectory(e){return this.getEntryStatus(e,!0).then(t=>{switch(t){case u.File:case u.Unknown:throw new c.EEXIST;case u.Directory:return;case u.NonExistent:return this.mkdir(e,!0)}})}ensureDir(){return this.ensureDirectory("/")}rename(e,t){return this.move(e,t)}readAll(e="Text",t){return this.list("/").then(r=>Promise.all(r.filter(e=>e.isFile).map(t=>this.read(t.fullPath,e).then(e=>({content:e,fileName:t.name})).catch(e=>({fileName:t.name,fullFilePath:t.fullPath,error:new Error(`Error in parsing ${t.fullPath}:\n${e.message}`)})))).then(e=>{const r=e.filter(e=>e.error);return t&&t(r),e.filter(e=>e.content)}))}isTargetInSourceDirectory(e,t){const r=this.dirPath(e),n=this.dirPath(t),i=this.getPathLib().sep;return-1===this.getPathLib().relative(n,r).split(i).indexOf("..")}sortEntries(e){const t=[...e];return t.sort((e,t)=>{if(e.isDirectory&&t.isFile)return-1;if(e.isFile&&t.isDirectory)return 1;const r=e.name.toLowerCase(),n=t.name.toLowerCase();return r<n?-1:r>n?1:0}),t}copyAllInDirectory(e,t){return this.list(e).then(e=>Promise.all(e.map(e=>{if(e.isFile)return this.copyFile(e.fullPath,this.getPathLib().resolve(t,e.name));if(e.isDirectory){const r=this.getPathLib().resolve(t,e.name);return this.ensureDirectory(r).then(()=>this.copyAllInDirectory(e.fullPath,r))}return Promise.resolve()})).then(()=>{}))}mkdir(e,t=!1){return(()=>t?Promise.resolve():this.getEntryStatus(e,!0).then(t=>{if(t!==u.NonExistent)throw new c.EEXIST(e)}))().then(()=>{const t=this.getPathLib().dirname(e);return"/"===t?this.__createDirectory(e):this.getEntryStatus(t,!0).then(r=>{switch(r){case u.File:case u.Unknown:throw new c.EEXIST(t);case u.Directory:return this.__createDirectory(e);case u.NonExistent:return this.mkdir(t,!0).then(()=>this.__createDirectory(e))}})}).then(()=>{this.emitListChanged()})}getEntryStatus(e,t){return this.stat(e,t).then(e=>e.isFile?u.File:e.isDirectory?u.Directory:u.NonExistent,e=>u.NonExistent)}emitFilesChanged(e){this.changedFileNames=e.reduce((e,t)=>(-1===e.indexOf(t)&&e.push(t),e),this.changedFileNames),this.__emitFilesChanged()}}t.StandardStorage=h},90:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(36));!function(e){e.XFile="xFile",e.XUserIO="xClick",e.XDesktop="xDesktop",e.XScreenCapture="xScreenCapture"}(t.XModuleTypes||(t.XModuleTypes={}));t.XModule=class{constructor(){this.cachedConfig={},this.initConfig()}getVersion(){return this.getAPI().reconnect().catch(e=>{throw new Error(`${this.getName()} is not installed yet`)}).then(e=>e.getVersion().then(e=>({version:e,installed:!0}))).catch(e=>({installed:!1}))}setConfig(e){return this.cachedConfig=Object.assign(Object.assign({},this.cachedConfig),e),this.getConfig().then(t=>{const r=Object.assign(Object.assign({},t),e);return i.default.set(this.getStoreKey(),r).then(e=>(e&&(this.cachedConfig=r),e))})}getConfig(){return i.default.get(this.getStoreKey()).then(e=>(this.cachedConfig=e||{},this.cachedConfig))}getCachedConfig(){return this.cachedConfig}getStoreKey(){return this.getName().toLowerCase()}}},97:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t,r,n){this.requestObject={id:e,method:t,params:r},this.callback=n}get request(){return this.requestObject}}t.NativeMessagingHost=class{constructor(e){this.internalHostName=e,this.nextInvocationId=1,this.queue=new Array,this.handleMessage=this.handleMessage.bind(this),this.handleDisconnect=this.handleDisconnect.bind(this)}processResponse(e,t,r){let n=void 0;for(let t=0;t<this.queue.length;++t){const r=this.queue[t];if(r.request.id===e){n=r.callback,this.queue.splice(t,1);break}}n&&n(t,r)}handleMessage(e){const t=e;"number"==typeof t.id&&this.processResponse(t.id,t.result,t.error)}handleDisconnect(){this.disconnect()}get hostName(){return this.internalHostName}connectAsync(){return this.port||(this.port=chrome.runtime.connectNative(this.hostName),this.port.onMessage.addListener(this.handleMessage),this.port.onDisconnect.addListener(this.handleDisconnect)),this.invokeAsync("get_version",void 0)}disconnect(){const e=chrome.runtime.lastError&&chrome.runtime.lastError.message||"Disconnected";this.port&&(this.port.disconnect(),this.port=void 0);const t=this.queue.map(e=>e.request.id);for(const r of t)this.processResponse(r,void 0,{message:e});this.queue=new Array}invoke(e,t,r){if(!this.port)return void r(void 0,{message:"Disconnected"});const i=this.nextInvocationId++,o=new n(i,e,t,r);this.queue.push(o),this.port.postMessage(o.request)}invokeAsync(e,t){return new Promise((r,n)=>{this.invoke(e,t,(e,t)=>{chrome.runtime.lastError&&(t=new Error(chrome.runtime.lastError.message)),t?n(t):r(e)})})}}}});