!function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],d=0,m=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&m.push(a[i][0]),a[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);m.length;)m.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={8:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([1086,1,0]),r()}({100:function(e,t,r){"use strict";r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return $})),r.d(t,"a",(function(){return Y})),r.d(t,"d",(function(){return H}));var n=r(149),a=r(192),o=r.n(a),i=r(4),s=r(22),c=r(12),l=r(63),u=r(10),d=r.n(u),m=r(11),p=r.n(m),h=r(360),f=r.n(h),g=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var b={DOWN:1,PRESS:2,UP:4,INPUT:8};b.ALL=b.DOWN|b.PRESS|b.UP|b.INPUT;var y=function e(t,r){v(this,e),this.modifiers=t,this.ctrlKey=!!(1&t),this.metaKey=!!(2&t),this.altKey=!!(4&t),this.shiftKey=!!(8&t),this.keyCode=r};y.CTRL=1,y.META=2,y.ALT=4,y.SHIFT=8;var w=function(){function e(t,r){v(this,e),this._charCodeKeyCodeMap=t,this._actionKeyCodeMap=r}return g(e,[{key:"charCodeForKeystroke",value:function(e){var t=this._charCodeKeyCodeMap;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=t[r];if(e.keyCode===n.keyCode&&e.modifiers===n.modifiers)return parseInt(r,10)}return null}},{key:"createEventFromKeystroke",value:function(e,t,r){var n=r.ownerDocument,a=n.defaultView.Event,o=void 0;try{o=new a(e)}catch(e){o=n.createEvent("UIEvents")}switch(o.initEvent(e,!0,!0),e){case"textInput":o.data=String.fromCharCode(this.charCodeForKeystroke(t));break;case"keydown":case"keypress":case"keyup":o.shiftKey=t.shiftKey,o.altKey=t.altKey,o.metaKey=t.metaKey,o.ctrlKey=t.ctrlKey,o.keyCode="keypress"===e?this.charCodeForKeystroke(t):t.keyCode,o.charCode="keypress"===e?o.keyCode:0,o.which=o.keyCode}return o}},{key:"dispatchEventsForAction",value:function(e,t){var r=this.keystrokeForAction(e);this.dispatchEventsForKeystroke(r,t)}},{key:"dispatchEventsForInput",value:function(e,t){for(var r=0,n=0,a=e.length;n<a;n++){var o=this.keystrokeForCharCode(e.charCodeAt(n));o&&(this.dispatchModifierStateTransition(t,r,o.modifiers),this.dispatchEventsForKeystroke(o,t,!1),r=o.modifiers)}this.dispatchModifierStateTransition(t,r,0)}},{key:"dispatchEventsForKeystroke",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.ALL;if(e){r&&this.dispatchModifierStateTransition(t,0,e.modifiers,n);var a=void 0;if(n&b.DOWN&&(a=this.createEventFromKeystroke("keydown",e,t)),a&&t.dispatchEvent(a)&&this.targetCanReceiveTextInput(t)){var o=void 0;if(n&b.PRESS&&(o=this.createEventFromKeystroke("keypress",e,t)),o&&o.charCode&&t.dispatchEvent(o)&&n&b.INPUT){var i=this.createEventFromKeystroke("textInput",e,t);t.dispatchEvent(i);var s=this.createEventFromKeystroke("input",e,t);t.dispatchEvent(s)}}if(n&b.UP){var c=this.createEventFromKeystroke("keyup",e,t);t.dispatchEvent(c)}r&&this.dispatchModifierStateTransition(t,e.modifiers,0)}}},{key:"dispatchModifierStateTransition",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.ALL,a=t,o=2==(2&t),i=2==(2&r),s=1==(1&t),c=1==(1&r),l=8==(8&t),u=8==(8&r),d=4==(4&t),m=4==(4&r),p=n&b.UP,h=n&b.DOWN;if(p&&!0===o&&!1===i&&(a&=-3,e.dispatchEvent(this.createEventFromKeystroke("keyup",new y(a,this._actionKeyCodeMap.META),e))),p&&!0===s&&!1===c&&(a&=-2,e.dispatchEvent(this.createEventFromKeystroke("keyup",new y(a,this._actionKeyCodeMap.CTRL),e))),p&&!0===l&&!1===u&&(a&=-9,e.dispatchEvent(this.createEventFromKeystroke("keyup",new y(a,this._actionKeyCodeMap.SHIFT),e))),p&&!0===d&&!1===m&&(a&=-5,e.dispatchEvent(this.createEventFromKeystroke("keyup",new y(a,this._actionKeyCodeMap.ALT),e))),h&&!1===o&&!0===i&&(a|=2,e.dispatchEvent(this.createEventFromKeystroke("keydown",new y(a,this._actionKeyCodeMap.META),e))),h&&!1===s&&!0===c&&(a|=1,e.dispatchEvent(this.createEventFromKeystroke("keydown",new y(a,this._actionKeyCodeMap.CTRL),e))),h&&!1===l&&!0===u&&(a|=8,e.dispatchEvent(this.createEventFromKeystroke("keydown",new y(a,this._actionKeyCodeMap.SHIFT),e))),h&&!1===d&&!0===m&&(a|=4,e.dispatchEvent(this.createEventFromKeystroke("keydown",new y(a,this._actionKeyCodeMap.ALT),e))),a!==r)throw new Error("internal error, expected modifier state: "+r+", got: "+a)}},{key:"keystrokeForAction",value:function(e){var t=null,r=0,n=1===e.length?[e]:e.split("+"),a=n.pop();if(n.forEach((function(t){switch(t.toUpperCase()){case"CTRL":r|=1;break;case"META":r|=2;break;case"ALT":r|=4;break;case"SHIFT":r|=8;break;default:throw console.error("parts",n),new Error('in "'+e+'", invalid modifier: '+t)}})),a.toUpperCase()in this._actionKeyCodeMap)t=this._actionKeyCodeMap[a.toUpperCase()];else{if(1!==a.length)throw new Error('in "'+e+'", invalid action: '+a);var o=this.keystrokeForCharCode(a.charCodeAt(0));if(!o)return null;r|=o.modifiers,t=o.keyCode}return new y(r,t)}},{key:"keystrokeForCharCode",value:function(e){return this._charCodeKeyCodeMap[e]||null}},{key:"targetCanReceiveTextInput",value:function(e){return!!e&&Object(n.a)(e)}}]),e}(),E={32:new y(0,32),33:new y(8,49),34:new y(8,222),35:new y(8,51),36:new y(8,52),37:new y(8,53),38:new y(8,55),39:new y(0,222),40:new y(8,57),41:new y(8,48),42:new y(8,56),43:new y(8,187),44:new y(0,188),45:new y(0,189),46:new y(0,190),47:new y(0,191),48:new y(0,48),49:new y(0,49),50:new y(0,50),51:new y(0,51),52:new y(0,52),53:new y(0,53),54:new y(0,54),55:new y(0,55),56:new y(0,56),57:new y(0,57),58:new y(8,186),59:new y(0,186),60:new y(8,188),61:new y(0,187),62:new y(8,190),63:new y(8,191),64:new y(8,50),65:new y(8,65),66:new y(8,66),67:new y(8,67),68:new y(8,68),69:new y(8,69),70:new y(8,70),71:new y(8,71),72:new y(8,72),73:new y(8,73),74:new y(8,74),75:new y(8,75),76:new y(8,76),77:new y(8,77),78:new y(8,78),79:new y(8,79),80:new y(8,80),81:new y(8,81),82:new y(8,82),83:new y(8,83),84:new y(8,84),85:new y(8,85),86:new y(8,86),87:new y(8,87),88:new y(8,88),89:new y(8,89),90:new y(8,90),91:new y(0,219),92:new y(0,220),93:new y(0,221),94:new y(8,54),95:new y(8,189),96:new y(0,192),97:new y(0,65),98:new y(0,66),99:new y(0,67),100:new y(0,68),101:new y(0,69),102:new y(0,70),103:new y(0,71),104:new y(0,72),105:new y(0,73),106:new y(0,74),107:new y(0,75),108:new y(0,76),109:new y(0,77),110:new y(0,78),111:new y(0,79),112:new y(0,80),113:new y(0,81),114:new y(0,82),115:new y(0,83),116:new y(0,84),117:new y(0,85),118:new y(0,86),119:new y(0,87),120:new y(0,88),121:new y(0,89),122:new y(0,90),123:new y(8,219),124:new y(8,220),125:new y(8,221),126:new y(8,192)};w.US_ENGLISH=new w(E,{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESCAPE:27,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,META:91,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123});var x,S=w.US_ENGLISH,C=function(e){if(null!==e.getAttribute("readonly"))return!1;var t=e.tagName.toUpperCase(),r=(e.type||"").toLowerCase();return"TEXTAREA"===t||"INPUT"===t&&-1!==["text","search","tel","url","email","password","number"].indexOf(r)},T=function(e){return null==e},_=function(e,t,r){T(e.selectionStart)||(e.selectionStart=t),T(e.selectionEnd)||(e.selectionEnd=void 0!==r?r:t)},O=(x={0:null,8:"BACKSPACE",9:"TAB",10:"ENTER",11:null,12:null,13:null},function(e){return e.length>1?e:x[e.charCodeAt(0)]||e});function k(e,t,r){var n=(r?t.split(""):function(e){var t=new RegExp("\\$\\{("+["KEY_LEFT","KEY_UP","KEY_RIGHT","KEY_DOWN","KEY_PGUP","KEY_PAGE_UP","KEY_PGDN","KEY_PAGE_DOWN","KEY_BKSP","KEY_BACKSPACE","KEY_DEL","KEY_DELETE","KEY_ENTER","KEY_TAB"].join("|")+")\\}");return Object(i.splitKeep)(t,e).reduce((function(e,r){return t.test(r)?e.push(r):e=e.concat(r.split("")),e}),[])}(t)).map(O).filter((function(e){return e&&e.length}));e.focus(),e.value&&_(e,e.value.length),n.forEach((function(t){var n=function(e){var t;if(t=e.match(/^\$\{([^}]+)\}$/))switch(t[1]){case"KEY_LEFT":return"LEFT";case"KEY_UP":return"UP";case"KEY_RIGHT":return"RIGHT";case"KEY_DOWN":return"DOWN";case"KEY_PGUP":case"KEY_PAGE_UP":return"PAGEUP";case"KEY_PGDN":case"KEY_PAGE_DOWN":return"PAGEDOWN";case"KEY_BKSP":case"KEY_BACKSPACE":return"BACKSPACE";case"KEY_DEL":case"KEY_DELETE":return"DELETE";case"KEY_ENTER":return"ENTER";case"KEY_TAB":return"TAB"}return e}(t);!function(e,t){if(C(e))if(1===t.length)if(T(e.selectionStart))e.value=e.value+t;else{var r=e.selectionStart;e.value=e.value.substring(0,e.selectionStart)+t+e.value.substring(e.selectionEnd),_(e,r+1)}else switch(t){case"ENTER":e.value=e.value+"\n",_(e,e.value.length);break;case"TAB":e.value=e.value+"\t",_(e,e.value.length);break;case"LEFT":_(e,e.selectionStart-1);break;case"RIGHT":_(e,e.selectionEnd+1);break;case"BACKSPACE":var n=e.selectionStart;e.value=e.value.substring(0,e.selectionStart-1)+e.value.substring(e.selectionEnd),_(e,n-1);break;case"DELETE":var a=e.selectionEnd;e.value=e.value.substring(0,e.selectionStart)+e.value.substring(e.selectionEnd+1),_(e,a)}}(e,n),S.dispatchEventsForAction(n,e),r||function(e,t){if("ENTER"===t&&C(e)){var r=function(e,t){for(var r=e;r=r.parentNode;)if(r.tagName===t.toUpperCase())return r;return null}(e,"FORM");r&&r.submit()}}(e,n)}))}var P=r(136),I=r(17),M=r(34),A=r.n(M),D=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R=function(e,t,r){return o()(e,r||{}).test(t)},j=function(e){for(var t=document.evaluate(e,document.body,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=[],n=0,a=t.snapshotLength;n<a;n++)r.push(t.snapshotItem(n));return r},L=function(e){return j(e)[0]},F=function(e){var t=e.getBoundingClientRect();return{top:t.top,left:t.left}},V=function(){return window===window.top?Promise.resolve({x:0,y:0}):Object(l.postMessage)(window.parent,window,{action:"SOURCE_VIEWPORT_OFFSET",data:{}})},U=function(){var e={eval:function(e){return p()("sending INJECT_RUN_EVAL"),Object(l.postMessage)(window,window,{cmd:"INJECT_RUN_EVAL",args:{code:e}},"*",5e3).then((function(e){return p()("eval result",e),e.result}))}};return document.body.getAttribute("data-injected")?Promise.resolve(e):(Object(i.insertScript)(d.a.extension.getURL("inject.js")),Object(i.retry)((function(){return p()("sending INJECT_READY"),Object(l.postMessage)(window,window,{cmd:"INJECT_READY"},"*",500)}),{shouldRetry:function(){return!0},timeout:5e3,retryInterval:0})().then((function(){return e})).catch((function(e){throw p()(e.stack),new Error("fail to inject")})))},B=function(e){return/^#elementfrompoint/i.test(e.trim())},X=function(e){var t=e.trim().match(/^#elementfrompoint\s*\((\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\)/i);if(!t)throw new Error("Invalid '#elementfrompoint' expression");var r=parseFloat(t[1]),n=parseFloat(t[2]);if(r<=0||n<=0)throw new Error("'#elementfrompoint' only accepts positive numbers");return[r,n]},K=function(e){Object(n.a)(e)&&"function"==typeof e.focus&&e.focus()},$=function(e){try{return function(e){var t=e.indexOf("=");if(/^\//.test(e))return!0;if(/^#elementfrompoint/i.test(e))return!0;if(-1===t)throw new Error("invalid locator, "+e);var r=e.substr(0,t),n=e.substr(t+1);if(!n||!n.length)throw new Error("invalid locator, "+e);switch(r&&r.toLowerCase()){case"id":case"name":case"identifier":case"link":case"linktext":case"partiallinktext":case"css":case"xpath":return!0;default:throw new Error("invalid locator, "+e)}}(e),!0}catch(e){return!1}},Y=function(e,t){var r=e.indexOf("="),n=void 0;if(/^\//.test(e))n=L(e);else if(/^#elementfrompoint/i.test(e.trim()))n=function(e){var t=X(e),r=D(t,2),n=r[0],a=r[1];return document.elementFromPoint(n,a)}(e),p()("elementfrompoint",n);else{if(-1===r)throw new Error("getElementByLocator: invalid locator, "+e);var a=e.substr(0,r),o=e.substr(r+1),i=a&&a.toLowerCase();switch(i){case"id":n=document.getElementById(o);break;case"name":n=document.getElementsByName(o)[0];break;case"identifier":n=document.getElementById(o)||document.getElementsByName(o)[0];break;case"link-notused":var c=[].slice.call(document.getElementsByTagName("a")),l=o.replace(/^exact:/,""),u=l.match(/^(.+)@POS=(\d+)$/i),d=0;u&&(l=u[1],d=parseInt(u[2])-1),n=c.filter((function(e){return R(l,Object(s.domText)(e))}))[d];break;case"link":case"linktext":case"partiallinktext":var m=[].slice.call(document.getElementsByTagName("a")),h=o.match(/^(.+)@POS=(\d+)$/i),f=o,g=0;h&&(f=h[1],g=parseInt(h[2])-1);var v="partiallinktext"===i?"*"+f+"*":f;n=m.filter((function(e){return R(v,Object(s.domText)(e),{flags:"im"})}))[g];break;case"css":n=document.querySelector(o);break;case"xpath":n=L(o);break;default:throw new Error("getElementByLocator: unsupported locator method, "+a)}}if(!n)throw new Error("getElementByLocator: fail to find element based on the locator, "+e);if(t&&!Object(s.isVisible)(n))throw new Error("getElementByLocator: element is found but not visible yet");return n},W=function(e,t,r,n){var a=r||{},o=a.extra,i=a.targetOptions;if(o&&o.retryInfo&&o.retryInfo.final&&i&&i.length)for(var s=0,c=i.length;s<c;s++){var l=i[s];try{var u=Y(l,t);return n.ask("CS_ADD_LOG",{warning:'Element found with secondary locator "'+l+'". To use it by default, update the target field to use it as primary locator.'}),u}catch(e){if(s===c-1)throw e}}return Y(e,t)},G=function(e,t){var r=e.indexOf("=");if(-1!==r){var n=e.substr(0,r),a=e.substr(r+1);switch(n){case"index":var o=parseInt(a,10),i=window.frames,s=i[o];if(!s)throw new Error("Frame index out of range (index "+a+" in "+i.length+" frames");return{frame:s};case"relative":if("top"===a)return{frame:window.top};if("parent"===a)return{frame:window.parent};throw new Error("Unsupported relative type, "+a)}}-1!==r||/^\/.*/.test(e)||(e="name="+e);var c=Y(e);if(!c||!c.contentWindow)throw new Error("The element found based on "+e+" is NOT a frame/iframe");if(!c.getAttribute("src")){var l=d.a.extension.getURL("content_script.js"),u=c.contentDocument,m=u.constructor.prototype.createElement.call(u,"script");m.setAttribute("type","text/javascript"),m.setAttribute("src",l),u.documentElement.appendChild(m),m.parentNode.removeChild(m),t.hackAlertConfirmPrompt(u)}return{frame:c.contentWindow}},H=function(e,t,r){var n,a,u,m=e.cmd,h=e.target,g=e.value,v=e.extra,b=function(e,t){return function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];var o=t.apply(void 0,n);return new Promise((function(t,r){try{t(e.apply(void 0,n))}catch(e){r(new Error(o.errorMsg(e.message)))}}))}},y=Object(c.partial)((function(e,t){return b(t,(function(){var t=e.apply(void 0,arguments);return{errorMsg:function(e){return/element is found but not visible yet/.test(e)?"element is found but not visible yet for '"+t+"' (use !WaitForVisible = false to disable waiting for visible)":"timeout reached when looking for element '"+t+"'"}}}))})),w=Object(c.partial)((function(e,n){return function(){var a=n.apply(void 0,arguments),o=e.apply(void 0,arguments);if(B(o)){var i="unkown";try{i=r.xpath(a)}catch(e){}var s=o+' => xpath "'+i+'"';t.ask("CS_ADD_LOG",{info:s})}return a}})),E=(w(W,(function(e){return e})),b(G,(function(e){return{errorMsg:function(t){return"timeout reached when looking for frame '"+e+"'"}}}))),x=Object(c.compose)(y((function(e){return e})),w((function(e){return e})))(W),S=Object(c.compose)(y((function(e){return e})),w((function(e){return e})),(function(e){return function(){var t=e.apply(void 0,arguments);if(!t||"INPUT"===t.tagName)return t;var r=Object(s.getAncestor)(t,(function(e){return"LABEL"===e.tagName}));if(!r)return t;var n=r.querySelector("input");return n||t}}))(W),C=function(e,t){return x(e,t).then((function(){throw t?new Error("timeout reached when waiting for element '"+e+"' to be not present"):new Error("timeout reached when waiting for element '"+e+"' to be not visible")}),(function(){return!0}))};switch(m){case"open":return!!window.noCommandsYet||Object(i.until)("document.body",(function(){return{pass:!!document.body,result:document.body}})).then((function(r){return setTimeout((function(){t.ask("CS_LOAD_URL",{url:e.target}).then((function(){return!0}))})),!0}));case"refresh":return setTimeout((function(){return window.location.reload()}),0),!0;case"mouseOver":return x(h,!1,e,t).then((function(e){try{v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500)}catch(e){p.a.error("error in scroll and highlight",e.message)}return e.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0})),!0}));case"locate":return x(h,!1,e,t).then((function(e){try{v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500)}catch(e){p.a.error("error in scroll and highlight",e.message)}var t=F(e);return V().then((function(r){return{rect:{x:t.left+r.x,y:t.top+r.y,width:e.offsetWidth,height:e.offsetHeight}}}))}));case"dragAndDropToObject":return Promise.all([x(h,!1,e,t),x(g)]).then((function(e){var t=D(e,2),r=t[0],n=t[1];return f.a.triggerDragEvent(r,n),!0}));case"waitForElementVisible":case"waitForVisible":return x(h,!0,e,t).then((function(){return!0}));case"waitForElementNotVisible":return C(h,!0).then((function(){return!0}));case"waitForElementPresent":return x(h,!1,e,t).then((function(){return!0}));case"waitForElementNotPresent":return C(h,!1).then((function(){return!0}));case"clickAt":var T=B(h);return(T?V().then((function(e){p()("iframeOffset",e);var t=X(h),r=D(t,2),n=r[0],a=r[1];return"#elementfrompoint ("+(n-e.x)+", "+(a-e.y)+")"})):Promise.resolve(h)).then((function(n){return x(n,v.waitForVisible,e,t).then((function(e){if(!/^\d+\s*,\s*\d+$/.test(g)&&!B(n))throw new Error("invalid offset for clickAt: "+g);var t=function(){try{v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500)}catch(e){p.a.error("error in scroll and highlight")}},a=function(){if(T)return X(n);var t=g.split(",").map((function(e){return parseInt(e.trim(),10)})),r=D(t,2),a=r[0],o=r[1],i=F(e),s=i.top;return[i.left+a,s+o]}(),o=D(a,2),i=o[0],s=o[1],c=window.scrollX,l=window.scrollY;T||t();var u=i+(c-window.scrollX),d=s+(l-window.scrollY);return p()("clickAt clientX/clientY",u,d),["mousedown","mouseup","click"].forEach((function(t){e.dispatchEvent(new MouseEvent(t,{view:window,bubbles:!0,cancelable:!0,clientX:u,clientY:d}))})),T&&t(),K(e),!0}))}));case"click":case"clickAndWait":return x(h,v.waitForVisible,e,t).then((function(e){try{v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500)}catch(e){p.a.error("error in scroll and highlight")}return["mousedown","mouseup","click"].forEach((function(t){if("click"===t&&"function"==typeof e.click)return e.click();e.dispatchEvent(new MouseEvent(t,{view:window,bubbles:!0,cancelable:!0}))})),K(e),!0}));case"check":case"uncheck":return S(h,v.waitForVisible,e,t).then((function(e){return e.checked="check"===m,e.dispatchEvent(new Event("change",{target:e,bubbles:!0})),!0}));case"addSelection":case"removeSelection":case"select":case"selectAndWait":return x(h,v.waitForVisible,e,t).then((function(e){var t=[].slice.call(e.getElementsByTagName("option")),n=g.indexOf("="),a=g.substring(0,n),o=g.substring(n+1),i=function(){switch(a){case"label":return t.find((function(e){return R(o,Object(s.domText)(e).trim())}));case"index":return t.find((function(e,t){return t===parseInt(o)}));case"id":return t.find((function(e,t){return e.id===o}));case"value":return t.find((function(e){return e.value===o}));default:throw new Error('Option type "'+a+'" not supported')}}();if(!i)throw new Error("cannot find option with '"+g+"'");switch(v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500),m){case"addSelection":i.selected=!0;break;case"removeSelection":i.selected=!1;break;default:e.value=i.value}return e.dispatchEvent(new Event("change",{target:e,bubbles:!0})),!0}));case"type":return x(h,v.waitForVisible,e,t).then((function(e){var n=e.tagName.toLowerCase();if("input"!==n&&"textarea"!==n)throw new Error("run command: element found is neither input nor textarea");if(v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500),e.type&&"file"===e.type.toLowerCase()){if(d.a.isFirefox())throw new Error("Setting file path fo file inputs is not supported by Firefox extension api yet");return t.ask("CS_SET_FILE_INPUT_FILES",{files:g.split(";"),selector:Object(s.cssSelector)(e)})}return K(e),Object(P.a)(g,e).then((function(t){return e.value="",t.length<=A.a.commandRunner.sendKeysMaxCharCount&&k(e,t,!0),e.value=t,e.dispatchEvent(new Event("change",{target:e,bubbles:!0})),!0}))})).catch((function(e){if(/This input element accepts a filename/i.test(e.message))throw new Error("Sorry, upload can not be automated Chrome (API limitation).");throw e}));case"editContent":return x(h,v.waitForVisible,e,t).then((function(e){if("true"!==e.contentEditable)throw new Error("Target is not contenteditable");return v.playScrollElementsIntoView&&e.scrollIntoView({block:"center"}),v.playHighlightElements&&r.highlightDom(e,500),e.focus(),e.innerHTML=g,e.blur(),!0}));case"selectFrame":return E(h,r).then((function(e){if(!e)throw new Error("Invalid frame/iframe");return e}));case"verifyText":return x(h,!1,e,t).then((function(e){var t=Object(s.domText)(e);return!!R(g,t)||{log:{error:'text not matched, \n\texpected: "'+g+'", \n\tactual: "'+t+'"'}}}));case"verifyTitle":return!!R(h,document.title)||{log:{error:'title not matched, \n\texpected: "'+h+'", \n\tactual: "'+document.title+'"'}};case"verifyElementPresent":var _=v||{},O=_.timeoutElement,M=_.retryInfo;return x(h,!1,e,t).then((function(){return!0}),(function(e){if(1e3*O/M.retryInterval-M.retryCount<=1)return{log:{error:"'"+h+"' element not present"}};throw e}));case"verifyElementNotPresent":var L=v||{},$=L.timeoutElement,Y=L.retryInfo;return C(h).then((function(){return!0}),(function(e){if(1e3*$/Y.retryInterval-Y.retryCount<=1)return{log:{error:"'"+h+"' element is still present"}};throw e}));case"verifyEditable":return x(h,!1,e,t).then((function(e){return!!Object(s.isEditable)(e)||{log:{error:"'"+h+"' is not editable"}}}));case"verifyNotEditable":return x(h,!1,e,t).then((function(e){return!Object(s.isEditable)(e)||{log:{error:"'"+h+"' is editable"}}}));case"verifyChecked":return S(h,!1,e,t).then((function(e){return!!e.checked||{log:{error:"'"+h+"' is not checked"}}}));case"verifyNotChecked":return S(h,!1,e,t).then((function(e){return!!!e.checked||{log:{error:"'"+h+"' is checked"}}}));case"verifyAttribute":var H=h.lastIndexOf("@");if(-1===H)throw new Error("invalid target for verifyAttribute - "+h);var z=h.substr(0,H),q=h.substr(H+1);return x(z,!1,e,t).then((function(e){var t=e.getAttribute(q);return!!R(g,t)||{log:{error:'attribute not matched, \n\texpected: "'+g+'", \n\tactual: "'+t+'"'}}}));case"verifyError":return!v.lastCommandOk||{log:{error:h}};case"assertText":return x(h,!1,e,t).then((function(e){var t=Object(s.domText)(e);if(!R(g,t))throw new Error('text not matched, \n\texpected: "'+g+'", \n\tactual: "'+t+'"');return!0}));case"assertTitle":if(!R(h,document.title))throw new Error('title not matched, \n\texpected: "'+h+'", \n\tactual: "'+document.title+'"');return!0;case"assertElementPresent":return x(h,!1,e,t).then((function(){return!0}));case"assertElementNotPresent":return C(h);case"assertChecked":return S(h,!1,e,t).then((function(e){if(!!!e.checked)throw new Error("'"+h+"' is not checked");return!0}));case"assertNotChecked":return S(h,!1,e,t).then((function(e){if(!!e.checked)throw new Error("'"+h+"' is checked");return!0}));case"assertEditable":return x(h,!1,e,t).then((function(e){if(!Object(s.isEditable)(e))throw new Error("'"+h+"' is not editable");return!0}));case"assertNotEditable":return x(h,!1,e,t).then((function(e){if(Object(s.isEditable)(e))throw new Error("'"+h+"' is editable");return!0}));case"assertAttribute":var J=h.lastIndexOf("@");if(-1===J)throw new Error("invalid target for assertAttribute - "+h);var Z=h.substr(0,J),Q=h.substr(J+1);return x(Z,!1,e,t).then((function(e){var t=e.getAttribute(Q);if(!R(g,t))throw new Error('attribute not matched, \n\texpected: "'+g+'", \n\tactual: "'+t+'"');return!0}));case"assertError":if(v.lastCommandOk)throw new Error(h);return!0;case"assertAlert":var ee=document.body.getAttribute("data-alert");if(!ee)throw new Error("no alert found!");if(!R(h,ee))throw new Error('unmatched alert msg, \n\texpected: "'+h+'", \n\tactual: "'+ee+'"');return document.body.setAttribute("data-alert",""),!0;case"assertConfirmation":var te=document.body.getAttribute("data-confirm");if(!te)throw new Error("no confirm found!");if(!R(h,te))throw new Error('unmatched confirm msg, \n\texpected: "'+h+'", \n\tactual: "'+te+'"');return document.body.setAttribute("data-confirm",""),!0;case"assertPrompt":var re=document.body.getAttribute("data-prompt");if(!re)throw new Error("no prompt found!");if(!R(h,re))throw new Error('unmatched prompt msg, \n\texpected: "'+h+'", \n\tactual: "'+re+'"');return document.body.setAttribute("data-prompt",""),!0;case"answerOnNextPrompt":return document.body.setAttribute("data-prompt-answer",h),!0;case"waitForPageToLoad":return!0;case"storeXpathCount":var ne=h.indexOf("="),ae=h.substr(0,ne),oe=h.substr(ne+1);if("xpath"!==(ae&&ae.toLowerCase()))throw new Error('storeXpathCount: target should start with "xpath="');return{vars:N({},g,j(oe).length)};case"storeTitle":return{vars:N({},g,document.title)};case"storeText":return x(h,!1,e,t).then((function(e){return{vars:N({},g,Object(s.domText)(e))}}));case"storeAttribute":var ie=h.lastIndexOf("@");if(-1===ie)throw new Error("invalid target for storeAttribute - "+h);var se=h.substr(0,ie),ce=h.substr(ie+1);return x(se,!1,e,t).then((function(e){var t=e.getAttribute(ce);if(!t)throw new Error("missing attribute '"+ce+"'");return{vars:N({},g,t)}}));case"storeEval":return U().then((function(e){return e.eval(h).then((function(e){return{vars:N({},g,e)}})).catch((function(e){throw new Error("Error in runEval code: "+e.message)}))}));case"storeValue":return x(h,!1,e,t).then((function(e){var t=e.value||"";return{vars:N({},g,t)}}));case"storeChecked":return x(h,!1,e,t).then((function(e){var t=!!e.checked;return{vars:N({},g,t)}}));case"verifyValue":return x(h,!1,e,t).then((function(e){var t=e.value;return!!R(g,t)||{log:{error:'value not matched, \n\texpected: "'+g+'", \n\tactual: "'+t+'"'}}}));case"assertValue":return x(h,!1,e,t).then((function(e){var t=e.value;if(!R(g,t))throw new Error('value not matched, \n\texpected: "'+g+'", \n\tactual: "'+t+'"');return!0}));case"executeScript":case"executeAsyncScript":return U().then((function(e){var t="Promise.resolve((function () { "+h+" })());";return e.eval(t).then((function(e){return!g||!g.length||{vars:N({},g,e)}})).catch((function(e){throw new Error("Error in "+m+" code: "+e.message)}))}));case"sendKeys":return x(h,!1,e,t).then((function(e){return K(e),k(e,g),!0}));case"selectWindow":return function(){switch(h&&h.toUpperCase()){case"TAB=CLOSEALLOTHER":return t.ask("CS_CLOSE_OTHER_TABS",{});case"TAB=CLOSE":return t.ask("CS_CLOSE_CURRENT_TAB",{});default:return t.ask("CS_SELECT_WINDOW",{target:h,value:g})}}().then((function(){return!0}));case"sourceSearch":case"sourceExtract":if(!h)throw new Error("Must provide text / regular expression to search for");if(!g)throw new Error("Must specify a variable to save the result");var le=(a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return void 0===e?0:Math.max(0,parseInt(e,10)+t)},(u=/@\s*(\d+)(?:\s*,\s*(\d+))?\s*$/.exec(n=h))?{rest:n.substring(0,u.index),matchIndex:a(u[1],-1),captureIndex:a(u[2])}:{rest:n,matchIndex:0,captureIndex:0}),ue=le.rest,de=le.matchIndex,me=le.captureIndex;if("sourceSearch"===m&&ue!==h)throw new Error("The @ parameter is only supported in sourceExtract");var pe=function(){if(!/^regex(=|:)/i.test(ue))return null;var e=ue.replace(/^regex(=|:)/i,""),t=/^\/(.*)\/([gimsuy]+)?$/;if(!t.test(e))return Object(i.toRegExp)(e.replace(/^\/|\/g?$/g,""),{needEncode:!1,flag:"g"});var r=e.match(t);if(!r||!r.length)return null;var n=D(r,3),a=(n[0],n[1]),o=n[2],s=c.uniqueStrings.apply(void 0,["g"].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(o.split("")))).join("");return Object(i.toRegExp)(a,{needEncode:!1,flag:s})}(),he=function(){if(pe)return null;var e=ue.replace(/^text(=|:)/i,"");if("sourceExtract"===m&&!/\*/.test(e))throw new Error("Missing * or REGEX in sourceExtract. Extracting a plain text doesn't make much sense");var t=RegExp.prototype.hasOwnProperty("dotAll")?"gs":"g";return o()(e,{flags:t,capture:!0,nonGreedy:!0})}(),fe=function(){for(var e=document.documentElement.outerHTML,t=pe||he,r=[],n=void 0;(n=t.exec(e))&&(r.push(n),!("sourceExtract"===m&&r.length>=de+1)););return r}();if(p()("matches",fe,pe,he),"sourceSearch"===m)return{vars:N({},g,fe.length)};if("sourceExtract"===m){return{vars:N({},g,function(e){return void 0!==e?e:"#nomatchfound"}((fe[de]||[])[me]))}}throw new Error("Impossible to reach here");case"visionLimitSearchArea":case"storeImage":var ge=void 0,ve=void 0;return"storeImage"===m?(ge=h,ve=g):"visionLimitSearchArea"===m&&(ge=h.trim().replace(/^element:/i,"").trim(),ve=I.LAST_SCREENSHOT_FILE_NAME),function(e,r){return x(e).then((function(e){if(!r||!r.length)throw new Error("storeImage: 'value' is required as image name");var n=e.getBoundingClientRect();return(window.top===window?Promise.resolve({x:0,y:0}):(e.scrollIntoView(),Object(l.postMessage)(window.parent,window,{action:"SOURCE_PAGE_OFFSET",data:{}}))).then((function(e){var a={x:e.x+n.x+Object(s.scrollLeft)(document),y:e.y+n.y+Object(s.scrollTop)(document),width:n.width,height:n.height};return t.ask("CS_STORE_SCREENSHOT_IN_SELECTION",{rect:a,fileName:Object(i.ensureExtName)(".png",r),devicePixelRatio:window.devicePixelRatio}).then((function(){return{vars:{"!storedImageRect":a}}}))}))}))}(ge,ve);case"captureScreenshot":if(!h||!h.length)throw new Error("captureScreenshot: 'target' is required as file name");return t.ask("CS_CAPTURE_SCREENSHOT",{fileName:Object(i.ensureExtName)(".png",h)}).then((function(e){var t=e.fileName;return{screenshot:{url:e.url,name:t}}}));case"captureEntirePageScreenshot":if(!h||!h.length)throw new Error("captureEntirePageScreenshot: 'target' is required as file name");return t.ask("CS_CAPTURE_FULL_SCREENSHOT",{fileName:Object(i.ensureExtName)(".png",h)}).then((function(e){var t=e.fileName;return{screenshot:{url:e.url,name:t}}}));case"onDownload":return t.ask("CS_ON_DOWNLOAD",{fileName:h,wait:"true"===(g||"").trim(),timeout:1e3*v.timeoutDownload,timeoutForStart:1e3*v.timeoutDownloadStart});case"deleteAllCookies":return t.ask("CS_DELETE_ALL_COOKIES",{url:window.location.origin}).then((function(){return!0}));case"if":case"while":case"gotoIf":try{return{condition:window.eval(h)}}catch(e){throw new Error("Error in runEval condition of "+m+": "+e.message)}default:throw new Error("Command "+m+" not supported yet")}}},1003:function(e,t,r){var n=r(1004);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(133)(n,a);n.locals&&(e.exports=n.locals)},1004:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,'.header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;overflow:hidden;padding:0 20px;width:100%;height:44px;border-bottom:2px solid #ccc;background-color:#f9f9f9}.header .status{float:right;line-height:42px;font-size:14px}.header .status h1{margin:0;font-size:20px;line-height:44px}.header .select-case{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:44px;font-size:13px}.header .select-case .test-case-name{margin-right:15px;line-height:35px;max-width:100px;overflow:hidden;display:inline-block;white-space:nowrap;text-overflow:ellipsis}.header .select-case .test-case-name.unsaved{color:orange}.header .select-case .test-case-name.unsaved:after{content:"*";margin-left:3px}.header .actions{margin-top:6px}.header .actions .ant-btn-group>.ant-btn-group{float:none}.header .actions .play-actions{margin:0 10px}.ant-dropdown-menu{max-height:300px;overflow-y:auto}.ant-dropdown-menu .editing{color:blue!important}.settings-modal .ant-tabs-nav .ant-tabs-tab{margin-right:12px;padding:8px 6px}.settings-modal .ant-checkbox-wrapper+.ant-checkbox-wrapper{margin-left:0}.settings-modal .tip{margin-left:15px;color:#aaa}.settings-modal .xmodule-item{margin-bottom:25px;padding:15px;border:2px solid #333;font-size:14px;-webkit-box-shadow:rgba(0,0,0,.5) 0 2px 5px 0;box-shadow:0 2px 5px 0 rgba(0,0,0,.5)}.settings-modal .xmodule-item label{margin-right:15px;width:100px;font-size:14px}.settings-modal .xmodule-item .xmodule-title{margin-bottom:10px;font-size:14px}.settings-modal .xmodule-item .xmodule-title>*{margin-right:20px}.settings-modal .xmodule-item .xmodule-title>:last-child{margin-right:0}.settings-modal .xmodule-item .xmodule-status{display:-webkit-box;display:-ms-flexbox;display:flex;margin-bottom:20px}.settings-modal .xmodule-item .xmodule-status .status-box>*{margin-right:15px}.settings-modal .xmodule-item .xmodule-status .status-box>:last-child{margin-right:0}.settings-modal .xmodule-item .xmodule-settings h3{margin-bottom:10px;font-size:14px;font-weight:700}.settings-modal .xmodule-item .xmodule-settings .xmodule-settings-item .settings-detail{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:10px}.settings-modal .xmodule-item .xmodule-settings .xmodule-settings-item .settings-detail .settings-detail-content{-webkit-box-flex:1;-ms-flex:1;flex:1}.settings-modal .xmodule-item .xmodule-settings .check-result{margin-top:5px;color:red;font-size:13px}.settings-modal .backup-pane{padding:0 20px}.settings-modal .backup-pane h4{font-size:16px;margin-bottom:10px}.settings-modal .backup-pane .row{margin-bottom:10px}.settings-modal .backup-pane p,.settings-modal .backup-pane ul li{margin-bottom:5px}.settings-modal .api-pane{padding:0 20px 20px}.settings-modal .api-pane p{margin:20px 0}.settings-modal .selenium-pane{padding:0 20px 20px}.settings-modal .selenium-pane h4{font-size:16px;margin-bottom:10px}.settings-modal .selenium-pane .import-row{margin-top:20px;margin-bottom:20px}.settings-modal .selenium-pane .import-row button{margin-right:20px}.settings-modal .security-pane{padding:0 20px 20px}.settings-modal .security-pane h4{font-size:16px;margin-bottom:10px}.settings-modal .security-pane p{margin-bottom:10px}.settings-modal .security-pane label{margin-right:10px}.settings-modal .security-pane .ant-radio-wrapper{display:block;height:30px;line-height:30px}.settings-modal .security-pane .input-line{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:10px}.settings-modal .security-pane .input-line .input-label{width:120px}.settings-modal .security-pane .input-line .ant-checkbox-wrapper{margin-left:15px}.settings-modal .security-pane .input-line a{margin-left:20px}.settings-modal .ocr-pane{padding:0 20px 20px}.settings-modal .ocr-pane p{margin-bottom:10px}.settings-modal .ocr-pane .row{margin-bottom:20px}.settings-modal .ocr-pane .radio-block .ant-radio-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;line-height:30px}.settings-modal .ocr-pane .radio-block .ant-radio-wrapper.need-pro{color:gray}.settings-modal .ocr-pane .radio-block .ant-radio-wrapper .ant-radio{margin-top:8px}.settings-modal .ocr-pane .radio-block .ant-radio-wrapper .offline-label{display:inline-block;width:80px}.settings-modal .ocr-pane .label-text{margin-right:15px}.settings-modal .vision-pane{padding:0 20px 20px}.settings-modal .vision-pane .row,.settings-modal .vision-pane p{margin-bottom:10px}.settings-modal .vision-pane .ant-radio-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;line-height:30px}.settings-modal .vision-pane .ant-radio-wrapper .ant-radio{margin-top:8px}.settings-modal .vision-pane .ant-form-item label{width:280px;color:rgba(0,0,0,.65)}.settings-modal .xmodules-pane{padding:0 0 20px}.settings-modal .register-pane .register-note{width:80%}.settings-modal .register-pane .register-note .actions{margin-top:15px}.settings-modal .register-pane .register-note.inactive,.settings-modal .register-pane .register-note.inactive a{color:#aaa}.settings-modal .register-pane .register-form{margin-top:25px}.settings-modal .register-pane .register-form label{display:block;margin-bottom:10px;font-weight:700}.settings-modal .register-pane .register-form .register-row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.settings-modal .register-pane .register-form .register-row input{margin-right:15px;width:40%}.settings-modal .register-pane .register-status{margin-top:25px}.settings-modal .register-pane .register-status a{margin-left:15px}',""])},1005:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(84),i=n(r(523)),s=a(r(34));class c{constructor(e){this.params=e,this.license=null,this.getLatestInfo()}get legacyXModuleStatus(){return this.params.getLegacyXModuleStatus()}checkLicense(e){return this.params.getVersion().then(t=>i.checkLicense({licenseKey:e,version:t})).then(e=>"key_not_found"===e.status?e:(this.license=e,Promise.all([this.params.save(e),this.params.setLegacyXModuleStatus("checked_by_remote")]).then(()=>e)))}recheckLicenseIfPossible(){var e;return"checked_by_remote"===this.legacyXModuleStatus&&this.license?this.checkLicense(null===(e=this.license)||void 0===e?void 0:e.licenseKey).then(()=>!0):Promise.resolve(!1)}getLatestInfo(){return Promise.all([this.params.read()]).then(e=>(this.license=e[0],e[0]))}canPerform(e){var t;if("checked_by_remote"!==this.legacyXModuleStatus)return!0;switch(null!==(t=this.license.type)&&void 0!==t?t:o.LicenseType.Personal){case o.LicenseType.Enterprise:case o.LicenseType.Personal:case o.LicenseType.Pro:return!0;case o.LicenseType.Player:return e===o.Feature.Replay}}isProLicense(){var e;switch(this.legacyXModuleStatus){case"pro":return!0;case"checked_by_remote":return"on"===(null===(e=this.license)||void 0===e?void 0:e.status)&&(this.license.type===o.LicenseType.Pro||this.license.type===o.LicenseType.Enterprise);default:return!1}}isPersonalLicense(){var e;switch(this.legacyXModuleStatus){case"free":return!0;case"checked_by_remote":return"on"===(null===(e=this.license)||void 0===e?void 0:e.status)&&this.license.type===o.LicenseType.Personal;default:return!1}}isPlayerLicense(){var e;switch(this.legacyXModuleStatus){case"checked_by_remote":return"on"===(null===(e=this.license)||void 0===e?void 0:e.status)&&this.license.type===o.LicenseType.Player;default:return!1}}hasNoLicense(){switch(this.legacyXModuleStatus){case"unregistered":return!0;case"checked_by_remote":return!this.license||"on"!==this.license.status;default:return!1}}isLicenseExpired(){var e;return"checked_by_remote"===this.legacyXModuleStatus&&"off"===(null===(e=this.license)||void 0===e?void 0:e.status)}getEditionName(){var e;if("checked_by_remote"===this.legacyXModuleStatus&&"on"===(null===(e=this.license)||void 0===e?void 0:e.status))return this.license.name;switch(this.legacyXModuleStatus){case"free":return"Personal Edition";case"pro":return"PRO Edition";case"unregistered":case"checked_by_remote":default:return"Free Edition"}}getUpgradeUrl(){var e;if("checked_by_remote"===this.legacyXModuleStatus&&"on"===(null===(e=this.license)||void 0===e?void 0:e.status))return this.license.upgradeUrl;switch(this.legacyXModuleStatus){case"free":return s.default.xmodulesLimit.free.upgradeUrl;case"pro":return s.default.xmodulesLimit.pro.upgradeUrl;case"unregistered":case"checked_by_remote":default:return s.default.xmodulesLimit.unregistered.upgradeUrl}}getMaxOcrCalls(){var e;if("checked_by_remote"===this.legacyXModuleStatus&&"on"===(null===(e=this.license)||void 0===e?void 0:e.status))return this.license.maxOcrCalls;switch(this.legacyXModuleStatus){case"free":return s.default.xmodulesLimit.free.ocrCommandCount;case"pro":return s.default.xmodulesLimit.pro.ocrCommandCount;case"checked_by_remote":case"unregistered":default:return s.default.xmodulesLimit.unregistered.ocrCommandCount}}getMaxXCommandCalls(){switch(this.convertToLegacyStatus()){case"free":return s.default.xmodulesLimit.free.xCommandCount;case"pro":return s.default.xmodulesLimit.pro.xCommandCount;case"unregistered":default:return s.default.xmodulesLimit.unregistered.xCommandCount}}getMaxProxyCalls(){switch(this.convertToLegacyStatus()){case"free":return s.default.xmodulesLimit.free.proxyExecCount;case"pro":return s.default.xmodulesLimit.pro.proxyExecCount;case"unregistered":default:return s.default.xmodulesLimit.unregistered.proxyExecCount}}getMaxXFileMacros(){switch(this.convertToLegacyStatus()){case"free":return s.default.xmodulesLimit.free.xFileMacroCount;case"pro":return s.default.xmodulesLimit.pro.xFileMacroCount;case"unregistered":default:return s.default.xmodulesLimit.unregistered.xFileMacroCount}}convertToLegacyStatus(){var e;if(this.legacyXModuleStatus&&"checked_by_remote"!==this.legacyXModuleStatus)return this.legacyXModuleStatus;if("on"!==(null===(e=this.license)||void 0===e?void 0:e.status))return"unregistered";switch(this.license.type){case o.LicenseType.Player:case o.LicenseType.Enterprise:case o.LicenseType.Pro:return"pro";case o.LicenseType.Personal:return"free"}}}t.LicenseService=c,c.StorageKey="a9t9"},1023:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MethodTypeFriendlyNames=["GetVersion","SendMouseEvent","SendMouseWheelEvent","SendText","GetActiveBrowserOuterRect","FindRectangle","GetScreenBackingScaleFactor"],t.MethodTypeInvocationNames=["get_version","send_mouse_event","send_mouse_wheel_event","send_text","get_active_browser_outer_rect","find_rectangle","get_screen_backing_scale_factor"]},1024:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(97);class a extends n.NativeMessagingHost{constructor(){super(a.HOST_NAME)}}t.KantuXYHost=a,a.HOST_NAME="com.a9t9.kantu.xy"},1029:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(404);class a extends n.Counter{constructor(e){super(e),this.ready=!1,this.read=e.read,this.write=e.write}reset(){super.reset(),this.ready=!1,setTimeout(()=>{this.read().then(e=>{this.ready=!0,this.n=e})},0)}inc(){if(!this.ready)throw new Error("counter not ready yet");const e=super.inc();return this.write(this.n),e}}t.PersistentCounter=a},1030:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12);t.Monitor=class{constructor(e,t){this.inspectorConstructors={},this.targets={},this.paramsProvider=t,this.inspectorConstructors=e}addTarget(e,t=!0){this.targets[e]=n.objMap((r,n)=>{const a=r(e);return t&&a.restart(...this.paramsProvider(n)),a},this.inspectorConstructors)}removeTarget(e){this.targets[e]&&(n.objMap(e=>{e.stop()},this.targets[e]),delete this.targets[e])}clear(){Object.keys(this.targets).map(e=>{this.removeTarget(e)})}restart(){this.traverseAllInspectors((e,t,r)=>{e.restart(...this.paramsProvider(t,r))})}pause(){this.traverseAllInspectors(e=>{e.pause()})}resume(){this.traverseAllInspectors(e=>{e.resume()})}stop(){this.traverseAllInspectors(e=>{e.stop()})}restartInspector(e,t){this.getInspector(e,t).restart(...this.paramsProvider(t,e,!0))}pauseInspector(e,t){this.getInspector(e,t).pause()}resumeInspector(e,t){this.getInspector(e,t).resume()}stopInspector(e,t){this.getInspector(e,t).stop()}getDataFromInspector(e,t){return this.getInspector(e,t).output()}traverseAllInspectors(e){n.objMap((t,r)=>{n.objMap((t,n)=>{try{e(t,n,r)}catch(e){console.error(e)}},t)},this.targets)}getInspector(e,t){const r=this.targets[e];if(!r)throw new Error(`Can't find monitor target with id '${e}'`);const n=r[t];if(!n)throw new Error(`Can't find inspector with name '${t}' for target id '${e}'`);return n}}},1031:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Timer=class{constructor(){this.startTime=new Date,this.acc=0}restart(){this.startTime=new Date,this.acc=0}pause(){const e=new Date;this.acc+=e.getTime()-this.startTime.getTime()}resume(){this.startTime=new Date}stop(){}output(){return this.elapsed()}elapsed(){return this.acc+((new Date).getTime()-this.startTime.getTime())}elapsedInSeconds(){return(this.elapsed()/1e3).toFixed(2)+"s"}}},1032:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Countdown=class{constructor(e){this.startTime=null,this.timeout=null,this.timer=null,this.callback=e}restart(e,t=!1){if(clearTimeout(this.timer),t||null===this.timeout||!this.startTime)this.timeout=e,this.startTime=new Date,0!==e&&(this.timer=setTimeout(()=>this.runCallback(),this.timeout));else{const t=e-((new Date).getTime()-this.startTime.getTime());if(this.timeout=e,0!==e){if(t<0)return this.callback();this.timer=setTimeout(()=>this.runCallback(),t)}}}pause(){if(clearTimeout(this.timer),!this.startTime||!this.timeout)return;const e=(new Date).getTime()-this.startTime.getTime(),t=this.timeout-e;this.timeout=t}resume(){this.timeout&&(this.startTime=new Date,this.timer=setTimeout(()=>this.runCallback(),this.timeout))}stop(){clearTimeout(this.timer),this.clearState()}output(){}clearState(){this.timer=null,this.timeout=null,this.startTime=null}runCallback(){try{this.callback()}catch(e){console.error(e)}finally{this.clearState()}}}},1033:function(e,t,r){var n=r(1034);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(133)(n,a);n.locals&&(e.exports=n.locals)},1034:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,'.sidebar{position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;min-width:260px;height:100%;border-right:2px solid #ccc}.sidebar .sidebar-inner{position:absolute;top:0;bottom:80px;right:0;left:0;overflow-y:auto}.sidebar .sidebar-inner.no-tab{padding-top:8px;overflow-x:hidden}.sidebar .no-data{margin-top:20px;text-align:center;font-size:14px;color:#aaa}.sidebar .sidebar-macros .untitled{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:5px 10px;font-size:14px}.sidebar .sidebar-macros .untitled.selected{background:#fdffd1}.sidebar .sidebar-macros .untitled .icon-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:5px;width:20px}.sidebar .sidebar-macros .untitled .icon-wrapper .file-icon{display:block;height:16px}.sidebar .test-case-actions,.sidebar .test-suite-actions{padding:0 10px 10px}.sidebar .test-case-actions button,.sidebar .test-suite-actions button{margin-right:10px}.sidebar .test-case-actions{display:-webkit-box;display:-ms-flexbox;display:flex;padding-bottom:0}.sidebar .sidebar-test-suites .test-suite-item{padding:0 0 10px;margin-bottom:5px}.sidebar .sidebar-test-suites .test-suite-item.playing{background:#fdffd1}.sidebar .sidebar-test-suites .test-suite-item.fold{margin-bottom:0;padding-bottom:0}.sidebar .sidebar-test-suites .test-suite-item.fold .test-suite-cases,.sidebar .sidebar-test-suites .test-suite-item.fold .test-suite-more-actions{display:none}.sidebar .sidebar-test-suites .test-suite-item .test-suite-row{padding:5px 10px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer}.sidebar .sidebar-test-suites .test-suite-item .test-suite-row .test-suite-title{-webkit-box-flex:1;-ms-flex:1;flex:1;margin-left:10px}.sidebar .sidebar-test-suites .test-suite-item .test-suite-row .more-button{display:none}.sidebar .sidebar-test-suites .test-suite-item .test-suite-row:hover .more-button{display:block}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases{padding:3px 5px}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:3px 5px 3px 20px;margin-bottom:5px}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li.done-tc{background-color:#d1ffd8}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li.done-tc.blur{background-color:rgba(209,255,216,.6)}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li.error-tc{background-color:#f7c1c1}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li.error-tc.blur{background-color:hsla(0,77%,86%,.6)}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li.current-tc{background-color:#d5d6f9}.sidebar .sidebar-test-suites .test-suite-item .test-suite-cases li.current-tc.blur{background-color:rgba(213,214,249,.6)}.sidebar .sidebar-test-suites .test-suite-item .test-suite-more-actions{padding-left:27px}.sidebar .sidebar-storage-mode{position:absolute;bottom:0;left:0;right:0;height:80px;padding:0 10px 15px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.sidebar .sidebar-storage-mode .storage-mode-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:5px;font-size:12px}.sidebar .sidebar-storage-mode .storage-mode-header h3{font-size:14px}.sidebar .ant-tabs{min-height:100%}.sidebar .ant-tabs-bar{border-bottom:2px solid #ccc}.sidebar .ant-tabs-nav-container-scrolling{padding-left:0;padding-right:0}.sidebar .ant-tabs-tab-next.ant-tabs-tab-arrow-show,.sidebar .ant-tabs-tab-prev.ant-tabs-tab-arrow-show{display:none}.sidebar .ant-tabs-nav{height:44px}.sidebar .ant-tabs-nav .ant-tabs-tab{margin-right:0;line-height:27px}.sidebar .ant-tabs-nav-scroll{text-align:center}.sidebar .resize-handler{position:absolute;right:-2px;top:0;bottom:0;width:2px;background:#ccc;cursor:col-resize}.sidebar .resize-handler.focused,.sidebar .resize-handler:hover{right:-4px;width:6px;background:#aaa}.sidebar.with-xmodules-note .sidebar-inner{bottom:160px}.sidebar.with-xmodules-note .sidebar-storage-mode{height:160px}.sidebar.with-xmodules-note .note-for-macros{margin-bottom:20px;padding:10px 10px 0;border-top:1px solid #333;font-size:12px}.with-sidebar .sidebar{display:block}.context-menu{z-index:10}.context-menu .ant-menu{border:"1px solid #ccc";border-radius:4px;-webkit-box-shadow:0 1px 6px rgba(0,0,0,.2);box-shadow:0 1px 6px rgba(0,0,0,.2)}.context-menu .ant-menu .ant-menu-item{height:36px;line-height:36px}.context-menu .ant-menu .ant-menu-item:hover{background:#ecf6fd}.xfile-not-installed-modal.left-bottom{position:absolute;top:auto!important;bottom:100px;left:100px}.xfile-not-installed-modal p{margin-bottom:20px;font-size:16px;font-weight:700}.macros-dropdown{width:auto!important}',""])},1036:function(e,t,r){var n=r(1037);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(133)(n,a);n.locals&&(e.exports=n.locals)},1037:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,'.dashboard{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1;flex:1;margin:15px 15px 0}.dashboard,.dashboard .flex-row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}.dashboard .flex-row{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row}.dashboard .form-group{margin-bottom:15px}.dashboard .toolbox{display:-webkit-box;display:-ms-flexbox;display:flex}.dashboard .toolbox .record-ops{-webkit-box-flex:1;-ms-flex:1;flex:1;text-align:right}.dashboard .toolbox .play-ops{margin-left:15px}.dashboard .ant-table-pagination{display:none}.dashboard .ant-table-header{overflow:hidden!important;margin-bottom:0!important;padding-bottom:0!important}.dashboard .ant-table-header .ant-table-thead>tr>th{padding:13px 8px}.dashboard .ant-table-body .ant-table-thead>tr>th{padding:10px 8px}.dashboard .ant-table-tbody>tr>td{padding:8px}.dashboard tr.selected-command>td{background-color:#fdffd1!important}.dashboard tr.error-command>td{background-color:#f7c1c1!important}.dashboard tr.running-command>td{background-color:#d5d6f9!important}.dashboard tr.done-command>td{background-color:#d1ffd8!important}.dashboard .ant-btn-group>.ant-btn-group{float:none}.dashboard .ant-form-item{margin-bottom:8px}.dashboard .editor-wrapper{-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:2;-ms-flex:2;flex:2}.dashboard .editor-wrapper,.dashboard .editor-wrapper .tabs-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal}.dashboard .editor-wrapper .tabs-wrapper{position:relative;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1;flex:1}.dashboard .editor-wrapper .tabs-wrapper .vision-type{position:absolute;right:0;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer}.dashboard .editor-wrapper .tabs-wrapper .vision-type img{display:block;margin-right:10px;width:20px;height:20px}.dashboard .editor-wrapper .tabs-wrapper .vision-type span{text-decoration:underline;color:#108ee9;font-size:16px}.dashboard .commands-view{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:2;-ms-flex:2;flex:2}.dashboard .commands-view .ant-tabs-bar{margin-bottom:0}.dashboard .commands-view .ant-tabs-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:10px;border:1px solid #d9d9d9;border-width:0 1px 1px}.dashboard .commands-view .ant-tabs-content .ant-tabs-tabpane{-webkit-box-flex:1;-ms-flex:1;flex:1;-ms-flex-negative:unset!important;flex-shrink:unset!important;position:relative}.dashboard .commands-view .ant-tabs-content .table-wrapper{position:absolute;top:0;bottom:165px;left:0;right:0;overflow-y:auto}.dashboard .commands-view .ant-tabs-content .fields-wrapper{position:absolute;left:0;right:0;bottom:0;height:155px}.dashboard .commands-view .ant-tabs-content .fields-wrapper .ant-form-item-label{text-align:left}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row .flex-row{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row .select-input{-webkit-box-flex:1;-ms-flex:1;flex:1}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row .select-input input{width:100%}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row .textarea-wrapper{position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;max-width:60%;margin-right:10px}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row .textarea-wrapper .open-full-editor{position:absolute;bottom:5px;right:15px;cursor:pointer}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row .textarea-wrapper .open-full-editor:hover{color:#108ee9}.dashboard .commands-view .ant-tabs-content .fields-wrapper .target-row button{margin-left:10px}.dashboard .commands-view .ant-tabs-content .react-codemirror2{position:relative}.dashboard .commands-view .ant-tabs-content .react-codemirror2.has-error{height:calc(100% - 70px)}.dashboard .commands-view .ant-tabs-content .react-codemirror2.no-error{height:calc(100% - 0px)}.dashboard .commands-view .ant-tabs-content .react-codemirror2 .CodeMirror{position:absolute;top:0;bottom:0;left:0;right:0;height:auto;font-size:13px}.dashboard .commands-view .ant-tabs-content .ant-spin-container,.dashboard .commands-view .ant-tabs-content .ant-spin-nested-loading,.dashboard .commands-view .ant-tabs-content .ant-table,.dashboard .commands-view .ant-tabs-content .ant-table-content,.dashboard .commands-view .ant-tabs-content .ant-table-scroll,.dashboard .commands-view .ant-tabs-content .ant-table-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1;flex:1}.dashboard .commands-view .ant-tabs-content .ant-table-scroll{overflow-y:auto}.dashboard .commands-view.target-as-textarea .ant-tabs-content .table-wrapper{bottom:179px}.dashboard .commands-view.target-as-textarea .ant-tabs-content .fields-wrapper{height:169px}.dashboard .commands-view.target-as-textarea .ant-tabs-content .fields-wrapper textarea{resize:none}.dashboard .commands-view .command-row{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;padding-left:5px;border-bottom:1px solid #e9e9e9;line-height:35px;font-size:13px}.dashboard .commands-view .command-row:hover{background:#ecf6fd}.dashboard .commands-view .command-row.dragging{opacity:0}.dashboard .commands-view .command-row.footer-row,.dashboard .commands-view .command-row.header-row{background-color:#f7f7f7;font-weight:700}.dashboard .commands-view .command-row.footer-row{display:block;text-align:center;cursor:pointer}.dashboard .commands-view .command-row.breakpoint-command:before{content:"";position:absolute;top:50%;left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:0;height:0;border:8px solid transparent;border-left-color:green}.dashboard .commands-view .command-row.error-command{background-color:#f7c1c1;color:red}.dashboard .commands-view .command-row.error-command.blur{background-color:hsla(0,77%,86%,.6)}.dashboard .commands-view .command-row.warning-command{background-color:hsla(33,87%,79%,.7);color:orange}.dashboard .commands-view .command-row.warning-command.blur{background-color:hsla(33,87%,79%,.3)}.dashboard .commands-view .command-row.running-command{background-color:#d5d6f9}.dashboard .commands-view .command-row.running-command.blur{background-color:rgba(213,214,249,.6)}.dashboard .commands-view .command-row.done-command{background-color:#d1ffd8}.dashboard .commands-view .command-row.done-command.blur{background-color:rgba(209,255,216,.6)}.dashboard .commands-view .command-row.selected-command{background-color:#fdffd1}.dashboard .commands-view .command-row.selected-command.blur{background-color:rgba(253,255,209,.6)}.dashboard .commands-view .command-row.comment-command{background-color:transparent;color:#ccc;font-style:italic}.dashboard .commands-view .command-row.comment-command.selected-command{background-color:#fdffd1}.dashboard .commands-view .command-row.comment-command.selected-command.blur{background-color:rgba(253,255,209,.6)}.dashboard .commands-view .command-row .row-col{padding:0 8px}.dashboard .commands-view .command-row .row-col.index-col{padding:0;width:25px;text-align:center}.dashboard .commands-view .command-row .row-col.command-col{min-width:130px}.dashboard .commands-view .command-row .row-col.command-col,.dashboard .commands-view .command-row .row-col.target-col,.dashboard .commands-view .command-row .row-col.value-col{-webkit-box-flex:1;-ms-flex:1;flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.dashboard .commands-view .command-row .row-col.op-col{width:80px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.dashboard .table-footer{position:absolute;left:0;right:0;top:0;bottom:0;line-height:32px;text-align:center;font-weight:700;background:#f7f7f7;cursor:pointer}.dashboard .table-footer:hover{background:#e0e0e0}.dashboard .logs-screenshots{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;position:relative;margin-top:15px}.dashboard .logs-screenshots.fold{height:32px!important;overflow:hidden}.dashboard .logs-screenshots.fold .ant-tabs-content{display:none}.dashboard .logs-screenshots .resize-handler{position:absolute;top:-10px;left:0;width:100%;height:6px;background:transparent;cursor:row-resize}.dashboard .logs-screenshots .resize-handler.focused,.dashboard .logs-screenshots .resize-handler:hover{height:6px;background:#ccc}.dashboard .logs-screenshots .ant-tabs.ant-tabs-card>.ant-tabs-bar .ant-tabs-tab{padding:5px 12px 4px}.dashboard .logs-screenshots .ant-tabs{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1;flex:1}.dashboard .logs-screenshots .ant-tabs-bar{margin-bottom:0}.dashboard .logs-screenshots .ant-tabs-content{-webkit-box-flex:1;-ms-flex:1;flex:1;overflow-y:auto;min-height:70px;border:1px solid #d9d9d9;border-width:0 1px 1px}.dashboard .logs-screenshots .ls-toolbox{position:absolute;right:0;top:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.dashboard .logs-screenshots .ls-toolbox>*{margin-right:5px}.dashboard .logs-screenshots .ls-toolbox>:last-child{margin-right:0}.dashboard .logs-screenshots .log-content,.dashboard .logs-screenshots .screenshot-content{padding:10px 0}.dashboard .logs-screenshots .screenshot-content li{padding:0 20px 20px}.dashboard .logs-screenshots .screenshot-content li .timestamp{display:block;margin-bottom:10px;font-size:14px}.dashboard .logs-screenshots .screenshot-content li .filename{font-weight:700}.dashboard .logs-screenshots .log-content{list-style:none;margin:0;padding:0 10px;height:calc(100% - 38px);overflow-y:auto}.dashboard .logs-screenshots .log-content li{padding:5px 0;font-size:12px;border-bottom:1px solid #f3f3f3}.dashboard .logs-screenshots .log-content li:after{content:"";display:table;clear:both}.dashboard .logs-screenshots .log-content li a.info{color:#108ee9!important}.dashboard .logs-screenshots .log-content li.error{color:red;font-weight:700}.dashboard .logs-screenshots .log-content li.error a{color:red;text-decoration:underline}.dashboard .logs-screenshots .log-content li.warning{color:orange}.dashboard .logs-screenshots .log-content li .log-type{float:left;margin-right:10px}.dashboard .logs-screenshots .log-content li .log-detail{white-space:pre-wrap}.dashboard .logs-screenshots .csv-content{padding:10px}.dashboard .logs-screenshots .csv-content button{margin-right:5px}.dashboard .logs-screenshots .variable-content{padding:10px}.dashboard .logs-screenshots .variable-content .variable-options{margin-bottom:10px}.dashboard .logs-screenshots .variable-content .ant-checkbox-wrapper{margin-left:0!important;margin-right:10px}.dashboard .logs-screenshots .variable-content .read-only{color:#ccc}.dashboard .logs-screenshots .vision-content{padding:10px}.dashboard .logs-screenshots .vision-content .vision-top-actions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:15px}.dashboard .logs-screenshots .vision-content .vision-top-actions .main-actions{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-right:15px}.dashboard .logs-screenshots .vision-content .vision-top-actions .main-actions .main-actions-left{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.dashboard .logs-screenshots .vision-content .vision-top-actions .main-actions .main-actions-left>*{margin-right:15px}.dashboard .logs-screenshots .vision-content .vision-top-actions .main-actions .main-actions-left>:last-child{margin-right:0}.dashboard .logs-screenshots .vision-content .vision-top-actions .main-actions .load-image-button{padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.dashboard .logs-screenshots .vision-content .vision-top-actions .main-actions .load-image-button label{padding:0 15px;cursor:pointer}.dashboard .logs-screenshots .vision-content .vision-top-actions .more-info{font-size:14px}.dashboard .logs-screenshots .vision-content .vision-image{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-ms-flex-line-pack:center;align-content:center;overflow:hidden;width:100px;height:100px;border:1px solid #ccc}.dashboard .logs-screenshots .vision-content .vision-image img{max-height:100px}.dashboard .logs-screenshots .vision-content .vision-name{font-size:14px;word-break:break-all}.dashboard .logs-screenshots .vision-content .vision-actions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.dashboard .logs-screenshots .vision-content .vision-actions button{margin-right:5px}.dashboard .logs-screenshots .vision-content .vision-actions button:last-child{margin-right:0}.dashboard .online-help{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-top:15px;padding:0 10px;height:25px;line-height:25px;font-size:14px;text-align:right}.dashboard #context_menu{z-index:10}.dashboard #context_menu .ant-menu{border:"1px solid #ccc";border-radius:4px;-webkit-box-shadow:0 1px 6px rgba(0,0,0,.2);box-shadow:0 1px 6px rgba(0,0,0,.2)}.dashboard #context_menu .ant-menu .ant-menu-item{height:36px;line-height:36px}.dashboard #context_menu .ant-menu .ant-menu-item:hover{background:#ecf6fd}.dashboard #context_menu .ant-menu .ant-menu-item .shortcut{float:right;color:#999}.dashboard .target-full-editor .mask{position:fixed;z-index:100;top:0;bottom:0;left:0;right:0;background:#000;opacity:.4}.dashboard .target-full-editor .react-codemirror2{position:fixed;z-index:100;top:40px;bottom:40px;left:40px;right:40px}.dashboard .target-full-editor .react-codemirror2 .CodeMirror{height:100%}.dashboard .target-full-editor .close-button{position:fixed;z-index:101;top:25px;right:25px}.source-error{color:red;white-space:pre-wrap;font-size:12px}.ant-dropdown .ant-dropdown-menu{max-height:none}@media (max-width:768px){.duplicate-modal,.play-loop-modal,.rename-modal,.save-modal{width:400px!important;margin:0 auto}}',""])},105:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(153),a=r(12);!function(e){e.Normal="NORMAL",e.Success="SUCCESS",e.Error="ERROR",e.ErrorInSub="ERROR_IN_SUB"}(t.MacroResultStatus||(t.MacroResultStatus={}));class o extends n.KeyValueData{getAll(){return super.get("")}getMainKeyAndSubKeys(e){const[t,r]=super.getMainKeyAndSubKeys(e);return[o.STORAGE_KEY,[t].concat(r).filter(e=>e&&e.length)]}}t.MacroExtraKeyValueData=o,o.STORAGE_KEY="macro_extra",t.getMacroExtraKeyValueData=a.singletonGetter(()=>new o)},1059:function(e,t,r){var n=r(1060);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(133)(n,a);n.locals&&(e.exports=n.locals)},106:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(385)),o=r(112),i=r(4),s=r(12);function c(e){return e.response&&"string"==typeof e.response.body?new Error(e.response.body):e}function l(e){throw console.error(e),c(e)}function u(e){return d(e.body),e.body}function d(e){switch(e.OCRExitCode){case o.OCRExitCode.AllParsed:return;case o.OCRExitCode.PartiallyParsed:throw new Error(["Parsed Partially (Only few pages out of all the pages parsed successfully)",e.ErrorMessage||"",e.ErrorDetails||""].filter(e=>e.length>0).join("; "));case o.OCRExitCode.Failed:throw new Error(["OCR engine fails to parse an image",e.ErrorMessage||"",e.ErrorDetails||""].filter(e=>e.length>0).join("; "));case o.OCRExitCode.Fatal:throw new Error(["Fatal error occurs during parsing",e.ErrorMessage||"",e.ErrorDetails||""].filter(e=>e.length>0).join("; "))}}function m(e){let t=0,r=0,n=0;return{next:()=>{const a=e[t],o=a?a.TextOverlay.Lines:[],i=a?a.TextOverlay.Lines[r]:null,s=i?i.Words:[],c=i?i.Words[n]:null;if(!c)return{done:!0,value:null};const l={word:c,position:{pageIndex:t,lineIndex:r,wordIndex:n}};return[t,r,n]=(()=>{let a=n+1,i=r,c=t;return a>=s.length&&(a=0,i+=1),i>=o.length&&(i=0,c+=1),c>=e.length?[-1,-1,-1]:[c,i,a]})(),{value:l,done:!1}}}}function p(e,t){const r=m(e);for(;;){const{done:e,value:n}=r.next();if(e)break;if(!t(n))break}}var h;function f(e,t,r){if(!e||!t)return!1;const n=e.trim().toLowerCase(),a=t.trim().toLowerCase();switch(r){case h.Full:return n===a;case h.Prefix:return 0===a.indexOf(n);case h.Postfix:{const e=a.indexOf(n);return-1!==e&&e===a.length-n.length}case h.AnyPart:return-1!==a.indexOf(n)}}function g(e,t){return e.pageIndex===t.pageIndex&&e.lineIndex===t.lineIndex&&e.wordIndex===t.wordIndex}function v(e){const t=e.words.reduce((e,t)=>{const r=`${t.position.pageIndex}_${t.position.lineIndex}`;return e[r]?e[r]=Object.assign(Object.assign({},e[r]),{width:Math.max(e[r].width,t.word.Left+t.word.Width-e[r].x),height:Math.max(e[r].height,t.word.Top+t.word.Height-e[r].y)}):e[r]={x:t.word.Left,y:t.word.Top,width:t.word.Width,height:t.word.Height},e},{});return Object.keys(t).reduce((e,r)=>e.width<t[r].width?t[r]:e,{x:0,y:0,width:0,height:0})}function b(e,t){return Object.assign(Object.assign({},e),{Width:t*e.Width,Height:t*e.Height,Left:t*e.Left,Top:t*e.Top})}t.runOCR=function(e){const t=(e.scale+"").toLowerCase(),r=-1!==["true","false"].indexOf(t)?t:"true",n=-1!==[1,2].indexOf(e.engine||0)?e.engine:1,o=s.retry(()=>e.getApiUrlAndApiKey().then(t=>{const{url:o,key:s}=t,d=new FormData;d.append("apikey",s),d.append("language",e.language),d.append("scale",r),d.append("OCREngine",""+n),d.append("isOverlayRequired",""+e.isOverlayRequired),void 0!==e.isTable&&d.append("isTable",""+e.isTable),"string"==typeof e.image?d.append("file",i.dataURItoBlob(e.image),"unknown.png"):d.append("file",e.image.blob,e.image.name);const m=(new Date).getTime();return e.willSendRequest&&e.willSendRequest({server:t,startTime:m}),i.withTimeout(e.singleApiTimeout,()=>a.default.post(o).send(d)).then(r=>e.didGetResponse?e.didGetResponse({server:t,startTime:m,endTime:(new Date).getTime(),response:r.body,error:null}).then(()=>r,()=>r):r,r=>{const n=c(r);if(e.didGetResponse)return e.didGetResponse({server:t,startTime:m,endTime:(new Date).getTime(),response:null,error:n}).then(()=>{throw n},()=>{throw n});throw r}).then(u,l).catch(t=>{throw/timeout/i.test(t.message)?new Error(`OCR request timeout ${(e.singleApiTimeout/1e3).toFixed(1)}s`):t})}),{timeout:10*e.singleApiTimeout,retryInterval:0,shouldRetry:e.shouldRetry||(()=>!1)});return i.withTimeout(e.totalTimeout,o).catch(e=>{throw/timeout/i.test(e.message)?new Error("OCR timeout"):e})},t.guardOCRResponse=d,t.wordIteratorFromParseResults=m,t.iterateThroughParseResults=p,t.searchTextInOCRResponse=function(e){const{text:t,index:r,parsedResults:n,exhaust:a}=e,o=/^\[.*\]$/.test(t),i=(o?t.slice(1,-1):t).split(/\s+/g).map(e=>e.trim()).filter(e=>e.length>0);if(r<0||Math.round(r)!==r)throw new Error("index must be positive integer");let s=[],c=0,l=0;p(n,e=>{const t=o?h.Full:1===i.length?h.AnyPart:0===c?h.Postfix:c===i.length-1?h.Prefix:h.Full;if(!f(i[c],e.word.WordText,t))return s[l]=[],c=0,!0;if(s[l]=s[l]||[],s[l].push(e),c+=1,c>=i.length){return l+=1,c=0,a||l<=r}return!0});const u=s.filter(e=>e.length===i.length).map(e=>({words:e,similarity:1}));return{hit:u[r]||null,all:u,exhaust:a}},t.isWordEqual=function(e,t){return!(!e||!t)&&e.trim().toLowerCase()===t.trim().toLowerCase()},function(e){e[e.Full=0]="Full",e[e.Prefix=1]="Prefix",e[e.Postfix=2]="Postfix",e[e.AnyPart=3]="AnyPart"}(h=t.WordMatchType||(t.WordMatchType={})),t.hasWordMatch=f,t.isWordPositionEqual=g,t.allWordsWithPosition=function(e,t){const r=[];return p(e,e=>((e=>t.reduce((t,r)=>!!t||g(r,e.position),!1))(e)||r.push(e),!0)),r},t.ocrMatchRect=v,t.ocrMatchCenter=function(e){const t=v(e);return{x:t.x+t.width/2,y:t.y+t.height/2}},t.scaleOcrParseResultWord=b,t.scaleOcrResponseCoordinates=function(e,t){return s.safeUpdateIn(["ParsedResults","[]","TextOverlay","Lines","[]","Words","[]"],e=>b(e,t),e)},t.scaleOcrTextSearchMatch=function(e,t){return s.safeUpdateIn(["words","[]","word"],e=>b(e,t),e)}},1060:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,".select-input{position:relative}.select-input input{padding-right:24px}.select-input .arrow-icon{position:absolute;top:50%;right:8px;-webkit-transform:scale(.75) rotate(0deg);transform:scale(.75) rotate(0deg);color:rgba(0,0,0,.43);-webkit-transition:-webkit-transform .2s ease;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease;pointer-events:none;cursor:pointer}.select-input.opened .arrow-icon{-webkit-transform:scale(.75) rotate(180deg);transform:scale(.75) rotate(180deg)}.drop-down .option-list{position:absolute;z-index:1000;border-radius:4px;font-size:12px;background:#fff;-webkit-box-shadow:0 1px 6px rgba(0,0,0,.2);box-shadow:0 1px 6px rgba(0,0,0,.2)}.drop-down .option-list .plain-text-option{padding:7px 8px;cursor:pointer}.drop-down .option-list .plain-text-option.selected{background-color:#f7f7f7;font-weight:600}.drop-down .option-list .plain-text-option:hover{background-color:#ecf6fd}",""])},1062:function(e,t,r){var n=r(1063);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(133)(n,a);n.locals&&(e.exports=n.locals)},1063:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,"body{margin:0;padding:0;font-size:16px}*{-webkit-box-sizing:border-box;box-sizing:border-box}.app{position:absolute;top:0;bottom:0;left:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.app.no-display .status{margin-bottom:20px;font-size:14px}.app.no-display .content{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.app.with-alert .backup-alert{display:block}.app .app-inner{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.app .backup-alert{display:none;padding:5px 0;text-align:center;font-size:14px;background:#fdfdc2}.app .backup-alert .backup-actions{margin-left:20px}.app .backup-alert .backup-actions button{margin-right:10px}.app .content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:3;-ms-flex:3;flex:3;min-width:520px;background:#fff;overflow-y:auto}.app .hidden-during-replay{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;padding-top:15px;font-size:14px;color:#999}.app .hidden-during-replay,.app .list-not-loaded{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.app .list-not-loaded{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}.app .list-not-loaded button{margin-top:20px}",""])},107:function(e,t,r){"use strict";r.r(t);r(170);var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(){var e=window.requestFileSystem||window.webkitRequestFileSystem;if(!e)throw new Error("requestFileSystem not supported");var t=function(t){return t=t||5242880,new Promise((function(r,n){e(window.TEMPORARY,t,r,n)}))},r=function(e,r,n){var a=(Array.isArray(e)?e:e.split("/")).filter((function(e){return e&&e.length}));return(n?Promise.resolve(n):t(1048576)).then((function(e){return function e(t,n){return t&&t.length?new Promise((function(e,a){n.getDirectory(t[0],{create:!!r},(function(t){return e(t)}),(function(e){return a(e)}))})).then((function(r){return e(t.slice(1),r)})):Promise.resolve(n)}(a,e.root)}))},a=function(e,t){var n=e.split("/");return r(n.slice(0,-1),!1,t).then((function(e){return{directoryEntry:e,fileName:n.slice(-1)[0]}}))},o=function(e,r){if(-1===["ArrayBuffer","BinaryString","DataURL","Text"].indexOf(r))throw new Error("invalid readFile type, '"+r+"'");return t().then((function(t){return a(e,t).then((function(e){var t=e.directoryEntry,n=e.fileName;return new Promise((function(e,a){t.getFile(n,{},(function(t){t.file((function(t){var n=new FileReader;switch(n.onerror=a,n.onloadend=function(){e(this.result)},r){case"ArrayBuffer":return n.readAsArrayBuffer(t);case"BinaryString":return n.readAsBinaryString(t);case"DataURL":return n.readAsDataURL(t);case"Text":return n.readAsText(t);default:throw new Error("unsupported data type, '"+r)}}),a)}),a)}))}))})).catch((function(e){throw console.warn("readFile",e.code,e.name,e.message),e}))},i=function(e,r,n){return t(n).then((function(t){return a(e,t).then((function(e){var t=e.directoryEntry,n=e.fileName;return new Promise((function(e,a){t.getFile(n,{create:!0},(function(t){t.createWriter((function(n){n.onwriteend=function(){return e(t.toURL())},n.onerror=a,n.write(r)}))}),a)}))}))})).catch((function(e){throw console.warn(e.code,e.name,e.message),e}))},s=function(e){return t().then((function(t){return a(e,t).then((function(e){var t=e.directoryEntry,r=e.fileName;return new Promise((function(e,n){t.getFile(r,{create:!0},(function(t){t.remove(e,n)}),n)}))}))})).catch((function(e){throw console.warn("removeFile",e.code,e.name,e.message),e}))},c=function(e){return t().then((function(t){return a(e,t).then((function(e){var t=e.directoryEntry,r=e.fileName,a=function(e){return new Promise((function(n){t[e](r,{create:!1},(function(e){n(!0)}),(function(){return n(!1)}))}))},o=a("getFile"),i=a("getDirectory");return Promise.all([o,i]).then((function(e){var t=n(e,2);return{isFile:t[0],isDirectory:t[1]}}))}))})).catch((function(e){if(e&&8===e.code)return{isFile:!1,isDirectory:!1};throw console.warn("fs.exists",e.code,e.name,e.message),e}))};return{list:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";return t(1048576).then((function(t){return new Promise((function(t,n){r(e).then((function(e){var r=[],a=e.createReader();!function e(){a.readEntries((function(n){0===n.length?t(r.sort()):(r=r.concat(Array.from(n)),e())}),n)}()})).catch(n)}))})).catch((function(e){throw console.warn("list",e.code,e.name,e.message),e}))},readFile:o,writeFile:i,removeFile:s,moveFile:function(e,r){return t().then((function(t){return Promise.all([a(e,t),a(r,t)]).then((function(t){var n=t[0].directoryEntry,a=t[0].fileName,c=t[1].directoryEntry,l=t[1].fileName;return new Promise((function(t,u){n.getFile(a,{},(function(n){try{n.moveTo(c,l,t,u)}catch(n){o(e,"ArrayBuffer").then((function(e){return i(r,new Blob([new Uint8Array(e)]))})).then((function(){return s(e)})).then(t,u)}}),u)}))}))}))},copyFile:function(e,r){return t().then((function(t){return Promise.all([a(e,t),a(r,t)]).then((function(t){var n=t[0].directoryEntry,a=t[0].fileName,s=t[1].directoryEntry,c=t[1].fileName;return new Promise((function(t,l){n.getFile(a,{},(function(n){try{n.copyTo(s,c,t,l)}catch(n){o(e,"ArrayBuffer").then((function(e){return i(r,new Blob([new Uint8Array(e)]))})).then(t,l)}}),l)}))}))})).catch((function(e){throw console.warn("copyFile",e.code,e.name,e.message),e}))},getDirectory:r,getMetadata:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t().then((function(t){return e.getMetadata?new Promise((function(t,r){return e.getMetadata(t)})):a(e,t).then((function(e){var t=e.directoryEntry,n=e.fileName;return new Promise((function(e,a){var o=[n,{create:!1},function(t){t.getMetadata(e)},a];r?t.getDirectory.apply(t,o):t.getFile.apply(t,o)}))}))})).catch((function(e){throw console.warn("getMetadata",e.code,e.name,e.message),e}))},ensureDirectory:function(e,t){return r(e,!0,t)},exists:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.type;return c(e).then((function(e){switch(r){case"file":return e.isFile;case"directory":return e.isDirectory;default:return e.isFile||e.isDirectory}}))},existsStat:c,rmdir:function(e,t){return r(e,!1,t).then((function(e){return new Promise((function(t,r){e.remove(t,r)}))}))},rmdirR:function(e,t){return r(e,!1,t).then((function(e){return new Promise((function(t,r){return e.removeRecursively(t,r)}))}))}}}();window.fs=a,t.default=a},1086:function(e,t,r){"use strict";r.r(t);var n=r(15),a=r.n(n),o=r(621),i=r.n(o),s=r(0),c=r.n(s),l=r(18),u=r.n(l),d=r(362),m=r(387),p=r.n(m),h=r(655),f=r(553),g=r(627),v=r.n(g),b=r(135),y=r.n(b),w=r(34),E=r.n(w),x=r(27),S=r(70),C=r.n(S),T=r(19),_=r.n(T),O=r(56),k=r.n(O),P=r(85),I=r(77),M=r(16),A=r(17),D=r(20),N=r(45),R=r.n(N),j=r(158),L=r.n(j),F=r(25),V=r.n(F),U=r(38),B=r.n(U),X=r(29),K=r.n(X),$=r(39),Y=r.n($),W=r(37),G=r.n(W),H=r(35),z=r.n(H),q=r(31),J=r.n(q),Z=r(639),Q=r.n(Z),ee=r(403),te=r.n(ee),re=r(640),ne=r.n(re),ae=(r(1003),r(28)),oe=r(23),ie=r(99),se=r(41),ce=r(4),le=r(32),ue=r(88),de=r(74),me=r(75),pe=(r(90),r(13)),he=r(10),fe=r.n(he),ge=r(329),ve=r(184),be=r(12),ye=r(42),we=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function xe(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var Se=[].concat(["KEY_LEFT","KEY_UP","KEY_RIGHT","KEY_DOWN","KEY_PGUP","KEY_PAGE_UP","KEY_PGDN","KEY_PAGE_DOWN","KEY_BKSP","KEY_BACKSPACE","KEY_DEL","KEY_DELETE","KEY_ENTER","KEY_TAB","KEY_ESC","KEY_SPACE","KEY_HOME","KEY_END"],["KEY_CTRL","KEY_ALT","KEY_SHIFT","KEY_WIN","KEY_CMD","KEY_META"],["KEY_F1","KEY_F2","KEY_F3","KEY_F4","KEY_F5","KEY_F6","KEY_F7","KEY_F8","KEY_F9","KEY_F10","KEY_F11","KEY_F12","KEY_F13","KEY_F14","KEY_F15"],["KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9"],["KEY_Num0","KEY_Num1","KEY_Num2","KEY_Num3","KEY_Num4","KEY_Num5","KEY_Num6","KEY_Num7","KEY_Num8","KEY_Num9"],["KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z"]).map((function(e){return e.toUpperCase()})),Ce=function(e){var t=e&&e.toUpperCase();if(-1!==Se.indexOf(t))return!0;if(/^KEY_\w+(\+KEY_\w+)*$/.test(t)){var r=t.split("+");return ce.and.apply(void 0,xe(r.map((function(e){return-1!==Se.indexOf(e)}))))}return!1},Te={},_e=function(e){"!"===e.charAt(0)&&(e=e.substr(1));try{Object(ce.validateStandardName)(e)}catch(t){throw new Error("Invalid variable name '"+e+"'. A variable name "+t.message)}return!0},Oe=/\$\{((!?\w+)((\.\w+|\[(\d+|\$\{!?\w+\})\])*))\}/gi,ke=/storedVars\[('|")((!?\w+)((\.\w+|\[(\d+|\$\{!?\w+\})\])*))\1\]/gi;function Pe(e){var t=/\.(\w+)|\[(\d+|\$\{!?\w+\})\]/gi,r=e&&e.trim();if(!r||0===r.length)return[];for(var n=[],a=-1,o=void 0;o=t.exec(e);){if(!o||o.index!==a+1)throw new Error("Invalid variable expression");n.push(o[1]||o[2]),a+=o[0].length}if(a!==r.length-1)throw new Error("Invalid variable expression ending");return n}function Ie(e){return e.map((function(e){return/^\d+$/.test(e)?"["+e+"]":"."+e})).join("")}var Me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return Te[e]},Ae=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ne=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var je=function(e){return e.toUpperCase()},Le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Re(this,e),this.state=Object(be.clone)(e.DefaultState),t.pre&&(this.__customPre=t.pre),t.run&&(this.__customRun=t.run),t.post&&(this.__customPost=t.post)}return Ne(e,[{key:"reset",value:function(){this.__setState({labels:{},tags:[],commands:[]})}},{key:"preprocess",value:function(e){var t=this,r={commands:e,tags:[]},n=[],a=function(e,t){var r=new Error(t);return r.errorIndex=e,r};if(e.forEach((function(e,o){if(!t.__customPre||!t.__customPre(e,o)){var i,s,c,l=n[n.length-1];switch(e.cmd){case"if_v2":case"if":case"times":case"forEach":case"while_v2":case"while":case"do":n.push({type:e.cmd,start:{index:o,command:e}});break;case"repeatIf":if(!l||!/^do$/.test(l.type))throw a(o,"No matching do for this repeatIf (at command #"+(o+1)+")");r.tags.push(De({},l,{end:{index:o,command:e}})),n.pop();break;case"elseif":case"else":if(!l||!/^if/.test(l.type))throw a(o,"No matching if for this "+e.cmd+" (at command #"+(o+1)+")");l.children=l.children||[];var u=l.children.findIndex((function(e){return e.command&&"else"===e.command.cmd}));if(-1!==u){var d=l.children[u];throw new Error("'"+e.cmd+"' (at command #"+(o+1)+") could not be used after '"+d.command.cmd+"' (at command #"+(d.index+1)+")")}l.children.push({index:o,command:e});break;case"break":case"continue":var m=n.find((function(e){return/^(do|while|forEach|times)/.test(e.type)}));if(!m)throw a(o,"No matching loop command for this "+e.cmd+" (at command #"+(o+1)+")");m.children=m.children||[],m.children.push({index:o,command:e});break;case"end":case"endWhile":case"endif":var p=function(){switch(e.cmd){case"end":return[/^(if|while|times|forEach)/,"if/while/times/forEach"];case"endWhile":return[/^while/,"while"];case"endif":return[/^if/,"if"]}}(),h=Ae(p,2),f=h[0],g=h[1];if(!l||!f.test(l.type))throw a(o,"No matching "+g+" for this end (at command #"+(o+1)+")");r.tags.push(De({},l,{end:{index:o,command:e}})),n.pop();break;case"label":if(!e.target||!e.target.length)throw new Error("invalid target for label command");t.__setState({labels:De({},t.state.labels,(i={},s=je(e.target),c={index:o},s in i?Object.defineProperty(i,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):i[s]=c,i))})}}})),n.length>0){var o=n[n.length-1];throw a(o.start.index,"Unclosed '"+o.type+"' (at command #"+(o.start.index+1)+")")}this.__setState(r)}},{key:"run",value:function(e,t){var r=this,n=e.cmd,a=e.target;e.value;return function(){switch(n){case"onError":var o=e.value&&e.value.trim(),i=e.target&&e.target.trim();if(!(i&&(/^#restart$/i.test(i)||/^#goto$/i.test(i))))throw new Error("invalid target for onError command");if(/^#goto$/i.test(i)){var s=je(o);if(!r.state.labels[s])throw new Error("label "+o+" doesn't exist")}return Promise.resolve({isFlowLogic:!0});case"gotoLabel":if(!a||!a.length)throw new Error("invalid target for gotoLabel command");var c=je(a);if(!r.state.labels[c])throw new Error("label "+a+" doesn't exist");return Promise.resolve({isFlowLogic:!0,nextIndex:r.state.labels[c].index});case"elseif":var l=r.state.tags.find((function(e){return/^if/.test(e.type)&&e.children&&e.children.find((function(e){return e.index===t&&e.command.cmd===n}))}));if(!l)throw new Error("tag not found for this else (at command #"+(t+1)+")");return l.alreadyRun?Promise.resolve({isFlowLogic:!0,nextIndex:l.end.index+1}):Promise.resolve({isFlowLogic:!1});case"else":var u=r.state.tags.find((function(e){return/^if/.test(e.type)&&e.children&&e.children.find((function(e){return e.index===t&&e.command.cmd===n}))}));if(!u)throw new Error("tag not found for this else (at command #"+(t+1)+")");return Promise.resolve({isFlowLogic:!0,nextIndex:u.end.index+1});case"break":var d=r.state.tags.find((function(e){return/^(do|while|forEach|times)/.test(e.type)&&e.children&&e.children.find((function(e){return e.index===t&&e.command.cmd===n}))}));if(!d)throw new Error("No loop found for this break (at command #"+(t+1)+")");return Promise.resolve({isFlowLogic:!0,nextIndex:d.end.index+1});case"continue":var m=r.state.tags.find((function(e){return/^(do|while|forEach|times)/.test(e.type)&&e.children&&e.children.find((function(e){return e.index===t&&e.command.cmd===n}))}));if(!m)throw new Error("No loop found for this break (at command #"+(t+1)+")");return Promise.resolve({isFlowLogic:!0,nextIndex:m.start.index});case"endif":return Promise.resolve({isFlowLogic:!0});case"endWhile":var p=r.state.tags.find((function(e){return/^while/.test(e.type)&&e.end.index===t}));if(!p)throw new Error("tag not found for this endWhile (at command #"+(t+1)+")");return Promise.resolve({isFlowLogic:!0,nextIndex:p.start.index});case"end":var h=r.state.tags.find((function(e){return/^(if|while|times|forEach)/.test(e.type)&&e.end.index===t}));if(!h)throw new Error("tag not found for this end (at command #"+(t+1)+")");return/^if/.test(h.type)?Promise.resolve({isFlowLogic:!0}):Promise.resolve({isFlowLogic:!0,nextIndex:h.start.index});case"comment":case"label":case"do":return Promise.resolve({isFlowLogic:!0});case"gotoIf":case"if":case"while":case"gotoIf_v2":case"if_v2":case"while_v2":case"repeatIf":default:return Promise.resolve({isFlowLogic:!1})}}().then((function(n){if(n.isFlowLogic)return n;if(r.__customRun){var a=r.__customRun(e,t);if(a)return Promise.resolve(a)}return n}))}},{key:"postRun",value:function(e,t,r){var n=this,a=e.cmd,o=(e.target,e.value);if(this.__customPost){var i=this.__customPost(e,t,r);if(i)return Promise.resolve(i)}switch(a){case"gotoIf_v2":case"gotoIf":if(!r.condition)return Promise.resolve();if(!o||!o.length)throw new Error("invalid value for value command");var s=je(o);if(!this.state.labels[s])throw new Error("label "+o+" doesn't exist");return Promise.resolve({nextIndex:this.state.labels[s].index});case"elseif":case"if_v2":case"if":var c=r.condition,l="elseif"===a?n.state.tags.find((function(e){return/^if/.test(e.type)&&e.children&&e.children.find((function(e){return e.index===t&&"elseif"===e.command.cmd}))})):n.state.tags.find((function(e){return/^if/.test(e.type)&&e.start.index===t}));if(!l)throw new Error("'if' tag not found for this "+a+" (at command #"+(t+1)+")");l.alreadyRun=!!c;var u=function(){if("elseif"!==a)return 0;var e=(l.children||[]).findIndex((function(e){return e.index===t&&"elseif"===e.command.cmd}));return-1===e?-1:e+1}();if(-1===u)throw new Error("Can't find fork for this elseif (at command #"+(t+1)+")");var d=function(){var e=l.children&&l.children[u];if(!e)return null;var t=e&&"else"===e.command.cmd?1:0;return e.index+t}(),m=l.end&&l.end.index+1;return Promise.resolve({nextIndex:c?t+1:d||m});case"times":case"forEach":case"while_v2":case"while":var p=r.condition,h=this.state.tags.find((function(e){return/^while|times|forEach/.test(e.type)&&e.start.index===t}));if(!h)throw new Error("tag not found for this "+a+" (at command #"+(t+1)+")");if(!h.end||void 0===h.end.index||null===h.end.index)throw new Error("tag doesn't have a valid end index");return Promise.resolve(p?{}:{nextIndex:h.end.index+1});case"repeatIf":var f=r.condition,g=this.state.tags.find((function(e){return/^do$/.test(e.type)&&e.end.index===t}));if(!g)throw new Error("tag not found for this repeatIf (at command #"+(t+1)+")");if(!g.end||void 0===g.start.index||null===g.start.index)throw new Error("tag doesn't have a valid start index");return Promise.resolve(f?{nextIndex:g.start.index+1}:{});default:return Promise.resolve()}}},{key:"commandIndexByLabel",value:function(e){var t=this.state.labels[je(e)];if(!t)throw new Error("label '"+e+"' doesn't exist");return t.index}},{key:"backupState",value:function(){return Object(be.clone)(this.state)}},{key:"restoreState",value:function(e){this.__setState(e)}},{key:"getKeyForTimes",value:function(e){return"times_"+e}},{key:"getKeyForSurroundingTimes",value:function(e){var t=this,r=this.state.tags.findIndex((function(t){return/^(times)/.test(t.type)&&t.start.index===e}));if(-1===r)return null;var n=this.state.tags[r],a=function(){for(var e=r;e<t.state.tags.length;e++){var a=t.state.tags[e];if("times"===a.type&&a.start.index<n.start.index&&a.end.index>n.end.index)return a}return null}();return a?this.getKeyForTimes(a.start.index):null}},{key:"getExtraByKey",value:function(e){return this.state.extra[e]}},{key:"setExtraByKey",value:function(e,t){this.state.extra[e]=t}},{key:"updateExtraByKey",value:function(e,t){this.setExtraByKey(e,t(this.getExtraByKey[e]))}},{key:"removeExtraByKey",value:function(e){delete this.state.extra[e]}},{key:"__setState",value:function(e){this.state=De({},this.state,e)}}]),e}();Le.DefaultState={labels:{},tags:[],commands:[],extra:{}};var Fe=Le,Ve=r(534),Ue=r.n(Ve);function Be(e){return new Promise((function(t,r){Ue.a.parse(e,(function(e,n){return e?r(e):t(n)}))}))}function Xe(e){return new Promise((function(t,r){Ue.a.stringify(e,(function(e,n){return e?r(e):t(n)}))}))}var Ke=r(11),$e=r.n(Ke),Ye=r(161),We=r(100),Ge=r(58),He=r(91),ze=r(106),qe=r(76),Je=r(112),Ze=r(404),Qe=r(330),et=r(197),tt=r(187),rt=r(87),nt=r(115),at=r(191),ot=r(402),it=r(96),st=r(95),ct=r(43),lt=r(60),ut=r(146),dt=r(157),mt=r(105),pt=r(22),ht=r(136),ft=r(30),gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vt=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},bt=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function yt(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function wt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Et=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reset()}return bt(e,[{key:"reset",value:function(){this.startTime=new Date}},{key:"elapsed",value:function(){return new Date-this.startTime}},{key:"elapsedInSeconds",value:function(){return(this.elapsed()/1e3).toFixed(2)+"s"}}]),e}(),xt=function(e){return D.default.ask("PANEL_SET_PROXY",{proxy:e})},St=function(e){var t=e.searchArea,r=e.storedImageRect,n=e.ocrApiTimeout,a=e.store,o=e.lang,i=e.engine,s=e.scale,c=e.isTable,l=e.isDesktop,u=s;return new Promise((function(e,s){var d=Object(Qe.getOcrCommandCounter)();return(Object(ft.getLicenseService)().hasNoLicense()||d.get()!==E.a.xmodulesLimit.unregistered.ocrCommandCount?Promise.resolve():Object(ft.getLicenseService)().recheckLicenseIfPossible().then((function(){if(Object(ft.getLicenseService)().isLicenseExpired())throw new Error("Activation check failed. Reset to free edition. If you believe this was an error, please contact tech support")}))).then((function(){return l?Promise.resolve():D.default.ask("PANEL_CLEAR_OCR_MATCHES_ON_PLAYING_PAGE")})).then((function(){return Object(ce.delay)((function(){}),1e3)})).then((function(){return D.default.ask("PANEL_CAPTURE_IMAGE",{isDesktop:l,storedImageRect:r,searchArea:/\.png/i.test(t)?"rect":t,scaleDpi:!0})})).then((function(e){var t=e.dataUrl,r=e.offset,s=e.viewportOffset,l=e.scale,m=void 0===l?1:l,p=Object(ce.dataURItoBlob)(t),h=Object(qe.readableSize)(p.size),f=(new Date,function(e,t){return((t-e)/1e3).toFixed(1)+"s"}),g=Object(be.countDown)({interval:1e3,timeout:n,onTick:function(e){var t=e.past,r=e.total;a.dispatch(M.setTimeoutStatus({past:t,total:r,type:"OCR in progress"}))}});return d.check(),a.dispatch(M.addLog("info","OCR ("+o+") started ("+h+")")),Object(ze.runOCR)({engine:i,isTable:c,scale:u,image:t,language:o,totalTimeout:n,singleApiTimeout:E.a.ocr.singleApiTimeout,isOverlayRequired:!0,getApiUrlAndApiKey:function(){return function(){var e=a.getState().config,t=e.ocrMode,r=e.ocrOfflineURL,n=e.ocrOfflineAPIKey;switch(t){case"enabled":return Object(et.getOcrEndpointPicker)().bestPick();case"offline_enabled":if(!/^https?:\/\//.test(r))throw new Error("Please set local OCR API first");if(!n||!n.length)throw new Error("Please set local OCR API key first");return Promise.resolve({url:r,key:n});default:throw new Error("Please enable OCR first")}}().then((function(e){return e}))},shouldRetry:function(){switch(a.getState().config.ocrMode){case"enabled":return Object(et.getOcrEndpointPicker)().isAllDown().then((function(e){return!e}));case"offline_enabled":case"disabled":return!1}},didGetResponse:function(e){var t=e.server,r=e.startTime,n=e.endTime,o=e.response,i=e.error,s=t.id||t.url;return Object(et.getOcrEndpointPicker)().validServers().then((function(e){var t=e.servers.length>=2;return o?a.dispatch(M.addLog("info","OCR result received ("+f(r,n)+" from endpoint "+s+")")):i&&a.dispatch(M.addLog("warning","Error in OCR endpoint "+s+" after "+f(r,n)+": "+i.message+(t?" - trying next.":""))),s&&o&&Object(et.getOcrEndpointPicker)().use(s),s&&window.navigator.onLine?Object(et.getOcrEndpointPicker)().report(s,{lastError:i,lastOcrExitCode:o?o.OCRExitCode:void 0,lastRequestTimestamp:r,lastResponseTimestamp:n,lastTotalMilliseconds:n-r}).then((function(){})):Promise.resolve()}))}}).then((function(e){return g(),"enabled"===a.getState().config.ocrMode&&d.inc(),{offset:r,viewportOffset:s,response:Object(ze.scaleOcrResponseCoordinates)(e,m)}}),(function(e){throw g(),/All OCR servers are down/i.test(e.message)&&Object(et.getOcrEndpointPicker)().reset(),e}))})).then(e,s)}))},Ct=function(){return D.default.ask("PANEL_DISABLE_DOWNLOAD_BAR",{}).catch((function(e){return!0}))},Tt=function(){return D.default.ask("PANEL_ENABLE_DOWNLOAD_BAR",{}).catch((function(e){return!0}))},_t=function(e){var t=e.store,r=e.vars,n=e.getTcPlayer,a=e.getInterpreter,o=e.xCmdCounter,i=[kt({store:t,vars:r,getTcPlayer:n,getInterpreter:a,xCmdCounter:o}),Ot({store:t,vars:r,getTcPlayer:n,getInterpreter:a,xCmdCounter:o})];return function(e,t){return i.reduce((function(r,n){return void 0!==r?r:n(e,t)}),void 0)}},Ot=function(e){var t=e.store,r=e.vars,n=e.getTcPlayer,a=e.getInterpreter,o=e.xCmdCounter;return function e(i,s){var c=Object(pe.getStorageManager)().getCSVStorage(),l=Object(pe.getStorageManager)().getScreenshotStorage(),u=Object(pe.getStorageManager)().getMacroStorage().getPathLib(),d=i.cmd,m=i.target,p=i.value,h=i.extra,f={isFlowLogic:!0},g=function(){if("disabled"===t.getState().config.ocrMode)throw new Error("OCR feature disabled.")};$e()("interpretCsFreeCommands",i);var v,b,y=n().getState(),w=Object(pe.getStorageManager)().getMacroStorage().relativePath(y.extra.macroId),x=u.dirname(w);switch(d){case"repeatIf":case"elseif":case"if_v2":case"while_v2":case"gotoIf_v2":$e()("Executing "+d+": "+m);try{return{condition:window.eval(m),byPass:!0}}catch(e){throw new Error("Error in condition of "+d+": "+e.message)}case"times":var S=a(),T=S.getKeyForTimes(s),_=1+(S.getExtraByKey(T)||0),O=parseInt(m,10);if(isNaN(O))throw new Error("target must be a positive number");if(O<1)return{condition:!1,byPass:!0};var k=_<=O;if(k)S.setExtraByKey(T,_),r.set({"!TIMES":_},!0);else{S.removeExtraByKey(T);var P=S.getKeyForSurroundingTimes(s),I=S.getExtraByKey(P);void 0!==I?r.set({"!TIMES":I},!0):r.set({"!TIMES":_},!0)}return{condition:k,byPass:!0};case"forEach":var N=a(),R="forEach_"+s,j=N.getExtraByKey(R),L=1+(void 0===j?-1:j),F=r.get(m);if(!Array.isArray(F))throw new Error("target must be an array");var V=L<F.length,U=V?wt({},p,F[L]):null;return r.set({"!FOREACH":L},!0),V?N.setExtraByKey(R,L):N.removeExtraByKey(R),{vars:U,condition:V,byPass:!0};case"assert":case"verify":var B="assert"===d,X=m;if(!X||!X.length)throw new Error(d+": target is required as variable name");var K=""+r.get(X),$=""+p;if(K===$)return{byPass:!0};var Y="Expected variable "+X+" to be "+$+", but it is "+K;if(B)throw new Error(Y);return{byPass:!0,log:{error:Y}};case"executeScript_Sandbox":try{var W=";(function () { "+m+" })();",G=window.eval(W);return p&&p.length?{byPass:!0,vars:wt({},p,G)}:{byPass:!0}}catch(e){throw new Error("Error in executeScript_Sandbox code: "+e.message)}case"executeAsyncScript_Sandbox":try{var H="Promise.resolve((function () { "+m+" })());";return window.eval(H).then((function(e){return p&&p.length?{byPass:!0,vars:wt({},p,e)}:{byPass:!0}}))}catch(e){throw new Error("Error in executeScriptAsync_Sandbox code: "+e.message)}case"setProxy":return function(){if(/direct/i.test(m&&m.trim()))return xt(null).then((function(){return t.dispatch(M.addLog("info","Proxy reset to none"))}));var e=/default/i.test(m&&m.trim())?[t.getState().config.defaultProxy,t.getState().config.defaultProxyAuth]:[m,p],n=vt(e,2),a=n[0],o=n[1],i=Object(ut.parseProxyUrl)(a,o),s=i.type===dt.ProxyScheme.Socks4||i.type===dt.ProxyScheme.Socks5,c=!!i.username;return s&&c&&!Object(pt.isFirefox)()&&t.dispatch(M.addLog("warning","Browser doesn't support authentication on socks proxy")),xt(i).then((function(){r.set({"!PROXY_EXEC_COUNT":1+(r.get("!PROXY_EXEC_COUNT")||0)},!0),t.dispatch(M.addLog("info","Proxy set to "+a))}))}().then((function(){return{byPass:!0}}));case"run":var z=t.getState(),q=0===(b=(b=m).replace(/\\/g,"/")).indexOf("/")?u.normalize(b).replace(/^(\/|\\)/,""):u.join(x,b),J=Object(oe.findMacroNodeWithCaseInsensitiveRelativePath)(z,q);return Object(pe.getStorageManager)().getMacroStorage().read(J&&J.fullPath||q,"Text").then((function(e){var r=e.data.commands.find((function(e){return"open"===e.cmd.toLowerCase()})),n=M.commonPlayerState(t.getState(),{extra:{id:e.id},mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,startUrl:r?r.target:null,resources:e.data.commands,postDelay:1e3*z.config.playCommandInterval,isStep:Object(ae.b)().getState().isStep,loopsCursor:1,loopsStart:1,loopsEnd:1},e.id,e.name);return Object(ce.delay)((function(){}),500).then((function(){return Object(nt.getMacroCallStack)().call(e,{playerState:n,status:at.MacroStatus.Running,nextIndex:0,commandResults:[]})})).then((function(){return t.dispatch(M.updateMacroPlayStatus(e.id,mt.MacroResultStatus.Success)),{byPass:!0}}))}));case"store":return{byPass:!0,vars:wt({},p,m)};case"echo":return{byPass:!0,log:gt({info:m},"#shownotification"===p?{options:{notification:!0}}:p?{options:{color:p}}:{})};case"prompt":var Z=m.match(/^([^@]+)(?:@(.+))?$/),Q=vt(Z,3),ee=(Q[0],Q[1]),te=Q[2];return D.default.ask("PANEL_BRING_PANEL_TO_FOREGROUND").then((function(){return Object(tt.prompt)({message:ee,value:te||""})})).then((function(e){return{byPass:!0,vars:wt({},p,e)}}));case"throwError":throw new Error(m);case"pause":var re=parseInt(m);if(!m||!m.length||0===re)return{byPass:!0,control:{type:"pause"}};if(isNaN(re)||re<0)throw new Error("target of pause command must be a positive integer");var ne=n().getPlayUID();return Object(be.withCountDown)({timeout:re,interval:1e3,onTick:function(e){var r=e.total,a=e.past,o=e.cancel;return t.getState().player.status!==A.PLAYER_STATUS.PLAYING?o():n().checkPlayUID(ne)?void t.dispatch(M.setTimeoutStatus({past:a,total:r,type:"pause"})):o()}}).then((function(){return{byPass:!0}}));case"localStorageExport":var ie=/\s*#DeleteAfterExport\s*/i.test(p);if(/^\s*log\s*$/i.test(m)){var se=t.getState().logs.map(Ye.renderLog).join("\n");return C.a.saveAs(new Blob([se]),"uivision_log.txt"),ie&&t.dispatch(M.clearLogs()),f}if(/\.csv$/i.test(m))return c.exists(m).then((function(e){if(!e)throw new Error(m+" doesn't exist");return c.read(m,"Text").then((function(e){return C.a.saveAs(new Blob([e]),m),ie&&c.remove(m).then((function(){return t.dispatch(M.listCSV())})),f}))}));if(/\.png$/i.test(m))return l.exists(m).then((function(e){if(!e)throw new Error(m+" doesn't exist");return l.read(m,"ArrayBuffer").then((function(e){return C.a.saveAs(new Blob([new Uint8Array(e)]),m),ie&&l.remove(m).then((function(){return t.dispatch(M.listScreenshots())})),f}))}));throw new Error(m+" doesn't exist");case"OCRSearch":if(g(),!p||!p.length)throw new Error("value is required");var de=r.get("!ocrLanguage").toLowerCase(),me=r.get("!ocrEngine"),he=r.get("!ocrScale"),fe=r.get("!ocrTableExtraction"),ge=r.get("!visualSearchArea"),ve=r.get("!storedImageRect"),we=E.a.ocr.apiTimeout,Ee=(v=m.match(/^(.+)@POS=(\d+)$/i))?[v[1],parseInt(v[2])-1,!0]:[m,0,!1],xe=vt(Ee,3),Se=xe[0],Ce=xe[1],Te=xe[2];return St({store:t,lang:de,scale:he,engine:me,isTable:fe,searchArea:ge,storedImageRect:ve,ocrApiTimeout:we,isDesktop:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))}).then((function(e){var t=e.response,n=e.offset,a=e.viewportOffset,o=Object(be.safeUpdateIn)(["[]","TextOverlay","Lines","[]","Words","[]"],(function(e){return gt({},e,{Top:e.Top+a.y,Left:e.Left+a.x})}),t.ParsedResults),i=Object(be.safeUpdateIn)(["[]","TextOverlay","Lines","[]","Words","[]"],(function(e){return gt({},e,{Top:e.Top+n.y,Left:e.Left+n.x})}),t.ParsedResults),s=Object(ze.searchTextInOCRResponse)({text:Se,index:Ce,exhaust:!0,parsedResults:o}),c=s.hit,l=s.all,u=function(){if(c){var e,t=Object(ze.ocrMatchCenter)(c);return wt(e={},p,Te?1:l.length),wt(e,"!ocrx",t.x),wt(e,"!ocry",t.y),e}var r;return wt(r={},p,0),wt(r,"!ocrx",0),wt(r,"!ocry",0),r}(),d=[{similarity:1,highlight:Je.OcrHighlightType.Identified,words:Object(ze.allWordsWithPosition)(i,Object(be.flatten)(l.map((function(e){return e.words.map((function(e){return e.position}))}))))}].concat(yt(Object(be.compose)(l[Ce]?Object(ce.setIn)([Ce,"highlight"],Je.OcrHighlightType.TopMatched):function(e){return e},Object(ce.setIn)(["[]","highlight"],Je.OcrHighlightType.Matched),Object(ce.updateIn)(["[]","words","[]","word"],(function(e){return gt({},e,{Top:e.Top+n.y-a.y,Left:e.Left+n.x+a.x})})))(l)));return h&&h.debugVisual&&D.default.ask("PANEL_HIGHLIGHT_OCR_MATCHES",{ocrMatches:d,isDesktop:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))}),(Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))?Object(Ge.getNativeXYAPI)().getScalingFactor():Promise.resolve(1)).then((function(e){return Object(be.compose)(void 0===u["!ocrx"]?be.id:Object(be.safeUpdateIn)(["vars","!ocrx"],(function(t){return t*e})),void 0===u["!ocry"]?be.id:Object(be.safeUpdateIn)(["vars","!ocry"],(function(t){return t*e})),Object(be.safeUpdateIn)(["best"],(function(t){return t&&t.similarity?Object(ze.scaleOcrTextSearchMatch)(t,e):null})))({vars:u,byPass:!0,best:c})}))}));case"OCRExtract":case"OCRExtractRelative":if(g(),!p||!p.length)throw new Error("value is required");var _e=r.get("!ocrLanguage").toLowerCase(),Oe=r.get("!ocrEngine"),ke=r.get("!ocrScale"),Pe=r.get("!ocrTableExtraction"),Ie=E.a.ocr.apiTimeout,Me=/relative/i.test(d);return D.default.ask("PANEL_CLEAR_OCR_MATCHES_ON_PLAYING_PAGE").catch((function(){})).then((function(){return Object(ce.delay)((function(){}),1e3)})).then((function(){return Promise.all([e(gt({},i,{cmd:"visualAssert",target:m,value:"",extra:gt({},i.extra||{},{relativeVisual:Me,debugVisual:!1})})),Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))?Object(Ge.getNativeXYAPI)().getScalingFactor():Promise.resolve(1)])})).then((function(e){var n,a,o=vt(e,2),i=o[0],s=o[1],c=i.best;if(!c)throw new Error("no matched vision found for '"+m+"'");return n=function(){return St({store:t,lang:_e,scale:ke,engine:Oe,isTable:Pe,ocrApiTimeout:Ie,searchArea:"rect",storedImageRect:{x:c.viewportLeft/s,y:c.viewportTop/s,width:c.width/s,height:c.height/s},isDesktop:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))}).then((function(e){var t=e.response,n=e.offset,a=(e.viewportOffset,Object(be.safeUpdateIn)(["[]","TextOverlay","Lines","[]","Words","[]"],(function(e){return gt({},e,{Top:e.Top+n.y,Left:e.Left+n.x})}),t.ParsedResults)),o=[{similarity:1,highlight:Je.OcrHighlightType.Matched,words:Object(ze.allWordsWithPosition)(a,[])}];return h&&h.debugVisual&&D.default.ask("PANEL_HIGHLIGHT_OCR_MATCHES",{ocrMatches:o,isDesktop:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))}),{byPass:!0,vars:wt({},p,t.ParsedResults&&t.ParsedResults[0]?t.ParsedResults[0].ParsedText:"")}}))},a=function(){return D.default.ask("PANEL_SHOW_VISION_HIGHLIGHT").catch((function(){}))},D.default.ask("PANEL_HIDE_VISION_HIGHLIGHT").catch((function(){})).then((function(){return n()})).then((function(e){return a(),e}),(function(e){throw a(),e}))}));case"visualVerify":case"visualAssert":case"visualSearch":case"visionFind":if(!("visualSearch"!==d||p&&p.length))throw new Error(d+": Must specify a variable to save the result");var Ae=Object(ct.parseImageTarget)(m);if(!m)throw new Error("Target should be like 'abc.png@0.8#1'");var De=Ae.imageUrl,Ne=Ae.fileName,Re=Ae.confidence,je=void 0===Re?t.getState().config.defaultVisionSearchConfidence:Re,Le=Ae.index,Fe="number"!=typeof Le||isNaN(Le)?0:Le,Ve=-1===["visualVerify","visualAssert"].indexOf(d),Ue=r.get("!visualSearchArea"),Be=1e3*r.get("!TIMEOUT_WAIT"),Xe=r.get("!CVSCOPE"),Ke=function(){if(!De||!De.length)return Promise.resolve();return(0===De.indexOf("data:")?Promise.resolve(Object(ce.dataURItoBlob)(De)):Object(ce.loadImage)(De)).then((function(e){return Object(pe.getStorageManager)().getVisionStorage().write(Ne,e)})).then((function(){t.dispatch(M.listVisions())}))},qe=Object(ce.retry)((function(){return(Object(ye.isCVTypeForDesktop)(Xe)?Promise.resolve():D.default.ask("PANEL_CLEAR_VISION_RECTS_ON_PLAYING_PAGE")).then(Ke).then((function(){return D.default.ask("PANEL_SEARCH_VISION_ON_PLAYING_PAGE",{visionFileName:Ne,minSimilarity:je,searchArea:Ue,cvScope:Xe,command:i,storedImageRect:r.get("!storedImageRect")})})).then((function(e){var n=e.regions,a=e.imageInfo;$e()("regions",n,a);var o=0===n.length,i=n.length<=Fe;if(o||i){if(r.set({"!imageX":0,"!imageY":0,"!imageWidth":0,"!imageHeight":0},!0),o)throw new Error("Image '"+Ne+"' (conf. = "+je+") not found");if(i)throw new Error("Found "+n.length+" "+(n.length>1?"matches":"match")+", but you are looking for #"+(Fe+1))}Fe===Le?n.sort((function(e,t){var r=Math.sign(e.matched.offsetTop-t.matched.offsetTop),n=Math.sign(e.matched.offsetLeft-t.matched.offsetLeft);return r||n})):n.sort((function(e,t){var r=Math.sign(t.matched.score-e.matched.score),n=Math.sign(e.matched.offsetTop-t.matched.offsetTop),a=Math.sign(e.matched.offsetLeft-t.matched.offsetLeft);return r||n||a}));var s=n[Fe].matched;if(Object(ye.isCVTypeForDesktop)(Xe)){if(h&&h.debugVisual){var c=function(e,t,r){return e?{type:r,index:t,x:e.viewportLeft,y:e.viewportTop,width:e.width,height:e.height,score:e.score}:null};D.default.ask("PANEL_HIGHLIGHT_DESKTOP_RECTS",{imageInfo:a,selectedIndex:Fe,scoredRects:Object(be.flatten)(n.map((function(e,t){return[c(e.reference,t,t===Fe?rt.DesktopScreenshot.RectType.ReferenceOfBestMatch:rt.DesktopScreenshot.RectType.Reference),c(e.matched,t,t===Fe?rt.DesktopScreenshot.RectType.BestMatch:rt.DesktopScreenshot.RectType.Match)].filter((function(e){return e}))})))})}}else(t.getState().config.playHighlightElements||h&&h.debugVisual)&&D.default.ask("PANEL_HIGHLIGHT_RECTS",{selectedIndex:Fe,scoredRects:n.map((function(e){return gt({},e.matched,{left:e.matched.pageLeft,top:e.matched.pageTop})}))});var l=Object(ye.isCVTypeForDesktop)(Xe)?Object(Ge.getNativeXYAPI)().getScalingFactor():Promise.resolve(1),u=s.viewportTop,d=s.viewportLeft;return l.then((function(e){return{byPass:!0,vars:gt({"!imageX":Math.round(e*(d+s.width/2)),"!imageY":Math.round(e*(u+s.height/2)),"!imageWidth":Math.round(e*s.width),"!imageHeight":Math.round(e*s.height)},Ve&&p&&p.length?wt({},p,n.length):{}),best:Object(ce.objMap)((function(t){return t*e}),s)}})).then((function(e){return Object(ce.delay)((function(){return e}),100)}))}))}),{timeout:Be,shouldRetry:function(e){return t.getState().status===A.APP_STATUS.PLAYER&&/Image.*\(conf\. =.*\) not found/.test(e.message)},retryInterval:function(e,t){return.5+.25*e},onFirstFail:function(){D.default.ask("PANEL_TIMEOUT_STATUS",{timeout:Be,type:"Vision waiting"})},onFinal:function(){D.default.ask("PANEL_CLEAR_TIMEOUT_STATUS")}});return function(e,t){return Object(pe.getStorageManager)().getVisionStorage().exists(e).then((function(r){if(!r)throw new Error("Error #120: "+t+": No input image found for file name '"+e+"'")}))}(Ne,d).then((function(){return qe().catch((function(e){if("visualAssert"===d||h&&h.throwError)throw e;return gt({byPass:!0},Ve&&p&&p.length?{vars:wt({},p,0)}:{},"visualVerify"===d?{log:{error:e.message}}:{})}))}));case"visionLimitSearchArea":case"visionLimitSearchAreaRelative":var Ze=/relative/i.test(d),Qe=m.trim(),et=Promise.resolve({byPass:!0}),ot=function(e){var t=e.rect,n=e.isDesktop,a=e.searchArea;return r.set({"!storedImageRect":t},!0),D.default.ask("PANEL_CAPTURE_IMAGE",{isDesktop:n,storedImageRect:t,searchArea:/\.png/i.test(a)?"rect":a,scaleDpi:!0})},it=function(e){switch(r.get("!CVSCOPE")){case ye.ComputerVisionType.Browser:return Promise.resolve(e);case ye.ComputerVisionType.Desktop:case ye.ComputerVisionType.DesktopScreenCapture:return Object(Ge.getNativeXYAPI)().getScalingFactor().then((function(t){return{x:e.x/t,y:e.y/t,width:e.width/t,height:e.height/t}}))}};if(Ze&&!/\.png/i.test(Qe))throw new Error(d+" only accepts a vision image as target");if(/^viewport$/.test(Qe))return r.set({"!visualSearchArea":"viewport"},!0),et;if(/^full$/.test(Qe))return r.set({"!visualSearchArea":"full"},!0),et;if(/^area=/i.test(Qe)){var st=Qe.replace(/^area=/i,"").split(/\s*,\s*/g).map((function(e){return parseFloat(e.trim())}));if(!(4===st.length&&ce.and.apply(void 0,yt(st.map((function(e){return"number"==typeof e&&!isNaN(e)}))))))throw new Error('area should be in format of "area=x1,y1,x2,y2"');var ft={x:st[0],y:st[1],width:st[2]-st[0],height:st[3]-st[1]};return r.set({"!visualSearchArea":"rect"},!0),it(ft).then((function(e){return ot({isDesktop:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE")),searchArea:"rect",rect:e}).then((function(){return{byPass:!0}}))}))}if(/\.png/.test(Qe))return e(gt({},i,{cmd:"visualAssert",target:Qe,value:"",extra:gt({},i.extra||{},{relativeVisual:Ze})})).then((function(e){var t=e.best;if(!t)throw new Error("No match found for "+Qe+" in screenshot");return r.set({"!visualSearchArea":Qe},!0),it({x:t.offsetLeft,y:t.offsetTop,width:t.width,height:t.height}).then((function(e){return ot({rect:e,searchArea:Qe,isDesktop:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))})})).then((function(){return{byPass:!0}}))}));switch(r.get("!CVSCOPE")){case ye.ComputerVisionType.Browser:if(/^element:/.test(Qe))return r.set({"!visualSearchArea":Qe},!0),D.default.ask("PANEL_CLEAR_VISION_RECTS_ON_PLAYING_PAGE").then((function(){return Promise.resolve({byPass:!1})}));throw new Error("Target of visionLimitSearchArea could only be either 'viewport', 'full' or 'element:...'");case ye.ComputerVisionType.Desktop:case ye.ComputerVisionType.DesktopScreenCapture:throw new Error("In desktop mode, target of visionLimitSearchArea could only be a vision image name or area")}break;case"visualGetPixelColor":var bt=/^\s*(\d+)\s*,\s*(\d+)\s*$/;if(!bt.test(m))throw new Error("visualGetPixelColor: target must be a position in this fomrat: 100,200");if(!p||!p.length)throw new Error("visualGetPixelColor: must specify a variable name as value");var Et=Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE")),Tt=m.match(bt),_t=vt(Tt,3),Ot=(_t[0],_t[1]),kt=_t[2],Pt=parseInt(Ot,10),Mt=parseInt(kt,10);return D.default.ask("PANEL_GET_PIXEL_COLOR_IN_SCREENSHOT",{type:r.get("!CVSCOPE"),offset:{x:Pt,y:Mt}}).then((function(e){if(Et){if(h&&h.debugVisual){var t=1/window.devicePixelRatio;D.default.ask("PANEL_HIGHLIGHT_DESKTOP_RECTS",{imageInfo:{source:rt.DesktopScreenshot.ImageSource.Storage,path:Object(ce.ensureExtName)(".png",A.LAST_DESKTOP_SCREENSHOT_FILE_NAME)},selectedIndex:0,scoredRects:[{x:t*(Mt-8),y:t*(Pt-8),width:16*t,height:16*t,text:e,type:rt.DesktopScreenshot.RectType.BestMatch}]})}}else D.default.ask("PANEL_SCREENSHOT_PAGE_INFO").then((function(t){D.default.ask("PANEL_HIGHLIGHT_RECT",{rect:{top:t.originalY+Mt-8,left:t.originalX+Pt-8,width:16,height:16,text:e}})}));return r.set(wt({},p,e)),{byPass:!0}}));case"XRun":case"XRunAndWait":var At=m,Dt=p,Nt=/AndWait/.test(d);return Object(le.getXFile)().sanityCheck().then((function(){return Object(lt.getNativeFileSystemAPI)().runProcess({fileName:At,waitForExit:Nt,arguments:Dt})})).then((function(e){return"XRunAndWait"===d&&(r.set({"!XRUN_EXITCODE":e.exitCode},!0),t.dispatch(M.addLog("info","App close detected, Exit code="+e.exitCode))),{byPass:!0}}));case"XDesktopAutomation":var Rt=Object(be.parseBoolLike)(m,!1);return t.dispatch(M.updateUI({shouldEnableDesktopAutomation:Rt})),r.set({"!CVSCOPE":Rt?"desktop":"browser"},!0),Promise.resolve({byPass:!0});case"bringBrowserToForeground":var jt=void 0;try{jt=""!==m&&void 0!==m&&!Object(be.strictParseBoolLike)(m)}catch(e){throw new Error("Invalid target for bringBrowserToForeground. It should be true / false or leave it blank")}return(jt?D.default.ask("PANEL_MINIMIZE_ALL_WINDOWS_BUT_PANEL"):D.default.ask("PANEL_BRING_PLAYING_WINDOW_TO_FOREGROUND")).then((function(){return{byPass:!0}}));case"bringIDEandBrowserToBackground":return D.default.ask("PANEL_MINIMIZE_ALL_WINDOWS").then((function(){return{byPass:!0}}));case"setWindowSize":case"resize":var Lt=function(){if("resize"===d){if(!/\s*\d+@\d+\s*/.test(m))throw new Error("Syntax for target of resize command is x@y, e.g. 800@600");return m.split("@")}if(!/\s*\d+x\d+\s*/i.test(m))throw new Error("Syntax for target of setWindowSize command is WidthxHeight, e.g. 800x600");return m.split(/x/i)}(),Ft=vt(Lt,2),Vt=Ft[0],Ut=Ft[1],Bt=parseInt(Vt,10),Xt=parseInt(Ut,10);return $e()("resize",Bt,Xt),D.default.ask("PANEL_RESIZE_PLAY_TAB",{width:Bt,height:Xt}).then((function(e){var t=e.actual,r=e.desired;return 0===e.diff.length?{byPass:!0}:{byPass:!0,log:{warning:"Only able to resize it to "+t.width+"@"+t.height+", given "+r.width+"@"+r.height}}}));case"XType":return Object(ue.getXUserIO)().sanityCheck().then((function(){if(1===o.get())return Ct()})).then((function(){return Object(ce.delay)((function(){}),300)})).then((function(){return Object(ht.a)(m)})).then((function(e){return Object(Ge.getNativeXYAPI)().sendText({text:e}).then((function(e){if(!e)throw new Error("Failed to XType '"+m+"'");return{byPass:!0}}))}));case"XMouseWheel":var Kt=parseFloat(m);if(isNaN(Kt))throw new Error("Target of XMouseWheel must be a number");return Object(ue.getXUserIO)().sanityCheck().then((function(){if(1===o.get())return Ct()})).then((function(){return Object(Ge.getNativeXYAPI)().sendMouseWheelEvent({deltaX:Kt,deltaY:0,deltaZ:0}).then((function(e){if(!e)throw new Error("Failed to XMouseWheel '"+m+"'");return{byPass:!0}}))}));case"XMove":case"XMoveRelative":case"XClickRelative":case"XClick":var $t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.trim().toLowerCase();switch(t){case"":return"#left";case"#left":case"#middle":case"#right":case"#doubleclick":case"#tripleclick":case"#shiftclick":case"#ctrlclick":return t;default:throw new Error("XClick: invalid value, '"+e+"'")}},Yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.trim().toLowerCase();switch(t){case"":return"#move";case"#move":case"#up":case"#down":return t;default:throw new Error("XMove: invalid value, '"+e+"'")}},Wt={XClick:$t,XClickRelative:$t,XMove:Yt,XMoveRelative:Yt}[d],Gt=/relative/i.test(d);return Object(ue.getXUserIO)().sanityCheck().then((function(){if(1===o.get())return Ct()})).then((function(){var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.trim(),n=Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"));if(/^ocr=/i.test(t))return g(),{type:"ocr",value:{query:t.substr(4)}};if(Object(We.c)(t)){if(n)throw new Error("Locator is not support in desktop mode");return{type:"locator",value:{locator:t}}}if(/^[dD](\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?)$/.test(t))return{type:"desktop_coordinates",value:{coordinates:t.substr(1).split(/\s*,\s*/)}};if(/^(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?)$/.test(t))return{type:n?"desktop_coordinates":"viewport_coordinates",value:{coordinates:t.split(/\s*,\s*/)}};if(/^.*\.png(@\d\.\d+)?(#\d+)?(\[[^\]]+\])?$/.test(t))return{type:"visual_search",value:{query:t}};throw new Error("XClick: invalid target, '"+e+"'")}(m),o=Wt(p);return function(){if(Gt&&"visual_search"!==a.type)throw new Error(d+" only accepts a vision image as target");switch(a.type){case"locator":return function(e){return It({vars:r,store:t,command:e,state:n().getState(),preRun:function(e,t,r){return r(e)}})}(gt({},i,{cmd:"locate",target:a.value.locator,value:""})).then((function(e){var t=e.rect;if(!t)throw new Error("no rect data returned");var r=t.x+t.width/2,n=t.y+t.height/2;if(isNaN(r))throw new Error("empty x");if(isNaN(n))throw new Error("empty y");return{type:"viewport",offset:{x:r,y:n}}}));case"visual_search":return e(gt({},i,{cmd:"visualAssert",target:a.value.query,value:"",extra:gt({},i.extra||{},{relativeVisual:Gt})})).then((function(e){var t=e.best;if(!t)throw new Error("no best found from result of verifyAssert triggered by XClick");var n=Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE")),a=t.viewportLeft+t.width/2,o=t.viewportTop+t.height/2;if(isNaN(a))throw new Error("empty x");if(isNaN(o))throw new Error("empty y");return{type:n?"desktop":"viewport",offset:{x:a,y:o},originalResult:e}}));case"ocr":return e(gt({},i,{cmd:"OCRSearch",target:a.value.query,value:"__ocrResult__"})).then((function(e){var t=e.best;if(!t)throw new Error("no match found for '"+m+"'");return{type:Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))?"desktop":"viewport",offset:Object(ze.ocrMatchCenter)(t),originalResult:e}}));case"desktop_coordinates":var o=a.value.coordinates;return Promise.resolve({type:"desktop",offset:{x:parseFloat(o[0]),y:parseFloat(o[1])}});case"viewport_coordinates":var s=a.value.coordinates;return Promise.resolve({type:"viewport",offset:{x:parseFloat(s[0]),y:parseFloat(s[1])}})}}().then((function(t){var n=t.type,a=t.offset,i=t.originalResult,s=void 0===i?{}:i;return(Object(ye.isCVTypeForDesktop)(r.get("!CVSCOPE"))?Promise.resolve():e({cmd:"bringBrowserToForeground"})).then((function(){return Object(ce.delay)((function(){}),300)})).then((function(){var e=Object(Ge.getNativeXYAPI)(),t=function(){switch(o){case"#left":return[Ge.MouseButton.Left,Ge.MouseEventType.Click];case"#middle":return[Ge.MouseButton.Middle,Ge.MouseEventType.Click];case"#right":return[Ge.MouseButton.Right,Ge.MouseEventType.Click];case"#doubleclick":return[Ge.MouseButton.Left,Ge.MouseEventType.DoubleClick];case"#tripleclick":return[Ge.MouseButton.Left,Ge.MouseEventType.TripleClick];case"#shiftclick":return[Ge.MouseButton.Left,Ge.MouseEventType.ShiftClick];case"#ctrlclick":return[Ge.MouseButton.Left,Ge.MouseEventType.CtrlClick];case"#move":return[Ge.MouseButton.Left,Ge.MouseEventType.Move];case"#up":return[Ge.MouseButton.Left,Ge.MouseEventType.Up];case"#down":return[Ge.MouseButton.Left,Ge.MouseEventType.Down];default:throw new Error("Unsupported realValue: "+o)}}(),r=vt(t,2),i=r[0],c=r[1],l={button:i,x:a.x,y:a.y,type:c};return("desktop"===n?e.sendMouseEvent(l):e.sendViewportMouseEvent(l,{getViewportRectInScreen:function(){return D.default.ask("PANEL_GET_VIEWPORT_RECT_IN_SCREEN")}})).then((function(e){if(!e)throw new Error("E201: Failed to "+d+" "+n+" coordinates at ["+a.x+", "+a.y+"]");return gt({},s,{byPass:!0})}))}))}))}));case"captureDesktopScreenshot":var Ht=Object(He.getNativeCVAPI)(),zt=m&&m.trim(),qt=zt&&zt.length>0?Object(ce.ensureExtName)(".png",zt):void 0,Jt=qt&&function(e){return!/[\\/]/.test(e)}(qt)?function(e){return Ht.readFileAsBlob(e).then((function(e){return Object(pe.getStorageManager)().getScreenshotStorage().overwrite(zt,e).then((function(){t.dispatch(M.listScreenshots()),t.dispatch(M.addLog("info","desktop screenshot saved to screenshot storage with file name '"+zt+"'"))}))}))}:function(e){t.dispatch(M.addLog("info","desktop screenshot saved to hard drive at '"+e+"'"))};return Ht.captureDesktop().then(Jt).then((function(){return{byPass:!0}}));default:return}}},kt=function(e){var t=e.store,r=e.vars;return function(e,n){var a=Object(pe.getStorageManager)().getCSVStorage(),o=e.cmd,i=e.target,s=e.value,c=function(e){return a.exists(e).then((function(t){if(!t){r.set({"!CsvReadStatus":"FILE_NOT_FOUND"},!0);var n="csv file '"+e+"' does not exist";throw Object(pe.getStorageManager)().isBrowserMode()&&(x.posix.isAbsolute(e)||x.win32.isAbsolute(e))&&(n+=". Full path works only in hard-drive mode."),new Error(n)}}))};switch(o){case"csvRead":return s&&s.length>0&&t.dispatch(M.addLog("warning","csvRead: Value field should be empty (not used)")),c(i).then((function(){return a.read(i,"Text").then(Be).then((function(e){var t=r.get("!CsvReadLineNumber")-1,n=e[t];if(t>=e.length)throw r.set({"!CsvReadStatus":"END_OF_FILE"},!0),new Error("end of csv file reached");return r.set({"!CsvReadStatus":"OK","!CsvReadMaxRow":e.length},!0),r.clear(/^!COL\d+$/i),n.forEach((function(e,t){r.set(wt({},"!COL"+(t+1),e))})),{isFlowLogic:!0}}))}));case"csvSave":var l=r.get("!CSVLINE");if(!l||!l.length)throw new Error("No data to save to csv");return Xe([l]).then((function(e){var t=/\.csv$/i.test(i)?i:i+".csv";return a.exists(t).then((function(r){return r?a.read(t,"Text").then((function(r){var n=(r+"\n"+e).replace(/\n+/g,"\n");return a.overwrite(t,new Blob([n]))})):a.write(t,new Blob([e]))}))})).then((function(){r.clear(/^!CSVLINE$/),t.dispatch(M.listCSV())})).then((function(){return{isFlowLogic:!0}}));case"csvReadArray":if(!s||!s.length)throw new Error("Please provide variable name as value");return c(i).then((function(){return a.read(i,"Text").then(Be).then((function(e){return r.set({"!CsvReadStatus":!0,"!CsvReadMaxRow":e.length},!0),{byPass:!0,vars:wt({},s,e)}}),(function(e){return r.set({"!CsvReadStatus":!1},!0),Promise.reject(e)}))}));case"csvSaveArray":if(!s||!s.length)throw new Error("Please provide csv file name as value");if(!i||!i.length)throw new Error("Please provide array variable name as target");var u=r.get(i);if(!u)throw new Error("No variable found with name '"+i+"'");if(!(Array.isArray(u)&&Array.from(u).every((function(e){return Array.isArray(e)}))))throw new Error("Array must be two dimensional array");return Xe(u).then((function(e){var t=/\.csv$/i.test(s)?s:s+".csv";return a.overwrite(t,new Blob([e]))})).then((function(){t.dispatch(M.listCSV())})).then((function(){return{isFlowLogic:!0}}));default:return}}},Pt=function(e){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=function(e){return-1!==["TRUE","FALSE"].indexOf((e+"").toUpperCase())},a=Ee({isInvalidInternalVar:function(e){return 0===e.indexOf("!")&&"!TIMEOUT_PAGELOAD"!==e&&"!TIMEOUT_WAIT"!==e&&"!TIMEOUT_MACRO"!==e&&"!TIMEOUT_DOWNLOAD"!==e&&"!TIMEOUT_DOWNLOAD_START"!==e&&"!REPLAYSPEED"!==e&&"!LOOP"!==e&&"!TESTSUITE_LOOP"!==e&&"!URL"!==e&&"!MACRONAME"!==e&&"!RUNTIME"!==e&&"!CSVLINE"!==e&&"!CSVLINE"!==e&&"!LASTCOMMANDOK"!==e&&"!ERRORIGNORE"!==e&&"!CSVREADLINENUMBER"!==e&&"!CSVREADSTATUS"!==e&&"!CSVREADMAXROW"!==e&&"!CLIPBOARD"!==e&&"!STATUSOK"!==e&&"!WAITFORVISIBLE"!==e&&"!IMAGEX"!==e&&"!IMAGEY"!==e&&"!IMAGEWIDTH"!==e&&"!IMAGEHEIGHT"!==e&&"!VISUALSEARCHAREA"!==e&&"!STOREDIMAGERECT"!==e&&"!STRINGESCAPE"!==e&&"!CMD_VAR1"!==e&&"!CMD_VAR2"!==e&&"!CMD_VAR3"!==e&&"!OCRLANGUAGE"!==e&&"!OCRENGINE"!==e&&"!OCRSCALE"!==e&&"!OCRTABLEEXTRACTION"!==e&&"!OCRX"!==e&&"!OCRY"!==e&&"!BROWSER"!==e&&"!OS"!==e&&"!TIMES"!==e&&"!FOREACH"!==e&&"!CVSCOPE"!==e&&"!XRUN_EXITCODE"!==e&&"!PROXY_EXEC_COUNT"!==e&&"!GLOBAL_TESTSUITE_STOP_ON_ERROR"!==e&&"!LAST_DOWNLOADED_FILE_NAME"!==e&&!/^!COL\d+$/i.test(e)},readonly:["!LOOP","TESTSUITE_LOOP","!URL","!MACRONAME","!RUNTIME","!LASTCOMMANDOK","!CSVREADSTATUS","!CSVREADMAXROW","!VISUALSEARCHAREA","!BROWSER","!OS","!CVSCOPE","!XRUN_EXITCODE","!PROXY_EXEC_COUNT","!TIMES","!FOREACH","!LAST_DOWNLOADED_FILE_NAME"].concat(xe(Se)),typeCheck:{"!REPLAYSPEED":function(e){return-1!==["SLOW","MEDIUM","FAST","NODISPLAY"].indexOf((e||"").toUpperCase())},"!TIMEOUT_PAGELOAD":function(e){return parseInt(e,10)>=0},"!TIMEOUT_WAIT":function(e){return parseInt(e,10)>=0},"!TIMEOUT_MACRO":function(e){return parseInt(e,10)>=0},"!TIMEOUT_DOWNLOAD":function(e){return parseInt(e,10)>=0},"!TIMEOUT_DOWNLOAD_START":function(e){return parseInt(e,10)>=0},"!CSVREADLINENUMBER":function(e){return parseInt(e,10)>=0},"!OCRLANGUAGE":function(e){return Object(ge.isValidOCRLanguage)(e)},"!OCRENGINE":function(e){return-1!==[1,2].indexOf(parseInt(e,10))},"!OCRSCALE":n,"!OCRX":function(e){return parseInt(e,10)>=0},"!OCRY":function(e){return parseInt(e,10)>=0},"!ERRORIGNORE":n,"!STATUSOK":n,"!WAITFORVISIBLE":n,"!STRINGESCAPE":n,"!GLOBAL_TESTSUITE_STOP_ON_ERROR":n,"!CVSCOPE":function(e){return-1!==[ye.ComputerVisionType.Browser,ye.ComputerVisionType.Desktop,ye.ComputerVisionType.DesktopScreenCapture].indexOf(e)}},normalize:function(e,t){switch(e.toUpperCase()){case"!ERRORIGNORE":case"!STATUSOK":case"!WAITFORVISIBLE":case"!STRINGESCAPE":case"!GLOBAL_TESTSUITE_STOP_ON_ERROR":case"!OCRSCALE":case"!OCRTABLEEXTRACTION":return function(e){return"true"===e||"false"!==e&&e}(t);case"!TIMEOUT_PAGELOAD":case"!TIMEOUT_WAIT":case"!TIMEOUT_MACRO":case"!TIMEOUT_DOWNLOAD":case"!TIMEOUT_DOWNLOAD_START":case"!OCRENGINE":return parseFloat(t);default:return t}}},t),o=r,i=new ve.Registry({process:function(e,t,r){return e(t)}}),s=function(){return i.fire("change",{vars:Ee({},o)})},c={reset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.keepGlobal){var t=Object.keys(o).reduce((function(e,t){return(/^!?global/i.test(t)||/^!TESTSUITE_LOOP$/i.test(t))&&(e[t]=o[t]),e}),{});o=t}else o={};s()},render:function(e,t){var r=t&&t.withHashNotation?[ke,3,4]:[Oe,2,3],n=we(r,3),a=n[0],o=n[1],i=n[2],s=t&&t.shouldStringify?function(e){return JSON.stringify(e)}:be.id;return c.replaceAllVars({str:e,reg:a,decorate:s,getVarName:function(e){return e[o]},getSubstring:function(e){return e[i]}})},replaceAllVars:function(e){var t=e.str,r=e.reg,n=e.getVarName,a=void 0===n?function(e){return e[1]}:n,o=e.getSubstring,i=void 0===o?function(e){return e[2]}:o,s=e.decorate,l=void 0===s?function(e){return e}:s;return t.replace(r,(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=(a(t)||"").toUpperCase(),o=Pe(i(t)).map((function(e){return c.render(e)}));if(Ce(n))return t[0];var s=c.getVarForRender(n),u=o.reduce((function(e,t,r){if(null==e)throw new Error(""+n+Ie(o.slice(0,r))+" is "+e);return e[t]}),s);return l(u,t)}))},getVarForRender:function(e){var t=(e||"").toUpperCase();if(t in o)return o[t];if(/^!cmd_var(1|2|3)$/i.test(t))return"NOT_SET";throw/^!/.test(t)?new Error('Internal variable "'+t+'" not supported'):new Error('variable "'+t+'" is not defined')},get:function(e){return o[e.toUpperCase()]},set:function(e,t){Object.keys(e).forEach((function(r){var n=r.trim();if(0!==n.length){_e(n);var i=n.toUpperCase();if(0!==i.length){if(/^!CSVLINE$/i.test(i)){var s=c.get("!CSVLINE");return void 0===s?s=[]:Array.isArray(s)||(s=[s]),s.push(e[r]),void(o["!CSVLINE"]=s)}if(!t&&-1!==a.readonly.indexOf(i))throw new Error("Cannot write to readonly variable '"+r+"'");if(a.isInvalidInternalVar(i))throw new Error("Not allowed to write to '"+r+"'");if(a.typeCheck[i]&&!a.typeCheck[i](e[r]))throw new Error("Value '"+e[r]+"' is not supported for variable \""+i+'"');o[i]=a.normalize(r,e[r])}}})),s()},clear:function(e){Object.keys(o).forEach((function(t){e.test(t)&&delete o[t]})),s()},isReadOnly:function(e){var t=e&&e.toUpperCase?e.toUpperCase():"";return-1!==a.readonly.indexOf(t)},dump:function(){return Ee({},o)},onChange:function(e){return i.add("change",e),function(){return i.remove("change",e)}}};return Te[e]=c,c}("main",{},{"!TESTSUITE_LOOP":1}),r=Object(nt.createMacroCallStack)({getCurrentMacroRunningStatus:function(){var t=s.getState(),r=e.getState();return{playerState:t,commandResults:Object(at.getCommandResults)({count:t.resources.length,doneIndices:Object(oe.getDoneCommandIndices)(r),errorIndices:Object(oe.getErrorCommandIndices)(r),warningIndices:Object(oe.getWarningCommandIndices)(r)}),status:at.MacroStatus.Running,nextIndex:t.nextIndex,interpreterState:i.backupState()}},updateSelectedMacro:function(t,r){return e.dispatch(M.editTestCase(t.id))},restorePlayerState:function(t,r){var n=r.playerState,a=r.interpreterState,o=void 0===a?Object(be.clone)(Fe.DefaultState):a;s.setState(n),e.dispatch(M.setPlayerState({nextCommandIndex:n.nextIndex})),i.restoreState(o)},playMacro:function(e,t,r){var n,o,i=r.isBottom,c=r.isResume,l=r.frameId,u=gt({},t.playerState);return u.noEndEvent=!i,u.extra=gt({},u.extra||{},{frameId:l,macroId:e.id,isBottomFrame:i,isBackFromCalling:c}),n=function(){return a.get()>0},o=function(){if(c)return s.setState(u),s.__setNext(t.nextIndex),s.play(s.getState());var e=ce.and.apply(void 0,yt(u.resources.map((function(e){return Object(ct.isExtensionResourceOnlyCommand)(e.cmd)})))),r=gt({},u,{needDelayAfterLoop:e});return s.play(r)},Promise.resolve(o()).then((function(e){return n()?Tt().then((function(){return e})):e}),(function(e){return n()?Tt().then((function(){return Promise.reject(e)})):Promise.reject(e)}))}}),n=Object(Qe.getOcrCommandCounter)({initial:0,getMax:function(){return Object(ft.getLicenseService)().getMaxOcrCalls()},onMax:function(e,t,r){throw new Error("OCR conversion limit reached")}}),a=new Ze.Counter({initial:0,getMax:function(){return Object(ft.getLicenseService)().getMaxXCommandCalls()},onMax:function(e,t,r){throw new Error("XClick/XMove/XType "+t+" commands limit reached")}}),o=new Ze.Counter({initial:0,getMax:function(){return Object(ft.getLicenseService)().getMaxProxyCalls()},onMax:function(e,t,r){throw new Error("PROXY "+t+" commands limit reached")}}),i=new Fe({run:_t({vars:t,store:e,xCmdCounter:a,getTcPlayer:function(){return s},getInterpreter:function(){return i}})}),s=At({store:e,vars:t,interpreter:i,xCmdCounter:a,ocrCmdCounter:n,proxyCounter:o});Dt({store:e,vars:t,tcPlayer:s,xCmdCounter:a,ocrCmdCounter:n,proxyCounter:o});!function(e){e.store;var t=e.vars;Object(it.getMacroMonitor)((function(e,r,n,a){switch(e){case it.MacroParamsProviderType.Constructor:switch(r){case st.MacroInspector.Countdown:return[function(){Object(ae.b)().stopWithError(new Error("macro '"+Object(nt.getMacroCallStack)().peek().resource.name+"' timeout "+t.get("!TIMEOUT_MACRO")+"s (change the value in the settings if needed)"))}];case st.MacroInspector.Timer:case st.MacroInspector.LoopTimer:default:return[]}case it.MacroParamsProviderType.Restart:switch(r){case st.MacroInspector.Countdown:return[1e3*t.get("!TIMEOUT_MACRO"),!0];case st.MacroInspector.Timer:case st.MacroInspector.LoopTimer:default:return[]}}}))}({vars:t,store:e}),r.on(ot.CallStackEvent.BeforeRun,(function(t){var r=t[t.length-1].name,n=t.slice(0,-1).map((function(e){return"'"+e.name+"'"}));n.length>0&&e.dispatch(M.addLog("status","Running '"+r+"', called by "+n.join(" > ")))})),r.on(ot.CallStackEvent.AfterReturn,(function(t){var r=t[t.length-1],n=r.name,a=r.frameId,o=t.slice(0,-1).map((function(e){return"'"+e.name+"'"}));Object(it.getMacroMonitor)().removeTarget(a),o.length>0&&e.dispatch(M.addLog("status","Finished running '"+n+"', returning to "+o.join(" > ")))})),D.default.onAsk((function(e,r){switch(e){case"DOWNLOAD_COMPLETE":var n=r?x.default.basename(r.filename):null;return!!n&&(t.set({"!LAST_DOWNLOADED_FILE_NAME":n},!0),!0)}}))},It=function(e){var t=e.command,r=e.state,n=e.store,a=e.vars,o=e.preRun,i=/!clipboard/i.test(t.target+";"+t.value)?D.default.ask("GET_CLIPBOARD").then((function(e){return{useClipboard:!0,clipboard:e}})):Promise.resolve({useClipboard:!1});if(fe.a.isFirefox())switch(t.cmd){case"onDownload":n.dispatch(M.addLog("warning","onDownload - changing file names not supported by Firefox extension api yet"))}switch(t.cmd){case"XType":if(t.value&&t.value.length>0)throw new Error('XType currently doesn\'t use the "Value" field')}return i.then((function(e){var n=e.useClipboard,i=e.clipboard,s=void 0===i?"":i;n&&a.set({"!CLIPBOARD":s}),r.extra.isBottomFrame&&a.set({"!LOOP":r.loopsCursor},!0),a.set({"!RUNTIME":Object(be.milliSecondsToStringInSecond)(Object(it.getMacroMonitor)().getDataFromInspector(Object(nt.getMacroCallStack)().bottom().id,st.MacroInspector.LoopTimer))},!0),"open"===t.cmd&&(t=gt({},t,{href:r.startUrl})),t.target&&/^#efp$/i.test(t.target.trim())&&(t.target="#elementfrompoint (${!imageX}, ${!imageY})");var c=-1!==["executeScript","executeScript_Sandbox","executeAsyncScript","executeAsyncScript_Sandbox","if_v2","while_v2","gotoIf_v2","elseif","repeatIf"].indexOf(t.cmd);return"comment"!==t.cmd&&["target","value"].forEach((function(e){if(void 0!==t[e]){var r="storeEval"===t.cmd&&"target"===e||"gotoIf"===t.cmd&&"target"===e||"if"===t.cmd&&"target"===e||"while"===t.cmd&&"target"===e,n=r?{withHashNotation:!0}:{};n.shouldStringify=r||c,t=gt({},t,wt({},e,a.render(function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return n?-1!==["csvRead","csvReadArray","csvSave","gotoIf","if","while","gotoIf_v2","if_v2","while_v2","XType","elseif","repeatIf","executeScript","executeScript_Sandbox","executeAsyncScript","executeAsyncScript_Sandbox"].indexOf(t.cmd)&&"target"===r||-1!==["csvSaveArray"].indexOf(t.cmd)&&"value"===r||-1!==["XRun","XRunAndWait"].indexOf(t.cmd)?e:[[/\\n/g,"\n"],[/\\t/g,"\t"],[/\\b/g,"\b"],[/\\f/g,"\f"],[/\\t/g,"\t"],[/\\v/g,"\v"]].reduce((function(e,t){var r=vt(t,2),n=r[0],a=r[1];return e.replace(n,a)}),e):e}("type"===t.cmd?t[e]:t[e].trim(),t,e,a.get("!StringEscape")),n)))}})),t=Object(ce.updateIn)(["extra"],(function(e){return gt({},e||{},{timeoutPageLoad:a.get("!TIMEOUT_PAGELOAD"),timeoutElement:a.get("!TIMEOUT_WAIT"),timeoutDownload:a.get("!TIMEOUT_DOWNLOAD"),timeoutDownloadStart:a.get("!TIMEOUT_DOWNLOAD_START")||Math.max(10,a.get("!TIMEOUT_WAIT")),lastCommandOk:a.get("!LASTCOMMANDOK"),errorIgnore:!!a.get("!ERRORIGNORE"),waitForVisible:!!a.get("!WAITFORVISIBLE")})}),t),o(t,r,(function(e){var t="pause"===e.cmd?-1:null;return function(e,t){var r="open"===t.cmd,n=/^\s*tab=open\s*$/i.test(t.target),a=r||n;return Object(ce.retry)((function(){var t=function(){(new Date).getTime();var e=!1,t=null,r=function r(){return a?new Promise((function(){})):($e()("start to send heart beat to background"),e?Promise.resolve():D.default.ask("PANEL_HEART_BEAT",{},300).then((function(e){if(-1===e)return new Promise((function(){}));if(e===t)throw new Error("lost background heart beat when running command");return t=e,Object(ce.delay)((function(){}),3e3).then(r)}),(function(e){throw $e.a.error("lost background heart beart!!",e.stack),new Error("lost background heart beat when running command")})))};return r.stop=function(){$e()("stopping background heart beat"),e=!0},r}();return Promise.race([e().then((function(e){return t.stop(),e})).catch((function(e){throw t.stop(),e})),t()])}),{timeout:999999,shouldRetry:function(e,t){return e&&e.message&&-1!==e.message.indexOf("lost background heart beat when running command")&&t<10},retryInterval:function(e,t){return Math.max(5e3,Math.min(2e4,1.2*t))}})()}((function(){return D.default.ask("PANEL_RUN_COMMAND",{command:e,playUID:r.playUID},t)}),e)}))}))};function Mt(e){return/player: paused or stopped/.test(e)}var At=function(e){var t=e.store,r=e.vars,n=e.interpreter,o=e.xCmdCounter,i=(e.ocrCmdCounter,e.proxyCounter),s=null,c=Object(ae.b)({prepare:function(e){var a;return e.extra.isBottomFrame&&!e.extra.isBackFromCalling&&(r.reset({keepGlobal:!0}),r.set(e.public.scope||{},!0),r.set({"!StatusOK":!0,"!WaitForVisible":!1,"!StringEscape":!0,"!IMAGEX":0,"!IMAGEY":0,"!OCRX":0,"!OCRY":0,"!OCRENGINE":t.getState().config.ocrEngine,"!BROWSER":fe.a.isFirefox()?"firefox":"chrome","!OS":(a=window.navigator.userAgent,/windows/i.test(a)?"windows":/mac/i.test(a)?"mac":"linux")},!0)),e.extra.isBackFromCalling||(n.reset(),n.preprocess(e.resources)),D.default.ask("PANEL_START_PLAYING",{url:e.startUrl,shouldNotActivateTab:!0})},run:function(e,a){return It({command:e,state:a,store:t,vars:r,preRun:function(e,t,r){return new Promise((function(a,c){/^(XType|XClick|XMove|XClickRelative|XMoveRelative|XMouseWheel)$/i.test(e.cmd)&&o.inc(),"setProxy"===e.cmd&&i.inc(),n.run(e,t.nextIndex).then((function(t){var n=t.byPass,a=t.isFlowLogic,o=t.nextIndex;t.resetVars;return"onError"===e.cmd&&(s=e),n?Promise.resolve(t):a?Promise.resolve({nextIndex:o}):r(e)})).then(a,c)}))}}).catch((function(e){if(r.get("!ERRORIGNORE"))return{log:{error:e.message}};if(s){var o=s.value&&s.value.trim(),i=s.target&&s.target.trim();if(/^#restart$/i.test(i))throw t.dispatch(M.addLog("status","onError - about to restart")),e.restart=!0,e;if(/^#goto$/i.test(i))return t.dispatch(M.addLog("status","onError - about to goto label '"+o+"'")),Promise.resolve({log:{error:e.message},nextIndex:n.commandIndexByLabel(o)})}var c=Mt(e.message);if(a.mode===ae.a.C.MODE.LOOP&&a.loopsCursor<a.loopsEnd&&"continue_next_loop"===t.getState().config.onErrorInLoop)return c?{nextIndex:a.resources.length}:{log:{error:e.message},nextIndex:a.resources.length};throw r.set({"!LastCommandOK":!1,"!StatusOK":!1},!0),e}))},handleResult:function(e,a,o){var i=[];if(e&&e.pageUrl&&r.set({"!URL":e.pageUrl},!0),e&&e.vars){var s=Object(ce.objMap)((function(e){if(!e||!e.__undefined__)return e}),e.vars);$e()("set vars",s);try{r.set(s);var l=Object.keys(e.vars).find((function(e){return/!clipboard/i.test(e)}));if(l&&i.push(D.default.ask("SET_CLIPBOARD",{value:e.vars[l]})),Object.keys(e.vars).find((function(e){return/!timeout_macro/i.test(e)}))){var u=Object(nt.getMacroCallStack)().peek().id;Object(it.getMacroMonitor)().restartInspector(u,st.MacroInspector.Countdown)}}catch(e){return Promise.reject(e)}}var d=!1;if(e&&e.log&&(e.log.info&&(t.dispatch(M.addLog("echo",e.log.info,e.log.options)),e.log.options&&e.log.options.notification&&D.default.ask("PANEL_NOTIFY_ECHO",{text:e.log.info})),e.log.warning&&t.dispatch(M.addLog("warning",e.log.warning,e.log.options)),e.log.error&&!Mt(e.log.error)&&(t.dispatch(M.addPlayerWarningCommandIndex(o.nextIndex)),t.dispatch(M.addLog("error",e.log.error,{ignored:!0})),d=!0)),"echo"!==a.cmd&&r.set({"!LastCommandOK":!d},!0),d&&r.set({"!StatusOK":!1},!0),e&&e.screenshot&&(t.dispatch(M.addLog("info","a new screenshot captured")),Object(pe.getStorageManager)().getScreenshotStorage().getLink(e.screenshot.name).then((function(t){return gt({},e.screenshot,{url:t})})).then((function(e){t.dispatch(M.listScreenshots())})).catch((function(e){$e.a.error("screenshot obj error 1",e),$e.a.error("screenshot obj error stack",e.stack)}))),e&&e.control)switch(e.control.type){case"pause":return D.default.ask("PANEL_NOTIFY_AUTO_PAUSE",{}),Object(ae.b)({name:"testCase"}).pause();default:throw new Error("Control type '"+e.control.type+"' not supported yet")}if(/^(fast|medium|slow|nodisplay)$/i.test(r.get("!REPLAYSPEED"))){var m=r.get("!REPLAYSPEED").toUpperCase();c.setPostDelay({NODISPLAY:1,FAST:1,MEDIUM:300,SLOW:2e3}[m])}return Object.keys(e.vars||{}).find((function(e){return"!REPLAYSPEED"===e.toUpperCase()}))&&t.dispatch(se.Actions.setNoDisplayInPlay(/^nodisplay$/i.test(r.get("!REPLAYSPEED")))),e&&void 0!==e.nextIndex?Promise.all(i).then((function(){return e.nextIndex})):Promise.all(i).then((function(){return n.postRun(a,o.nextIndex,e)})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.nextIndex}))}},{preDelay:0});return c.on("BREAKPOINT",(function(){D.default.ask("PANEL_NOTIFY_BREAKPOINT",{})})),c.on("LOOP_START",(function(e){var t=e.loopsCursor,n=e.extra;n.isBottomFrame&&r.set({"!CsvReadLineNumber":t,"!visualSearchArea":"viewport","!StatusOK":!0},!0);var a=n.frameId;Object(it.getMacroMonitor)().restartInspector(a,st.MacroInspector.LoopTimer),Object(it.getMacroMonitor)().restartInspector(a,st.MacroInspector.Countdown),n.isBottomFrame&&(s=null)})),c.on("LOOP_RESTART",(function(e){var r=e.currentLoop;e.loopsCursor;D.default.ask("PANEL_STOP_PLAYING",{}),D.default.ask("PANEL_START_PLAYING",{shouldNotActivateTab:!0}),t.dispatch(M.addLog("status","Current loop: "+r))})),c.on("START",(function(e){var r=e.title,n=e.extra;e.loopsCursor;$e()("START"),t.getState().player.mode===A.PLAYER_MODE.TEST_CASE&&n.isBottomFrame&&!n.isBackFromCalling&&(o.reset(),i.reset()),t.dispatch(M.startPlaying()),t.dispatch(M.setPlayerState({status:A.PLAYER_STATUS.PLAYING,nextCommandIndex:null})),n.isBackFromCalling||t.dispatch(M.updateMacroExtra(Object(oe.getCurrentMacroId)(t.getState()),{doneCommandIndices:[],errorCommandIndices:[],warningCommandIndices:[]})),t.dispatch(M.addLog("status","Playing macro "+r))})),c.on("PREPARED",(function(e){var t=e.extra;if(!t.isBackFromCalling){var r=t.frameId;Object(it.getMacroMonitor)().addTarget(r)}})),c.on("PAUSED",(function(){$e()("PAUSED"),t.dispatch(M.setPlayerState({status:A.PLAYER_STATUS.PAUSED})),t.dispatch(M.addLog("status","Macro paused")),Object(it.getMacroMonitor)().pause()})),c.on("RESUMED",(function(){$e()("RESUMED"),t.dispatch(M.setPlayerState({status:A.PLAYER_STATUS.PLAYING})),t.dispatch(M.addLog("status","Macro resumed")),Object(it.getMacroMonitor)().resume()})),c.on("END",(function(e){var n;$e()("END",e),D.default.ask("PANEL_STOP_PLAYING",{}),t.dispatch(M.stopPlaying());var o=t.getState(),i=null!==o.player.nextCommandIndex?{lastNextCommandIndex:o.player.nextCommandIndex}:{};t.dispatch(M.setPlayerState(gt({status:A.PLAYER_STATUS.STOPPED,stopReason:e.reason,nextCommandIndex:null,timeoutStatus:null},i))),r.get("!PROXY_EXEC_COUNT")>0&&t.getState().config.turnOffProxyAfterReplay&&(xt(null),t.dispatch(M.addLog("info","Proxy reset to none")));var s=e.extra&&e.extra.id;switch(e.reason){case c.C.END_REASON.COMPLETE:s&&t.dispatch(M.updateMacroPlayStatus(s,mt.MacroResultStatus.Success)),a.a.success("Macro completed running",1.5);break;case c.C.END_REASON.ERROR:var l=Object(nt.getMacroCallStack)().toArray(),u=l.length;l.forEach((function(e,r){var n=r===u-1?mt.MacroResultStatus.Error:mt.MacroResultStatus.ErrorInSub;t.dispatch(M.updateMacroPlayStatus(e.resource.id,n))})),a.a.error("Macro encountered some error",1.5)}var d=(wt(n={},c.C.END_REASON.COMPLETE,"Macro completed"),wt(n,c.C.END_REASON.ERROR,"Macro failed"),wt(n,c.C.END_REASON.MANUAL,"Macro was stopped manually"),n),m=e.extra.frameId,p=Object(it.getMacroMonitor)().getDataFromInspector(m,st.MacroInspector.Timer);t.dispatch(M.addLog("info",d[e.reason]+" (Runtime "+Object(be.milliSecondsToStringInSecond)(p)+")")),Object(it.getMacroMonitor)().stopInspector(m,st.MacroInspector.Timer),Object(it.getMacroMonitor)().stopInspector(m,st.MacroInspector.LoopTimer),Object(it.getMacroMonitor)().stopInspector(m,st.MacroInspector.Countdown),e.reason!==c.C.END_REASON.COMPLETE&&e.reason!==c.C.END_REASON.ERROR||D.default.ask("PANEL_UPDATE_BADGE",gt({type:"play",blink:5e3,text:e.reason===c.C.END_REASON.COMPLETE?"done":"err"},e.reason===c.C.END_REASON.COMPLETE?{}:{color:"orange"})),t.getState().player.mode!==A.PLAYER_MODE.TEST_SUITE&&t.dispatch(M.updateUI({shouldEnableDesktopAutomation:void 0}))})),c.on("TO_PLAY",(function(e){var r=e.index,n=e.currentLoop,a=e.loops,o=e.resource,i=e.extra;$e()("TO_PLAY",r,o,"currentLoop",n),t.dispatch(M.setPlayerState(gt({timeoutStatus:null,nextCommandIndex:r},i.isBottomFrame?{currentLoop:n,loops:a}:{})));var s=[o.cmd,o.target,o.value],c=[""].concat(s,[""]).join(" | ");t.dispatch(M.addLog("reflect","Executing: "+c)),D.default.ask("PANEL_UPDATE_BADGE",{type:"play",text:""+(r+1)})})),c.on("PLAYED_LIST",(function(e){var r=e.indices;$e()("PLAYED_LIST",r),t.dispatch(M.updateMacroDoneCommandsIndices(Object(oe.getCurrentMacroId)(t.getState()),r))})),c.on("ERROR",(function(e){var r=e.errorIndex,n=e.msg,a=e.restart;$e.a.error("command index: "+r+", Error: "+n),t.dispatch(M.addPlayerErrorCommandIndex(r)),t.dispatch(M.addLog("error",n)),a&&t.getState().player.mode===A.PLAYER_MODE.TEST_CASE&&setTimeout((function(){return c.replayLastConfig()}),50)})),c.on("DELAY",(function(e){var r=e.total,n=e.past;t.dispatch(M.setPlayerState({timeoutStatus:{type:"delay",total:r,past:n}}))})),c},Dt=function(e){var t=e.store,r=e.vars,n=e.tcPlayer,a=e.xCmdCounter,o=(e.ocrCmdCounter,e.proxyCounter),i=new Et,s=new Et,l={isPlaying:!1,tsId:null,lastErrMsg:"",testCasePromiseHandlers:null,reports:[],stopReason:null},u=function(e){l=gt({},l,e)},d=Object(ae.b)({name:"testSuite",prepare:function(){u({isPlaying:!0,reports:[]}),r.set({"!TESTSUITE_LOOP":1,"!GLOBAL_TESTSUITE_STOP_ON_ERROR":!1},!0)},run:function(e,r){var n=e.id,a=e.loops>1?parseInt(e.loops,10):1,o=t.getState();return Object(pe.getStorageManager)().getMacroStorage().read(n,"Text").then((function(e){var n=e&&e.data.commands.find((function(e){return"open"===e.cmd.toLowerCase()}));if(!e)throw new Error("macro does not exist");return t.dispatch(M.editTestCase(e.id)),t.dispatch(M.playerPlay({macroId:e.id,title:e.name,extra:{id:e.id,name:e.name,shouldNotActivateTab:!0},mode:1===a?ae.a.C.MODE.STRAIGHT:ae.a.C.MODE.LOOP,loopsStart:1,loopsEnd:a,startIndex:0,startUrl:n?n.target:null,resources:e.data.commands,postDelay:1e3*o.config.playCommandInterval,overrideScope:0!==r.nextIndex?{}:r.public.scope})),new Promise((function(e,t){u({testCasePromiseHandlers:{resolve:e,reject:t}})}))}))},handleResult:function(e,t,r){return Promise.resolve(void 0)}},{preDelay:0});return d.on("START",(function(e){var r=e.title,n=e.extra;$e()("START SUITE"),i.reset(),a.reset(),o.reset(),u({tsId:n.id,isPlaying:!0,stopReason:null}),t.dispatch(M.addLog("status","Playing test suite "+r)),t.dispatch(M.setPlayerMode(A.PLAYER_MODE.TEST_SUITE)),t.dispatch(se.Actions.updateTestSuite(n.id,(function(e){return gt({},e,{playStatus:{isPlaying:!0,currentIndex:-1,errorIndices:[],doneIndices:[]}})})))})),d.on("LOOP_START",(function(e){var t=e.loopsCursor;r.set({"!TESTSUITE_LOOP":t},!0)})),d.on("LOOP_RESTART",(function(e){var r=e.currentLoop;t.dispatch(M.addLog("status","Current test suite loop: "+r))})),d.on("PAUSED",(function(e){e.extra;$e()("PAUSED SUITE"),t.dispatch(M.addLog("status","Test suite paused")),n.pause()})),d.on("RESUMED",(function(e){e.extra;$e()("RESUMED SUIITE"),t.dispatch(M.addLog("status","Test suite resumed")),n.resume()})),d.on("TO_PLAY",(function(e){var r=e.index,n=e.extra;s.reset(),u({lastErrMsg:"",tcIndex:r}),t.dispatch(se.Actions.updateTestSuite(n.id,(function(e){return gt({},e,{playStatus:gt({},e.playStatus,{currentIndex:r})})})))})),d.on("PLAYED_LIST",(function(e){var r=e.indices,n=e.extra;t.dispatch(se.Actions.updateTestSuite(n.id,(function(e){return gt({},e,{playStatus:gt({},e.playStatus,{doneIndices:r})})})))})),d.on("END",(function(e){var a=e.reason,o=e.extra,s=e.opts;l.isPlaying&&(r.set({"!TESTSUITE_LOOP":1},!0),u({isPlaying:!1}),t.dispatch(M.setPlayerMode(A.PLAYER_MODE.TEST_CASE)),t.dispatch(se.Actions.updateTestSuite(o.id,(function(e){return gt({},e,{playStatus:gt({},e.playStatus,{isPlaying:!1,currentIndex:-1})})}))),t.dispatch(M.updateUI({shouldEnableDesktopAutomation:void 0})),a!==ae.a.C.END_REASON.MANUAL||s&&s.tcPlayerStopped||n.stop(),setTimeout((function(){var e,r=l.reports.length,n=l.reports.filter((function(e){return e.stopReason===ae.a.C.END_REASON.ERROR})).length,s=r-n,u=(wt(e={},ae.a.C.END_REASON.MANUAL,"Manually stopped"),wt(e,ae.a.C.END_REASON.COMPLETE,"OK"),wt(e,ae.a.C.END_REASON.ERROR,"Error"),e),d=u[l.stopReason||a],m=["Test Suite name: "+o.name,"Start Time: "+i.startTime.toString(),"Overall status: "+d+", Runtime: "+i.elapsedInSeconds(),"Macro run: "+r,"Success: "+s,"Failure: "+n,"Macro executed:"];t.dispatch(M.addLog("report",(function(e){var t=e.renderText;return[c.a.createElement("span",null,m.join("\n"))].concat(yt(l.reports.map((function(e,r){return c.a.createElement("div",null,e.name,"  (",u[e.stopReason],e.stopReason===ae.a.C.END_REASON.ERROR?": ":"",e.stopReason===ae.a.C.END_REASON.ERROR?t({type:"error",text:e.errMsg,stack:e.stack}):null,", Runtime: ",e.usedTime,")")}))))})))}),200))})),n.on("END",(function(e){var n=e.reason;e.extra;if(t.getState().player.mode===A.PLAYER_MODE.TEST_SUITE){var a,o=Object(nt.getMacroCallStack)().bottom(),i=Object(nt.getMacroCallStack)().toArray(),c=t.getState().player.lastNextCommandIndex;switch(a={id:o.resource.id,name:o.resource.name,errMsg:l.lastErrMsg,stopReason:n,usedTime:s.elapsedInSeconds(),stack:i.map((function(e,t){return{macroId:e.resource.id,macroName:e.resource.name,commandIndex:t===i.length-1?c:e.runningStatus.nextIndex,isSubroutine:0!==t}}))},u({reports:l.reports.concat(a)}),n){case ae.a.C.END_REASON.MANUAL:break;case ae.a.C.END_REASON.COMPLETE:setTimeout((function(){l.testCasePromiseHandlers.resolve(!0)}),10);break;case ae.a.C.END_REASON.ERROR:if(t.dispatch(se.Actions.updateTestSuite(l.tsId,(function(e){return gt({},e,{playStatus:gt({},e.playStatus,{errorIndices:e.playStatus.errorIndices.concat([d.state.nextIndex])})})}))),u({stopReason:ae.a.C.END_REASON.ERROR}),r.get("!GLOBAL_TESTSUITE_STOP_ON_ERROR")){l.testCasePromiseHandlers.reject(new Error),d.stop({tcPlayerStopped:!0});break}l.testCasePromiseHandlers.resolve(!0)}}})),n.on("ERROR",(function(e){var r=e.msg,n=e.restart;u({lastErrMsg:r}),n&&t.getState().player.mode===A.PLAYER_MODE.TEST_SUITE&&setTimeout((function(){return d.replayLastConfig()}),50)})),d},Nt=r(50),Rt=r(641),jt=r(642),Lt=r(523),Ft=r(84),Vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ut=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var $t,Yt,Wt=(($t=Object.keys(ge.languages).map((function(e){return{text:ge.languages[e].name,value:ge.languages[e].lang}}))).sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0})),$t),Gt=function(e){function t(){var e,r,n;Xt(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=Kt(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={showPlayLoops:!1,loopsStart:1,loopsEnd:3,xModules:[Object(le.getXFile)(),Object(ue.getXUserIO)(),Object(de.getXDesktop)(),Object(me.getXScreenCapture)()],xModuleData:{},xFileRootDirChanged:!1,registerKey:"",websiteWhiteListText:"",textToEncrypt:"",encryptedText:"",showText:!1,isCheckingLicense:!1},n.getPlayer=function(e){if(e)return Object(ae.b)({name:e});switch(n.props.player.mode){case A.PLAYER_MODE.TEST_CASE:return Object(ae.b)({name:"testCase"});case A.PLAYER_MODE.TEST_SUITE:return Object(ae.b)({name:"testSuite"})}},n.getTestCaseName=function(){var e=n.props.editing.meta.src;return e&&e.name&&e.name.length?e.name:"Untitled"},n.togglePlayLoopsModal=function(e){n.setState({showPlayLoops:e})},n.onToggleRecord=function(){if(Object(ye.isCVTypeForDesktop)(n.props.config.cvScope)){var e="Recording is only available for browser automation. Desktop automation macros are created by adding XClick and other visual commands step by step.";return n.props.addLog("warning",e),a.a.warn(e,2.5)}n.props.status===A.APP_STATUS.RECORDER?(n.props.stopRecording(),n.props.normalizeCommands()):n.props.startRecording(),n.setState({lastOperation:"record"})},n.onClickPlayLoops=function(){var e=n.state,t=e.loopsStart,r=e.loopsEnd;if(t<0)return a.a.error("Start value must be no less than zero",1.5);if(r<t)return a.a.error("Max value must be greater than start value",1.5);var o=n.getPlayer(),i=n.props.editing.commands,s=n.props.editing.meta.src,c=i.find((function(e){return"open"===e.cmd.toLowerCase()}));n.props.playerPlay({macroId:s&&s.id,loopsEnd:r,loopsStart:t,title:n.getTestCaseName(),extra:{id:s&&s.id},mode:o.C.MODE.LOOP,startIndex:0,startUrl:c?c.target:null,resources:n.props.editing.commands,postDelay:1e3*n.props.config.playCommandInterval}),n.setState({lastOperation:"play"}),n.togglePlayLoopsModal(!1)},n.onCancelPlayLoops=function(){n.togglePlayLoopsModal(!1),n.setState({loopsToPlay:2})},n.onChangePlayLoops=function(e,t){n.setState(Bt({},e,parseInt(t,10)))},n.onClickSave=function(){return Object(ie.default)().save()},n.playCurrentMacro=function(e){var t=n.props.editing.commands,r=n.props.editing.meta.src,a=t.find((function(e){return"open"===e.cmd.toLowerCase()}));n.setState({lastOperation:"play"}),n.props.playerPlay({macroId:r&&r.id,title:n.getTestCaseName(),extra:{id:r&&r.id},mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,startUrl:a?a.target:null,resources:t,postDelay:1e3*n.props.config.playCommandInterval,isStep:e})},n.playCurrentLine=function(){var e=n.props.editing.commands,t=n.props.editing.meta,r=t.src,a=t.selectedIndex,o=-1===a?0:a||0;return n.props.playerPlay({macroId:r&&r.id,title:n.getTestCaseName(),extra:{id:r&&r.id},mode:ae.a.C.MODE.SINGLE,startIndex:o,startUrl:null,resources:e,postDelay:1e3*n.props.config.playCommandInterval,callback:function(t,r){t||o+1<e.length&&n.props.selectCommand(o+1,!0)}})},n.checkRegisterKey=function(){var e=n.state.registerKey;if("freeman"===e)return n.props.updateConfig({xmodulesStatus:"unregistered"}),a.a.success("Unregistered"),Object(pe.getStorageManager)().emit(pe.StorageManagerEvent.RootDirChanged),n.resetRegisterKey(),void n.forceUpdate();var t=function(){return a.a.error("Invalid license key")};return function(e){return 15===e.length&&"K"===e.charAt(0)}(e)?(n.setState({isCheckingLicense:!0}),Object(ft.getLicenseService)().checkLicense(e).then((function(e){if("key_not_found"===e.status)return t();n.resetRegisterKey(),n.forceUpdate(),Object(pe.getStorageManager)().emit(pe.StorageManagerEvent.RootDirChanged),a.a.success("License key verified")})).catch((function(e){var t=Object(Lt.isNetworkError)(e)?"Internet connection required for activation. If you want use the software on a machine without Internet connection, please contact tech support":e.message;a.a.error(t,4)})).finally((function(){n.setState({isCheckingLicense:!1})}))):t()},Kt(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ut(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.history;this.props.setRoute(t.location.pathname),this.props.history.listen((function(r,n){e.props.setRoute(t.location.pathname)})),Object(ft.getLicenseService)().getLatestInfo((function(t){e.setState({licenseInfo:t})}))}},{key:"componentWillReceiveProps",value:function(e){e.ui.showSettings&&!this.props.ui.showSettings&&this.onShowSettings(),e.ui.showWebsiteWhiteList&&!this.props.ui.showWebsiteWhiteList&&this.setState({websiteWhiteListText:(this.props.config.websiteWhiteList||[]).join("\n")})}},{key:"initXModules",value:function(){var e=this,t=this.state.xModules;Promise.all(t.map((function(e){return e.initConfig().catch((function(e){})).then((function(){return e.getVersion()})).then((function(t){return t.installed?e.sanityCheck().then((function(){return{error:null}}),(function(e){return{error:e.message}})).then((function(e){return{versionInfo:t,checkResult:e}})):{versionInfo:t,checkResult:null}}))}))).then((function(r){var n=r.reduce((function(e,r,n){return e[t[n].getName()]=Vt({},r.versionInfo,{checkResult:r.checkResult,config:t[n].getCachedConfig()}),e}),{});e.setState({xModuleData:n,xFileRootDirChanged:!1})}))}},{key:"isEitherXModuleInstalled",value:function(){var e=this.state.xModuleData[Object(le.getXFile)().getName()],t=this.state.xModuleData[Object(ue.getXUserIO)().getName()];return e&&e.installed||t&&t.installed}},{key:"resetRegisterKey",value:function(){this.setState({registerKey:""})}},{key:"onShowSettings",value:function(){this.initXModules(),this.resetRegisterKey()}},{key:"showSettingsModal",value:function(){this.props.updateUI({showSettings:!0})}},{key:"renderPublicWebsiteWhiteList",value:function(){var e=this;return c.a.createElement(k.a,{title:"Embedded Macros Website Whitelist",className:"whitelist-modal",width:450,okText:"Save",visible:this.props.ui.showWebsiteWhiteList,onCancel:function(){return e.props.updateUI({showWebsiteWhiteList:!1})},onOk:function(t){var r=e.state.websiteWhiteListText.split(/\n/g).map((function(e){return e.trim()})).filter((function(e){return e.length>0}));return e.props.updateConfig({websiteWhiteList:r}),e.props.updateUI({showWebsiteWhiteList:!1}),a.a.success("Saved"),Promise.resolve(!0)}},c.a.createElement("p",{style:{marginBottom:"10px"}},"Allow embedded macros to run ",c.a.createElement("em",null,"without warning dialog"),", if started from the following sites:"),c.a.createElement(K.a.TextArea,{placeholder:"One url per line, e. g. https://ui.vision/rpa",autosize:{minRows:6,maxRows:12},value:this.state.websiteWhiteListText,style:{resize:"vertical"},onChange:function(t){return e.setState({websiteWhiteListText:t.target.value})}}),c.a.createElement("p",{style:{color:"green",marginTop:"20px"}},c.a.createElement("a",{style:{float:"right",marginLeft:"20px"},href:"https://ui.vision/x/idehelp?help=website_whitelist",target:"_blank"},"More info"),"Only run embedded macros from websites you trust"))}},{key:"renderPlayLoopModal",value:function(){var e=this;return c.a.createElement(k.a,{title:"How many loops to play?",okText:"Play",cancelText:"Cancel",className:"play-loop-modal",visible:this.state.showPlayLoops,onOk:this.onClickPlayLoops,onCancel:this.onCancelPlayLoops},c.a.createElement(Q.a,null,c.a.createElement(te.a,{span:10},c.a.createElement(J.a.Item,{label:"Start value"},c.a.createElement(K.a,{type:"number",min:"0",value:this.state.loopsStart,onKeyDown:function(t){13===t.keyCode&&e.onClickPlayLoops()},onChange:function(t){return e.onChangePlayLoops("loopsStart",t.target.value)}}))),c.a.createElement(te.a,{span:10,offset:2},c.a.createElement(J.a.Item,{label:"Max"},c.a.createElement(K.a,{type:"number",min:"0",value:this.state.loopsEnd,onKeyDown:function(t){13===t.keyCode&&e.onClickPlayLoops()},onChange:function(t){return e.onChangePlayLoops("loopsEnd",t.target.value)}})))),c.a.createElement("p",null,"The value of the loop counter is available in $","{","!LOOP","}"," variable"))}},{key:"renderSettingModal",value:function(){var e=this,t=function(t,r){e.props.updateConfig(Bt({},t,r))},r={labelCol:{span:8},wrapperCol:{span:16}};return c.a.createElement(k.a,{title:"Settings",className:"settings-modal",width:650,footer:null,visible:this.props.ui.showSettings,onCancel:function(){e.props.updateUI({showSettings:!1}),e.setState({textToEncrypt:"",encryptedText:""})}},c.a.createElement(B.a,{activeKey:this.props.ui.settingsTab||"replay",onChange:function(t){return e.props.updateUI({settingsTab:t})}},c.a.createElement(B.a.TabPane,{tab:"Replay",key:"replay"},c.a.createElement(J.a,null,c.a.createElement(J.a.Item,Vt({label:"Replay Helper"},r),c.a.createElement(Y.a,{onChange:function(e){return t("playScrollElementsIntoView",e.target.checked)},checked:this.props.config.playScrollElementsIntoView},"Scroll elements into view during replay"),c.a.createElement(Y.a,{onChange:function(e){return t("playHighlightElements",e.target.checked)},checked:this.props.config.playHighlightElements},"Highlight elements during replay")),c.a.createElement(J.a.Item,Vt({label:c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=command_interval"},"Command Interval")},r),c.a.createElement(G.a,{style:{width:"200px"},placeholder:"interval",value:""+this.props.config.playCommandInterval,onChange:function(e){return t("playCommandInterval",e)}},c.a.createElement(G.a.Option,{value:"0"},"Fast (no delay)"),c.a.createElement(G.a.Option,{value:"0.3"},"Medium (0.3s delay)"),c.a.createElement(G.a.Option,{value:"2"},"Slow (2s delay)"))),c.a.createElement(J.a.Item,Vt({label:c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=timeout_pageload"},"!TIMEOUT_PAGELOAD")},r),c.a.createElement(K.a,{type:"number",min:"0",style:{width:"70px"},value:this.props.config.timeoutPageLoad,onChange:function(e){return t("timeoutPageLoad",e.target.value)},placeholder:"in seconds"}),c.a.createElement("span",{className:"tip"},"Max. time for new page load")),c.a.createElement(J.a.Item,Vt({label:c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=timeout_wait"},"!TIMEOUT_WAIT")},r),c.a.createElement(K.a,{type:"number",min:"0",style:{width:"70px"},value:this.props.config.timeoutElement,onChange:function(e){return t("timeoutElement",e.target.value)},placeholder:"in seconds"}),c.a.createElement("span",{className:"tip"},"Max. time per step")),c.a.createElement(J.a.Item,Vt({label:c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=timeout_macro"},"!TIMEOUT_MACRO")},r),c.a.createElement(K.a,{type:"number",min:"0",style:{width:"70px"},value:this.props.config.timeoutMacro,onChange:function(e){return t("timeoutMacro",e.target.value)},placeholder:"in seconds"}),c.a.createElement("span",{className:"tip"},"Max. overall macro runtime")),c.a.createElement(J.a.Item,Vt({label:c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=timeout_download"},"!TIMEOUT_DOWNLOAD")},r),c.a.createElement(K.a,{type:"number",min:"0",style:{width:"70px"},value:this.props.config.timeoutDownload,onChange:function(e){return t("timeoutDownload",e.target.value)},placeholder:"in seconds"}),c.a.createElement("span",{className:"tip"},"Max. allowed time for file")),c.a.createElement(J.a.Item,Vt({label:"If error happens in loop"},r),c.a.createElement(z.a.Group,{onChange:function(e){return t("onErrorInLoop",e.target.value)},value:this.props.config.onErrorInLoop},c.a.createElement(z.a,{value:"continue_next_loop"},"Continue next loop"),c.a.createElement(z.a,{value:"stop"},"Stop"))))),c.a.createElement(B.a.TabPane,{tab:"API",key:"api",className:"api-pane"},c.a.createElement("p",null,"The RPA command line API allows you to run macros and test suites from the command line and to control UI.Vision RPA from any scripting or programming language (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=cmdline",target:"_blank"},"more info"),")."),c.a.createElement("p",null,c.a.createElement(_.a,{type:"primary",onClick:function(){var e=Object(Nt.generateEmptyHtml)(),t=new Blob([e],{type:"text/plain;charset=utf-8"});C.a.saveAs(t,"ui.vision.html",!0)}},"Generate Autostart HTML Page")),c.a.createElement(J.a,null,c.a.createElement(J.a.Item,Vt({label:c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=cmdline"},"Allow Command Line")},r,{labelCol:{span:6}}),c.a.createElement(Y.a,{onChange:function(e){return t("allowRunFromBookmark",e.target.checked)},checked:this.props.config.allowRunFromBookmark},"Run macro and test suite shortcuts from Javascript Bookmarklets"),c.a.createElement(Y.a,{onChange:function(e){return t("allowRunFromFileSchema",e.target.checked)},checked:this.props.config.allowRunFromFileSchema},"Run embedded macros from local files"),c.a.createElement(Y.a,{onChange:function(e){return t("allowRunFromHttpSchema",e.target.checked)},checked:this.props.config.allowRunFromHttpSchema},"Run embedded macros from public websites",c.a.createElement("a",{href:"#",style:{position:"relative",marginLeft:"10px",padding:"15px 0"},onClick:function(t){t.stopPropagation(),t.preventDefault(),e.props.updateUI({showWebsiteWhiteList:!0})}},"Edit Whitelist"))))),c.a.createElement(B.a.TabPane,{tab:"Selenium",key:"selenium",className:"selenium-pane"},c.a.createElement("h4",null,"Import Selenium IDE Projects"),c.a.createElement("p",null,"Import web tests created in the classic Selenium IDE. Unknown commands (if any) are imported as comments. If you want us to add a certain not yet supported command, or find any other import issues, please let us know in the ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=forum",target:"_blank"},"user forum"),"."),c.a.createElement("div",{className:"import-row"},c.a.createElement("input",{type:"file",accept:".side",id:"select_side_file",ref:function(t){e.sideFileInput=t},style:{display:"none"},onChange:function(t){setTimeout((function(){e.sideFileInput.value=null}),500);var r=t.target.files[0];Object(be.readFileAsText)(r).then((function(t){var r=JSON.parse(t);Object(Rt.importSideProject)(r).then((function(t){var r=['Project "'+t.projectName+'" import into folder: "'+t.folderName+'"',"- "+t.macros.successCount+" "+(1===t.macros.successCount?"macro":"macros")+" (imported)","- "+t.suites.ignoreCount+" "+(1===t.suites.ignoreCount?"test suite":"test suites")+" (test suites are not imported yet)"];e.props.addLog("info",r.join("\n")),a.a.success('Project "'+t.projectName+'" import into folder: "'+t.folderName+'"')})).catch((function(e){a.a.error(e.message)}))}))}}),c.a.createElement(_.a,{type:"primary",onClick:function(){var e=document.querySelector("#select_side_file");e&&e.click()}},"Import .SIDE projects"),c.a.createElement("span",null,"Imports projects from Selenium IDE V3.x (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=import_side",target:"_blank"},"more info"),")")),c.a.createElement("div",{className:"import-row"},c.a.createElement("input",{multiple:!0,type:"file",accept:".html",id:"select_html_files_for_macros",ref:function(t){e.jsonFileInput=t},style:{display:"none"},onChange:function(t){return setTimeout((function(){e.jsonFileInput.value=null}),500),e.props.readFilesAndImportTestCases({files:t.target.files,type:"text",process:function(e,t){return{macros:[Object(Nt.fromHtml)(e,t)],csvs:[],images:[]}}})}}),c.a.createElement(_.a,{type:"primary",onClick:function(){var e=document.querySelector("#select_html_files_for_macros");e&&e.click()}},"Import .HTML projects"),c.a.createElement("span",null,"Import projects from Selenium IDE V2.x (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=import_html",target:"_blank"},"more info"),")")),c.a.createElement("h4",null,"Web Recording Options"),c.a.createElement(J.a,null,c.a.createElement(J.a.Item,Vt({label:"Notification"},r),c.a.createElement(Y.a,{onChange:function(e){return t("recordNotification",e.target.checked)},checked:this.props.config.recordNotification},"Show notifications when recording")),c.a.createElement(J.a.Item,Vt({label:"Locators"},r),c.a.createElement(Y.a,{onChange:function(e){return t("saveAlternativeLocators",e.target.checked)},checked:this.props.config.saveAlternativeLocators},"Store alternative locators in macro (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=alternative_locators",target:"_blank"},"more info"),")")),c.a.createElement(J.a.Item,Vt({label:"click / clickAt"},r),c.a.createElement(z.a.Group,{onChange:function(e){return t("recordClickType",e.target.value)},value:this.props.config.recordClickType},c.a.createElement(z.a,{value:"click"},"Record click"),c.a.createElement(z.a,{value:"clickAt"},"Record clickAt")))),c.a.createElement("h4",null,"Proxy Options"),c.a.createElement(J.a,null,c.a.createElement(J.a.Item,Vt({label:"Default Proxy (IP:Port)"},r),c.a.createElement(K.a,{type:"text",style:{width:"300px"},value:this.props.config.defaultProxy,onChange:function(e){return t("defaultProxy",e.target.value)},placeholder:"eg. http://0.0.0.0:1234"})),c.a.createElement(J.a.Item,Vt({label:"User name, Password"},r),c.a.createElement(K.a,{type:"text",style:{width:"300px"},value:this.props.config.defaultProxyAuth,onChange:function(e){return t("defaultProxyAuth",e.target.value)},placeholder:"eg. admin, mypassword"})),c.a.createElement(J.a.Item,Vt({label:"Status"},r),c.a.createElement(z.a.Group,{value:this.props.proxy?"on":"off",onChange:function(t){switch(t.target.value){case"off":return D.default.ask("PANEL_SET_PROXY",{proxy:null});case"on":var r=void 0;try{r=Object(ut.parseProxyUrl)(e.props.config.defaultProxy,e.props.config.defaultProxyAuth)}catch(t){return a.a.error(t.message)}return D.default.ask("PANEL_SET_PROXY",{proxy:r})}}},c.a.createElement(z.a,{value:"on"},"Proxy ON"),c.a.createElement(z.a,{value:"off"},"Proxy OFF")),c.a.createElement(Y.a,{onChange:function(e){return t("turnOffProxyAfterReplay",e.target.checked)},checked:this.props.config.turnOffProxyAfterReplay},"Turn off at end of replay (Proxy controlled by ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?cmd=setproxy",target:"_blank"},"setProxy command"),")"))),c.a.createElement("h4",null,"Old-Style Test Cases"),c.a.createElement(J.a,null,c.a.createElement(J.a.Item,Vt({label:"Sidebar"},r),c.a.createElement(Y.a,{onChange:function(e){return t("showTestCaseTab",e.target.checked)},checked:this.props.config.showTestCaseTab},"Show test case tab (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=old_style_test_cases",target:"_blank"},"more info"),")")))),c.a.createElement(B.a.TabPane,{tab:"Backup",key:"backup",className:"backup-pane"},c.a.createElement("h4",null,"Automatic Backup"),c.a.createElement("p",null,"The automatic backup reminder helps to you to regularly export macros and other data as ZIP archive. As browser extension UI.Vision RPA must store its data ",c.a.createElement("em",null,"inside the browser extension"),". This means that when you uninstall the extension, the data is removed, too. Therefore it is good to have backups! Note that if the hard drive storage mode of the File Access XModule is active, then the backup archive contains these files."),c.a.createElement("div",{className:"row"},c.a.createElement(Y.a,{onChange:function(e){return t("enableAutoBackup",e.target.checked)},checked:this.props.config.enableAutoBackup}),c.a.createElement("span",null,"Show backup reminder every"),c.a.createElement(K.a,{type:"number",min:1,disabled:!this.props.config.enableAutoBackup,value:this.props.config.autoBackupInterval,onChange:function(e){return t("autoBackupInterval",e.target.value)},style:{width:"40px"}}),c.a.createElement("span",null," days")),c.a.createElement("div",{className:"row"},c.a.createElement("p",null,"Backup includes"),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(Y.a,{onChange:function(e){return t("autoBackupTestCases",e.target.checked)},checked:this.props.config.autoBackupTestCases}),c.a.createElement("span",null,"Macros and Folders (includes Folders as Test Suites)")),c.a.createElement("li",null,c.a.createElement(Y.a,{onChange:function(e){return t("autoBackupTestSuites",e.target.checked)},checked:this.props.config.autoBackupTestSuites}),c.a.createElement("span",null,"Old-style Test Suites")),c.a.createElement("li",null,c.a.createElement(Y.a,{onChange:function(e){return t("autoBackupScreenshots",e.target.checked)},checked:this.props.config.autoBackupScreenshots}),c.a.createElement("span",null,"Screenshots")),c.a.createElement("li",null,c.a.createElement(Y.a,{onChange:function(e){return t("autoBackupCSVFiles",e.target.checked)},checked:this.props.config.autoBackupCSVFiles}),c.a.createElement("span",null,"CSV Files")),c.a.createElement("li",null,c.a.createElement(Y.a,{onChange:function(e){return t("autoBackupVisionImages",e.target.checked)},checked:this.props.config.autoBackupVisionImages}),c.a.createElement("span",null,"Visual UI Test images")))),c.a.createElement("div",{className:"row"},c.a.createElement(_.a,{type:"primary",onClick:function(){return e.props.runBackup()}},"Run Backup Now"),c.a.createElement("span",null," Create a backup ZIP file now.")),c.a.createElement("div",{style:{paddingTop:"30px"},className:"row"},c.a.createElement(_.a,{type:"primary",onClick:function(){var e=document.getElementById("select_zip_file");e&&e.click()}},"Restore Data from Backup"),c.a.createElement("span",null," Select a backup ZIP file to import it (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=bkup_import",target:"_blank"},"more info"),"). "),c.a.createElement("input",{type:"file",accept:".zip",id:"select_zip_file",ref:function(t){e.zipFileInput=t},style:{display:"none"},onChange:function(t){setTimeout((function(){e.zipFileInput.value=null}),500);var r=t.target.files[0];Object(jt.restoreBackup)({file:r,storage:Object(pe.getStorageManager)().getCurrentStrategyType()}).then((function(t){Object(pe.getStorageManager)().emit(pe.StorageManagerEvent.ForceReload),a.a.success("Backup restored"),e.props.addLog("info",["Backup restored:",t.count.macro+" macros",t.count.testSuite+" test suites",t.count.csv+" csvs",t.count.screenshot+" screenshots",t.count.vision+" vision images"].join("\n"))}),(function(e){a.a.error("Failed to restore: "+e.message),console.error(e)}))}}))),c.a.createElement(B.a.TabPane,{tab:"Security",key:"security",className:"security-pane"},c.a.createElement("h4",null,"Master password for Password Encryption"),c.a.createElement("p",null,"A master password is used to encrypt and decrypt all stored website passwords. The websites passwords are encrypted using strong encryption.  ",c.a.createElement("a",{target:"_blank",href:"https://ui.vision/x/idehelp?help=encryption"},"More info >>")),c.a.createElement("div",null,c.a.createElement(z.a.Group,{onChange:function(e){return t("shouldEncryptPassword",e.target.value)},value:this.props.config.shouldEncryptPassword},c.a.createElement(z.a,{value:"no"},"Do not encrypt passwords"),c.a.createElement(z.a,{value:"master_password"},"Enter master password here to store it")),"master_password"===this.props.config.shouldEncryptPassword?c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("label",null,"Master password:"),c.a.createElement(K.a,{type:"password",style:{width:"200px"},value:this.props.config.masterPassword,onChange:function(e){return t("masterPassword",e.target.value)}})),c.a.createElement("div",null,c.a.createElement("hr",{style:{margin:"20px 0"}}),c.a.createElement("h4",null,"Create encrypted text string"),c.a.createElement("p",null,"The feature uses the master password to encrypt text. The encrypted string can be used with TYPE, SENDKEY and XTYPE."),c.a.createElement("div",{className:"input-line"},c.a.createElement("span",{className:"input-label"},"Text to encrypt:"),c.a.createElement(K.a,{type:this.state.showText?"text":"password",style:{width:"200px"},value:this.state.textToEncrypt,onChange:function(t){e.setState({textToEncrypt:t.target.value,encryptedText:""})}}),c.a.createElement(Y.a,{onChange:function(t){e.setState({showText:t.target.checked})},checked:this.state.showText},"Show text")),c.a.createElement("div",{className:"input-line"},c.a.createElement("span",{className:"input-label"},"Encrypted string:"),c.a.createElement(K.a,{readOnly:!0,type:"text",style:{width:"200px"},value:this.state.encryptedText})),c.a.createElement("div",{className:"input-line"},c.a.createElement("span",{className:"input-label"}),c.a.createElement(_.a,{type:"primary",onClick:function(){Object(ht.b)(e.state.textToEncrypt).then((function(t){e.setState({encryptedText:t}),ne()(t,{format:"text/plain"}),a.a.success("Copied to clipboard")}))}},"Encrypt & Copy"),c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=encrypt",target:"_blank"},"(More info)")))):null)),c.a.createElement(B.a.TabPane,{tab:"OCR",key:"ocr",className:Object(ce.cn)("ocr-pane",{"ocr-disabled":"disabled"===this.props.config.ocrMode,"ocr-enabled":"enabled"===this.props.config.ocrMode,"ocr-offline":"offline_enabled"===this.props.config.ocrMode})},c.a.createElement("p",null,"This tab manages the ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=ocr",target:"_blank"},"OCR commands"),". Please note that the Online OCR option sends screenshots to our Cloud OCR API. All screenshots are deleted after processing. But since this means that data leaves your machine, you must explicitly allow it. By default (after installation) Online OCR is disabled."),c.a.createElement("div",{className:"row"},c.a.createElement(z.a.Group,{className:"radio-block",onChange:function(e){return t("ocrMode",e.target.value)},value:this.props.config.ocrMode},c.a.createElement(z.a,{value:"disabled"},"OCR feature disabled"),c.a.createElement(z.a,{value:"enabled"},"Online OCR enabled (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=ocronline",target:"_blank"},"more info"),")",c.a.createElement("br",null),"Conversion counter: You used ",Object(Qe.getOcrCommandCounter)().get()," from ",Object(Qe.getOcrCommandCounter)().getMaximum()," conversions/day (",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=ocradd",target:"_blank"},"add more"),")"),c.a.createElement(z.a,{value:"offline_enabled",disabled:!Object(ft.getLicenseService)().isProLicense(),class:Object(ce.cn)({"need-pro":!Object(ft.getLicenseService)().isProLicense()})},"Offline OCR - use ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=ocroffline",target:"_blank"},"local OCR engine")," (Requires XModules Enterprise Edition)",c.a.createElement("br",null),c.a.createElement("span",{className:"offline-label"},"Local OCR"),c.a.createElement(K.a,{type:"text",style:{width:"200px"},disabled:"offline_enabled"!==this.props.config.ocrMode,value:this.props.config.ocrOfflineURL,onChange:function(e){return t("ocrOfflineURL",e.target.value)}}),c.a.createElement("br",null),c.a.createElement("span",{className:"offline-label"},"Local API key"),c.a.createElement(K.a,{type:"password",style:{width:"200px"},disabled:"offline_enabled"!==this.props.config.ocrMode,value:this.props.config.ocrOfflineAPIKey,onChange:function(e){return t("ocrOfflineAPIKey",e.target.value)}})))),c.a.createElement("div",{className:"row"},c.a.createElement("p",null,c.a.createElement("span",{className:"label-text"},"Default OCR Engine"),c.a.createElement(z.a.Group,{onChange:function(e){return t("ocrEngine",parseInt(e.target.value,10))},value:""+this.props.config.ocrEngine},c.a.createElement(z.a,{value:"1"},"Engine 1"),c.a.createElement(z.a,{value:"2"},"Engine 2")))),c.a.createElement("div",{className:"row"},c.a.createElement("p",null,c.a.createElement("span",{className:"label-text"},"Default OCR language"),c.a.createElement(G.a,{style:{width:"150px"},placeholder:"OCR Language",value:this.props.config.ocrLanguage,disabled:"disabled"===this.props.config.ocrMode||2===this.props.config.ocrEngine,onChange:function(e){return t("ocrLanguage",e)}},Wt.map((function(e){return c.a.createElement(G.a.Option,{value:e.value,key:e.value},e.text)})))),c.a.createElement("div",null,"You can overwrite the default OCR settings in the macro with ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=ocrlanguage",target:"_blank"},"!OCRLanguage")," and ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=ocrengine",target:"_blank"},"!OCREngine"),".")),c.a.createElement("div",{className:"row"},c.a.createElement("p",null,c.a.createElement(_.a,{type:"primary",loading:this.state.testingOcrAPI,disabled:"disabled"===this.props.config.ocrMode,onClick:function(){var t,r,n,o;e.setState({testingOcrAPI:!0}),(t={store:window.store,isDesktop:Object(ye.isCVTypeForDesktop)(e.props.config.cvScope)},r=t.store,n=t.isDesktop,o=function(){return D.default.ask("PANEL_UPDATE_BADGE",{type:"play",clear:!0})},St({store:r,isDesktop:n,lang:r.getState().config.ocrLanguage,engine:r.getState().config.ocrEngine,scale:"true",searchArea:"viewport",storedImageRect:null,ocrApiTimeout:E.a.ocr.apiTimeout}).then((function(e){var t=e.response,r=e.offset,a=(e.viewportOffset,Object(be.safeUpdateIn)(["[]","TextOverlay","Lines","[]","Words","[]"],(function(e){return gt({},e,{Top:e.Top+r.y,Left:e.Left+r.x})}),t.ParsedResults)),o=[{similarity:1,highlight:Je.OcrHighlightType.Matched,words:Object(ze.allWordsWithPosition)(a,[])}];return D.default.ask("PANEL_HIGHLIGHT_OCR_MATCHES",{ocrMatches:o,isDesktop:n})})).then((function(){o()}),(function(e){throw o(),e}))).catch((function(e){a.a.error(e.message)})).then((function(){e.setState({testingOcrAPI:!1})}))}},"Show OCR Overlay")),c.a.createElement("p",null,"The test runs OCR on the currently active browser tab and displays the result as overlay."))),c.a.createElement(B.a.TabPane,{tab:"Vision",key:"vision",className:"vision-pane"},c.a.createElement("p",null,"UI.Vision RPA's eyes can look inside the web browser or search the complete desktop."),c.a.createElement("div",{className:"row"},c.a.createElement(z.a.Group,{onChange:function(e){return t("cvScope",e.target.value)},value:this.props.config.cvScope},c.a.createElement(z.a,{value:"browser"},"Browser Automation (Look inside browser)"),c.a.createElement(z.a,{value:"desktop",disabled:!(this.state.xModuleData[Object(de.getXDesktop)().getName()]&&this.state.xModuleData[Object(de.getXDesktop)().getName()].installed)},c.a.createElement("span",null,"Desktop Automation (Search complete desktop)"),this.state.xModuleData[Object(de.getXDesktop)().getName()]&&this.state.xModuleData[Object(de.getXDesktop)().getName()].installed?null:c.a.createElement("a",{target:"_blank",href:Object(de.getXDesktop)().downloadLink(),style:{marginLeft:"15px"}},"Install the DesktopAutomation XModule first."),c.a.createElement("div",null,c.a.createElement(Y.a,{onChange:function(e){return t("useDesktopScreenCapture",e.target.checked)},checked:this.props.config.useDesktopScreenCapture,disabled:"desktop"!==this.props.config.cvScope||!(this.state.xModuleData[Object(me.getXScreenCapture)().getName()]&&this.state.xModuleData[Object(me.getXScreenCapture)().getName()].installed)},c.a.createElement("span",null,"Use native ",c.a.createElement("a",{href:Object(me.getXScreenCapture)().infoLink(),target:"_blank"},"desktop screen capture (BETA)")," if installed (see XModule below)"),this.state.xModuleData[Object(me.getXScreenCapture)().getName()]&&this.state.xModuleData[Object(me.getXScreenCapture)().getName()].installed?null:c.a.createElement("a",{target:"_blank",href:Object(me.getXScreenCapture)().downloadLink(),style:{marginLeft:"15px"}},"Install the ScreenCapture XModule first.")))))),c.a.createElement("p",null,"Inside a macro the computer vision scope can be changed with the ",c.a.createElement("a",{href:Object(de.getXDesktop)().infoLink(),target:"_blank"},"XDesktopAutomation")," command. In addition, you can restrict the image search  area with the ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=limitsearcharea",target:"_blank"},"visionLimitSearchArea")," command."),c.a.createElement("div",{className:"row",style:{marginTop:"30px"}},c.a.createElement("p",null,"Default Vision Search Confidence"),c.a.createElement(G.a,{style:{width:"200px"},placeholder:"interval",value:""+this.props.config.defaultVisionSearchConfidence,onChange:function(e){return t("defaultVisionSearchConfidence",parseFloat(e))}},Object(ce.range)(1,11,1).map((function(e){return c.a.createElement(G.a.Option,{key:e,value:""+(.1*e).toFixed(1)},(.1*e).toFixed(1))})))),c.a.createElement("div",{className:"row",style:{marginTop:"30px"}},c.a.createElement(Y.a,{onChange:function(e){return t("waitBeforeDesktopScreenCapture",e.target.checked)},checked:this.props.config.waitBeforeDesktopScreenCapture},c.a.createElement("span",null,"Wait"),c.a.createElement(K.a,{type:"number",min:"0",max:"60",value:this.props.config.secondsBeforeDesktopScreenCapture,style:{width:"60px",margin:"0 10px"},onChange:function(e){return t("secondsBeforeDesktopScreenCapture",Math.min(60,Number(e.target.value)))}}),c.a.createElement("span",null,"seconds before taking screenshots. This allows you to switch windows"))),c.a.createElement("div",{style:{margin:"30px 0 0"},className:"xmodule-item"},c.a.createElement("div",{className:"xmodule-title"},c.a.createElement("span",null,c.a.createElement("b",null,"Screen Capture XModule")," - Select images more quickly"),c.a.createElement("a",{href:Object(me.getXScreenCapture)().infoLink(),target:"_blank"},"More Info"),c.a.createElement(_.a,{type:"primary",onClick:function(){Object(me.getXScreenCapture)().getVersion().then((function(t){var r=t.installed,n=t.version,o=r?"Installed (v"+n+")":"Not Installed";a.a.info("status updated: "+o),e.setState(Object(ce.updateIn)(["xModuleData",Object(me.getXScreenCapture)().getName()],(function(e){return Vt({},e,t,{config:Object(me.getXScreenCapture)().getCachedConfig()})}),e.state))}))}},"Test it")),c.a.createElement("div",{className:"xmodule-status"},c.a.createElement("label",null,"Status:"),this.state.xModuleData[Object(me.getXScreenCapture)().getName()]&&this.state.xModuleData[Object(me.getXScreenCapture)().getName()].installed?c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Installed (v",this.state.xModuleData[Object(me.getXScreenCapture)().getName()].version,")"),c.a.createElement("a",{target:"_blank",href:Object(me.getXScreenCapture)().checkUpdateLink(this.state.xModuleData[Object(me.getXScreenCapture)().getName()]&&this.state.xModuleData[Object(me.getXScreenCapture)().getName()].version,fe.a.runtime.getManifest().version)},"Check for update")):c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Not Installed"),c.a.createElement("a",{href:Object(me.getXScreenCapture)().downloadLink(),target:"_blank"},"Download it"))))),c.a.createElement(B.a.TabPane,{tab:"XModules",key:"xmodules",className:"xmodules-pane"},c.a.createElement("div",{className:"xmodule-item"},c.a.createElement("div",{className:"xmodule-title"},c.a.createElement("span",null,c.a.createElement("b",null,"FileAccess XModule")," - Read and write to your hard drive"),c.a.createElement("a",{href:Object(le.getXFile)().infoLink(),target:"_blank"},"More Info"),c.a.createElement(_.a,{type:"primary",onClick:function(){Object(le.getXFile)().getVersion().then((function(t){var r=t.installed,n=t.version,o=r?"Installed (v"+n+")":"Not Installed";a.a.info("status updated: "+o),(r?Object(le.getXFile)().initConfig():Promise.resolve()).catch((function(e){})).then((function(){e.setState(Object(ce.updateIn)(["xModuleData",Object(le.getXFile)().getName()],(function(e){return Vt({},e,t,{config:Object(le.getXFile)().getCachedConfig()})}),e.state))}))}))}},"Test it")),c.a.createElement("div",{className:"xmodule-status"},c.a.createElement("label",null,"Status:"),this.state.xModuleData[Object(le.getXFile)().getName()]&&this.state.xModuleData[Object(le.getXFile)().getName()].installed?c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Installed (v",this.state.xModuleData[Object(le.getXFile)().getName()].version,")"),c.a.createElement("a",{target:"_blank",href:Object(le.getXFile)().checkUpdateLink(this.state.xModuleData[Object(le.getXFile)().getName()]&&this.state.xModuleData[Object(le.getXFile)().getName()].version,fe.a.runtime.getManifest().version)},"Check for update")):c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Not Installed"),c.a.createElement("a",{href:Object(le.getXFile)().downloadLink(),target:"_blank"},"Download it"))),c.a.createElement("div",{className:"xmodule-settings"},c.a.createElement("h3",null,"Settings"),c.a.createElement("div",{className:"xmodule-settings-item"},c.a.createElement("div",{className:"settings-detail"},c.a.createElement("label",null,"Home Folder"),c.a.createElement("div",{className:"settings-detail-content"},c.a.createElement(K.a,{type:"text",value:Object(le.getXFile)().getCachedConfig().rootDir,disabled:!(this.state.xModuleData[Object(le.getXFile)().getName()]&&this.state.xModuleData[Object(le.getXFile)().getName()].installed),onChange:function(t){var r=t.target.value;e.setState(Object(ce.compose)(Object(ce.setIn)(["xModuleData",Object(le.getXFile)().getName(),"config","rootDir"],r),Object(ce.setIn)(["xFileRootDirChanged"],!0))(e.state)),Object(le.getXFile)().setConfig({rootDir:r})},onBlur:function(){e.state.xFileRootDirChanged&&(e.setState({xFileRootDirChanged:!1}),Object(le.getXFile)().sanityCheck().then((function(){e.setState(Object(ce.setIn)(["xModuleData",Object(le.getXFile)().getName(),"checkResult"],{error:null},e.state)),Object(pe.getStorageManager)().emit(pe.StorageManagerEvent.RootDirChanged)}),(function(t){e.setState(Object(ce.setIn)(["xModuleData",Object(le.getXFile)().getName(),"checkResult"],{error:t.message},e.state)),e.props.updateUI({showSettings:!0,settingsTab:"xmodules"})})))}}),this.state.xModuleData[Object(le.getXFile)().getName()]&&this.state.xModuleData[Object(le.getXFile)().getName()].checkResult&&this.state.xModuleData[Object(le.getXFile)().getName()].checkResult.error?c.a.createElement("div",{className:"check-result"},this.state.xModuleData[Object(le.getXFile)().getName()].checkResult.error):null)),c.a.createElement("div",{className:"settings-desc"},"In this folder, UI.Vision RPA creates /macros, /images, /testsuites, /datasources")))),c.a.createElement("div",{className:"xmodule-item"},c.a.createElement("div",{className:"xmodule-title"},c.a.createElement("span",null,c.a.createElement("b",null,"RealUser XModule")," - Click / Type / Drag with OS native events"),c.a.createElement("a",{href:Object(ue.getXUserIO)().infoLink(),target:"_blank"},"More Info"),c.a.createElement(_.a,{type:"primary",onClick:function(){Object(ue.getXUserIO)().getVersion().then((function(t){var r=t.installed,n=t.version,o=r?"Installed (v"+n+")":"Not Installed";a.a.info("status updated: "+o),e.setState(Object(ce.updateIn)(["xModuleData",Object(ue.getXUserIO)().getName()],(function(e){return Vt({},e,t,{config:Object(ue.getXUserIO)().getCachedConfig()})}),e.state))}))}},"Test it")),c.a.createElement("div",{className:"xmodule-status"},c.a.createElement("label",null,"Status:"),this.state.xModuleData[Object(ue.getXUserIO)().getName()]&&this.state.xModuleData[Object(ue.getXUserIO)().getName()].installed?c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Installed (v",this.state.xModuleData[Object(ue.getXUserIO)().getName()].version,")"),c.a.createElement("a",{target:"_blank",href:Object(ue.getXUserIO)().checkUpdateLink(this.state.xModuleData[Object(ue.getXUserIO)().getName()]&&this.state.xModuleData[Object(ue.getXUserIO)().getName()].version,fe.a.runtime.getManifest().version)},"Check for update")):c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Not Installed"),c.a.createElement("a",{href:Object(ue.getXUserIO)().downloadLink(),target:"_blank"},"Download it")))),c.a.createElement("div",{className:"xmodule-item"},c.a.createElement("div",{className:"xmodule-title"},c.a.createElement("span",null,c.a.createElement("b",null,"DesktopAutomation XModule")," - Visual Desktop Automation"),c.a.createElement("a",{href:Object(de.getXDesktop)().infoLink(),target:"_blank"},"More Info"),c.a.createElement(_.a,{type:"primary",onClick:function(){Object(de.getXDesktop)().getVersion().then((function(t){var r=t.installed,n=t.version,o=r?"Installed (v"+n+")":"Not Installed";a.a.info("status updated: "+o),e.setState(Object(ce.updateIn)(["xModuleData",Object(de.getXDesktop)().getName()],(function(e){return Vt({},e,t,{config:Object(de.getXDesktop)().getCachedConfig()})}),e.state))}))}},"Test it")),c.a.createElement("div",{className:"xmodule-status"},c.a.createElement("label",null,"Status:"),this.state.xModuleData[Object(de.getXDesktop)().getName()]&&this.state.xModuleData[Object(de.getXDesktop)().getName()].installed?c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Installed (v",this.state.xModuleData[Object(de.getXDesktop)().getName()].version,")"),c.a.createElement("a",{target:"_blank",href:Object(de.getXDesktop)().checkUpdateLink(this.state.xModuleData[Object(de.getXDesktop)().getName()]&&this.state.xModuleData[Object(de.getXDesktop)().getName()].version,fe.a.runtime.getManifest().version)},"Check for update")):c.a.createElement("div",{className:"status-box"},c.a.createElement("span",null,"Not Installed"),c.a.createElement("a",{href:Object(de.getXDesktop)().downloadLink(),target:"_blank"},"Download it"))))),c.a.createElement(B.a.TabPane,{tab:"XModules PRO",key:"register",className:"register-pane"},c.a.createElement("div",{className:Object(ce.cn)("register-note",{inactive:!Object(ft.getLicenseService)().hasNoLicense()})},c.a.createElement("p",null,"Thank you for using the UI.Vision RPA Community Edition. For unlimited real user commands (XClick, XMove and XType), unlimited direct file access and priority support, please upgrade to our PRO and Enterprise Editions. If you have already purchased a license key, you can enter it here:"),c.a.createElement("div",{className:"actions"},c.a.createElement("a",{href:Object(ft.getLicenseService)().getUpgradeUrl(),target:"_blank"},"Click here to upgrade."))),c.a.createElement("div",{className:"register-form"},c.a.createElement("label",null,"Enter license key:"),c.a.createElement("div",{className:"register-row"},c.a.createElement(K.a,{value:this.state.registerKey,type:"text",onChange:function(t){e.setState({registerKey:t.target.value})}}),c.a.createElement(_.a,{type:"primary",loading:this.state.isCheckingLicense,onClick:this.checkRegisterKey},"Check Key"))),c.a.createElement("div",{className:"register-status"},Object(ft.getLicenseService)().hasNoLicense()?c.a.createElement("div",null,c.a.createElement("span",null,"XModules status: "),c.a.createElement("b",null,this.isEitherXModuleInstalled()?Object(ft.getLicenseService)().getEditionName()+" active":"Not installed"),".",c.a.createElement("a",{href:Object(ft.getLicenseService)().getUpgradeUrl(),target:"_blank"},"Upgrade to XModules Personal, PRO or Enterprise")):null,Object(ft.getLicenseService)().isPersonalLicense()?c.a.createElement("div",null,"XModules status: ",c.a.createElement("b",null,Object(ft.getLicenseService)().getEditionName()," active"),".",c.a.createElement("a",{href:Object(ft.getLicenseService)().getUpgradeUrl(),target:"_blank"},"Upgrade to PRO or Enterprise")):null,Object(ft.getLicenseService)().isProLicense()?c.a.createElement("div",null,"XModules status: ",c.a.createElement("b",null,Object(ft.getLicenseService)().getEditionName()," active"),".",c.a.createElement("a",{href:Object(ft.getLicenseService)().getUpgradeUrl(),target:"_blank"},"Contact Support")):null,Object(ft.getLicenseService)().isPlayerLicense()?c.a.createElement("div",null,"XModules status: ",c.a.createElement("b",null,Object(ft.getLicenseService)().getEditionName()," active"),".",c.a.createElement("a",{href:Object(ft.getLicenseService)().getUpgradeUrl(),target:"_blank"},"Contact Support")):null))))}},{key:"renderMainMenu",value:function(){var e=this,t=this.state,r=(t.htmlUri,t.jsonUri,this.props),n=(r.status,r.editing),a=(n.commands,n.meta.src),o=this.props.player.status===A.PLAYER_STATUS.STOPPED;a&&a.name;return c.a.createElement(V.a,{onClick:function(t){switch(t.key){case"play_settings":e.showSettingsModal()}},selectable:!1},c.a.createElement(V.a.Item,{key:"play_settings",disabled:!o},"Replay settings.."))}},{key:"renderStatus",value:function(){var e=this.props,t=e.status,r=e.player;return c.a.createElement("div",{className:"status"},function(){switch(t){case A.APP_STATUS.RECORDER:return"Recording";case A.APP_STATUS.PLAYER:switch(r.status){case A.PLAYER_STATUS.PLAYING:var e=r.nextCommandIndex,n=r.loops,a=r.currentLoop,o=r.timeoutStatus;if(null===e||null===n||0===a)return"";var i=["Line "+(e+1),"Round "+a+"/"+n];if(o&&o.type&&o.total){var s=o.type,c=o.total,l=o.past;i.unshift(s+" "+l/1e3+"s ("+c/1e3+")")}return i.join(" | ");case A.PLAYER_STATUS.PAUSED:return"Player paused";default:return""}default:return""}}())}},{key:"renderActions",value:function(){var e=this,t=this.props,r=t.player,n=t.status,a=c.a.createElement(V.a,{onClick:function(t){switch(t.key){case"play_loop":e.togglePlayLoopsModal(!0)}},selectable:!1},c.a.createElement(V.a.Item,{key:"play_loop",disabled:!1},"Play loop.."));if(n===A.APP_STATUS.RECORDER)return c.a.createElement("div",{className:"actions"},c.a.createElement(_.a,{onClick:this.onToggleRecord,style:{color:"#ff0000"}},c.a.createElement("span",null,"Stop Record")));switch(r.status){case A.PLAYER_STATUS.PLAYING:return c.a.createElement("div",{className:"actions"},c.a.createElement(_.a.Group,null,c.a.createElement(_.a,{onClick:function(){return e.getPlayer().stop()}},c.a.createElement("span",null,"Stop")),c.a.createElement(_.a,{onClick:function(){return e.getPlayer("testCase").pause()}},c.a.createElement("span",null,"Pause"))));case A.PLAYER_STATUS.PAUSED:return c.a.createElement("div",{className:"actions"},c.a.createElement(_.a.Group,null,this.props.player.mode===A.PLAYER_MODE.TEST_CASE?c.a.createElement(_.a,{onClick:function(){return e.getPlayer("testCase").resume(!0)}},"Step"):null,c.a.createElement(_.a,{onClick:function(){return e.getPlayer().stop()}},"Stop"),c.a.createElement(_.a,{onClick:function(){return e.getPlayer("testCase").resume()}},"Resume")));case A.PLAYER_STATUS.STOPPED:return c.a.createElement("div",{className:"actions"},c.a.createElement(_.a,{disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Record),onClick:this.onToggleRecord},c.a.createElement("span",null,"Record")),c.a.createElement(_.a.Group,{className:"play-actions"},c.a.createElement(_.a,{onClick:function(){return e.playCurrentMacro(!0)}},"Step"),c.a.createElement(L.a.Button,{onClick:function(){return e.playCurrentMacro(!1)},overlay:a},c.a.createElement("span",null,"Play Macro"))),c.a.createElement(_.a,{shape:"circle",onClick:function(){return e.showSettingsModal()}},c.a.createElement(R.a,{type:"setting"})))}}},{key:"renderMacro",value:function(){var e=this.props,t=e.editing,r=e.player,n=e.hasUnsaved,a=t.meta.src,o=r.status===A.PLAYER_STATUS.STOPPED,i=n?"unsaved":"",s={text:a?"Save":"Save..",disabled:!n};return c.a.createElement("div",{className:"select-case"},c.a.createElement("span",{className:"test-case-name "+i},a?a.name:"Untitled"),o?c.a.createElement(_.a,{disabled:s.disabled,onClick:this.onClickSave},c.a.createElement("span",null,s.text)):null)}},{key:"render",value:function(){this.props.player.status,A.PLAYER_STATUS.STOPPED;return c.a.createElement("div",{className:"header "+this.props.status.toLowerCase()},this.renderMacro(),this.renderStatus(),this.renderActions(),this.renderPlayLoopModal(),this.renderSettingModal(),this.renderPublicWebsiteWhiteList())}}]),t}(c.a.Component),Ht=Object(P.b)((function(e){return{hasUnsaved:Object(oe.hasUnsavedMacro)(e),route:e.route,editing:e.editor.editing,player:e.player,status:e.status,config:e.config,ui:e.ui,proxy:e.proxy}}),(function(e){return Object(I.b)(Vt({},M,se.Actions),e)}))(Object(d.b)(Gt)),zt=(r(1033),r(405)),qt=r.n(zt),Jt=r(406),Zt=r.n(Jt),Qt=r(142),er=r.n(Qt),tr=r(69),rr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nr=(Yt=fe.a.isFirefox()?1:0,fe.a.bookmarks.getTree().then((function(e){return e[0].children[Yt].id}))),ar=function(e){return nr.then((function(t){return fe.a.bookmarks.create(rr({},e,{parentId:t}))}))},or=r(1),ir=r.n(or),sr=r(194),cr=(r(183),r(507),r(508),r(509),r(510),function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}());function lr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ur(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var dr=function(e){function t(){var e,r,n;lr(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return r=n=ur(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.state={value:"",valueModified:null,errMsg:null},n.onSave=function(){var e=null;try{n.props.validate(n.state.valueModified),n.props.onChange(n.state.valueModified)}catch(t){e=t.message}finally{n.setState({errMsg:e})}},ur(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),cr(t,[{key:"componentDidMount",value:function(){this.setState({value:this.props.value,valueModified:this.props.value})}},{key:"componentWillReceiveProps",value:function(e){e.value!==this.props.value&&this.setState({value:e.value,valueModified:e.value})}},{key:"render",value:function(){var e=this;return c.a.createElement(k.a,{visible:this.props.visible,okText:"Save",onOk:this.onSave,onCancel:this.props.onClose,width:"80%"},c.a.createElement("pre",{style:{color:"red",lineHeight:"18px",marginBottom:"10px"}},this.state.errMsg),c.a.createElement(sr.UnControlled,{className:this.state.sourceErrMsg?"has-error":"no-error",value:this.state.value,onChange:function(t,r,n){return e.setState({valueModified:n})},options:{mode:{name:"javascript",json:!0},lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0}}))}}]),t}(c.a.Component);dr.propTypes={value:ir.a.string.isRequired,onClose:ir.a.func.isRequired,visible:ir.a.bool,validate:ir.a.func,onChange:ir.a.func},dr.defaultProps={visible:!1,validate:function(){return!0},onChange:function(){}};var mr=dr,pr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function fr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gr(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var vr=function(e){function t(){var e,r,n;fr(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return r=n=gr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.state={isEditing:!1},n.onChange=function(e){n.setState({value:e.target.value})},n.onKeyDown=function(e){13===e.keyCode?n.submit():27===e.keyCode&&n.setState({value:n.props.value},n.submit)},n.onBlur=function(e){n.submit()},n.onClickText=function(){n.props.clickToEdit&&n.setState({isEditing:!0})},n.submit=function(){n.setState({isEditing:!1}),n.props.onChange&&n.props.onChange(n.state.value).catch((function(){return!1})).then((function(e){e||n.setState({value:n.props.value})}))},gr(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),hr(t,[{key:"componentDidMount",value:function(){this.setState({isEditing:this.props.isEditing,value:this.props.value}),this.props.isEditing&&this.focusOnInput()}},{key:"componentWillReceiveProps",value:function(e){var t={};this.props.isEditing!==e.isEditing&&(t.isEditing=e.isEditing,t.isEditing&&this.focusOnInput()),this.props.value!==e.value&&(t.value=e.value),this.setState(t)}},{key:"focusOnInput",value:function(){var e=this;setTimeout((function(){var t=e.input.refs.input;t&&(t.focus(),t.selectionStart=0,t.selectionEnd=t.value.length)}),200)}},{key:"render",value:function(){var e=this,t=this.state,r=t.isEditing,n=t.value;return c.a.createElement("div",{className:this.props.className},r?c.a.createElement(K.a,pr({value:n,onChange:this.onChange,onBlur:this.onBlur,onKeyDown:this.onKeyDown,ref:function(t){e.input=t}},this.props.inputProps||{})):c.a.createElement("span",{onClick:this.onClickText},c.a.createElement("span",null,n),this.props.clickToEdit?c.a.createElement(R.a,{type:"edit",style:{marginLeft:"10px"}}):null))}}]),t}(c.a.Component);vr.propTypes={value:ir.a.string,isEditing:ir.a.bool,onChange:ir.a.func,inputProps:ir.a.object,textProps:ir.a.object,className:ir.a.any,clickToEdit:ir.a.bool};var br=vr,yr=r(62),wr=r(195),Er=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cr(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Tr=function(e,t){var r=Object(tr.stringifyTestSuite)({name:e.name,cases:e.cases}),n=new Blob([r],{type:"text/plain;charset=utf-8"});C.a.saveAs(n,"suite_"+e.name+".json",!0)},_r=function(e){var t=Object(tr.toHtml)({name:e.name}),r=new Blob([t],{type:"text/plain;charset=utf-8"});C.a.saveAs(r,e.name+".html",!0)},Or=function(e){function t(){var e,r,n;Sr(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=Cr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={tsContextMenu:{x:null,y:null,isShown:!1},tscContextMenu:{x:null,y:null,isShown:!1},tsEditingNameIndex:-1,editTestSuiteSource:{ts:null,visible:!1}},n.addTestSuite=function(){return Object(be.uniqueName)("__Untitled__",{check:function(e){return!n.props.testSuites.find((function(t){return t.name===e}))}}).then((function(e){return n.props.addTestSuite({name:e,cases:[]})})).catch((function(e){a.a.error(e.message,1.5)}))},n.addTestCaseToTestSuite=function(e){n.props.updateTestSuite(e.id,{cases:e.cases.concat({testCaseId:n.props.macros[0]&&n.props.macros[0].relativePath,loops:1})})},n.removeTestCaseFromTestSuite=function(e,t){var r,a,o,i,s,c;e.cases.splice(t,1),n.props.updateTestSuite(e.id,{cases:e.cases,playStatus:(r=e.playStatus,a=void 0===r?{}:r,o=a.doneIndices,i=void 0===o?[]:o,s=a.errorIndices,c=function(e){return void 0===e||e===t?-1:e>t?e-1:e},{errorIndices:(void 0===s?[]:s).map(c).filter((function(e){return-1!==e})),doneIndices:i.map(c).filter((function(e){return-1!==e}))})})},n.toggleTestSuiteFold=function(e){n.props.updateTestSuite(e.id,{fold:!e.fold})},n.foldAllTestSuites=function(){n.props.testSuites.forEach((function(e){n.props.updateTestSuite(e.id,{fold:!0})}))},n.onClickTestSuiteMore=function(e,t,r){e.stopPropagation(),e.preventDefault();var a={tsContextMenu:{x:e.clientX,y:e.clientY,isShown:!0,ts:t,tsIndex:r}};setTimeout((function(){return n.setState(a)}),20)},n.onClickTsTestCaseMore=function(e,t,r,a,o){e.stopPropagation(),e.preventDefault();var i={tscContextMenu:{x:e.clientX,y:e.clientY,isShown:!0,tc:t,ts:a,tcIndex:r,tsIndex:o}};setTimeout((function(){return n.setState(i)}),20)},n.hideTsContextMenu=function(){n.setState({tsContextMenu:Er({},n.state.tsContextMenu,{isShown:!1})})},n.hideTscContextMenu=function(){n.setState({tscContextMenu:Er({},n.state.tscContextMenu,{isShown:!1})})},n.onTsMenuClick=function(e,t,r){var o=e.key;switch(n.hideTsContextMenu(),o){case"play":Object(ae.b)({name:"testSuite"}).play({title:t.name,extra:{id:t.id,name:t.name},mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,resources:t.cases.map((function(e){return{id:e.testCaseId,loops:e.loops}}))});break;case"edit_source":n.setState({editTestSuiteSource:{ts:t,visible:!0}});break;case"rename":n.setState({tsEditingNameIndex:r});break;case"export":Tr(t,n.props.macros);break;case"create_bookmark":var i=prompt("Title for this bookmark","#"+t.name+".rpa");if(null===i)return;return ar(Object(tr.toBookmarkData)({bookmarkTitle:i,name:t.name})).then((function(){a.a.success("successfully created bookmark!",1.5)}));case"export_html":return fe.a.isFirefox()||fe.a.extension.isAllowedFileSchemeAccess().then((function(e){if(!e){var t='To run test suite from html file, you need to enable "Allow access to file URLs" in extension details page';a.a.warn(t),n.props.addLog("warning",t)}})),_r(t);case"delete":k.a.confirm({title:"Are your sure to delete this test suite?",okText:"Confirm",onOk:function(){return n.props.removeTestSuite(t.id)}})}},n.onTscMenuClick=function(e,t,r,a,o){var i=e.key;switch(n.hideTscContextMenu(),i){case"play_from_here":Object(ae.b)({name:"testSuite"}).play({title:a.name,extra:{id:a.id,name:a.name},mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:r,resources:a.cases.map((function(e){return{id:e.testCaseId,loops:e.loops}}))})}},n.onChangeTsName=function(e,t,r){return n.setState({tsEditingNameIndex:-1}),n.props.updateTestSuite(t.id,{name:e}).then((function(){return!0}),(function(e){return a.a.error(e.message,1.5),!1}))},n.onChangeTsCase=function(e,t,r,a,o){n.props.updateTestSuite(a.id,{cases:Object(ce.setIn)([r,e],t,a.cases)})},n.getTsTestCaseClass=function(e,t){if(!t)return"";var r=t.doneIndices,n=void 0===r?[]:r,a=t.errorIndices,o=void 0===a?[]:a;return e===t.currentIndex?"current-tc":-1!==o.indexOf(e)?"error-tc":-1!==n.indexOf(e)?"done-tc":""},n.onJSONFileChange=function(e){return setTimeout((function(){n.jsonFileInput.value=null}),500),n.onReadFile((function(e){return Object(tr.parseTestSuite)(e)}))(e)},n.onReadFile=function(e){return function(t){var r=[].slice.call(t.target.files);if(r&&r.length){Promise.all(r.map((function(t){return new Promise((function(r,n){var a=new FileReader;a.onload=function(n){try{var a=n.target.result,o=e(a,t.name);r({data:o})}catch(e){r({err:e,fileName:t.name})}},a.readAsText(t)}))}))).then((function(e){var t=e.filter((function(e){return e.data})),r=e.filter((function(e){return e.err}));n.props.addTestSuites(t.map((function(e){return e.data}))).then((function(e){var t=e.passCount,o=e.failCount,i=e.failTcs;a.a.info([t+" test suite"+(t>1?"s":"")+" imported!",r.length+o+" test suite"+(r.length+o>1?"s":"")+" failed!"].join(", "),3),r.forEach((function(e){n.props.addLog("error","in parsing "+e.fileName+": "+e.err.message)})),i.forEach((function(e){n.props.addLog("error","duplicated test suite name: "+e.name)}))}))}))}}},Cr(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),xr(t,[{key:"getPortalContainer",value:function(){var e="__context_menu_container__",t=document.getElementById(e);if(t)return t;var r=document.createElement("div");return r.id=e,document.body.appendChild(r),r}},{key:"renderTestSuiteContextMenu",value:function(){var e=this,t=this.state.tsContextMenu,r=t.x+window.scrollX;r-230>0&&(r-=230);var n={position:"absolute",top:t.y+window.scrollY,left:r,display:t.isShown?"block":"none"},a={width:"230px"},o=c.a.createElement("div",{style:n,className:"context-menu"},c.a.createElement(Zt.a,{onClickOutside:this.hideTsContextMenu},c.a.createElement(V.a,{onClick:function(r){return e.onTsMenuClick(r,t.ts,t.tsIndex)},style:a,mode:"vertical",selectable:!1},c.a.createElement(V.a.Item,{key:"play"},"Play"),c.a.createElement(V.a.Item,{key:"edit_source"},"Edit source.."),c.a.createElement(V.a.Item,{key:"rename"},"Rename.."),c.a.createElement(V.a.Item,{key:"export"},"Export"),c.a.createElement(V.a.Item,{key:"create_bookmark"},"Add to Bookmarks"),c.a.createElement(V.a.Divider,null),c.a.createElement(V.a.Item,{key:"delete"},"Delete"))));return u.a.createPortal(o,this.getPortalContainer())}},{key:"renderTestSuiteCaseContextMenu",value:function(){var e=this,t=this.state.tscContextMenu,r=t.x+window.scrollX;r-150>0&&(r-=150);var n={position:"absolute",top:t.y+window.scrollY,left:r,display:t.isShown?"block":"none"},a={width:"150px"},o=c.a.createElement("div",{style:n,className:"context-menu"},c.a.createElement(Zt.a,{onClickOutside:this.hideTscContextMenu},c.a.createElement(V.a,{onClick:function(r){return e.onTscMenuClick(r,t.tc,t.tcIndex,t.ts,t.tsIndex)},style:a,mode:"vertical",selectable:!1},c.a.createElement(V.a.Item,{key:"play_from_here"},"Replay from here"))));return u.a.createPortal(o,this.getPortalContainer())}},{key:"renderTestSuiteMenu",value:function(){var e=this;return c.a.createElement(V.a,{onClick:function(t){switch(t.key){case"export_all":var r=new er.a;if(0===e.props.testSuites.length)return a.a.error("No saved test suites to export",1.5);var n=Object(ce.nameFactory)();e.props.testSuites.forEach((function(e){var t=n(e.name);r.file(t+".json",Object(tr.stringifyTestSuite)(e))})),r.generateAsync({type:"blob"}).then((function(e){C.a.saveAs(e,"all_suites.zip")}))}},selectable:!1},c.a.createElement(V.a.Item,{key:"export_all"},"Export all (JSON)"),c.a.createElement(V.a.Item,{key:"4"},c.a.createElement("label",{htmlFor:"select_json_files_for_ts"},"Import JSON"),c.a.createElement("input",{multiple:!0,type:"file",accept:".json",id:"select_json_files_for_ts",onChange:this.onJSONFileChange,style:{display:"none"},ref:function(t){e.jsonFileInput=t}})))}},{key:"renderEditTestSuiteSource",value:function(){var e=this;if(!this.state.editTestSuiteSource.visible)return null;var t=this.state.editTestSuiteSource.ts,r=Object(tr.stringifyTestSuite)(t);return c.a.createElement(mr,{visible:!0,value:r,validate:function(t){return Object(tr.validateTestSuiteText)(t,e.props.macros)},onClose:function(){return e.setState({editTestSuiteSource:{visible:!1}})},onChange:function(r){var n=Object(tr.parseTestSuite)(r);e.props.updateTestSuite(t.id,n),e.setState({editTestSuiteSource:{visible:!1}})}})}},{key:"renderTestSuites",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement("div",{className:"test-suite-actions"},c.a.createElement(_.a,{type:"primary",onClick:this.addTestSuite},"+ Test Suite"),c.a.createElement(_.a,{type:"default",onClick:this.foldAllTestSuites},"Fold"),c.a.createElement(L.a,{overlay:this.renderTestSuiteMenu(),trigger:["click"]},c.a.createElement(_.a,{shape:"circle"},c.a.createElement(R.a,{type:"setting"})))),!this.props.config.hidePlayTestSuiteTip&&this.props.testSuites.length>0?c.a.createElement(qt.a,{type:"info",message:"Right click to play test suite",onClose:function(){e.props.updateConfig({hidePlayTestSuiteTip:!0})},closable:!0,showIcon:!0,style:{margin:"10px",paddingRight:"30px"}}):null,this.props.config.hideFolderAsTestSuiteTip?null:c.a.createElement(qt.a,{type:"info",message:c.a.createElement("span",null,"New: ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=folder_as_testsuites",target:"_blank"},"Use folders as test suites")),onClose:function(){e.props.updateConfig({hideFolderAsTestSuiteTip:!0})},closable:!0,showIcon:!0,style:{margin:"10px",paddingRight:"30px"}}),0===this.props.testSuites.length?c.a.createElement("div",{className:"no-data"},"No test suite"):null,c.a.createElement("ul",{className:"sidebar-test-suites"},this.props.testSuites.map((function(t,r){return c.a.createElement("li",{key:t.id,className:Object(ce.cn)("test-suite-item ",{fold:t.fold,playing:t.playStatus&&t.playStatus.isPlaying})},c.a.createElement("div",{className:"test-suite-row",onClick:function(){return e.toggleTestSuiteFold(t)},onContextMenu:function(n){return e.onClickTestSuiteMore(n,t,r)}},c.a.createElement(R.a,{type:t.fold?"folder":"folder-open"}),c.a.createElement(br,{className:"test-suite-title",value:t.name,onChange:function(n){return e.onChangeTsName(n,t,r)},isEditing:r===e.state.tsEditingNameIndex,inputProps:{onClick:function(e){return e.stopPropagation()},onContextMenu:function(e){return e.stopPropagation()}}}),r===e.state.tsEditingNameIndex?null:c.a.createElement(R.a,{type:"bars",className:"more-button",onClick:function(n){return e.onClickTestSuiteMore(n,t,r)}})),t.cases.length>0?c.a.createElement("ul",{className:"test-suite-cases"},t.cases.map((function(n,a){return c.a.createElement("li",{key:a,className:e.getTsTestCaseClass(a,t.playStatus),onContextMenu:function(o){return e.onClickTsTestCaseMore(o,n,a,t,r)}},c.a.createElement(R.a,{type:"file",style:{marginRight:"10px",cursor:"pointer"},onClick:function(){e.props.editing.meta.src;return Object(ie.default)().saveOrNot().then((function(){return e.props.editTestCase(n.testCaseId),Promise.resolve()}))}}),c.a.createElement(G.a,{showSearch:!0,optionFilterProp:"children",value:n.testCaseId,onChange:function(n){return e.onChangeTsCase("testCaseId",n,a,t,r)},filterOption:function(e,t){return-1!==t.props.children.toLowerCase().indexOf(e.toLowerCase())},style:{flex:1,marginRight:"10px",maxWidth:"50%"},dropdownClassName:"macros-dropdown"},e.props.macros.map((function(e){return c.a.createElement(G.a.Option,{value:e.relativePath,key:e.relativePath},e.relativePath.replace(/\.json$/,""))}))),c.a.createElement(K.a,{type:"number",min:1,value:n.loops,onChange:function(n){return e.onChangeTsCase("loops",0===n.target.value.trim().length?"1":n.target.value,a,t,r)},style:{width:"45px",marginRight:"10px"}}),c.a.createElement(R.a,{type:"close",style:{cursor:"pointer"},onClick:function(){return e.removeTestCaseFromTestSuite(t,a)}}))}))):null,c.a.createElement("div",{className:"test-suite-more-actions"},c.a.createElement(_.a,{type:"default",onClick:function(){return e.addTestCaseToTestSuite(t)}},"+ Macro")))}))))}},{key:"render",value:function(){var e=this;return this.props.shouldLoadResources?c.a.createElement("div",null,this.renderTestSuites(),this.renderTestSuiteContextMenu(),this.renderTestSuiteCaseContextMenu(),this.renderEditTestSuiteSource()):c.a.createElement(wr.ResourceNotLoaded,{name:"Test suite list",from:this.props.from,showList:function(){e.props.setFrom(yr.RunBy.Manual)}})}}]),t}(c.a.Component),kr=Object(P.b)((function(e){return{status:e.status,from:e.from,shouldLoadResources:Object(oe.getShouldLoadResources)(e),macros:Object(oe.getMacroFileNodeList)(e),testSuites:Object(oe.getTestSuitesWithAllInfo)(e),editing:e.editor.editing,player:e.player,config:e.config}}),(function(e){return Object(I.b)(Er({},M,se.Actions),e)}))(Or),Pr=r(407),Ir=r.n(Pr),Mr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ar=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nr(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Rr,jr,Lr=function(e){function t(){return Dr(this,t),Nr(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Ar(t,[{key:"render",value:function(){var e=this,t=(this.props.inputProps||{}).value,r=void 0!==t&&t.length>0;return c.a.createElement("span",{className:this.props.className,style:Mr({},this.props.style||{},{position:"relative"})},c.a.createElement(K.a,this.props.inputProps||{}),c.a.createElement(R.a,{type:r?"close":"search",onClick:function(t){r&&e.props.inputProps&&e.props.inputProps.onChange&&e.props.inputProps.onChange({target:{value:""}})},style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",cursor:r?"pointer":"auto"}}))}}]),t}(K.a),Fr=r(137),Vr=r(71),Ur=r(159),Br=r.n(Ur),Xr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),$r=(Rr=[""],jr=[""],Object.freeze(Object.defineProperties(Rr,{raw:{value:Object.freeze(jr)}})));function Yr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wr(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Gr=function(e){function t(){var e,r,n;Yr(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=Wr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={showRename:!1,rename:"",folderToImport:"/"},n.unbindKeydown=function(){},n.onClickRename=function(){n.props.renameTestCase(n.state.rename,n.state.renameTcId).then((function(){a.a.success("successfully renamed!",1.5),n.toggleRenameModal(!1)})).catch((function(e){a.a.error(e.message,1.5)}))},n.onCancelRename=function(){n.toggleRenameModal(!1),n.setState({rename:null})},n.onChangeRename=function(e){n.setState({rename:e.target.value})},n.toggleRenameModal=function(e,t){n.setState({showRename:e,renameTcId:t&&t.fullPath}),e&&setTimeout((function(){var e=n.inputRenameTestCase.refs.input;e.focus(),e.selectionStart=e.selectionEnd=e.value.length}),100)},n.changeTestCase=function(e){return new Promise((function(t){if(n.props.status!==A.APP_STATUS.NORMAL)return t(!1);if(n.props.editing.meta.src&&n.props.editing.meta.src.id===e)return t(!0);var r=function(){n.props.editTestCase(e),t(!0)};return 0!==n.props.editing.commands.length||n.props.editing.meta.src?Object(ie.default)().saveOrNot().then(r):r()}))},n.playTestCase=function(e){n.props.status===A.APP_STATUS.NORMAL&&n.changeTestCase(e).then((function(e){e&&setTimeout((function(){var e=n.props.editing.commands,t=e.find((function(e){return"open"===e.cmd.toLowerCase()})),r=n.props.editing.meta.src,a=function(){return r?r.id:A.UNTITLED_ID};n.props.playerPlay({macroId:a(),title:r&&r.name&&r.name.length?r.name:"Untitled",extra:{id:a()},mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,startUrl:t?t.target:null,resources:e,postDelay:1e3*n.props.player.playInterval})}),500)}))},n.onJsonOrZipFileChange=function(e){return setTimeout((function(){n.jsonFileInput.value=null}),500),n.props.importMacroJsonOrZipFiles(e.target.files,n.state.folderToImport)},n.addTestCase=function(){return Object(ie.default)().saveOrNot().then((function(){n.props.macroCreateFile({dir:"/"})}))},n.onClickMacroNode=function(e,t,r){e.type===Fr.FileNodeType.File&&n.changeTestCase(e.id)},n.onContextMenuNode=function(e,t,r){return n.showContextMenuForEntry(e,r)},n.onToggleNode=function(e,t){return n.props.updateMacroExtra(e.id,{folded:!e.folded})},n.onMoveNode=function(e,t,r){n.props.macroMoveEntry({entryId:e,dirId:t,isSourceDirectory:r})},n.onDoubleClickNode=function(e,t,r){e.type===Fr.FileNodeType.File&&n.playTestCase(e.id)},Wr(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Kr(t,[{key:"componentDidMount",value:function(){this.bindKeydown()}},{key:"bindKeydown",value:function(){var e=this,t=function(t){if(e.props.canUseKeyboardShortcuts&&!(t.ctrlKey||t.altKey||t.metaKey||t.shiftKey))switch(Ir()(t)){case"up":return t.preventDefault(),e.props.editMacroByOffset(-1);case"down":return t.preventDefault(),e.props.editMacroByOffset(1)}};document.addEventListener("keydown",t,!0),this.unbindKeydown=function(){return document.removeEventListener("keydown",t,!0)}}},{key:"renderMacros",value:function(){var e=this.props.filteredMacroFileNodeData;return this.props.isLoadingMacros&&this.props.isMacroFolderNodeListEmpty?c.a.createElement("div",{className:"no-data"},"Loading macros..."):c.a.createElement("div",{className:"sidebar-macros"},0===e.length?c.a.createElement("div",{className:"no-data"},"No macro found"):null,c.a.createElement(Fr.FileTree,{nodes:e,rootPath:Object(pe.getStorageManager)().getMacroStorage().dirPath(""),onClick:this.onClickMacroNode,onContextMenu:this.onContextMenuNode,onToggle:this.onToggleNode,onMove:this.onMoveNode,onDoubleClick:this.onDoubleClickNode}))}},{key:"showContextMenuForEntry",value:function(e,t){switch(e.type){case Fr.FileNodeType.File:return this.showContextMenuForMacro(e,t);case Fr.FileNodeType.Folder:return this.showContextMenuForFolder(e,t)}}},{key:"showContextMenuForFolder",value:function(e,t){var r=this;return t.stopPropagation(),t.preventDefault(),Object(Vr.showContextMenu)({x:t.clientX,y:t.clientY,onHide:function(){},menuItems:[{type:Vr.MenuItemType.Button,disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit),data:{content:"New macro",onClick:function(){return Object(ie.default)().saveOrNot().then((function(){r.props.macroCreateFile({dir:e.entryPath})}))}}},{type:Vr.MenuItemType.Button,data:{content:"New folder",onClick:function(){r.props.macroCreateFolder({name:"untitled",dir:e.entryPath})}}},{type:Vr.MenuItemType.Button,data:{content:"Rename",onClick:function(){r.props.macroRenameFolder({dir:e.entryPath})}}},{type:Vr.MenuItemType.Button,data:{content:"Delete",onClick:function(){r.props.macroDeleteFolder({dir:e.entryPath})}}},{type:Vr.MenuItemType.Divider,data:{}},{type:Vr.MenuItemType.Button,data:{content:"Testsuite: Play all in folder",onClick:function(){var t=e.name,r=e.children.filter((function(e){return e.type===Fr.FileNodeType.File}));Object(ae.b)({name:"testSuite"}).play({title:t,mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,resources:r.map((function(e){return{id:e.id,loops:1}})),extra:{id:e.id,name:t}})}}},{type:Vr.MenuItemType.Button,data:{content:"Testsuite: Play in loop",onClick:function(){var t=function(t){var r=parseInt(t);if(isNaN(r)||r<1)throw new Error("Invalid loops: "+t);var n=e.name,a=e.children.filter((function(e){return e.type===Fr.FileNodeType.File}));Object(ae.b)({name:"testSuite"}).play({title:n,mode:1===r?Object(ae.b)().C.MODE.STRAIGHT:Object(ae.b)().C.MODE.LOOP,loopsStart:1,loopsEnd:r,startIndex:0,resources:a.map((function(e){return{id:e.id,loops:1}})),extra:{id:e.id,name:n}})};return function e(){return Object(tt.prompt)({width:400,title:"How many loops?",message:"",value:"2",placeholder:"Loops",inputType:"number",selectionStart:0,selectionEnd:1,okText:"Play",cancelText:"Cancel",onCancel:function(){return Promise.resolve(!0)},onOk:t}).catch((function(t){a.a.error(t.message),setTimeout(e,0)}))}()}}},{type:Vr.MenuItemType.Divider,data:{}},{type:Vr.MenuItemType.Button,data:{content:"Import JSON or ZIP",onClick:function(){var t=document.getElementById("select_json_files_for_macros");t&&(r.setState({folderToImport:e.entryPath}),t.click())}}}]})}},{key:"showContextMenuForMacro",value:function(e,t){var r=this,n=this.props.macros.find((function(t){return t.fullPath===e.id}));if(n){t.stopPropagation(),t.preventDefault();var o={clientX:t.clientX,clientY:t.clientY,stopPropagation:function(){},preventDefault:function(){}};return Object(Vr.showContextMenu)({x:o.clientX,y:o.clientY,onHide:function(){},menuItems:[{type:Vr.MenuItemType.Button,data:{content:"Play",onClick:function(){r.playTestCase(n.fullPath)}}},{type:Vr.MenuItemType.Button,data:{content:"Testsuite: Play from here",onClick:function(){var t=Object(pe.getStorageManager)().getMacroStorage(),r=t.getPathLib(),n=r.dirname(e.entryPath);return t.list(n).then((function(t){var a=t.filter((function(e){return e.isFile})),o=a.findIndex((function(t){return t.fullPath===e.entryPath}));if(-1!==o){var i=r.basename(n);Object(ae.b)({name:"testSuite"}).play({title:i,mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:o,resources:a.map((function(e){return{id:e.fullPath,loops:1}})),extra:{id:n,name:i}})}}))}}},{type:Vr.MenuItemType.Button,data:{content:"Rename..",onClick:function(){return Object(ie.default)().saveOrNot().then((function(){r.setState({rename:n.name}),r.toggleRenameModal(!0,n)}))}}},{type:Vr.MenuItemType.Button,disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit),data:{content:"Duplicate..",onClick:function(){return Object(ie.default)().saveOrNot().then((function(){r.props.duplicateTestCase(n)}))}}},{type:Vr.MenuItemType.Button,data:{content:"Export as JSON",onClick:function(){r.props.downloadMacroAsJson(n.fullPath)}}},{type:Vr.MenuItemType.Button,data:{content:"Export as ZIP (json, img & csv)",onClick:function(){r.props.downloadMacroAsZip(n.fullPath)}}},{type:Vr.MenuItemType.Button,data:{content:"Create autorun HTML",onClick:function(){var e,t;fe.a.isFirefox()||fe.a.extension.isAllowedFileSchemeAccess().then((function(e){if(!e){var t='To run macro from html file, you need to enable "Allow access to file URLs" in extension details page';a.a.warn(t),r.props.addLog("warning",t)}})),e=Object(Nt.generateEmptyHtml)(),t=new Blob([e],{type:"text/plain;charset=utf-8"}),C.a.saveAs(t,"ui.vision.html",!0),function(e){var t=Object(Nt.generateMacroEntryHtml)(e.relativePath),r=new Blob([t],{type:"text/plain;charset=utf-8"});C.a.saveAs(r,"start-"+e.name+".html",!0)}(n)}}},{type:Vr.MenuItemType.Button,data:{content:"Add shortcut to bookmarks bar",onClick:function(){var e=window.prompt("Title for this bookmark","#"+n.name+".rpa");null!==e&&ar(Object(Nt.toBookmarkData)({bookmarkTitle:e,path:n.relativePath})).then((function(){a.a.success("successfully created bookmark!",1.5)}))}}},Object(pe.getStorageManager)().isXFileMode()?{type:Vr.MenuItemType.Button,data:{content:"Copy to Local Storage",onClick:function(){Object(pe.getStorageManager)().isStrategyTypeAvailable(pe.StorageStrategyType.Browser).then((function(){var e=Object(pe.getStorageManager)().getStorageForTarget(pe.StorageTarget.Macro,pe.StorageStrategyType.Browser);return Object(pe.getStorageManager)().getStorageForTarget(pe.StorageTarget.Macro,pe.StorageStrategyType.XFile).read(n.fullPath,"Text").then((function(t){var r=Xr({},t,{id:Object(be.uid)()});return delete r.status,e.write(r.name,r).then((function(){return a.a.success("copied")}))}))})).catch((function(e){a.a.warn(e.message)}))}}}:null,Object(pe.getStorageManager)().isBrowserMode()?{type:Vr.MenuItemType.Button,data:{content:"Copy to Macro Folder",onClick:function(){Object(pe.getStorageManager)().isStrategyTypeAvailable(pe.StorageStrategyType.XFile).then((function(){var e=Object(pe.getStorageManager)().getStorageForTarget(pe.StorageTarget.Macro,pe.StorageStrategyType.XFile);return Object(pe.getStorageManager)().getStorageForTarget(pe.StorageTarget.Macro,pe.StorageStrategyType.Browser).read(n.fullPath,"Text").then((function(t){var r=Xr({},t,{id:Object(be.uid)()});return delete r.status,e.write(r.name,r).then((function(){return a.a.success("copied")}))}))})).catch((function(e){$e.a.error(e),r.props.updateUI({showXFileNotInstalledDialog:1})}))}}}:null,{type:Vr.MenuItemType.Divider,data:{}},{type:Vr.MenuItemType.Button,disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit),data:{content:"Delete",onClick:function(){k.a.confirm({title:"Sure to delete?",content:'Do you really want to delete "'+n.name+'"?',okText:"Delete",cancelText:"Cancel",onOk:function(){return r.props.removeTestCase(n.fullPath).then((function(){a.a.success("successfully deleted!",1.5)})).catch((function(e){k.a.warning({title:"Failed to delete",content:e.message})}))},onCancel:function(){}})}}}].filter((function(e){return e}))})}}},{key:"renderTestCaseMenu",value:function(){var e=this;return c.a.createElement(V.a,{onClick:function(t){switch(t.key){case"new_macro_folder":e.props.macroCreateFolder({name:"untitled",dir:"/"});break;case"export_all_json":var r=Object(pe.getStorageManager)().getMacroStorage().getPathLib(),n=new er.a;return 0===e.props.macros.length?a.a.error("No saved macros to export",1.5)($r):Promise.all(e.props.macros.map((function(t){var a,o=r.dirname(t.relativePath),i=r.basename(t.relativePath),s=(a=n,o.split(/\/|\\/g).reduce((function(e,t){return e.folder(t)}),a));return Object(pe.getStorageManager)().getMacroStorage().read(t.fullPath,"Text").then((function(t){s.file(i,Object(Nt.toJSONString)({name:t.name,commands:t.data.commands},{ignoreTargetOptions:e.props.ignoreTargetOptions}))}))}))).then((function(){return n.generateAsync({type:"blob"}).then((function(e){C.a.saveAs(e,"all_test_cases.zip")}))}));case"import_json":var o=document.getElementById("select_json_files_for_macros");o&&(e.setState({folderToImport:"/"}),o.click())}},selectable:!1},c.a.createElement(V.a.Item,{key:"new_macro_folder"},"New Folder"),c.a.createElement(V.a.Divider,null),c.a.createElement(V.a.Item,{key:"import_json"},"Import JSON or ZIP"))}},{key:"renderRenameModal",value:function(){var e=this;return c.a.createElement(k.a,{title:"Rename the macro as..",okText:"Save",cancelText:"Cancel",visible:this.state.showRename,onOk:this.onClickRename,onCancel:this.onCancelRename,className:"rename-modal"},c.a.createElement(K.a,{style:{width:"100%"},value:this.state.rename,onKeyDown:function(t){13===t.keyCode&&e.onClickRename()},onChange:this.onChangeRename,placeholder:"macro name",ref:function(t){e.inputRenameTestCase=t}}))}},{key:"renderShowListAction",value:function(){var e=this;return c.a.createElement(wr.ResourceNotLoaded,{name:"Macro list",from:this.props.from,showList:function(){e.props.setFrom(yr.RunBy.Manual)}})}},{key:"render",value:function(){var e=this;return this.props.shouldLoadResources?this.props.isPlaying&&this.props.macros.length>E.a.performanceLimit.fileCount?c.a.createElement("div",{className:"hidden-during-replay"},Br.a.contentHidden):c.a.createElement("div",null,c.a.createElement("input",{multiple:!0,type:"file",accept:".json, .zip",id:"select_json_files_for_macros",onChange:this.onJsonOrZipFileChange,ref:function(t){e.jsonFileInput=t},style:{display:"none"}}),c.a.createElement("div",{className:"test-case-actions"},c.a.createElement(_.a,{type:"primary",disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit),onClick:this.addTestCase},"+ Macro"),c.a.createElement(L.a,{overlay:this.renderTestCaseMenu(),trigger:["click"]},c.a.createElement(_.a,{shape:"circle"},c.a.createElement(R.a,{type:"folder-add"}))),c.a.createElement(Lr,{style:{flex:1},inputProps:{placeholder:"search macro",value:this.props.searchText,onChange:function(t){return e.props.setMacroQuery(t.target.value)}}})),this.renderMacros(),this.renderRenameModal()):this.renderShowListAction()}}]),t}(c.a.Component),Hr=Object(P.b)((function(e){return{status:e.status,from:e.from,shouldLoadResources:Object(oe.getShouldLoadResources)(e),isLoadingMacros:e.isLoadingMacros,isMacroFolderNodeListEmpty:Object(oe.isMacroFolderNodeListEmpty)(e),macroFileNodeData:Object(oe.getMacroFileNodeData)(e),macros:Object(oe.getMacroFileNodeList)(e),isPlaying:Object(oe.isPlaying)(e),testSuites:e.editor.testSuites,editing:e.editor.editing,player:e.player,config:e.config,ignoreTargetOptions:Object(oe.getShouldSaveAlternativeLocators)(e),searchText:e.macroQuery,filteredMacroFileNodeData:Object(oe.getFilteredMacroFileNodeData)(e),canUseKeyboardShortcuts:Object(oe.isFocusOnSidebar)(e)&&"test_suites"!==e.ui.sidebarTab}}),(function(e){return Object(I.b)(Xr({},M,se.Actions),e)}))(Gr),zr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qr=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Jr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zr(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Qr=function(e){function t(){var e,r,n;Jr(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=Zr(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={drag:{isDragging:!1,startX:0,movingX:0,lastWidth:260,currentMinWidth:260}},n.getSideBarMinWidth=function(){var e=n.state.drag,t=e.isDragging,r=e.lastWidth,a=e.currentMinWidth;return(t?a:r)+"px"},n.onResizeDragStart=function(e){e.dataTransfer.setData("text","");var t=window.getComputedStyle(n.$dom),r=parseInt(t.width);n.setState(Object(ce.setIn)(["drag"],{isDragging:!0,startX:e.screenX,lastWidth:r,currentWidth:r},n.state))},n.onResizeDragEnd=function(e){var t=e.screenX-n.state.drag.startX+n.state.drag.lastWidth;n.setState(Object(ce.setIn)(["drag"],{isDragging:!1,startX:0,lastWidth:t,currentMinWidth:t}))},n.onTryToChangeStorageMode=function(e){var t=Object(pe.getStorageManager)();t.isStrategyTypeAvailable(e).then((function(r){if(r)return n.props.updateConfig({storageMode:e}),t.setCurrentStrategyType(e);throw new Error("It should be impossible to get isOk as false")})).catch((function(e){a.a.warn(e.message),e.message&&/xFile is not installed yet/.test(e.message)?n.props.updateUI({showXFileNotInstalledDialog:!0}):n.props.updateUI({showSettings:!0,settingsTab:"xmodules"})}))},n.openRegisterSettings=function(e){e&&e.preventDefault&&e.preventDefault(),n.props.updateUI({showSettings:!0,settingsTab:"register"})},n.onClickSidebar=function(){n.props.updateUI({focusArea:yr.FocusArea.Sidebar})},Zr(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),qr(t,[{key:"componentDidMount",value:function(){var e=Object(pe.getStorageManager)().getCurrentStrategyType();this.setState({storageMode:e})}},{key:"prefixHardDisk",value:function(e){return Object(pe.getStorageManager)().isXFileMode()?c.a.createElement("div",{style:{display:"inline-block"}},c.a.createElement("img",{src:"./img/hard-drive.svg",style:{position:"relative",top:"3px",marginRight:"5px",height:"15px"}}),c.a.createElement("span",null,e)):e}},{key:"renderXFileNotInstalledModal",value:function(){var e=this;return c.a.createElement(k.a,{title:"",className:Object(ce.cn)("xfile-not-installed-modal",{"left-bottom":!0===this.props.ui.showXFileNotInstalledDialog}),width:350,footer:null,visible:this.props.ui.showXFileNotInstalledDialog,onCancel:function(){e.props.updateUI({showXFileNotInstalledDialog:!1})}},c.a.createElement("p",null,"XFileAccess Module not installed."),c.a.createElement("div",null,c.a.createElement(_.a,{type:"primary",onClick:function(){e.props.updateUI({showXFileNotInstalledDialog:!1,showSettings:!0,settingsTab:"xmodules"})}},"Open Settings")))}},{key:"shouldRenderMacroNote",value:function(){var e=this.props.config,t=e.xmodulesStatus;if(e.storageMode!==pe.StorageStrategyType.XFile)return!1;if("pro"===t)return!1;var r=Object(pe.getStorageManager)().getMacroStorage();return r.getDisplayCount()<r.getTotalCount()}},{key:"renderMacroNote",value:function(){if(!this.shouldRenderMacroNote())return null;var e=Object(ft.getLicenseService)().getMaxXFileMacros(),t=Object(ft.getLicenseService)().getUpgradeUrl();return c.a.createElement("div",{className:"note-for-macros"},Object(ft.getLicenseService)().hasNoLicense()?c.a.createElement("div",null,"XModules Free Edition:",c.a.createElement("br",null),"Only the first ",e," files/folders are displayed.",c.a.createElement("br",null),c.a.createElement("a",{href:t,onClick:this.openRegisterSettings},"Upgrade to PRO")," to add more."):null,Object(ft.getLicenseService)().isPersonalLicense()?c.a.createElement("div",null,"XModules PRO1 Edition:",c.a.createElement("br",null),"Only the first ",e," files/folders displayed.",c.a.createElement("br",null),c.a.createElement("a",{href:t,onClick:this.openRegisterSettings},"Upgrade to PRO2 or Enterprise")," for unlimited files"):null)}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:Object(ce.cn)("sidebar",{"with-xmodules-note":this.shouldRenderMacroNote()}),ref:function(t){e.$dom=t},style:{minWidth:this.getSideBarMinWidth()},onClickCapture:this.onClickSidebar},c.a.createElement("div",{className:Object(ce.cn)("sidebar-inner",{"no-tab":!this.props.config.showTestCaseTab})},this.props.config.showTestCaseTab?c.a.createElement(B.a,{defaultActiveKey:"macros",activeKey:this.props.ui.sidebarTab||"macros",onChange:function(t){return e.props.updateUI({sidebarTab:t})}},c.a.createElement(B.a.TabPane,{tab:this.prefixHardDisk("Macros"),key:"macros"},c.a.createElement(Hr,null)),c.a.createElement(B.a.TabPane,{tab:this.prefixHardDisk("Test Suites"),key:"test_suites"},c.a.createElement(kr,null))):c.a.createElement(Hr,null)),c.a.createElement("div",{className:"sidebar-storage-mode"},this.renderMacroNote(),c.a.createElement("div",{className:"storage-mode-header"},c.a.createElement("h3",null,"Storage Mode"),Object(pe.getStorageManager)().isXFileMode()?c.a.createElement("img",{src:"./img/reload.svg",title:"Reload all resources on hard drive",style:{height:"15px",cursor:"pointer"},onClick:function(){Object(pe.getStorageManager)().emit(pe.StorageManagerEvent.ForceReload),a.a.info("reloaded from hard drive")}}):null,c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=storage_mode",target:"_blank"},"More Info")),c.a.createElement(G.a,{style:{width:"100%"},placeholder:"Storage Mode",value:this.props.config.storageMode,onChange:this.onTryToChangeStorageMode},c.a.createElement(G.a.Option,{value:pe.StorageStrategyType.Browser},"Local Storage (in browser)"),c.a.createElement(G.a.Option,{value:pe.StorageStrategyType.XFile},"File system (on hard drive)"))),c.a.createElement("div",{className:Object(ce.cn)("resize-handler",{focused:this.state.drag.isDragging}),draggable:"true",onDragStart:this.onResizeDragStart,onDragEnd:this.onResizeDragEnd,onMouseDown:function(){return e.setState(Object(ce.setIn)(["drag","isDragging"],!0,e.state))}}),this.renderXFileNotInstalledModal())}}]),t}(c.a.Component),en=Object(P.b)((function(e){return{status:e.status,testSuites:e.editor.testSuites,editing:e.editor.editing,player:e.player,config:e.config,ui:e.ui}}),(function(e){return Object(I.b)(zr({},M),e)}))(Qr),tn=(r(1036),r(408)),rn=r.n(tn),nn=r(643),an=r.n(nn),on=r(644),sn=r(645),cn=r(49),ln=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},un=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function dn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var hn={cmd:"",target:"",value:""},fn=[hn],gn=E.a.ui.commandItemHeight,vn=function(e){function t(){var e,r,n,o,i,s;mn(this,t);for(var l=arguments.length,u=Array(l),d=0;d<l;d++)u[d]=arguments[d];return r=n=pn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.state={cursor:null,contextMenu:{x:null,y:null,isShown:!1},visionFindPreview:{visible:!1,url:null,timer:null,left:-9999,top:-9999},targetEditor:{visible:!1,text:""}},n.resetSourceCodeCursor=function(e){return ln({},e?{cursor:{line:0,ch:0}}:{})},n.onDetailChange=function(e,t){n.props.updateSelectedCommand(dn({},e,t))},n.onChangeCommandsView=function(e){switch(e){case"table_view":case"source_view":var t=n.props.sourceErrMsg?"source_view":e;n.props.setEditorActiveTab(t),"source_view"===e&&n.codeMirror&&n.state.cursor&&setTimeout((function(){n.codeMirror.setCursor(n.state.cursor,!0,!0)}),200)}},n.onSourceBlur=function(){var e=n.props,t=e.sourceTextModified;e.sourceText;n.props.saveSourceCodeToEditing(t)},n.onChangeEditSource=function(e,t,r){n.props.setSourceCurrent(r)},n.onClickFind=function(){var e=n.state.lastOperation,t=n.props.selectedCommand;new Promise((function(r,a){switch(t.cmd){case"visualGetPixelColor":case"visionFind":case"visualSearch":case"visualAssert":case"visualVerify":case"visionLimitSearchArea":case"visionLimitSearchAreaRelative":case"XClick":case"XClickRelative":case"XMove":case"XMoveRelative":case"OCRExtract":case"OCRExtractRelative":case"OCRSearch":var o=n.props.editing.meta.selectedIndex;return n.waitBeforeScreenCapture().then((function(){return n.playLine(o,{overrideScope:{"!TIMEOUT_WAIT":0},commandExtra:{throwError:!0,debugVisual:!0}}),r(!0)}));default:return D.default.ask("PANEL_HIGHLIGHT_DOM",{lastOperation:e,locator:t.target}).then(r,a)}})).catch((function(e){a.a.error(e.message,1.5)}))},n.onToggleSelect=function(){var e=n.props,t=e.selectedCommand,r=e.config;new Promise((function(e,a){var o=function(){n.props.status===A.APP_STATUS.INSPECTOR?n.props.stopInspecting():n.props.startInspecting(),e(!0)},i=function(){var t=Object(ye.isCVTypeForDesktop)(r.cvScope);return n.waitBeforeScreenCapture().then((function(){return t?D.default.ask("PANEL_SELECT_AREA_ON_DESKTOP"):D.default.ask("PANEL_SELECT_AREA_ON_CURRENT_PAGE")})).then((function(e){return n.props.renameVisionImage(e.fileName)})).then(e,a)};switch(t.cmd){case"visionFind":case"visualSearch":case"visualAssert":case"visualVerify":case"OCRExtract":case"OCRExtractRelative":case"visionLimitSearchAreaRelative":case"XClickRelative":case"XMoveRelative":case"XMove":return i();case"OCRSearch":throw new Error("No select possible in OCR mode, just enter the text");case"XClick":if(/^ocr=/i.test(t.target))throw new Error("No select possible in OCR mode, just enter the text");return i();case"visionLimitSearchArea":return Object(ye.isCVTypeForDesktop)(r.cvScope)?i():o();default:return o()}})).catch((function(e){a.a.error(e.message)}))},n.onKeyDown=function(e){if(n.props.canUseKeyboardShortcuts&&-1===["INPUT","TEXTAREA"].indexOf(e.target.tagName)){var t=Ir()(e.keyCode),r=Object(be.isMac)()?e.metaKey:e.ctrlKey,a=!(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey);if(r)switch(t){case"c":return n.props.copyCurrentCommand();case"x":return n.props.cutCurrentCommand();case"v":return n.props.pasteAtCurrentCommand()}if(a)switch(t){case"delete":case"backspace":var o=n.props.editing.meta.selectedIndex;if(-1===o)return;return n.props.removeCommand(o);case"up":if(null!==n.props.selectedCommandIndex){var i=Math.max(0,n.props.selectedCommandIndex-1);n.selectCommandAndScroll(i)}break;case"down":if(null!==n.props.selectedCommandIndex){var s=Math.min(n.props.commandCount-1,n.props.selectedCommandIndex+1);n.selectCommandAndScroll(s)}}}},n.onDoubleClick=(o=void 0,i=void 0,s=void 0,function(e){var t=1*new Date;o===e.screenX&&i===e.screenY&&t-s<300&&"BUTTON"!==e.target.tagName&&function(){var t=cn.a.parentWithClass("real-command",e.target);if(t){var r=parseInt(t.getAttribute("data-index"));isNaN(r)||n.playLine(r)}}(),o=e.screenX,i=e.screenY,s=t}),n.onMoveCommand=function(e,t){n.props.moveCommands(e,t)},n.onStartDraggingCommand=function(){n.props.setIsDraggingCommand(!0)},n.onEndDraggingCommand=function(){n.props.setIsDraggingCommand(!1)},n.scheduleHideVisionFindPreview=function(){$e()("scheduleHideVisionFindPreview");var e=n.state.visionFindPreview.timer;return clearTimeout(e),setTimeout((function(){n.state.visionFindPreview.visible&&($e()("to hide preview"),n.setState({visionFindPreview:{visible:!1}}))}),3e3)},n.onMouseEnterTarget=function(e,t){if($e()("onMouseOverTarget"),n.commandHasVisionImage(t)&&!n.state.visionFindPreview.visible){clearTimeout(n.state.visionFindPreview.timer);var r=Object(pe.getStorageManager)().getVisionStorage(),a=e.target.getBoundingClientRect(),o=t.target.trim().split("@")[0],i={visible:!0,left:a.left,top:a.top+a.height};r.exists(o).then((function(e){return e?r.getLink(o).then((function(e){return n.setState({visionFindPreview:ln({},i,{url:e,timer:n.scheduleHideVisionFindPreview()})})})):n.setState({visionFindPreview:ln({},i,{url:"./img/not_found.png",timer:n.scheduleHideVisionFindPreview()})})}))}},n.onMouseLeaveTarget=function(e,t){$e()("onMouseOutTarget"),n.commandHasVisionImage(t)&&n.state.visionFindPreview.visible&&(clearTimeout(n.state.visionFindPreview.timer),n.setState({visionFindPreview:{visible:!1}}))},n.jumpToSourceCode=function(e){n.props.setEditorActiveTab("source_view"),setTimeout((function(){for(var t=n.props.editing.commands,r=n.state.cmEdtiorInstance,a=document.querySelector(".source-view"),o=parseInt(window.getComputedStyle(a).height,10),i=(o-60)/2,s=function(e){return 6+(e.targetOptions?e.targetOptions.length+2:0)},c=4,l=0;l<e;l++)c+=s(t[l]);var u=c+s(t[e]);$e()("margin",i,o),r.scrollIntoView({ch:0,line:c},i),r.setSelection({ch:0,line:c},{ch:0,line:u},{scroll:!1})}),100)},n.commandClassName=function(e,t){var r=n.props,a=r.editing,o=r.player,i=r.breakpointIndices,s=r.doneCommandIndices,c=r.errorCommandIndices,l=r.warningCommandIndices,u=o.nextCommandIndex,d=(a.commands,[]);return-1!==i.indexOf(t)&&d.push("breakpoint-command"),"comment"!==e.cmd&&""!==e.cmd||d.push("comment-command"),n.props.canUseKeyboardShortcuts||d.push("blur"),t===u?d.push("running-command"):-1!==l.indexOf(t)?d.push("warning-command"):-1!==c.indexOf(t)?d.push("error-command"):-1!==s.indexOf(t)&&d.push("done-command"),t===a.meta.selectedIndex&&d.push("selected-command"),d.join(" ")},n.needVirtualList=function(){var e=n.props.editing.commands;return(void 0===e?[]:e).length>=0},n.virtualCommmandList=function(e){var t=e.virtual,r=e.itemHeight,a=n.props.editing.commands,o=n.isPlayerStopped()&&Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit);return c.a.createElement("div",{style:t.style},t.items.map((function(e,t){return e.header?c.a.createElement("div",{className:"command-row header-row",key:"header"},c.a.createElement("div",{className:"row-col index-col"}),c.a.createElement("div",{className:"row-col command-col"},"Command"),c.a.createElement("div",{className:"row-col target-col"},"Target"),c.a.createElement("div",{className:"row-col value-col"},"Value"),c.a.createElement("div",{className:"row-col op-col"},"Ops")):e.footer?c.a.createElement("div",{className:"command-row footer-row",key:"footer",onClick:function(){Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)&&(n.props.updateUI({focusArea:yr.FocusArea.CommandTable}),n.props.insertCommand(hn,a.length))}},"Add"):c.a.createElement(sn.CommandItem,{key:e.key,index:e.realIndex+1,command:e,style:{height:r+"px"},className:"command-row real-command "+n.commandClassName(e,e.realIndex),attributes:{"data-index":""+e.realIndex},editable:o,onClick:function(e,t){return n.onClickCommand(e,t)},onContextMenu:function(e,t){return n.onContextMenu(e,t.realIndex)},onToggleComment:function(e,t){n.props.toggleComment(t.realIndex),e.stopPropagation()},onDuplicate:function(e,t){n.props.duplicateCommand(t.realIndex),e.stopPropagation()},onMouseEnterTarget:n.onMouseEnterTarget,onMouseLeaveTarget:n.onMouseLeaveTarget,onMoveCommand:n.onMoveCommand,onDragStart:n.onStartDraggingCommand,onDragEnd:n.onEndDraggingCommand})})))},n.onContextMenu=function(e,t){$e()("onContextMenu"),n.setState({contextMenu:{x:e.clientX,y:e.clientY,isShown:!0,commandIndex:t}}),n.props.selectCommand(t,!0),e.preventDefault(),e.stopPropagation()},n.onHideMenu=function(e){0===e.button&&n.setState({contextMenu:ln({},n.state.contextMenu,{isShown:!1})})},n.onClickCommand=function(e,t){n.props.updateUI({focusArea:yr.FocusArea.CommandTable}),n.props.selectCommand(t.realIndex,!0)},n.getTestCaseName=function(){var e=n.props.editing.meta.src;return e&&e.name&&e.name.length?e.name:"Untitled"},n.playLine=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.props.editing.commands,a=n.props.editing.meta.src;return n.setState({lastOperation:"play"}),n.props.playerPlay(ln({macroId:a&&a.id,title:n.getTestCaseName(),extra:{id:a&&a.id},mode:ae.a.C.MODE.SINGLE,startIndex:e,startUrl:null,resources:r,postDelay:1e3*n.props.config.playCommandInterval},t))},pn(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),un(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideMenu),document.addEventListener("click",this.onDoubleClick),document.addEventListener("keydown",this.onKeyDown)}},{key:"componentWillReceiveProps",value:function(e){if(e.editing.meta.src!==this.props.editing.meta.src||e.editing.commands!==this.props.editing.commands){var t=e.editing.meta.src!==this.props.editing.meta.src;this.setState(this.resetSourceCodeCursor(t))}if(e.status===A.APP_STATUS.PLAYER&&e.player.nextCommandIndex!==this.props.player.nextCommandIndex){var r=document.querySelector(".table-wrapper"),n=gn;if(!r)return;r.scrollTop=n*e.player.nextCommandIndex}if(e.status===A.APP_STATUS.RECORDER&&e.editing.commands.length>this.props.editing.commands.length){var a=document.querySelector(".table-wrapper"),o=gn;if(!a)return;setTimeout((function(){a.scrollTop=o*e.editing.commands.length*2}),100)}}},{key:"isPlayerStopped",value:function(){return this.props.player.status===A.PLAYER_STATUS.STOPPED}},{key:"waitBeforeScreenCapture",value:function(){return Object(ye.isCVTypeForDesktop)(this.props.config.cvScope)&&this.props.config.waitBeforeDesktopScreenCapture&&this.props.config.secondsBeforeDesktopScreenCapture>0?(a.a.info("About to take desktop screenshot in "+this.props.config.secondsBeforeDesktopScreenCapture+" seconds"),Object(be.delay)((function(){}),1e3*this.props.config.secondsBeforeDesktopScreenCapture)):Promise.resolve()}},{key:"isSelectedCommandVisualSearch",value:function(e){var t=this.props,r=t.editing,n=t.config,a=r.commands,o=r.meta.selectedIndex,i=a&&a.length?a:fn,s=e||i[o];return!(!s||(!Object(ye.isCVTypeForDesktop)(n.cvScope)||"visionLimitSearchArea"!==s.cmd)&&-1===["visionFind","visualSearch","visualAssert","visualVerify","XClick","XMove","XClickRelative","XMoveRelative","OCRExtract","OCRExtractRelative","visionLimitSearchAreaRelative"].indexOf(s.cmd))}},{key:"commandHasVisionImage",value:function(e){if(!this.isSelectedCommandVisualSearch(e))return!1;return!(-1!==["XClick","XClickRelative","XMove","XMoveRelative","OCRExtract","OCRExtractRelative","visionLimitSearchArea","visionLimitSearchAreaRelative"].indexOf(e.cmd)&&!/\.png/i.test(e.target))}},{key:"selectCommandAndScroll",value:function(e){this.props.selectCommand(e,!0),this.props.scrollToCommandAtIndex(e)}},{key:"renderVisionFindPreview",value:function(){var e=this.state.visionFindPreview,t=e.visible,r=e.url,n=e.left,a=e.top;return t?c.a.createElement("div",{style:{position:"absolute",width:"100px",height:"100px",border:"1px solid #ccc",left:n+"px",top:a+"px",backgroundColor:"#eee",backgroundImage:"url("+r+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}):null}},{key:"renderContextMenu",value:function(){var e=this,t=this.props,r=t.clipboard,n=t.status,a=this.state.contextMenu,o=n===A.APP_STATUS.NORMAL,i=document.documentElement.clientWidth,s=(document.documentElement.clientHeight,a.x+window.scrollX),l=a.y+window.scrollY;if(!o)return null;s+240>i&&(s-=240);var u={position:"absolute",top:l,left:s,display:a.isShown?"block":"none"},d={width:"240px"},m=a.commandIndex,p=-1!==this.props.breakpointIndices.indexOf(m),h=Object(be.isMac)()?"⌘":"CTRL-";return c.a.createElement("div",{style:u,id:"context_menu"},c.a.createElement(V.a,{onClick:function(t){switch(t.key){case"cut":return e.props.cutCommand(m);case"copy":return e.props.copyCommand(m);case"paste":return e.props.pasteCommand(m);case"insert":return e.props.insertCommand(hn,m+1);case"delete":return e.props.removeCommand(m);case"run_line":return e.playLine(m);case"play_from_here":var r=e.props.editing.commands;return e.setState({lastOperation:"play"}),e.props.playerPlay({macroId:e.props.macroId,title:e.getTestCaseName(),extra:{id:e.props.macroId},mode:ae.a.C.MODE.STRAIGHT,startIndex:m,startUrl:null,resources:r,postDelay:1e3*e.props.config.playCommandInterval});case"play_to_here":var n=e.props.editing.commands;return e.setState({lastOperation:"play"}),e.props.playerPlay({macroId:e.props.macroId,title:e.getTestCaseName(),extra:{id:e.props.macroId},mode:ae.a.C.MODE.STRAIGHT,startIndex:0,startUrl:null,resources:n,postDelay:1e3*e.props.config.playCommandInterval,breakpoints:[m]});case"add_breakpoint":return e.props.addBreakpoint(e.props.macroId,m);case"remove_breakpoint":return e.props.removeBreakpoint(e.props.macroId,m);case"jump_to_source_code":return e.jumpToSourceCode(m);case"record_from_here":return e.props.setIndexToInsertRecorded(m+1),e.props.toggleRecorderSkipOpen(!0),e.props.startRecording()}},style:d,mode:"vertical",selectable:!1},c.a.createElement(V.a.Item,{key:"cut",disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)},c.a.createElement("span",null,"Cut"),c.a.createElement("span",{className:"shortcut"},h,"X")),c.a.createElement(V.a.Item,{key:"copy",disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)},c.a.createElement("span",null,"Copy"),c.a.createElement("span",{className:"shortcut"},h,"C")),c.a.createElement(V.a.Item,{key:"paste",disabled:0===r.commands.length},c.a.createElement("span",null,"Paste"),c.a.createElement("span",{className:"shortcut"},h,"P")),c.a.createElement(V.a.Item,{key:"delete",disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)},c.a.createElement("span",null,"Delete")),c.a.createElement(V.a.Divider,null),c.a.createElement(V.a.Item,{key:"insert",disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)},"Insert new line"),c.a.createElement(V.a.Divider,null),c.a.createElement(V.a.Item,{key:"jump_to_source_code"},"Jump to source code"),c.a.createElement(V.a.Item,{key:p?"remove_breakpoint":"add_breakpoint"},p?"Remove breakpoint":"Add breakpoint"),c.a.createElement(V.a.Divider,null),c.a.createElement(V.a.Item,{key:"run_line"},"Execute this command"),c.a.createElement(V.a.Item,{key:"play_from_here"},"Play from here"),c.a.createElement(V.a.Item,{key:"play_to_here"},"Play to this point"),c.a.createElement(V.a.Item,{key:"record_from_here",disabled:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Record)},"Record from here")))}},{key:"renderTargetEditor",value:function(){var e=this,t=this.props,r=(t.status,t.editing),n=(t.config,t.ui,r.commands),a=r.meta.selectedIndex,o=this.isPlayerStopped(),i=(n&&n.length?n:fn)[a];return o&&!!i&&this.state.targetEditor.visible?c.a.createElement("div",{className:"target-full-editor"},c.a.createElement("div",{className:"mask"}),c.a.createElement(_.a,{shape:"circle",icon:"close",className:"close-button",onClick:function(){e.setState({targetEditor:{visible:!1,text:""}})}}),c.a.createElement(sr.UnControlled,{value:this.state.targetEditor.text,onChange:function(t,r,n){e.onDetailChange("target",n)},onCursor:function(e,t){},onFocus:function(){e.props.updateUI({focusArea:yr.FocusArea.CodeSource})},options:{mode:{name:"javascript",json:!0},lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0}})):null}},{key:"renderTable",value:function(){var e=this.props,t=e.editing,r=(e.player,t.commands),n=(r&&r.length?r:fn).reduce((function(e,t,r){var n=e.dataSource,a=e.indent,o=Object(ct.indentCreatedByCommand)(t.cmd),i=o.selfIndent,s=o.nextIndent;return n.push(ln({},t,{key:Math.random(),indent:a+i,realIndex:r})),{dataSource:n,indent:Math.max(0,a+i+s)}}),{dataSource:[],indent:0}).dataSource;return this.needVirtualList()?this.renderVirtualTable(n):this.renderNormalTable(n)}},{key:"renderVirtualTable",value:function(e){var t=an()({container:this.listContainer})(this.virtualCommmandList),r=[{header:!0}].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e),[{footer:!0}]);return c.a.createElement("div",{className:"t-body"},this.listContainer?c.a.createElement(t,{itemHeight:gn,items:r}):null)}},{key:"renderNormalTable",value:function(e){var t=this,r=this.props,n=r.editing,a=r.player,o=(r.doneCommandIndices,r.errorCommandIndices,a.nextCommandIndex,n.commands),i=this.isPlayerStopped(),s={dataSource:e,columns:[{title:"Command",dataIndex:"cmd",key:"cmd",width:130},{title:"Target",dataIndex:"target",key:"target",width:190},{title:"Value",dataIndex:"value",key:"value"},{title:"Ops",key:"ops",width:80,render:function(e,r,n){return c.a.createElement("div",null,c.a.createElement(_.a,{disabled:!i,shape:"circle",onClick:function(e){t.props.removeCommand(n),e.stopPropagation()}},c.a.createElement(R.a,{type:"minus"})),c.a.createElement(_.a,{disabled:!i,shape:"circle",onClick:function(e){t.props.duplicateCommand(n),e.stopPropagation()}},c.a.createElement(R.a,{type:"plus"})))}}],pagination:!1,footer:function(){return c.a.createElement("div",{className:"table-footer",onClick:function(e){Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)&&t.props.insertCommand(hn,o.length)}},"Add")},onRowClick:function(e,r,n){t.props.selectCommand(r)},rowClassName:this.commandClassName};return c.a.createElement(rn.a,s)}},{key:"render",value:function(){var e=this,t=this.props,r=t.status,n=t.editing,a=t.config,o=t.ui,i=n.commands,s=n.meta.selectedIndex,l=this.isPlayerStopped(),u=(i&&i.length?i:fn)[s],d=l&&!!u,m=d&&Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit),p=r===A.APP_STATUS.INSPECTOR,h=this.isSelectedCommandVisualSearch(),f=u&&u.cmd&&Object(ct.canCommandSelect)(u.cmd),g=u&&u.cmd&&Object(ct.canCommandFind)(u.cmd),v=u&&u.targetOptions&&u.targetOptions.length&&Object(ct.doesCommandSupportTargetOptions)(u.cmd),b=u&&-1!==["executeScript","executeScript_Sandbox"].indexOf(u.cmd),y=!v&&!b;return c.a.createElement("div",{className:"editor-wrapper"},c.a.createElement("div",{className:"tabs-wrapper"},c.a.createElement(B.a,{type:"card",className:Object(ce.cn)("commands-view",{"target-as-textarea":b}),activeKey:this.props.editor.activeTab,onChange:this.onChangeCommandsView},c.a.createElement(B.a.TabPane,{tab:"Table View",key:"table_view"},c.a.createElement("div",{className:"form-group table-wrapper",style:{marginBottom:0},ref:function(t){e.listContainer=t}},this.renderTable()),c.a.createElement("div",{className:"form-group fields-wrapper",style:{marginBottom:0}},c.a.createElement(J.a,null,c.a.createElement(J.a.Item,{label:"Command",labelCol:{span:4},wrapperCol:{span:20}},c.a.createElement("div",{className:"flex-row"},c.a.createElement(G.a,{showSearch:!0,optionFilterProp:"children",placeholder:"command",disabled:!m,value:u&&u.cmd,onChange:function(t){return e.onDetailChange("cmd",t)},filterOption:function(e,t){return-1!==t.key.toLowerCase().indexOf(e.toLowerCase())},style:{flex:1,maxWidth:"60%",marginRight:"10px"},size:"default"},ct.availableCommands.map((function(e){return c.a.createElement(G.a.Option,{value:e,key:e},Object(ct.commandText)(e))}))),c.a.createElement("div",{style:{flex:.6,display:"flex",justifyContent:"space-between"}},u&&u.cmd?c.a.createElement("a",{style:{marginRight:"10px",whiteSpace:"nowrap"},href:"https://ui.vision/x/idehelp?cmd="+u.cmd.toLowerCase(),target:"_blank"},"Info for this command"):c.a.createElement("span",null),c.a.createElement(_.a,{style:{padding:"0 10px"},title:"Toggle comment",disabled:!m,onClick:function(){e.props.toggleCommentOnSelectedCommand()}},"//")))),c.a.createElement(J.a.Item,{label:"Target",className:"target-row",labelCol:{span:4},wrapperCol:{span:20}},c.a.createElement("div",{className:"flex-row"},y?c.a.createElement(K.a,{style:{flex:1,maxWidth:"60%",marginRight:"10px"},placeholder:"target",disabled:!m,value:u&&u.target,onChange:function(t){return e.onDetailChange("target",t.target.value)},size:"default"}):null,v?c.a.createElement(on.SelectInput,{disabled:!m,getId:function(e){return e},stringifyOption:function(e){return e},value:u.target,options:u.targetOptions,onChange:function(t){return e.onDetailChange("target",t)}}):null,b?c.a.createElement("div",{className:"textarea-wrapper"},c.a.createElement(K.a.TextArea,{rows:2,placeholder:"target",disabled:!m,value:u&&u.target,onChange:function(t){return e.onDetailChange("target",t.target.value)},size:"default"}),c.a.createElement(R.a,{type:"arrows-alt",className:"open-full-editor",title:"Open full editor",onClick:function(){e.setState({targetEditor:{visible:!0,text:u.target}})}})):null,c.a.createElement(_.a,{disabled:!m||!f,onClick:this.onToggleSelect},p?c.a.createElement("span",null,(h?"👁":"")+"Cancel"):c.a.createElement("span",null,(h?"👁":"")+"Select")),c.a.createElement(_.a,{disabled:!d||!g,onClick:this.onClickFind},(h?"👁":"")+"Find"))),c.a.createElement(J.a.Item,{label:"Value",labelCol:{span:4},wrapperCol:{span:20}},c.a.createElement(K.a,{disabled:!m,value:u&&u.value,onChange:function(t){return e.onDetailChange("value",t.target.value)},style:{width:"100%"},placeholder:"value",size:"default"})),c.a.createElement(J.a.Item,{label:"Description",labelCol:{span:4},wrapperCol:{span:20},style:{marginBottom:0}},c.a.createElement(K.a,{disabled:!m,value:u&&u.description,onChange:function(t){return e.onDetailChange("description",t.target.value)},style:{width:"100%"},placeholder:"description",size:"default"}))))),c.a.createElement(B.a.TabPane,{tab:"Source View (JSON)",key:"source_view",className:"source-view"},c.a.createElement("pre",{className:"source-error"},this.props.sourceErrMsg),c.a.createElement(sr.UnControlled,{ref:function(t){e.codeMirror=t},className:this.props.sourceErrMsg?"has-error":"no-error",value:this.props.sourceText,onChange:this.onChangeEditSource,onBlur:this.onSourceBlur,onCursor:function(t,r){e.setState({cmEdtiorInstance:t}),r.sticky&&e.setState({cursor:{line:r.line,ch:r.ch}})},onFocus:function(){e.props.updateUI({focusArea:yr.FocusArea.CodeSource})},options:{mode:{name:"javascript",json:!0},lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,readOnly:!Object(ft.getLicenseService)().canPerform(Ft.Feature.Edit)}}))),Object(ye.isCVTypeForDesktop)(a.cvScope)&&!1!==o.shouldEnableDesktopAutomation||!0===o.shouldEnableDesktopAutomation?c.a.createElement("div",{className:"vision-type",onClick:function(){e.props.updateUI({showSettings:!0,settingsTab:"vision"})}},c.a.createElement("img",{src:"./img/computer.svg"}),c.a.createElement("span",null,"Desktop mode active")):null),this.renderContextMenu(),this.renderVisionFindPreview(),this.renderTargetEditor())}}]),t}(c.a.Component),bn=Object(P.b)((function(e){return{status:e.status,editor:e.editor,editing:e.editor.editing,clipboard:e.editor.clipboard,player:e.player,config:e.config,ui:e.ui,sourceErrMsg:e.editor.editingSource.error,sourceText:e.editor.editingSource.pure,sourceTextModified:e.editor.editingSource.current,selectedCommand:Object(oe.editorSelectedCommand)(e),selectedCommandIndex:Object(oe.editorSelectedCommandIndex)(e),commandCount:Object(oe.editorCommandCount)(e),breakpointIndices:Object(oe.getBreakpoints)(e),doneCommandIndices:Object(oe.getDoneCommandIndices)(e),errorCommandIndices:Object(oe.getErrorCommandIndices)(e),warningCommandIndices:Object(oe.getWarningCommandIndices)(e),macroId:Object(oe.getCurrentMacroId)(e),canUseKeyboardShortcuts:Object(oe.isFocusOnCommandTable)(e)}}),(function(e){return Object(I.b)(ln({},M,se.Actions),e)}))(vn),yn=(r(619),r(646)),wn=r(647),En=r(648),xn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sn=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Cn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Tn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var On=function(e){function t(){var e,r,n;Tn(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return r=n=_n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n.state={activeTabForLogScreenshot:"Logs",showCSVModal:!1,csvText:"",csvFile:"",drag:{isDragging:!1,startY:0,lastHeight:220,currentMinHeight:220},searchImageText:""},n.getBottomMinHeight=function(){var e=n.state.drag,t=e.isDragging,r=e.lastHeight,a=e.currentMinHeight;return(t?a:r)+"px"},n.onResizeDragStart=function(e){e.dataTransfer.setData("text","");var t=window.getComputedStyle(n.$dom),r=parseInt(t.height);n.setState(Object(ce.setIn)(["drag"],{isDragging:!0,startY:e.screenY,lastHeight:r,currentHeight:r},n.state))},n.onResizeDragEnd=function(e){var t=e.screenY-n.state.drag.startY,r=n.state.drag.lastHeight-t;n.setState(Object(ce.setIn)(["drag"],{isDragging:!1,startY:0,lastHeight:r,currentMinHeight:r}))},n.onFileChange=function(e){var t=Object(pe.getStorageManager)().getCSVStorage(),r=[].slice.call(e.target.files);if(r&&r.length){Promise.all(r.map((function(e){return new Promise((function(t,r){var n=new FileReader;n.onload=function(r){var n=r.target.result;t({text:n,fileName:e.name})},n.readAsText(e)}))}))).then((function(e){var r=e.map((function(e){return e.fileName})),o=e.map((function(e){return t.write(Object(ce.sanitizeFileName)(e.fileName),new Blob([e.text]))}));return Promise.all(o).then((function(){return n.props.listCSV()})).then((function(){a.a.info(e.length+" csv files imported"),n.props.addLog("info",e.length+" csv files imported: "+r.join(", "))}))})).catch((function(e){n.props.addLog("error",e.message)}))}},n.removeCSV=function(e){Object(pe.getStorageManager)().getCSVStorage().remove(e.name).then((function(){return n.props.listCSV()})).then((function(){a.a.success("successfully deleted"),n.props.addLog("info",e.name+" deleted")}))},n.viewCSV=function(e){window.open("./csv_editor.html?csv="+e.name,"","width=600,height=500,scrollbars=true")},n.downloadCSV=function(e){Object(pe.getStorageManager)().getCSVStorage().read(e.fullPath,"Text").then((function(t){var r=new Blob([t]);C.a.saveAs(r,e.name)}))},n.onImageFileChange=function(e){var t=[].slice.call(e.target.files);if(t&&t.length){var r=function(e){var t=e.dataUrl,r=e.name;return Object(ce.uniqueName)(r,{check:function(e){return Object(pe.getStorageManager)().getVisionStorage().exists(e).then((function(e){return!e}))}}).then((function(e){return Object(pe.getStorageManager)().getVisionStorage().write(Object(ce.sanitizeFileName)(e),Object(ce.dataURItoBlob)(t)).then((function(){return e}))})).catch((function(e){$e.a.error(e.stack)}))};Promise.all(t.map((function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(n){try{var a=n.target.result,o=r({dataUrl:a,name:e.name});t(o)}catch(r){t({err:r,fileName:e.name})}},a.readAsDataURL(e)}))}))).then((function(e){a.a.success(e.length+" image files imported into Vision tab"),n.props.addLog("info",e.length+" image files imported: "+e.join(", ")),n.props.listVisions()})).catch((function(e){$e.a.error(e.stack),n.props.addLog("error",e.message)}))}},n.viewVision=function(e){window.open("./vision_editor.html?vision="+e,"","width=600,height=500,scrollbars=true")},n.renameVision=function(e,t){return Object(pe.getStorageManager)().getVisionStorage().rename(e,Object(ce.ensureExtName)(".png",t)).then((function(){a.a.success("Successfully renamed"),n.props.listVisions()})).catch((function(e){throw a.a.error(e.message),e}))},n.isVisionNameValid=function(e){return Promise.resolve(Object(ce.withFileExtension)(e,(function(e){try{Object(ce.validateStandardName)(e,!0)}catch(e){throw a.a.error(e.message),e}return e}))).then((function(){return Object(pe.getStorageManager)().getVisionStorage().exists(e).then((function(t){return t&&a.a.error("'"+e+"' already exists"),!t}))}),(function(){return!1}))},n.duplicateVision=function(e){n.props.duplicateVisionImage(e)},n.deleteVision=function(e){return k.a.confirm({title:"Sure to delete?",okText:"Delete",onOk:function(){return Object(pe.getStorageManager)().getVisionStorage().remove(e).then((function(){a.a.success("Successfully deleted"),n.props.listVisions()})).catch((function(e){$e.a.error(e)}))},onCancel:function(){return Promise.resolve(!0)}})},n.addVisionNameToTargetBox=function(e){var t=n.props,r=t.config,o=t.selectedCommand;if(!!(!o||(!Object(ye.isCVTypeForDesktop)(r.cvScope)||"visionLimitSearchArea"!==o.cmd)&&-1===["visionFind","visualSearch","visualAssert","visualVerify","XClick","XMove","XClickRelative","XMoveRelative","OCRExtract","OCRExtractRelative","visionLimitSearchAreaRelative"].indexOf(o.cmd)))return a.a.error("Image names can only be added to the target box if a vision related command is selected");n.props.updateSelectedCommand({target:e})},n.exportAllVisions=function(){var e=new er.a,t=Object(pe.getStorageManager)().getVisionStorage();t.list().then((function(r){if(0===r.length)return a.a.error("No vision to export");var n=r.map((function(r){return t.read(r.fullPath,"ArrayBuffer").then((function(t){e.file(r.name,t,{binary:!0})}))}));return Promise.all(n).then((function(){e.generateAsync({type:"blob"}).then((function(e){C.a.saveAs(e,"vision-images-export.zip")}))}))}))},n.downloadScreenshot=function(e,t){return Object(pe.getStorageManager)().getScreenshotStorage().read(t,"ArrayBuffer").then((function(t){C.a.saveAs(new Blob([new Uint8Array(t)]),e)}))},n.toggleBottom=function(){n.props.updateConfig({showBottomArea:!n.props.config.showBottomArea})},n.logLinkPatterns=[[/Error #101/i,"https://ui.vision/x/idehelp?help=error101"],[/Error #120/i,"https://ui.vision/x/idehelp?help=error120"],[/Error #121/i,"https://ui.vision/x/idehelp?help=error121"]],_n(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Cn(t,[{key:"componentDidMount",value:function(){var e=this;Object(pe.getStorageManager)().on(pe.StorageManagerEvent.StrategyTypeChanged,(function(t){e.forceUpdate()}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.logs.length!==this.props.logs.length){var r=document.querySelector(".log-content");if(!r)return;setTimeout((function(){var e=r.children[r.children.length-1];e&&e.scrollIntoView()}),100)}if(e.visions.length>this.props.visions.length){var n=e.visions.filter((function(e){return!t.props.visions.find((function(t){return t.name===e.name}))}));n.length>1&&n.sort((function(e,t){return e.createTime>t.createTime}));var a=n[0];setTimeout((function(){var e=document.getElementById(a.name);e&&e.scrollIntoView({block:"center",behavior:"smooth"})}),100)}}},{key:"logStyle",value:function(e){return e.options&&e.options.color?{color:e.options.color}:e.options&&e.options.ignored?{color:"orange"}:void 0}},{key:"prefixHardDisk",value:function(e){return Object(pe.getStorageManager)().isXFileMode()?c.a.createElement("div",{style:{display:"inline-block"}},c.a.createElement("img",{src:"./img/hard-drive.svg",style:{position:"relative",top:"3px",marginRight:"5px",height:"15px"}}),c.a.createElement("span",null,e)):e}},{key:"shouldUseFileSaverForDownloadingScreenshot",value:function(){return!!fe.a.isFirefox()||Object(pe.getStorageManager)().isXFileMode()}},{key:"shouldRenderLogStack",value:function(e){if(e.stack.length<=1)return!1;switch(e.type){case"error":case"warning":return!0;case"status":return/^Running/.test(e.text);default:return!1}}},{key:"renderCSVModal",value:function(){var e=this;return c.a.createElement(k.a,{title:"Preview - "+this.state.csvFile,visible:this.state.showCSVModal,onCancel:function(){return e.setState({showCSVModal:!1,csvText:"",csvFile:""})},className:"csv-preview-modal",footer:null},c.a.createElement(K.a.TextArea,{style:{width:"100%"},value:this.state.csvText,readOnly:!0,rows:10}))}},{key:"renderCSVTable",value:function(){var e=this;return this.props.shouldLoadResources?"CSV"!==this.state.activeTabForLogScreenshot?null:this.props.isPlaying&&this.props.csvs.length>E.a.performanceLimit.fileCount?c.a.createElement("div",{className:"hidden-during-replay"},Br.a.contentHidden):c.a.createElement(yn.CsvList,{list:this.props.csvs,viewCSV:this.viewCSV,removeCSV:this.removeCSV,downloadCSV:this.downloadCSV}):c.a.createElement(wr.ResourceNotLoaded,{name:"CSV list",from:this.props.from,showList:function(){e.props.setFrom(yr.RunBy.Manual)}})}},{key:"renderVisionSection",value:function(){var e=this;return this.props.shouldLoadResources?c.a.createElement("div",{className:"vision-content"},c.a.createElement("div",{className:"vision-top-actions"},c.a.createElement("div",{className:"main-actions"},c.a.createElement("div",{className:"main-actions-left"},c.a.createElement("span",{className:"load-image-button ant-btn ant-btn-primary"},c.a.createElement("label",{htmlFor:"select_image_files"},"Load Image"),c.a.createElement("input",{multiple:!0,type:"file",accept:"image/*",id:"select_image_files",onChange:this.onImageFileChange,ref:function(t){e.imageFileInput=t},style:{display:"none"}})),c.a.createElement(_.a,{onClick:this.exportAllVisions},"Export All")),c.a.createElement(Lr,{style:{flex:.8},inputProps:{placeholder:"search image",value:this.state.searchImageText,onChange:function(t){return e.setState({searchImageText:t.target.value})}}})),c.a.createElement("a",{className:"more-info",target:"_blank",href:"https://ui.vision/x/idehelp?help=visual"},"More Info")),this.renderVisionTable()):c.a.createElement("div",{className:"vision-content"},c.a.createElement(wr.ResourceNotLoaded,{name:"Image list",from:this.props.from,showList:function(){e.props.setFrom(yr.RunBy.Manual)}}))}},{key:"renderVisionTable",value:function(){return"Vision"!==this.state.activeTabForLogScreenshot?null:this.props.isPlaying&&this.props.visions.length>E.a.performanceLimit.fileCount?c.a.createElement("div",{className:"hidden-during-replay"},Br.a.contentHidden):this.$dom?c.a.createElement(wn.VisionList,{visions:this.props.visions,intersectRoot:this.$dom,query:this.state.searchImageText,isNameValid:this.isVisionNameValid,renameVision:this.renameVision,viewVision:this.viewVision,duplicateVision:this.duplicateVision,deleteVision:this.deleteVision,copyNameToTarget:this.addVisionNameToTargetBox}):null}},{key:"renderScreenshots",value:function(){return"Screenshots"!==this.state.activeTabForLogScreenshot?null:this.$dom?c.a.createElement(En.ScreenshotList,{screenshots:this.props.screenshots,intersectRoot:this.$dom,downloadScreenshot:this.downloadScreenshot}):null}},{key:"renderVariableTable",value:function(){if("Variables"!==this.state.activeTabForLogScreenshot)return null;var e=[{title:"Name",dataIndex:"key",key:"key",width:"40%"},{title:"Value",dataIndex:"value",key:"value",render:function(e){return JSON.stringify(e)||"undefined"}}],t=this.props.config,r=function(e){var t,r=e.withUserDefined,n=void 0===r||r,a=e.withCommonInternal,o=e.withAdvancedInternal,i=function(e){return-1!==["!url","!clipboard","!runtime","!statusok","!errorignore"].map((function(e){return e.toUpperCase()})).indexOf(e.toUpperCase())},s=[n?function(e){return!/^!/.test(e)}:null,a?i:null,o?function(e){return/^!/.test(e)&&!i(e)}:null].filter((function(e){return!!e}));return t=s,function(){for(var e=0,r=t.length;e<r;e++)if(t[e].apply(t,arguments))return!0;return!1}}({withCommonInternal:t.showCommonInternalVariables,withAdvancedInternal:t.showAdvancedInternalVariables}),n={columns:e,dataSource:this.props.variables.filter((function(e){return r(e.key)})),pagination:!1,bordered:!0,size:"middle",rowKey:"key",onRowClick:function(e,t,r){},rowClassName:function(e,t){var r=Me();return r&&r.isReadOnly(e.key)?"read-only":""}};return c.a.createElement(rn.a,n)}},{key:"renderLogStack",value:function(e){var t=this,r=e.stack.slice(0,-1).reverse();return 0===r.length?null:c.a.createElement("div",{style:{marginLeft:"80px"}},r.map((function(e,r){return c.a.createElement("div",{key:r},"At ",c.a.createElement("a",{href:"#",onClick:function(r){r.preventDefault(),"number"==typeof e.commandIndex&&e.macroId&&t.props.gotoLineInMacro(e.macroId,e.commandIndex)}},"Line ",e.commandIndex+1," in ",e.macroName))})))}},{key:"appendLinkIfPatternMatched",value:function(e){var t=[];return this.logLinkPatterns.forEach((function(r){var n=Sn(r,3),a=n[0],o=n[1],i=n[2],s=void 0===i?"(more info)":i;a.test(e)&&t.push(c.a.createElement("a",{href:o,class:"info",target:"_blank",style:{marginLeft:"8px"}},s))})),0===t.length?e:c.a.createElement("span",null,c.a.createElement("span",null,e),t)}},{key:"renderLogText",value:function(e){var t=this;if("function"==typeof e.text)return e.text({renderText:this.renderLogText.bind(this)});if(-1===["error","warning"].indexOf(e.type))return e.text;var r=function(){if(/XClick\/XMove\/XType \d+ commands limit reached/.test(e.text)||/OCR conversion limit reached/.test(e.text)||/PROXY \d+ commands? limit reached/.test(e.text)){var r=Object(ft.getLicenseService)().hasNoLicense()?"PRO":Object(ft.getLicenseService)().isPersonalLicense()?"PRO2 or Enterprise":null;return r?c.a.createElement("span",null,c.a.createElement("span",null,e.text),c.a.createElement("a",{href:"#",style:{marginLeft:"10px"},onClick:function(e){e.preventDefault(),t.props.updateUI({showSettings:!0,settingsTab:"register"})}},"Get a ",r," license key to remove this limit")):e.text}return/(XModule|xFile) is not installed yet/.test(e.text)?c.a.createElement("span",null,c.a.createElement("span",null,e.text),c.a.createElement("a",{href:"#",style:{marginLeft:"10px"},onClick:function(e){e.preventDefault(),t.props.updateUI({showSettings:!0,settingsTab:"xmodules"})}},"Install now")):/OCR feature disabled/.test(e.text)?c.a.createElement("span",null,c.a.createElement("span",null,"OCR feature disabled. Please enable it in the "),c.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),t.props.updateUI({showSettings:!0,settingsTab:"ocr"})}},"OCR Settings")):t.appendLinkIfPatternMatched(e.text)}(),n=e.stack||[],a=n[n.length-1];return a?c.a.createElement("span",null,c.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),"number"==typeof a.commandIndex&&a.macroId&&t.props.gotoLineInMacro(a.macroId,a.commandIndex)}},c.a.createElement("span",null,"Line ",a.commandIndex+1),a.isSubroutine?c.a.createElement("span",null," (Sub: ",a.macroName,")"):null),c.a.createElement("span",null,": "),r):r}},{key:"render",value:function(){var e=this,t=this.state.activeTabForLogScreenshot,r=this.props.config.logFilter||"All",n=this.props.logs.filter({All:function(){return!0},Echo:function(e){return"echo"===e.type||"error"===e.type&&(!e.options||!e.options.ignored)},Echo_And_Status:function(e){return"echo"===e.type||"error"===e.type&&(!e.options||!e.options.ignored)||"status"===e.type},Error:function(e){return"error"===e.type||"report"===e.type},None:function(){return!1}}[r]||function(){return!0});return c.a.createElement("div",{className:Object(ce.cn)("logs-screenshots",{fold:!this.props.config.showBottomArea}),ref:function(t){e.$dom=t},style:{height:this.getBottomMinHeight()}},this.renderCSVModal(),c.a.createElement("div",{className:Object(ce.cn)("resize-handler",{focused:this.state.drag.isDragging}),draggable:"true",onDragStart:this.onResizeDragStart,onDragEnd:this.onResizeDragEnd,onMouseDown:function(){return e.setState(Object(ce.setIn)(["drag","isDragging"],!0,e.state))}}),c.a.createElement(B.a,{type:"card",onChange:function(t){e.setState({activeTabForLogScreenshot:t}),"Screenshots"===t&&e.props.listScreenshots()}},c.a.createElement(B.a.TabPane,{tab:"Logs",key:"Logs"},c.a.createElement("ul",{className:"log-content"},n.map((function(t,r){return c.a.createElement("li",{className:t.type,key:t.id,style:e.logStyle(t)},c.a.createElement("span",{className:"log-type"},Object(Ye.renderLogType)(t)),c.a.createElement("pre",{className:"log-detail"},e.renderLogText(t)),e.shouldRenderLogStack(t)?e.renderLogStack(t):null)})))),c.a.createElement(B.a.TabPane,{tab:"Variables",key:"Variables"},c.a.createElement("div",{className:"variable-content"},c.a.createElement("div",{className:"variable-options"},c.a.createElement(Y.a,{onChange:function(t){return e.props.updateConfig({showCommonInternalVariables:t.target.checked})},checked:this.props.config.showCommonInternalVariables},"Show most common ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=internalvars",target:"_blank"},"internal variables")),c.a.createElement(Y.a,{onChange:function(t){return e.props.updateConfig({showAdvancedInternalVariables:t.target.checked})},checked:this.props.config.showAdvancedInternalVariables},"Show advanced ",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=internalvars",target:"_blank"},"internal variables"))),this.renderVariableTable())),c.a.createElement(B.a.TabPane,{tab:this.prefixHardDisk("Screenshots"),key:"Screenshots"},this.renderScreenshots()),c.a.createElement(B.a.TabPane,{tab:this.prefixHardDisk("CSV"),key:"CSV"},c.a.createElement("div",{className:"csv-content"},this.renderCSVTable())),c.a.createElement(B.a.TabPane,{tab:this.prefixHardDisk("👁Visual"),key:"Vision"},this.renderVisionSection())),c.a.createElement("div",{className:"ls-toolbox"},"Logs"===t?[c.a.createElement(G.a,{value:this.props.config.logFilter,onChange:function(t){e.props.updateConfig({logFilter:t})},style:{width:"60px"},dropdownMatchSelectWidth:!1,size:"small"},c.a.createElement(G.a.Option,{value:"All"},"All"),c.a.createElement(G.a.Option,{value:"Echo"},"Echo"),c.a.createElement(G.a.Option,{value:"Echo_And_Status"},"Echo & Status"),c.a.createElement(G.a.Option,{value:"Error"},"Error & Reports"),c.a.createElement(G.a.Option,{value:"None"},"No log")),c.a.createElement(_.a,{size:"small",onClick:this.props.clearLogs},"Clear")]:null,"Screenshots"===t?c.a.createElement(_.a,{size:"small",onClick:this.props.clearScreenshots},"Clear"):null,"CSV"===t&&this.props.shouldLoadResources?c.a.createElement(_.a,{size:"small",onClick:function(){Object(pe.getStorageManager)().isXFileMode()?k.a.info({title:"In hard-drive mode, there is no need to import CSV files.",content:'To view the latest /datasource folder content, press the "Refresh" icon next to the word "Storage mode" on the left.'}):e.fileInput.click()}},"Import CSV",c.a.createElement("input",{multiple:!0,type:"file",accept:".csv",onChange:this.onFileChange,style:{display:"none"},ref:function(t){e.fileInput=t}})):null,c.a.createElement(_.a,{size:"small",onClick:this.toggleBottom},c.a.createElement(R.a,{type:this.props.config.showBottomArea?"down":"up"}))))}}]),t}(c.a.Component),kn=Object(P.b)((function(e){return{hasSelectedCommand:e.editor.editing&&e.editor.editing.meta&&-1!==e.editor.editing.meta.selectedIndex,selectedCommand:Object(oe.editorSelectedCommand)(e),shouldLoadResources:Object(oe.getShouldLoadResources)(e),isPlaying:Object(oe.isPlaying)(e),status:e.status,from:e.from,logs:e.logs,screenshots:e.screenshots,variables:e.variables,csvs:e.csvs,visions:e.visions,config:e.config}}),(function(e){return Object(I.b)(xn({},M,se.Actions),e)}))(On),Pn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},In=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function An(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Dn=function(e){function t(){return Mn(this,t),An(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),In(t,[{key:"render",value:function(){var e=/windows/i.test(window.navigator.userAgent);return c.a.createElement("div",{className:"dashboard"},c.a.createElement(bn,null),c.a.createElement(kn,null),c.a.createElement("div",{className:"online-help"},c.a.createElement("div",{style:{visibility:e?"visible":"hidden"}},c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=visual",target:"_blank"})),c.a.createElement("div",null,"UI.Vision RPA:",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=forum",target:"_blank"}," User Forum")," -",c.a.createElement("a",{href:"https://ui.vision/x/idehelp?help=docs",target:"_blank"}," Online Help"))))}}]),t}(c.a.Component),Nn=Object(P.b)((function(e){return{}}),(function(e){return Object(I.b)(Pn({},M),e)}))(Dn),Rn=(r(386),r(1062),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}),jn=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function Ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var Vn=function(e){function t(){var e,r,n;Ln(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return r=n=Fn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.hideBackupAlert=function(){n.props.updateConfig({lastBackupActionTime:1*new Date}),n.$app.classList.remove("with-alert")},n.onClickBackup=function(){n.props.runBackup(),n.hideBackupAlert()},n.onClickNoBackup=function(){n.hideBackupAlert()},n.onClickMainArea=function(){n.props.updateUI({focusArea:yr.FocusArea.Unknown})},n.getPlayer=function(e){if(e)return Object(ae.b)({name:e});switch(n.props.player.mode){case A.PLAYER_MODE.TEST_CASE:return Object(ae.b)({name:"testCase"});case A.PLAYER_MODE.TEST_SUITE:return Object(ae.b)({name:"testSuite"})}},Fn(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),jn(t,[{key:"componentDidMount",value:function(){var e=this,t=function(){D.default.ask("PANEL_TIME_FOR_BACKUP",{}).then((function(t){t&&e.$app.classList.add("with-alert")}))};this.timer=setInterval(t,3e5),t()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"renderPreinstallModal",value:function(){var e=this;return this.props.ui.newPreinstallVersion?c.a.createElement(k.a,{className:"preinstall-modal",visible:!0,title:"New demo macros available",okText:"Yes, overwrite",cancelText:"Skip",onOk:function(){return e.props.updateUI({newPreinstallVersion:!1}),e.props.preinstall(!0).then((function(){a.a.success("demo macros updated")})).catch((function(e){a.a.error(e.message)}))},onCancel:function(){e.props.updateUI({newPreinstallVersion:!1}),e.props.preinstall(!1)}},c.a.createElement("p",{style:{fontSize:"14px"}},"Do you want to overwrite the demo macros with their latest versions?")):null}},{key:"render",value:function(){var e=this;return this.props.noDisplay?c.a.createElement("div",{className:"app no-display"},c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"status"},'UI.Vision is in "No Display" mode now'),c.a.createElement(_.a.Group,{className:"simple-actions"},c.a.createElement(_.a,{size:"large",onClick:function(){return e.getPlayer().stop()}},c.a.createElement("span",null,"Stop")),c.a.createElement(_.a,{size:"large",onClick:function(){return e.getPlayer("testCase").pause()}},c.a.createElement("span",null,"Pause"))))):c.a.createElement("div",{className:"app with-sidebar",ref:function(t){e.$app=t}},c.a.createElement("div",{className:"backup-alert"},c.a.createElement("span",null,"Do you want to run the automated backup?"),c.a.createElement("span",{className:"backup-actions"},c.a.createElement(_.a,{type:"primary",onClick:this.onClickBackup},"Yes"),c.a.createElement(_.a,{onClick:this.onClickNoBackup},"No"))),c.a.createElement("div",{className:"app-inner"},c.a.createElement(en,null),c.a.createElement("section",{className:"content",onClickCapture:this.onClickMainArea},c.a.createElement(Ht,null),c.a.createElement(Nn,null))),this.renderPreinstallModal())}}]),t}(s.Component),Un=Object(P.b)((function(e){return{ui:e.ui,player:e.player,noDisplay:Object(oe.isNoDisplay)(e)}}),(function(e){return Object(I.b)(Rn({},M),e)}))(Vn),Bn=r(649),Xn=r.n(Bn),Kn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};r(104);var Yn=r(650),Wn=r.n(Yn),Gn=r(21),Hn=r(114),zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function qn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jn(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var Zn=function(e){var t=e.editor.editing,r=t.meta,n=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["meta"]);if(!(r.src&&r.src.id))return e;var a=e.editor.currentMacro,o=Object(Hn.c)({data:n}),i=!Wn()(a&&a.data,o.data);return Object(ce.setIn)(["editor","editing","meta","hasUnsaved"],i,e)},Qn=function(e,t,r){var n=function(e,t,r){switch(t){case"add":for(var n=e.slice(),a=0,o=e.length;a<o;a++)n[a]>=r&&(n[a]+=1);return n;case"delete":for(var i=e.slice(),s=e.length-1;s>=0;s--)i[s]>r?i[s]-=1:i[s]===r&&i.splice(s,1);return i;default:throw new Error("updateBreakpointIndices: unknown action, '"+t+"'")}};if("number"==typeof r)return n(e,t,r);if(Array.isArray(r)){var a=r.slice();return a.sort((function(e,t){return t-e})),a.reduce((function(e,r){return n(e,t,r)}),e)}throw new Error("updateBreakpointIndices: actionIndex should be either number or an array of number")},ea=Object(ce.partial)((function(e,t){$e()("resetEditingSource",e);var r=Object(Nt.toJSONString)(e,{ignoreTargetOptions:Object(oe.getShouldSaveAlternativeLocators)(t)});return Object(ce.setIn)(["editor","editingSource"],{original:r,pure:r,current:r,error:null},t)})),ta=function(e){var t={name:e.editor.editing.meta.src?e.editor.editing.meta.src.name:"Untitled",commands:e.editor.editing.commands};$e()("setEditingSourceCurrent",t);var r=Object(Nt.toJSONString)(t,{ignoreTargetOptions:Object(oe.getShouldSaveAlternativeLocators)(e)});return Object(ce.updateIn)(["editor","editingSource"],(function(e){return zn({},e,{pure:r,current:r})}),e)},ra=function(e){var t=e.editor.editingSource.current;return Object(ce.updateIn)(["editor","editingSource"],(function(e){return zn({},e,{pure:t,original:t})}),e)},na=function(e,t){var r=Object(Nt.toJSONString)(e,{ignoreTargetOptions:Object(oe.getShouldSaveAlternativeLocators)(t)});return Object(ce.updateIn)(["editor","editingSource"],(function(e){return zn({},e,{pure:r,original:r})}),t)};var aa,oa=Object(I.a)(Xn.a,(function(e){return e.dispatch,e.getState,function(e){return function(t){var r=t.promise,n=t.types,a=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["promise","types"]);if(!r)return e(t);var o=$n(n,3),i=o[0],s=o[1],c=o[2];return e(Kn({},a,{type:i})),r().then((function(t){return e(Kn({},a,{data:t,type:s}))}),(function(t){return e(Kn({},a,{err:t,type:c}))}))}}}),(function(e){var t=e.dispatch,r=e.getState;return function(e){return function(n){var a=n.post;return function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}(n,["post"]),a&&"function"==typeof a?setTimeout((function(){a({dispatch:t,getState:r},n,aa)}),0):Array.isArray(a)&&a.forEach((function(e){setTimeout((function(){e({dispatch:t,getState:r},n,aa)}),0)})),e(n)}}}))(I.c),ia=r(118),sa=r(390),ca=r(36),la=r(119),ua=r(389),da=r(325),ma=r(361),pa=r(185),ha=r(324),fa=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},ga=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};Object(ia.polyfillTimeoutFunctions)(D.default);var va=oa((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yr.initialState,t=arguments[1];switch(t.type){case Gn.b.START_RECORDING_SUCCESS:return zn({},e,{status:A.APP_STATUS.RECORDER,recorderStatus:A.APP_STATUS.PENDING,player:zn({},e.player,{nextCommandIndex:null})});case Gn.b.STOP_RECORDING_SUCCESS:return zn({},e,{status:A.APP_STATUS.NORMAL,recorderStatus:A.RECORDER_STATUS.STOPPED});case Gn.b.START_INSPECTING_SUCCESS:return zn({},e,{status:A.APP_STATUS.INSPECTOR,inspectorStatus:A.INSPECTOR_STATUS.PENDING});case Gn.b.STOP_INSPECTING_SUCCESS:case Gn.b.DONE_INSPECTING:return zn({},e,{status:A.APP_STATUS.NORMAL,recorderStatus:A.INSPECTOR_STATUS.STOPPED});case Gn.b.START_PLAYING:return zn({},e,{status:A.APP_STATUS.PLAYER});case Gn.b.STOP_PLAYING:return zn({},e,{status:A.APP_STATUS.NORMAL});case Gn.b.APPEND_COMMAND:return Object(ce.compose)(ta,Zn,Object(ce.updateIn)(["editor","editing","commands"],(function(e){return[].concat(Jn(e),[t.data.command])})))(e);case Gn.b.DUPLICATE_COMMAND:return Object(ce.compose)(ta,Zn,Object(ce.setIn)(["editor","editing","meta","selectedIndex"],t.data.index+1),Object(ce.updateIn)(["editor","editing","commands"],(function(e){var r=t.data.index,n=e.slice();return n.splice(r+1,0,e[r]),n})),Object(be.safeUpdateIn)(["editor","macrosExtra",Object(oe.getCurrentMacroId)(e),"breakpointIndices"],(function(e){return Qn(e||[],"add",t.data.index+1)})))(e);case Gn.b.INSERT_COMMAND:return Object(ce.compose)(ta,Zn,Object(ce.setIn)(["editor","editing","meta","selectedIndex"],t.data.index),Object(ce.updateIn)(["editor","editing","meta","indexToInsertRecorded"],(function(e){return null==e||e<0?e:e+(t.data.index<=e?1:0)})),Object(ce.updateIn)(["editor","editing","commands"],(function(e){var r=t.data,n=r.index,a=r.command,o=e.slice();return o.splice(n,0,a),o})),Object(be.safeUpdateIn)(["editor","macrosExtra",Object(oe.getCurrentMacroId)(e),"breakpointIndices"],(function(e){return Qn(e||[],"add",t.data.index)})))(e);case Gn.b.UPDATE_COMMAND:return Object(ce.compose)(ta,Zn,Object(ce.updateIn)(["editor","editing","commands",t.data.index],(function(e){return zn({},e,t.data.command)})))(e);case Gn.b.REMOVE_COMMAND:return Object(ce.compose)(ta,Zn,(function(e){var r=e.editor.editing,n=r.commands,a=r.meta;if(a.selectedIndex>=0&&a.selectedIndex<n.length)return e;var o=t.data.index<n.length-t.data.index-1?0:n.length-1;return Object(ce.setIn)(["editor","editing","meta","selectedIndex"],o,e)}),Object(ce.updateIn)(["editor","editing","commands"],(function(e){var r=t.data.index,n=e.slice();return n.splice(r,1),n})),Object(be.safeUpdateIn)(["editor","macrosExtra",Object(oe.getCurrentMacroId)(e),"breakpointIndices"],(function(e){return Qn(e||[],"delete",t.data.index)})))(e);case Gn.b.SELECT_COMMAND:return Object(ce.compose)(Object(ce.setIn)(["editor","editing","meta","selectedIndex"],t.data.forceClick||e.editor.editing.meta.selectedIndex!==t.data.index?t.data.index:-1),e.status===A.APP_STATUS.NORMAL?Object(ce.updateIn)(["editor","editing","commands"],(function(e){return e.map(Hn.b)})):function(e){return e})(e);case Gn.b.CUT_COMMAND:var r=t.data.indices.map((function(t){return e.editor.editing.commands[t]}));return Object(ce.compose)(ta,Zn,Object(ce.setIn)(["editor","clipboard","commands"],r),Object(ce.updateIn)(["editor","editing","commands"],(function(e){return e.slice().filter((function(e,r){return-1===t.data.indices.indexOf(r)}))})),Object(be.safeUpdateIn)(["editor","macrosExtra",Object(oe.getCurrentMacroId)(e),"breakpointIndices"],(function(e){return Qn(e||[],"delete",t.data.indices)})))(e);case Gn.b.COPY_COMMAND:var n=t.data.indices.map((function(t){return e.editor.editing.commands[t]}));return Object(ce.setIn)(["editor","clipboard","commands"],n,e);case Gn.b.PASTE_COMMAND:var a=e.editor.clipboard.commands;return Object(ce.compose)(ta,Zn,Object(ce.updateIn)(["editor","editing","commands"],(function(e){var r=e.slice();return r.splice.apply(r,[t.data.index+1,0].concat(Jn(a))),r})),Object(be.safeUpdateIn)(["editor","macrosExtra",Object(oe.getCurrentMacroId)(e),"breakpointIndices"],(function(e){return Qn(e||[],"add",a.map((function(e){return t.data.index+1})))})))(e);case se.ActionTypes.moveCommands:var o=e.editor.editing.commands,i=void 0===o?[]:o,s=t.data,c=s.startIndex,l=s.endIndex;if(c<0||c>=i.length)throw new Error("startIndex is out of range");if(l<0||l>=i.length)throw new Error("endIndex is out of range");if(l===c)throw new Error("startIndex and endIndex must be different");var u=[].concat(Jn(i));return u.splice(c,1),u.splice(l,0,i[c]),Object(ce.compose)(ta,Zn,Object(ce.setIn)(["editor","editing","commands"],u),Object(ce.updateIn)(["editor","editing","meta","selectedIndex"],(function(e){switch(e){case c:return l;case l:return c;default:return e}})))(e);case Gn.b.NORMALIZE_COMMANDS:return Object(ce.updateIn)(["editor","editing","commands"],(function(e){return e.map(Hn.b)}),e);case Gn.b.UPDATE_SELECTED_COMMAND:return-1===e.editor.editing.meta.selectedIndex?e:Object(ce.compose)(ta,Zn,Object(ce.updateIn)(["editor","editing","commands",e.editor.editing.meta.selectedIndex],(function(e){return Object(Hn.b)(zn({},e,t.data))})))(e);case Gn.b.SAVE_EDITING_AS_EXISTED:return Object(ce.compose)(Object(ce.setIn)(["editor","editing","meta","hasUnsaved"],!1),ra)(e);case Gn.b.SAVE_EDITING_AS_NEW:return Object(ce.compose)(Object(ce.updateIn)(["editor","editing","meta"],(function(e){return zn({},e,{hasUnsaved:!1,src:Object(ce.pick)(["id","name"],t.data)})})),ra)(e);case Gn.b.SET_TEST_CASES:return Object(ce.compose)((function(e){var t=e.editor.editing.meta.src;if(!t)return e;var r=e.editor.testCases.find((function(e){return e.id===t.id}));return r?na({name:r.name,commands:r.data.commands},e):e}),Object(ce.setIn)(["editor","testCases"],t.data))(e);case Gn.b.SET_TEST_SUITES:return Object(ce.setIn)(["editor","testSuites"],t.data,e);case se.ActionTypes.updateTestSuite:var d=t.data,m=d.id,p=d.updated,h=e.editor.testSuites.findIndex((function(e){return e.id===m}));return-1===h?e:Object(ce.setIn)(["editor","testSuites",h],p,e);case Gn.b.UPDATE_TEST_SUITE_STATUS:var f=t.data,g=f.id,v=f.extra;return g?Object(ce.updateIn)(["editor","testSuitesExtra"],(function(e){return zn({},e,qn({},g,v))}),e):e;case Gn.b.SET_EDITING:return $e()("REDUCER SET_EDITING",t.data),t.data?Object(ce.compose)(ta,Zn,Object(ce.setIn)(["editor","editing"],t.data))(e):e;case Gn.b.EDIT_TEST_CASE:var b=e.editor.editing.meta.src||{};b.id;if(!t.data.macro)return e;var y=t.data.macro;return Object(ce.compose)(Object(ce.setIn)(["editor","editing"],zn({},y.data,{meta:{selectedIndex:-1,hasUnsaved:!1,src:Object(ce.pick)(["id","name"],y)}})),Object(ce.updateIn)(["player"],(function(e){return zn({},e,{status:A.PLAYER_STATUS.STOPPED,stopReason:null,nextCommandIndex:null})})),ea({name:y.name,commands:y.data.commands}),Zn)(e);case Gn.b.SET_ONE_MACRO_EXTRA:var w=t.data,E=w.id,x=w.extra;return E?Object(be.safeSetIn)(["editor","macrosExtra",E],x,e):e;case Gn.b.UPDATE_ONE_MACRO_EXTRA:var S=t.data,C=S.id,T=S.extra;return C?Object(be.safeUpdateIn)(["editor","macrosExtra",C],(function(e){return zn({},e,T)}),e):e;case se.ActionTypes.renameTestCase:return Object(ce.setIn)(["editor","editing","meta","src","name"],t.data,e);case Gn.b.REMOVE_TEST_CASE:if(!t.data.isCurrent)return e;var _=e.editor.editing.meta.src.id,O=(e.editor.editing.meta.selectedIndex,e.editor.testCases.filter((function(e){return e.id!==_}))),k=e.editor.testCases.findIndex((function(e){return e.id===_})),P=void 0;if(0===O.length)P=zn({},yr.newTestCaseEditing);else{var I=-1===k?0:k<O.length?k:k-1,M=O[I];P=zn({},M.data,{meta:{src:Object(ce.pick)(["id","name"],M),hasUnsaved:!1,selectedIndex:I}})}return Object(ce.setIn)(["editor","editing"],P,e);case Gn.b.EDIT_NEW_TEST_CASE:return Object(ce.compose)(Object(ce.setIn)(["editor","editing"],zn({},yr.newTestCaseEditing)),Object(ce.updateIn)(["player"],(function(e){return zn({},e,{nextCommandIndex:null})})),ea({name:"Untitled",commands:[]}))(e);case Gn.b.SET_MACROS_EXTRA:return Object(ce.setIn)(["editor","macrosExtra"],t.data,e);case Gn.b.SET_TEST_SUITES_EXTRA:return Object(ce.setIn)(["editor","testSuitesExtra"],t.data,e);case se.ActionTypes.setMacroFolderStructure:return Object(ce.setIn)(["editor","macroFolderStructure"],t.data,e);case se.ActionTypes.setTestSuiteFolderStructure:return Object(ce.setIn)(["editor","testSuiteFolderStructure"],t.data,e);case Gn.b.SET_PLAYER_STATE:return Object(ce.compose)(Object(ce.updateIn)(["player"],(function(e){return zn({},e,t.data)})),Object(ce.updateIn)(["noDisplayInPlay"],(function(e){return t.data.status!==A.PLAYER_STATUS.STOPPED&&e})))(e);case Gn.b.ADD_LOGS:return zn({},e,{logs:[].concat(Jn(e.logs),Jn(t.data)).slice(-500)});case Gn.b.CLEAR_LOGS:return zn({},e,{logs:[]});case Gn.b.ADD_SCREENSHOT:return zn({},e,{screenshots:[].concat(Jn(e.screenshots),[t.data])});case Gn.b.CLEAR_SCREENSHOTS:return zn({},e,{screenshots:[]});case Gn.b.UPDATE_CONFIG:return Object(ce.updateIn)(["config"],(function(e){return zn({},e,t.data)}),e);case Gn.b.SET_CSV_LIST:return zn({},e,{csvs:t.data});case Gn.b.SET_SCREENSHOT_LIST:return zn({},e,{screenshots:t.data});case Gn.b.SET_VISION_LIST:return zn({},e,{visions:t.data});case Gn.b.SET_VARIABLE_LIST:return zn({},e,{variables:t.data});case Gn.b.UPDATE_UI:return Object(ce.updateIn)(["ui"],(function(e){return zn({},e,t.data)}),e);case Gn.b.SET_EDITOR_ACTIVE_TAB:return Object(ce.setIn)(["editor","activeTab"],t.data,e);case Gn.b.SET_SOURCE_ERROR:return Object(ce.setIn)(["editor","editingSource","error"],t.data,e);case Gn.b.SET_SOURCE_CURRENT:return Object(ce.setIn)(["editor","editingSource","current"],t.data,e);case Gn.b.UPDATE_PROXY:return zn({},e,{proxy:t.data});case se.ActionTypes.setIsDraggingCommand:return Object(ce.setIn)(["editor","isDraggingCommand"],t.data,e);case se.ActionTypes.setCurrentMacro:return Object(ce.setIn)(["editor","currentMacro"],t.data,e);case se.ActionTypes.setIsLoadingMacros:return Object(ce.setIn)(["isLoadingMacros"],t.data,e);case se.ActionTypes.setFrom:return Object(ce.setIn)(["from"],t.data,e);case se.ActionTypes.setNoDisplayInPlay:return Object(ce.setIn)(["noDisplayInPlay"],t.data,e);case se.ActionTypes.setMacroQuery:return Object(ce.setIn)(["macroQuery"],t.data,e);case se.ActionTypes.setIndexToInsertRecorded:return Object(ce.setIn)(["editor","editing","meta","indexToInsertRecorded"],t.data,e);case se.ActionTypes.toggleRecorderSkipOpen:return Object(ce.updateIn)(["recorder","skipOpen"],(function(e){return void 0!==t.data?t.data:!e}),e);default:return e}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());window.store=va;var ba=document.getElementById("root"),ya={},wa=function(){return ca.default.get("config").then((function(e){var t=ga({showSidebar:!0,showBottomArea:!0,playScrollElementsIntoView:!0,playHighlightElements:!0,playCommandInterval:.3,saveAlternativeLocators:!0,recordNotification:!0,recordClickType:"click",showTestCaseTab:!0,logFilter:"All",onErrorInLoop:"continue_next_loop",allowRunFromBookmark:!0,allowRunFromFileSchema:!0,allowRunFromHttpSchema:!0,timeoutPageLoad:60,timeoutElement:10,timeoutMacro:0,timeoutDownload:60,lastBackupActionTime:1*new Date,enableAutoBackup:!0,autoBackupInterval:7,autoBackupTestCases:!0,autoBackupTestSuites:!0,autoBackupScreenshots:!0,autoBackupCSVFiles:!0,autoBackupVisionImages:!0,shouldEncryptPassword:"no",masterPassword:"",showCommonInternalVariables:!0,showAdvancedInternalVariables:!1,storageMode:pe.StorageStrategyType.Browser,xmodulesStatus:"unregistered",ocrEngine:1,ocrMode:"disabled",ocrLanguage:"eng",ocrOfflineURL:"",ocrOfflineAPIKey:"",cvScope:"browser",defaultVisionSearchConfidence:.6,useDesktopScreenCapture:!0,waitBeforeDesktopScreenCapture:!1,secondsBeforeDesktopScreenCapture:3,defaultProxy:"",defaultProxyAuth:"",turnOffProxyAfterReplay:!0},e);return va.dispatch(Object(M.updateConfig)(t)),t}))},Ea=function(){return Object(oe.getShouldLoadResources)(va.getState())?(Object(pe.getStorageManager)().getCSVStorage(),va.dispatch(Object(M.listCSV)())):Promise.resolve()},xa=function(){return Object(pe.getStorageManager)().getScreenshotStorage(),va.dispatch(Object(M.listScreenshots)())},Sa=function(){return Object(oe.getShouldLoadResources)(va.getState())?(Object(pe.getStorageManager)().getVisionStorage(),va.dispatch(Object(M.listVisions)())):Promise.resolve()},Ca=function(e){e.savelog&&va.dispatch(Object(M.clearLogs)())},Ta=function(e){var t=e.options,r=!1;return function(e,n){if(!r){r=!0;var a=Object(ce.delay)((function(){}),1e3);if(t.savelog){var o=/\\|\//.test(t.savelog),i=va.getState().logs,s=i.find((function(e){return"error"===e.type&&!(e.options&&e.options.ignored)})),c=e||s&&{message:s.text},l=c?"Status=Error: "+c.message:"Status=OK",u=i.map((function(e){return Object(Ye.renderLog)(e,!1)})),d=[l,"###"].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(u)).join("\n");a=o&&Object(pe.getStorageManager)().isXFileMode()?Object(ha.getLogService)().logTo(t.savelog,d):Object(ce.delay)((function(){}),500).then((function(){return function(e,t){var r=new Blob([e],{type:"text/plain;charset=utf-8"});C.a.saveAs(r,t)}(d,decodeURIComponent(t.savelog)),Object(la.a)().prepareDownload(t.savelog)}))}var m=Object(be.parseBoolLike)(t.closeBrowser,!1),p=Object(be.parseBoolLike)(void 0!==t.closeRPA?t.closeRPA:t.closeKantu,!0);m&&n!==ae.a.C.END_REASON.MANUAL&&a.catch((function(e){$e.a.warn("Save log error: ",e.message)})).then((function(){return D.default.ask("PANEL_CLOSE_ALL_WINDOWS",{})})),e||n!==ae.a.C.END_REASON.COMPLETE||!p||m||setTimeout((function(){window.close()}),1e3)}}},_a=function(e){var t=e.options;return Object.keys(t||{}).reduce((function(e,r){var n=r.match(/^cmd_var(1|2|3)$/i);return n?(e["!CMD_VAR"+n[1]]=t[r],e):e}),{})},Oa=["direct","closeBrowser","closeKantu","closeRPA","continueInLastUsedTab","nodisplay","folder","savelog","storage","macro","testsuite","storageMode","loadmacrotree","cmd_var1","cmd_var2","cmd_var3","cmd_var4","cmd_var5","cmd_var6","cmd_var7","cmd_var8","cmd_var9","cmd_var10"],ka=new v.a(Oa),Pa=function(e){var t=Object(be.parseBoolLike)(e.loadmacrotree),r=Object(be.parseBoolLike)(e.nodisplay,!1);t&&va.dispatch(se.Actions.setFrom(yr.RunBy.Manual)),r&&va.dispatch(se.Actions.setNoDisplayInPlay(!0))},Ia=function(e,t){var r=Object.keys(e);r.forEach((function(t){if(0!==t.trim().length){if(!Oa.find((function(e){return n=t,"string"==typeof(r=e)?r===n:r.test(n);var r,n}))){var r=ka.get(t),n=r&&r[0]&&r[0][1]?', do you mean "'+r[0][1]+'"?':"";va.dispatch(Object(M.addLog)("warning",'Unknown command line parameter: "'+t+'"'+n))}try{!function(e,t){switch(e){case"continueInLastUsedTab":case"closeKantu":case"closeRPA":case"closeBrowser":case"direct":case"loadmacrotree":case"nodisplay":if(/^0|1|true|false$/i.test(t))return!0;throw new Error('"'+e+"\" should be 0, 1, true or false, but now it's "+t);case"storage":if(-1!==["browser","xfile"].indexOf(t))return!0;throw new Error('"'+e+"\" should be either browser or xfile, but now it's "+t);default:;}}(t,e[t])}catch(e){va.dispatch(Object(M.addLog)("warning","Invalid value for cmd line arg: "+e.message))}}}))},Ma=function(e){if(fe.a.isFirefox())return!0;var t=document.title.replace(/ - .*$/,"");document.title=t+" - (Tab: "+e.title+")"};function Aa(){var e,t,r,n,a,o,i=(e=Object(pe.getStorageManager)().getCurrentStrategyType(),t=Object(pe.getStorageManager)().getMacroStorage(),r=Object(pe.getStorageManager)().getTestSuiteStorage(),n=function(e){e.filter((function(e){return"__Untitled__"!==e.fileName})).forEach((function(e){var t=e.fullFilePath;(!ya[t]||1*new Date-ya[t]>2e3)&&(ya[t]=1*new Date,va.dispatch(Object(M.addLog)("warning",e.error.message)))}))},a=function(){va.dispatch(se.Actions.setIsLoadingMacros(!0));var e=Object(mt.getMacroExtraKeyValueData)().getAll().then((function(e){$e()("restoreMacrosExtra",e),va.dispatch(Object(M.setMacrosExtra)(e))})),r=Object(oe.getShouldLoadResources)(va.getState())?t.listR().then((function(e){$e()("restoreMacroFolderStructure",e),va.dispatch(se.Actions.setMacroFolderStructure(e))})):Promise.resolve();return Promise.all([e,r]).finally((function(){return va.dispatch(se.Actions.setIsLoadingMacros(!1))}))},o=function(){return Object(oe.getShouldLoadResources)(va.getState())?Object(be.until)("macros",(function(){return{pass:va.getState().editor.macroFolderStructure.length>=0,result:!0}})).then((function(){var e=r.readR("/","Text",n).then((function(e){return e.map((function(e){return Object(sa.normalizeTestSuite)(e.content)}))})).then((function(e){e.sort((function(e,t){var r=e.name.toLowerCase(),n=t.name.toLowerCase();return r<n?-1:r>n?1:r===n?t.updateTime-e.updateTime:void 0})),$e()("restoreTestSuites - suiteStorage - tss",e),va.dispatch(Object(M.setTestSuites)(e))})),t=Object(ua.getTestSuiteExtraKeyValueData)().getAll().then((function(e){$e()("restoreTestSuitesExtra",e),va.dispatch(Object(M.setTestSuitesExtra)(e))})),a=r.listR().then((function(e){$e()("restoreTestSuiteFolderStructure",e),va.dispatch(se.Actions.setTestSuiteFolderStructure(e))}));return Promise.all([e,t,a])})):Promise.resolve()},[qe.FlatStorageEvent.ListChanged,qe.FlatStorageEvent.FilesChanged].forEach((function(r){t.off(r),t.on(r,(function(){e===Object(pe.getStorageManager)().getCurrentStrategyType()&&($e()("macroStorage - eventName",r),setTimeout(a,50))}))})),[qe.FlatStorageEvent.ListChanged,qe.FlatStorageEvent.FilesChanged].forEach((function(t){r.off(t),r.on(t,(function(){e===Object(pe.getStorageManager)().getCurrentStrategyType()&&($e()("suiteStorage - eventName",t),setTimeout(o,50))}))})),Object(be.flow)(Object(be.guardVoidPromise)(a),Object(be.guardVoidPromise)(o))).then((function(){return Object(be.flow)(Object(be.guardVoidPromise)(Ea),Object(be.guardVoidPromise)(Sa),Object(be.guardVoidPromise)(xa),Object(be.guardVoidPromise)((function(){return va.dispatch(Object(M.resetEditingIfNeeded)())})))}));return Aa.onLastReloadFinished=function(e){return e?i.then(e):i},i}function Da(){var e=!0;Object(pe.getStorageManager)().on(pe.StorageManagerEvent.StrategyTypeChanged,(function(t){if(e)e=!1;else try{(t===pe.StorageStrategyType.XFile?Object(le.getXFile)().getVersion().then((function(e){if(e.version&&y.a.lt(e.version,E.a.xfile.minVersionToReadBigFile)){var t="Can not read/save screenshot on hard-drive. Please upgrade FileAccess XModule to latest version (>= "+E.a.xfile.minVersionToReadBigFile+").";a.a.warn(t),va.dispatch(Object(M.addLog)("warning",t))}})):Promise.resolve()).then(Aa).then((function(){va.dispatch(se.Actions.selectInitialMacro(t))}))}catch(e){$e.a.warn(e)}})),Object(pe.getStorageManager)().on(pe.StorageManagerEvent.RootDirChanged,(function(e){Aa()})),Object(pe.getStorageManager)().on(pe.StorageManagerEvent.ForceReload,(function(e){Aa()}))}function Na(){var e,t;e=Object(ce.parseQuery)(window.location.search),va.dispatch(se.Actions.setFrom(e.from||yr.RunBy.Manual)),e.settings&&va.dispatch(Object(M.updateUI)({showSettings:!0})),t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e).reduce((function(t,r){return t[r.toLowerCase()]=e[r],t}),{});return Object(be.parseBoolLike)(t.continueinlastusedtab,!1)?D.default.ask("PANEL_CLOSE_CURRENT_TAB_AND_SWITCH_TO_LAST_PLAYED"):Promise.resolve()},D.default.onAsk((function(e,r){switch($e()(e,r),e){case"PROXY_UPDATE":return va.dispatch(Object(M.updateProxy)(r.proxy)),!0;case"OPEN_SETTINGS":return va.dispatch(Object(M.updateUI)({showSettings:!0})),!0;case"INSPECT_RESULT":return va.dispatch(Object(M.doneInspecting)()),va.dispatch(Object(M.updateSelectedCommand)({target:r.locatorInfo.target,targetOptions:r.locatorInfo.targetOptions})),!0;case"RECORD_ADD_COMMAND":$e()("got add command",e,r);var n=va.getState(),o=Object(oe.editorCommandCount)(n),i=Object(oe.getIndexToInsertRecorded)(n),s=n.recorder.skipOpen&&"open"===r.cmd;return va.dispatch(se.Actions.toggleRecorderSkipOpen(!1)),!s&&(i>0&&i<=o?va.dispatch(Object(M.insertCommand)(r,i,!0)):va.dispatch(Object(M.appendCommand)(r,!0)),!0);case"TIMEOUT_STATUS":return!(va.getState().status!==A.APP_STATUS.PLAYER||r.playUID&&!Object(ae.b)().checkPlayUID(r.playUID)||(va.dispatch(Object(M.setTimeoutStatus)(r)),0));case"RUN_TEST_CASE":if(va.getState().status!==A.APP_STATUS.NORMAL)return a.a.error("can only run macros when it is not recording or playing"),!1;var c=r.testCase,l=r.options;Ia(l),Pa(l);var u=Object(pe.getStorageManager)(),d=c.storageMode||u.getCurrentStrategyType();return u.isStrategyTypeAvailable(d).catch((function(e){throw a.a.error(e.message),e})).then((function(){var e=u.setCurrentStrategyType(d);return va.dispatch(Object(M.updateConfig)({storageMode:d})),e?Object(ce.delay)((function(){return Aa.onLastReloadFinished()}),100):void 0})).then((function(){return t(l)})).then((function(){var e=va.getState();return Object(oe.getShouldLoadResources)(e)?new Promise((function(e){e(Aa.onLastReloadFinished?Aa.onLastReloadFinished():null)})).then((function(){return Object(be.until)("macros ready",(function(){var e=va.getState(),t=Object(oe.getMacroFileNodeList)(e);return{pass:t&&t.length>0,result:!0}}),1e3,2e4)})):Promise.resolve(!0)})).then((function(){var e=va.getState(),t=Object(oe.getShouldLoadResources)(e),r=c.name;if(t){var n=Object(oe.findMacroNodeWithCaseInsensitiveRelativePath)(e,c.name);if(!n)throw new Error("Can't find macro with name \""+c.name+'"');r=n.fullPath}else if(x.default.isAbsolute(r)&&Object(pe.getStorageManager)().isXFileMode()){var o=['Absolute path locations like "'+r+'" are not supported yet. ','Macro location must be relative to macro root folder (currently "'+Object(le.getXFile)().getCachedConfig().rootDir+'")'].join("");throw new Error(o)}var i="No macro found with path '"+r+"'";return u.getMacroStorage().read(r,"Text").then((function(e){if(!e)throw a.a.error(i),new Error(i);return e}),(function(e){if(/File size cannot be determined.|A requested file or directory could not be found/.test(e.message))throw new Error(i);return Promise.reject(e)})).then((function(t){var n=t.data.commands.find((function(e){return"open"===e.cmd.toLowerCase()}));Ca(l);var a=Ta({options:l});va.dispatch(Object(M.editTestCase)(t.id)),va.dispatch(Object(M.playerPlay)({macroId:t&&t.id,title:r,extra:{id:t&&t.id},mode:ae.a.C.MODE.STRAIGHT,startIndex:0,startUrl:n?n.target:null,resources:t.data.commands,postDelay:1e3*e.player.playInterval,overrideScope:_a({options:l}),callback:a})).finally(a),va.dispatch(Object(M.updateUI)({sidebarTab:"macros"}))}))})).catch((function(e){va.dispatch(Object(M.addLog)("error",e.message))})),!0;case"RUN_TEST_SUITE":if(va.getState().status!==A.APP_STATUS.NORMAL)return a.a.error("can only run test suites when it is not recording or playing"),!1;var m=r.testSuite,p=r.options;Ia(p),Pa(p);var h=m.storageMode||pe.StorageStrategyType.Browser,f=Object(pe.getStorageManager)();return f.isStrategyTypeAvailable(h).catch((function(e){throw a.a.error(e.message),e})).then((function(){return f.setCurrentStrategyType(h)?Object(ce.delay)((function(){}),1e3):void 0})).then((function(){return t(p)})).then((function(){var e=va.getState(),t=Object(oe.getShouldLoadResources)(e);return m.macroFolder&&m.macroFolder.length>0?(t?Object(be.until)("macros ready",(function(){var e=va.getState(),t=Object(oe.getMacroFileNodeList)(e);return{pass:t&&t.length>0,result:t}}),1e3,2e4).then((function(){var e=Object(oe.findMacroFolderWithCaseInsensitiveRelativePath)(va.getState(),m.macroFolder);return e&&e.children||[]})):f.getMacroStorage().listR(m.macroFolder).then((function(e){return e.filter((function(e){return e.isFile}))}))).then((function(e){var t=f.getMacroStorage(),r=t.dirPath(m.macroFolder.replace(/\\/g,"/")),n=t.getPathLib().basename(r);if(0===e.length)throw new Error("No folder found for "+m.macroFolder+", or no macro found in it");Ca(p),Object(ae.b)({name:"testSuite"}).play({title:n,mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,resources:e.map((function(e){return{id:e.fullPath,loops:1}})),extra:{id:r,name:n},public:{scope:_a({options:p})},callback:Ta({options:p})})})):m.name&&m.name.length>0?(t?Object(be.until)("testSuites ready",(function(){var e=va.getState().editor.testSuites;return{pass:e&&e.length>0,result:!0}})).then((function(){var e=va.getState();return Object(M.findSameNameTestSuite)(m.name,e.editor.testSuites)})):f.getTestSuiteStorage().read(m.name,"Text")).then((function(e){return e?(Ca(p),Object(ae.b)({name:"testSuite"}).play({title:e.name,extra:{id:e.id,name:e.name},mode:Object(ae.b)().C.MODE.STRAIGHT,startIndex:0,resources:e.cases.map((function(e){return{id:e.testCaseId,loops:e.loops}})),public:{scope:_a({options:p})},callback:Ta({options:p})}),va.dispatch(Object(M.updateUI)({sidebarTab:"test_suites"}))):(a.a.error("no macro found with name '"+m.name+"'"),!1)})):void 0})).catch((function(e){va.dispatch(Object(M.addLog)("error",e.message))})),!0;case"IMPORT_AND_RUN":var g=r.options,v=void 0;if(r.html)try{v=Object(Nt.fromHtml)(r.html)}catch(e){return a.a.error("Failed to parse html",1.5),!1}if(r.json)try{var b="string"==typeof r.json?r.json:JSON.stringify(r.json);v=Object(Nt.fromJSONString)(b)}catch(e){return a.a.error("Failed to parse json",1.5),!1}if(!v)return a.a.error("Nothing to import"),!1;Ia(g);var y=r.storageMode||pe.StorageStrategyType.Browser,w=Object(pe.getStorageManager)();return w.isStrategyTypeAvailable(y).catch((function(e){throw a.a.error(e.message),e})).then((function(){return w.setCurrentStrategyType(y)?Object(ce.delay)((function(){}),1e3):void 0})).then((function(){return t(g)})).then((function(){var e=va.getState();return Object(oe.getShouldLoadResources)(e)?new Promise((function(e){e(Aa.onLastReloadFinished?Aa.onLastReloadFinished():null)})).then((function(){return Object(be.until)("macros ready",(function(){var e=va.getState(),t=Object(oe.getMacroFileNodeList)(e);return{pass:t&&t.length>0,result:!0}}),1e3,2e4)})):Promise.resolve(!0)})).then((function(){return va.dispatch(Object(M.upsertTestCase)(v)).then((function(){return va.dispatch(Object(M.editTestCase)(v.name))})).then((function(e){var t=va.getState(),r=e.data.commands.find((function(e){return"open"===e.cmd.toLowerCase()}));return va.dispatch(Object(M.playerPlay)({macroId:e.id,title:e.name,extra:{id:e.id},mode:ae.a.C.MODE.STRAIGHT,startIndex:0,startUrl:r?r.target:null,resources:e.data.commands,postDelay:1e3*t.player.playInterval,overrideScope:_a({options:g}),callback:Ta({options:g})})),!0})).catch((function(e){throw $e.a.error(e.stack),e}))}));case"ADD_VISION_IMAGE":var E=r.dataUrl,S=r.requireRename,C=void 0!==S&&S,T=Object(ce.randomName)()+"_dpi_"+Object(ce.getScreenDpi)()+".png";return Object(pe.getStorageManager)().getVisionStorage().write(T,Object(ce.dataURItoBlob)(E)).then(Sa).then((function(){return C?va.dispatch(Object(M.renameVisionImage)(T)).then((function(e){return Sa(),{fileName:e}})):{fileName:T}}));case"RESTORE_SCREENSHOTS":return xa(),!0;case"UPDATE_ACTIVE_TAB":return Ma(r),!0;case"ADD_LOG":return!!r&&(r.info&&va.dispatch(Object(M.addLog)("info",r.info,r.options)),r.warning&&va.dispatch(Object(M.addLog)("warning",r.warning)),r.error&&va.dispatch(Object(M.addLog)("error",r.error)),!0)}})),window.addEventListener("beforeunload",(function(){D.default.ask("PANEL_STOP_RECORDING",{}),D.default.ask("PANEL_STOP_PLAYING",{})})),window.addEventListener("resize",(function(){var e,t,r,n={width:window.outerWidth,height:window.outerHeight},a=va.getState();va.dispatch(Object(M.updateConfig)({size:ga({},a.config.size,(e={},t=a.config.showSidebar?"with_sidebar":"standard",r=n,t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e))}))})),window.addEventListener("message",(function(e){switch(e.data&&e.data.type){case"RELOAD_VISIONS":return va.dispatch(Object(M.listVisions)())}})),setTimeout((function(){Me().onChange((function(e){var t=e.vars,r=Object.keys(t).map((function(e){return{key:e,value:t[e]}}));va.dispatch(Object(M.setVariables)(r))}))}),0),Da(),Pt(va),ca.default.get("editing").then((function(e){if(e){var t=e;e.baseUrl&&((t=ga({},e)).commands=t.commands.map(Object(Hn.a)(e.baseUrl)),delete t.baseUrl),va.dispatch(Object(M.setEditing)(t))}})),wa(),Object(ie.default)(va),D.default.ask("PANEL_GET_PROXY").then((function(e){va.dispatch(Object(M.updateProxy)(e))})),ca.default.get("preinstall_info").then((function(e){switch(function(){if(!e)return"fresh";var t=e.askedVersions;return-1===(void 0===t?[]:t).indexOf(E.a.preinstall.version)?"new_version_available":"up_to_date"}()){case"fresh":return va.dispatch(Object(M.preinstall)());case"new_version_available":return va.dispatch(Object(M.updateUI)({newPreinstallVersion:!0}));case"up_to_date":default:return!1}})).catch((function(e){$e.a.warn("Error in preinstall",e)})).then((function(){Aa()})),setTimeout((function(){var e;e=[],(Object(da.getMigrateMacroTestSuiteToBrowserFileSystem)().shouldMigrate()&&!Object(ma.getKantuMigrationService)().isMigrated(pa.MigrationJobType.MigrateMacroTestSuiteToBrowserFileSystem)||E.a.forceMigrationRemedy)&&(alert("Kantu introduced an internal storage migration in this version. It isn't supposed to disturb you, but looks like there is some unexpected error: \n\n=> Solution: After you click OK Kantu is going to download your macros and test suites from the old storage into a ZIP file. You can then manually import the macros back into the new Kantu version.\n\nIf you see this dialog, please also inform us at team@a9t9.com or in the user forum about the issue."),e.push((function(){return Object(da.getMigrateMacroTestSuiteToBrowserFileSystem)().remedy()}))),be.flow.apply(void 0,e)}),1e3),D.default.ask("I_AM_PANEL",{}),document.title=document.title+" "+fe.a.runtime.getManifest().version,D.default.ask("PANEL_CURRENT_PLAY_TAB_INFO").then(Ma),u.a.render(c.a.createElement(f.a,{backend:h.a},c.a.createElement(i.a,{locale:p.a},c.a.createElement(P.a,{store:va},c.a.createElement(d.a,null,c.a.createElement(Un,null))))),ba)}Promise.all([wa(),Object(le.getXFile)().getConfig(),Object(ft.getLicenseService)().getLatestInfo()]).then((function(e){var t=fa(e,2),r=t[0];t[1];Object(pe.getStorageManager)(r.storageMode,{getConfig:function(){return va.getState().config},getMacros:function(){return Object(oe.getMacroFileNodeList)(va.getState())},getMaxMacroCount:function(e){var t=function(){switch(e){case pe.StorageStrategyType.XFile:return Object(ft.getLicenseService)().getMaxXFileMacros();case pe.StorageStrategyType.Browser:default:return 1/0}}();return Promise.resolve(t)}}),Na()}),Na)},112:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.AllParsed=1]="AllParsed",e[e.PartiallyParsed=2]="PartiallyParsed",e[e.Failed=3]="Failed",e[e.Fatal=4]="Fatal"}(t.OCRExitCode||(t.OCRExitCode={})),function(e){e[e.FileNotFound=0]="FileNotFound",e[e.Success=1]="Success",e[e.ParseError=-10]="ParseError",e[e.Timeout=-20]="Timeout",e[e.ValidationError=-30]="ValidationError",e[e.UnknownError=-99]="UnknownError"}(t.FileParseExitCode||(t.FileParseExitCode={})),function(e){e[e.Identified=0]="Identified",e[e.Matched=1]="Matched",e[e.TopMatched=2]="TopMatched"}(t.OcrHighlightType||(t.OcrHighlightType={}))},114:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return u}));var n=r(4),a=r(12),o=r(92),i=r(43),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=(o.default.testCases,function(e){var t=Object(a.pickIfExist)(["cmd","target","value","targetOptions","description"],e);return Object(i.doesCommandSupportTargetOptions)(t.cmd)||delete t.targetOptions,t}),l=function(e){var t=Object(n.compose)(Object(n.on)("data"),Object(n.on)("commands"),n.map)(c)(e);return Object(a.pickIfExist)(["id","data","name","path"],t)},u=function(e){return function(t){return"open"!==t.cmd?t:s({},t,{target:(e+"/"+t.target).replace(/\/+/g,"/")})}}},115:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402),a=r(976),o=r(191),i=r(12),s=r(184);class c extends a.Stack{constructor(e){super(),this.opts=e,this.registry=s.createListenerRegistry()}on(e,t){return this.registry.add(e,t),()=>this.registry.remove(e,t)}off(){this.registry.destroy()}call(e,t){return this.isEmpty()||this.updatePeek(e=>({id:e.id,resource:e.resource,runningStatus:Object.assign(Object.assign({},this.opts.updateRunningStatusForCaller(e.runningStatus,e.resource)),{status:o.MacroStatus.Calling})})),this.push({resource:e,id:i.uid(),runningStatus:t||this.opts.getInitialRunningStatus(e)}),this.registry.fire(n.CallStackEvent.BeforeRun,this.callStackSnapshot()),this.runPeek()}runPeek(e=!1){return this.opts.prepareContext(this.peek(),this.getFrameStatus(this.peek(),e)).then(()=>{const t=this.peek();return this.opts.run(t,this.getFrameStatus(t,e)).then(()=>{const e=this.callStackSnapshot();if(this.opts.getLatestFrameIdFromSnapshot(e)===t.id&&(this.registry.fire(n.CallStackEvent.AfterReturn,e),this.pop(),!this.isEmpty()))return this.updatePeekAfterResume(),this.registry.fire(n.CallStackEvent.BeforeResume,this.callStackSnapshot()),this.runPeek(!0)})})}updatePeek(e){this.guardNotEmpty();const t=this.getCount()-1;this.list[t]=e(this.list[t])}getFrameStatus(e,t){return{isResume:t,isBottom:1===this.getCount(),frameId:e.id}}updatePeekAfterResume(){this.updatePeek(e=>e)}callStackSnapshot(){return this.list.map(e=>e.resource)}}t.CallStack=c;class l extends c{isAtBottom(){return 1===this.getCount()}callStackSnapshot(){return this.list.map(e=>({id:e.resource.id,name:e.resource.name,frameId:e.id}))}updatePeekAfterResume(){this.updatePeek(e=>{const t=e.runningStatus.nextIndex,r=t+1,n=[...e.runningStatus.commandResults];return n[t]=o.CommandRunningStatus.Success,{id:e.id,resource:e.resource,runningStatus:{nextIndex:r,commandResults:n,status:o.MacroStatus.Running,playerState:Object.assign(Object.assign({},e.runningStatus.playerState),{nextIndex:r,doneIndices:[...e.runningStatus.playerState.doneIndices,t]}),interpreterState:e.runningStatus.interpreterState}}})}}t.MacroCallStack=l,t.getMacroCallStack=i.singletonGetter(e=>{if(!e)throw new Error("macro call stack options is required");return new l(e)}),t.createMacroCallStack=function(e){return t.getMacroCallStack({getInitialRunningStatus:e=>({nextIndex:0,status:o.MacroStatus.Running,commandResults:[],playerState:{},interpreterState:{}}),getLatestFrameIdFromSnapshot:e=>{const t=e[e.length-1];return t?t.frameId:null},updateRunningStatusForCaller:(t,r)=>e.getCurrentMacroRunningStatus(),prepareContext:(t,r)=>{const n=t.resource,a=t.runningStatus;return i.withPromise(()=>e.updateSelectedMacro(n,a,r)).then(()=>i.withPromise(()=>e.restorePlayerState(n,a,r)))},run:(t,r)=>{const n=t.resource,a=t.runningStatus;return i.withPromise(()=>e.playMacro(n,a,r))}})}},118:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(11)),o=window.setTimeout,i=window.clearTimeout;window.setInterval,window.clearInterval;function s(){return Math.floor(1e8*Math.random())}t.polyfillTimeoutFunctions=function(e){const t={};function r(r,n=0,...i){let c=!1;const l=(...e)=>c?null:(c=!0,r(...e)),u=o(l,n,...i);return function(r){const n=null!=r?r:s();return function(r,o=0,...i){return t[n]=!0,e.ask("TIMEOUT",{id:n,timeout:o}).then(e=>{t[e]&&r(...i)}).catch(e=>{a.default.error("Error in setTimeout",e.stack)}),n}}(u)(l,n,...i),u}const n={};var c,l;window.setTimeout=r,window.clearTimeout=(c=function(e){delete t[e]},l=i,(...e)=>{c(...e),l(...e)}),window.setInterval=function(e,t=0,...a){const o=s(),i=()=>{n[o]&&(r(i,t),e(...a))};return n[o]=!0,r(i,t),o},window.clearInterval=function(e){delete n[e]}}},119:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(10),a=r.n(n),o=r(11),i=r.n(o),s=r(4),c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var d,m=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.activeDownloads=[],this.eventsBound=!1,this.filterActiveDownloads=function(e){t.activeDownloads=t.activeDownloads.filter(e),0===t.activeDownloads.length&&t.unbindEvents()},this.createdListener=function(e){if(t.isActive()){i()("download on created",e);var r=t.activeDownloads.find((function(e){return!e.id}));r&&l(r,l({id:e.id},!r.wait&&r.timeout>0?{}:{timeoutTimer:setTimeout((function(){r.reject(new Error("download timeout "+r.timeout/1e3+"s")),t.filterActiveDownloads((function(e){return r.uid!==e.uid}))}),r.timeout),countDownTimer:setInterval((function(){if(t.countDownHandler){var e=r.past,n=(void 0===e?0:e)+1e3;t.countDownHandler({total:r.timeout,past:n}),l(r,{past:n})}}),1e3)}))}},this.changedListener=function(e){if(t.isActive()){i()("download on changed",e);var r=t.findById(e.id);if(r&&e.state){var n=function(){},o=!1;switch(e.state.current){case"complete":n=function(){return r.resolve(!0)},o=!0,t.completeHandler&&a.a.downloads.search({id:r.id}).then((function(e){var r=c(e,1)[0];r&&t.completeHandler(r)}));break;case"interrupted":n=function(){return r.reject(new Error("download interrupted"))},o=!0}o&&(clearTimeout(r.timeoutTimer),clearInterval(r.countDownTimer),t.filterActiveDownloads((function(t){return t.id!==e.id}))),n()}}},this.determineFileNameListener=function(e,r){if(t.isActive()){i()("download on determine",e);var n=t.findById(e.id);if(n){var a=n.fileName.trim(),o=""===a||"*"===a?null:a;return o?r({filename:o,conflictAction:"uniquify"}):void 0}}}}return u(e,[{key:"isActive",value:function(){return this.activeDownloads.length>0}},{key:"findById",value:function(e){return this.activeDownloads.find((function(t){return t.id===e}))}},{key:"bindEvents",value:function(){this.eventsBound||(a.a.downloads.onCreated.addListener(this.createdListener),a.a.downloads.onChanged.addListener(this.changedListener),a.a.downloads.onDeterminingFilename&&a.a.downloads.onDeterminingFilename.addListener(this.determineFileNameListener),this.eventsBound=!0)}},{key:"unbindEvents",value:function(){this.eventsBound&&(a.a.downloads.onCreated.removeListener&&a.a.downloads.onCreated.removeListener(this.createdListener),a.a.downloads.onChanged.removeListener&&a.a.downloads.onChanged.removeListener(this.changedListener),a.a.downloads.onDeterminingFilename&&a.a.downloads.onDeterminingFilename.removeListener&&a.a.downloads.onDeterminingFilename.removeListener(this.determineFileNameListener),this.eventsBound=!1)}},{key:"reset",value:function(){this.activeDownloads.forEach((function(e){e.timeoutTimer&&clearTimeout(e.timeoutTimer),e.countDownTimer&&clearInterval(e.countDownTimer)})),this.activeDownloads=[],this.unbindEvents()}},{key:"prepareDownload",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.activeDownloads.find((function(e){return!e.id}));if(n)throw new Error("only one not-created download allowed at a time");this.bindEvents();var a=l({timeoutForStart:1e4,timeout:6e4,wait:!1},r),o=new Promise((function(r,n){var i=Math.floor(1e3*Math.random())+1*new Date;setTimeout((function(){t.activeDownloads.push({uid:i,resolve:r,reject:n,fileName:e,promise:o,timeoutForStart:a.timeoutForStart,timeout:a.timeout,wait:a.wait})}),0)}));return o}},{key:"waitForDownloadIfAny",value:function(){var e=this,t=this.activeDownloads.find((function(e){return!e.id}));if(t)return Object(s.until)("download start",(function(){return{pass:!!t.id,result:!0}}),50,t.timeoutForStart).then((function(){return e.waitForDownloadIfAny()}));var r=this.activeDownloads.find((function(e){return e.wait&&e.id}));return r?r.promise.then((function(){return e.waitForDownloadIfAny()})):Promise.resolve(!0)}},{key:"onCountDown",value:function(e){this.countDownHandler=e}},{key:"onDownloadComplete",value:function(e){this.completeHandler=e}},{key:"hasPendingDownload",value:function(){return!!this.activeDownloads.find((function(e){return!e.id}))}}]),e}(),p=(d=void 0,function(){return d||(d=new m),d})},121:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(89),o=n(r(107)),i=r(27),s=r(4),c=r(22),l=n(r(10)),u=r(12);class d extends a.StandardStorage{constructor(e){super({encode:e.encode,decode:e.decode}),this.transformFileName=e=>e;const{extensions:t,shouldKeepExt:r,transformFileName:n,baseDir:a="share"}=e;if(!a||"/"===a)throw new Error(`Invalid baseDir, ${a}`);n&&(this.transformFileName=n),this.baseDir=a,this.extensions=t,this.shouldKeepExt=r,o.default.getDirectory(a,!0)}getLink(e){if(c.isFirefox())return this.read(e,"DataURL");{const t=`filesystem:${l.default.extension.getURL("temporary")}/${this.filePath(e)}`;return Promise.resolve(t+"?"+(new Date).getTime())}}read(e,t){const r=this.filePath(e),n=i.posix.relative(this.dirPath("/"),r);return o.default.readFile(r,t).then(e=>this.decode(e,n,t),t=>{if(-1!==t.message.indexOf("A requested file or directory could not be found"))throw new Error(`File not found: ${e}`);return Promise.reject(t)})}stat(e,t){const r=i.posix.basename(e),n=i.posix.dirname(e),a=t?this.dirPath(e):this.filePath(e),s=i.posix.relative(this.dirPath("/"),a);return o.default.existsStat(a).then(({isFile:e,isDirectory:t})=>e?o.default.getMetadata(a,t).then(o=>({dir:n,name:r,fullPath:a,relativePath:s,isFile:e,isDirectory:t,size:o.size,lastModified:o.modificationTime})):{dir:n,name:r,fullPath:a,relativePath:s,isFile:e,isDirectory:t,size:0,lastModified:new Date(0)})}__list(e="/",t=!1){const r=(e,t)=>this.shouldKeepExt||t?e:this.removeExt(e);return this.ensureBaseDir().then(()=>o.default.list(this.dirPath(e))).then(e=>{const t=e.map(e=>this.stat(e.fullPath,e.isDirectory).then(t=>Object.assign(Object.assign({},t),{name:this.transformFileName(r(t.name,e.isDirectory))})));return Promise.all(t).then(e=>(e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0),this.totalCount=e.length,this.displayedCount=e.length,e))})}__write(e,t){return this.ensureBaseDir().then(()=>this.remove(e)).catch(()=>{}).then(()=>this.encode(t,e)).then(t=>o.default.writeFile(this.filePath(e,!0),t)).then(()=>{})}__overwrite(e,t){return this.__write(e,t)}__removeFile(e){return o.default.removeFile(this.filePath(e))}__removeEmptyDirectory(e){return o.default.rmdir(this.dirPath(e))}__moveFile(e,t){return o.default.moveFile(this.filePath(e),this.filePath(t,!0)).then(()=>{})}__copyFile(e,t){return o.default.copyFile(this.filePath(e),this.filePath(t,!0)).then(()=>{})}__createDirectory(e){return o.default.getDirectory(this.dirPath(e,!0),!0).then(()=>{})}dirPath(e,t=!1){const r=this.getPathLib(),n=(()=>this.isStartWithBaseDir(e)?e:r.join("/",this.baseDir,e))(),a=r.dirname(n),o=r.basename(n),i=t?s.sanitizeFileName(o):o;return r.join(a,i)}isWin32Path(){return!1}filePath(e,t=!1){const r=i.posix.dirname(e),n=i.posix.basename(e),a=t?s.sanitizeFileName(n):n,o=i.posix.extname(n),c=this.extensions[0],l=o&&o.substr(1).toLowerCase()===c.toLowerCase()?a:a+"."+c;return this.isStartWithBaseDir(r)?i.posix.join(r,this.transformFileName(l)):i.posix.join("/",this.baseDir,r,this.transformFileName(l))}isStartWithBaseDir(e){return 0===e.indexOf("/"+this.baseDir)}ensureBaseDir(){return o.default.ensureDirectory(this.baseDir).then(()=>{})}removeExt(e){const t=i.posix.basename(e),r=i.posix.extname(e),n=t.lastIndexOf(r);return t.substring(0,n)}}t.BrowserFileSystemStandardStorage=d,t.getBrowserFileSystemStandardStorage=u.singletonGetterByKey(e=>e&&e.baseDir||"share",e=>new d(e))},122:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12);t.EACCES=n.errorClassFactory("EACCES"),t.EEXIST=n.errorClassFactory("EEXIST"),t.EISDIR=n.errorClassFactory("EISDIR"),t.EMFILE=n.errorClassFactory("EMFILE"),t.ENOENT=n.errorClassFactory("ENOENT"),t.ENOTDIR=n.errorClassFactory("ENOTDIR"),t.ENOTEMPTY=n.errorClassFactory("ENOTEMPTY")},123:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(27)),o=r(89),i=r(4),s=r(60),c=r(128),l=r(12);class u extends o.StandardStorage{constructor(e){super({encode:e.encode,decode:e.decode,listFilter:e.listFilter});const{baseDir:t,rootDir:r,extensions:n,shouldKeepExt:a=!1,allowAbsoluteFilePath:o=!1}=e;if(!t||"/"===t)throw new Error(`Invalid baseDir, ${t}`);this.rootDir=r,this.baseDir=t,this.extensions=n,this.shouldKeepExt=a,this.allowAbsoluteFilePath=o,this.fs=s.getNativeFileSystemAPI()}getLink(e){return this.read(e,"DataURL")}read(e,t){const r=this.filePath(e),n=a.default.relative(this.dirPath("/"),r),o=r=>{if(0!==r.errorCode)throw new c.ErrorWithCode(`${e}: `+c.getErrorMessageForCode(r.errorCode),r.errorCode);const a=r.content,o=(()=>{switch(t){case"Text":case"DataURL":return a;case"ArrayBuffer":return i.dataURItoArrayBuffer(a);case"BinaryString":return i.arrayBufferToString(i.dataURItoArrayBuffer(a))}})();return this.decode(o,n,t)};switch(t){case"Text":return this.fs.readAllTextCompat({path:r}).then(o);default:return this.fs.readAllBytesCompat({path:r}).then(o)}}stat(e,t){const r=a.default.dirname(e),n=a.default.basename(e),o=t?this.dirPath(e):this.filePath(e),i=a.default.relative(this.dirPath("/"),o),s={dir:r,name:n,fullPath:o,relativePath:i,isFile:!1,isDirectory:!1,lastModified:new Date(0),size:0};return(t?this.fs.directoryExists({path:o}):this.fs.fileExists({path:o})).then(e=>e?this.fs.getFileSystemEntryInfo({path:o}).then(e=>({dir:r,name:n,fullPath:o,relativePath:i,isFile:!e.isDirectory,isDirectory:e.isDirectory,lastModified:new Date(e.lastWriteTime),size:e.length}),e=>s):s)}__list(e="/",t=!1){return this.ensureBaseDir().then(()=>this.fs.getEntries({brief:t,path:this.dirPath(e),extensions:this.extensions}).then(t=>{const r=t.entries,n=t.errorCode;if(0!==n)throw new c.ErrorWithCode(c.getErrorMessageForCode(n)+`: ${e}`,n);const o=(e,t)=>this.shouldKeepExt||t?e:this.removeExt(e);return r.map(t=>{const r=this.dirPath(e),n=o(t.name,t.isDirectory),i=a.default.join(r,t.name);return{dir:r,name:n,fullPath:i,relativePath:a.default.relative(this.dirPath("/"),i),isFile:!t.isDirectory,isDirectory:t.isDirectory,lastModified:new Date(t.lastWriteTime),size:t.length}})}))}__write(e,t){return this.ensureBaseDir().then(()=>this.encode(t,e)).then(t=>this.fs.writeAllBytes({content:t,path:this.filePath(e,!0)}).then(t=>{if(!t)throw new Error(`Failed to write to '${e}'`)}))}__overwrite(e,t){return this.write(e,t)}__removeFile(e){return this.ensureBaseDir().then(()=>this.fs.deleteFile({path:this.filePath(e)}).then(()=>{}))}__removeEmptyDirectory(e){return this.ensureBaseDir().then(()=>this.fs.removeDirectory({path:this.dirPath(e)}).then(()=>{}))}__moveFile(e,t){return this.ensureBaseDir().then(()=>this.fs.moveFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}__copyFile(e,t){return this.ensureBaseDir().then(()=>this.fs.copyFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}__createDirectory(e){return this.ensureBaseDir().then(()=>this.fs.createDirectory({path:this.dirPath(e,!0)}).then(()=>{}))}dirPath(e,t=!1){const r=this.getPathLib(),n=(()=>this.isStartWithBaseDir(e)?r.normalize(e):r.normalize(r.join(this.rootDir,this.baseDir,e)))(),a=r.dirname(n),o=r.basename(n),s=t?i.sanitizeFileName(o):o;return r.join(a,s)}filePath(e,t=!1){const r=a.default.dirname(e),n=a.default.basename(e),o=t?i.sanitizeFileName(n):n,s=a.default.extname(n),c=this.extensions[0],l=s&&s.substr(1).toLowerCase()===c.toLowerCase()?o:o+"."+c;return this.isStartWithBaseDir(r)||this.allowAbsoluteFilePath&&this.isAbsoluteUrl(e)?a.default.normalize(a.default.join(r,l)):a.default.normalize(a.default.join(this.rootDir,this.baseDir,r,l))}isWin32Path(){return/^([A-Z]:\\|\/\/|\\\\)/i.test(this.rootDir)}isAbsoluteUrl(e){return this.getPathLib().isAbsolute(e)}isStartWithBaseDir(e){return 0===e.indexOf(this.rootDir)}removeExt(e){const t=a.default.basename(e),r=a.default.extname(e),n=t.lastIndexOf(r);return t.substring(0,n)}ensureBaseDir(){const e=this.fs,t=a.default.normalize(a.default.join(this.rootDir,this.baseDir));return e.directoryExists({path:t}).then(r=>r||e.createDirectory({path:t})).then(()=>{})}}t.NativeFileSystemStandardStorage=u,t.getNativeFileSystemStandardStorage=l.singletonGetterByKey(e=>a.default.join(e.rootDir,e.baseDir),e=>new u(e))},124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PublicMethodTypes=[1,2,3,4,5,8,9,10,11,12,13,14,15,16,17,18],t.MethodTypeFriendlyNames=["GetVersion","GetFileSystemEntries","GetDirectories","GetFiles","GetFileSystemEntryInfo","GetSpecialFolderPath","DirectoryExists","FileExists","CreateDirectory","RemoveDirectory","CopyFile","MoveFile","DeleteFile","ReadAllText","WriteAllText","AppendAllText","ReadAllBytes","WriteAllBytes","AppendAllBytes","GetMaxFileRange","GetFileSize","ReadFileRange","RunProcess"],t.MethodTypeInvocationNames=["get_version","get_file_system_entries","get_directories","get_files","get_file_system_entry_info","get_special_folder_path","directory_exists","file_exists","create_directory","remove_directory","copy_file","move_file","delete_file","read_all_text","write_all_text","append_all_text","read_all_bytes","write_all_bytes","append_all_bytes","get_max_file_range","get_file_size","read_file_range","run_process"]},125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(97);class a extends n.NativeMessagingHost{constructor(){super(a.HOST_NAME)}}t.KantuFileAccessHost=a,a.HOST_NAME="com.a9t9.kantu.file_access"},126:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.input=e,this.position=0}getNextByte(){if(this.position>=this.input.length)return n.END;const e=255&this.input[this.position];return++this.position,e}getNextContinuationByte(){const e=this.getNextByte();return 128==(192&e)?63&e:n.ERROR}decodeNext(){if(this.position>=this.input.length)return this.position===this.input.length?n.END:n.ERROR;const e=this.getNextByte();if(0==(128&e))return e;if(192==(224&e)){const t=this.getNextContinuationByte();if(t>=0){const r=(31&e)<<6|t;if(r>=128)return r}}else if(224==(240&e)){const t=this.getNextContinuationByte(),r=this.getNextContinuationByte();if((t|r)>=0){const n=(15&e)<<12|t<<6|r;if(n>=2048&&(n<55296||n>57343))return n}}else if(240==(248&e)){const t=this.getNextContinuationByte(),r=this.getNextContinuationByte(),n=this.getNextContinuationByte();if((t|r|n)>=0){const a=(7&e)<<18|t<<12|r<<6|n;if(a>=65536&&a<=1114111)return a}}return n.ERROR}}n.REPLACEMENT_CHARACTER="�",n.END=-1,n.ERROR=-2,function(e){e.isValid=function(e){const t=new n(e);for(;;){switch(t.decodeNext()){case n.END:return!0;case n.ERROR:return!1}}},e.decode=function(e){const t=new n(e);let r="";for(;;){const e=t.decodeNext();if(e===n.END)break;r+=e!==n.ERROR?String.fromCodePoint(e):n.REPLACEMENT_CHARACTER}return r}}(t.utf8||(t.utf8={}))},127:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){const t=new Uint8Array([65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47]),r=new Uint8Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);function n(e,t,n){if(n>4)throw new Error("maxLength should be in range [0, 4].");const a=new Uint8Array(4);for(let o=0;o<n;++o){const n=e.charCodeAt(t+o),i=r[n];if(255===i)return;a[o]=i}return(a[0]<<18)+(a[1]<<12)+(a[2]<<6)+(a[3]<<0)}function a(e,t,r){e[t+0]=r>>16&255,e[t+1]=r>>8&255,e[t+2]=255&r}e.encode=function(e){const r=e.length,n=function(e){let t=4*Math.trunc(e/3);return t+=e%3!=0?4:0,t}(r),a=r%3,o=r-a,i=new Uint8Array(n);let s,c=0;for(s=0;s<o;s+=3)i[c+0]=t[(252&e[s])>>2],i[c+1]=t[(3&e[s])<<4|(240&e[s+1])>>4],i[c+2]=t[(15&e[s+1])<<2|(192&e[s+2])>>6],i[c+3]=t[63&e[s+2]],c+=4;switch(s=o,a){case 2:i[c+0]=t[(252&e[s])>>2],i[c+1]=t[(3&e[s])<<4|(240&e[s+1])>>4],i[c+2]=t[(15&e[s+1])<<2],i[c+3]=61,c+=4;break;case 1:i[c+0]=t[(252&e[s])>>2],i[c+1]=t[(3&e[s])<<4],i[c+2]=61,i[c+3]=61,c+=4}return new TextDecoder("ascii").decode(i)},e.decode=function(e){const t=e.length;if(t%4!=0)return;let r=0;t>0&&61==e.charCodeAt(t-1)&&(++r,t>1&&61==e.charCodeAt(t-2)&&++r);const o=-4&t-r,i=new Uint8Array(6*t/8-r);let s,c=0,l=0;for(;c<o;){if(s=n(e,c,4),void 0===s)return;a(i,l,s),c+=4,l+=3}if(r>0){if(s=n(e,c,4-r),void 0===s)return;switch(r){case 1:i[l+0]=s>>16&255,i[l+1]=s>>8&255;break;case 2:i[l+0]=s>>16&255}}return i}}(t.base64||(t.base64={}))},128:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(76),o=r(60),i=n(r(27)),s=r(4),c=r(12);class l extends a.FlatStorage{constructor(e){super({encode:e.encode,decode:e.decode}),this.listFilter=e=>e,this.displayedCount=0,this.totalCount=0;const{baseDir:t,rootDir:r,extensions:n,shouldKeepExt:a=!1,listFilter:i}=e;if(!t||"/"===t)throw new Error(`Invalid baseDir, ${t}`);this.rootDir=r,this.baseDir=t,this.extensions=n,this.shouldKeepExt=a,i&&(this.listFilter=i),this.fs=o.getNativeFileSystemAPI()}getDisplayCount(){return this.displayedCount}getTotalCount(){return this.totalCount}readAll(e="Text",t){return this.list().then(r=>Promise.all(r.map(t=>this.read(t.fileName,e).then(e=>({content:e,fileName:t.fileName})).catch(e=>({fileName:t.fileName,fullFilePath:this.filePath(t.fileName),error:new Error(`Error in parsing ${this.filePath(t.fileName)}:\n${e.message}`)})))).then(e=>{const r=e.filter(e=>e.error);return t&&t(r),e.filter(e=>e.content)}))}getLink(e){return this.read(e,"DataURL")}__list(){return this.ensureDir().then(()=>this.fs.getEntries({path:i.default.join(this.rootDir,this.baseDir),extensions:this.extensions}).then(e=>{const t=e.entries,r=e.errorCode;if(0!==r)throw new u(d(r),r);const n=e=>this.shouldKeepExt?e:this.removeExt(e),o=t.map(e=>({dir:this.baseDir,fileName:n(e.name),lastModified:new Date(e.lastWriteTime),size:a.readableSize(e.length)}));return Promise.resolve(this.listFilter(o)).then(e=>(this.totalCount=o.length,this.displayedCount=e.length,e))}))}exists(e){return this.fs.fileExists({path:this.filePath(e)})}read(e,t){const r=r=>{if(0!==r.errorCode)throw new u(`${e}: `+d(r.errorCode),r.errorCode);const n=r.content,a=(()=>{switch(t){case"Text":case"DataURL":return n;case"ArrayBuffer":return s.dataURItoArrayBuffer(n);case"BinaryString":return s.arrayBufferToString(s.dataURItoArrayBuffer(n))}})();return this.decode(a,e)};switch(t){case"Text":return this.fs.readAllTextCompat({path:this.filePath(e)}).then(r);default:return this.fs.readAllBytesCompat({path:this.filePath(e)}).then(r)}}__write(e,t){return this.ensureDir().then(()=>this.encode(t,e)).then(t=>this.fs.writeAllBytes({content:t,path:this.filePath(e,!0)}).then(t=>{if(!t)throw new Error(`Failed to write to '${e}'`)}))}__overwrite(e,t){return this.remove(e).catch(()=>{}).then(()=>this.write(e,t))}__clear(){return this.list().then(e=>{const t=e.map(e=>this.remove(e.fileName));return Promise.all(t)}).then(()=>{})}__remove(e){return this.ensureDir().then(()=>this.fs.deleteFile({path:this.filePath(e)}).then(()=>{}))}__rename(e,t){return this.ensureDir().then(()=>this.fs.moveFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}__copy(e,t){return this.ensureDir().then(()=>this.fs.copyFile({sourcePath:this.filePath(e),targetPath:this.filePath(t,!0)}).then(()=>{}))}filePath(e,t=!1){const r=t?s.sanitizeFileName(e):e,n=i.default.extname(e),a=this.extensions[0],o=n&&n.substr(1).toLowerCase()===a.toLowerCase()?r:r+"."+a;return i.default.join(this.rootDir,this.baseDir,o)}removeExt(e){const t=i.default.basename(e),r=i.default.extname(e),n=t.lastIndexOf(r);return t.substring(0,n)}ensureDir(){const e=this.fs,t=i.default.join(this.rootDir,this.baseDir);return e.directoryExists({path:t}).then(r=>r||e.createDirectory({path:t})).then(()=>{})}}t.NativeFileSystemFlatStorage=l,t.getNativeFileSystemFlatStorage=c.singletonGetterByKey(e=>i.default.join(e.rootDir,e.baseDir),e=>new l(e));class u extends Error{constructor(e,t){super(e),this.name="ErrorWithCode",this.code=t;let r=!0;if("function"==typeof Error.captureStackTrace)try{Error.captureStackTrace(this,this.constructor)}catch(e){r=!1}r||(this.stack=new Error(e).stack)}}function d(e){switch(e){case 0:return"Success";case 1:return"Failed to load";case 2:return"File too large to load";default:return`Unknown error code: ${e}`}}t.ErrorWithCode=u,t.getErrorMessageForCode=d},13:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(81)),o=r(121),i=r(123),s=r(12),c=r(32),l=r(50),u=r(69),d=r(4),m=n(r(27));var p,h,f;!function(e){e.Browser="browser",e.XFile="xfile",e.Nil="nil"}(p=t.StorageStrategyType||(t.StorageStrategyType={})),function(e){e[e.Macro=0]="Macro",e[e.TestSuite=1]="TestSuite",e[e.CSV=2]="CSV",e[e.Screenshot=3]="Screenshot",e[e.Vision=4]="Vision"}(h=t.StorageTarget||(t.StorageTarget={})),function(e){e.StrategyTypeChanged="StrategyTypeChanged",e.RootDirChanged="RootDirChanged",e.ForceReload="ForceReload"}(f=t.StorageManagerEvent||(t.StorageManagerEvent={}));class g extends a.default{constructor(e,t){super(),this.strategyType=p.Nil,this.getMacros=()=>[],this.getMaxMacroCount=e=>Promise.resolve(1/0),this.setCurrentStrategyType(e),t&&t.getMacros&&(this.getMacros=t.getMacros),t&&t.getMaxMacroCount&&(this.getMaxMacroCount=t.getMaxMacroCount),this.getConfig=null==t?void 0:t.getConfig}isXFileMode(){return this.strategyType===p.XFile}isBrowserMode(){return this.strategyType===p.Browser}getCurrentStrategyType(){return this.strategyType}setCurrentStrategyType(e){const t=e!==this.strategyType;return t&&(setTimeout(()=>{this.emit(f.StrategyTypeChanged,e)},0),this.strategyType=e),t}isStrategyTypeAvailable(e){switch(e){case p.Browser:return Promise.resolve(!0);case p.XFile:return c.getXFile().sanityCheck();default:throw new Error(`type '${e}' is not supported`)}}getStorageForTarget(e,t){switch(t||this.strategyType){case p.Browser:switch(e){case h.Macro:{const e=o.getBrowserFileSystemStandardStorage({baseDir:"macros",extensions:["json"],shouldKeepExt:!1,decode:(t,r)=>{const n=l.fromJSONString(t,m.default.basename(r),{withStatus:!0});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{var r,n;const a=l.toJSONString(Object.assign(Object.assign({},e),{commands:e.data.commands}),{withStatus:!0,ignoreTargetOptions:!!(null===(n=null===(r=this.getConfig)||void 0===r?void 0:r.call(this))||void 0===n?void 0:n.saveAlternativeLocators)});return new Blob([a])}});return window.newMacroStorage=e,e}case h.TestSuite:{const e=o.getBrowserFileSystemStandardStorage({baseDir:"testsuites",extensions:["json"],shouldKeepExt:!1,decode:(t,r)=>{console.log("test suite raw content",r,t,this.getMacros());const n=u.parseTestSuite(t,{fileName:m.default.basename(r)});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{const r=u.stringifyTestSuite(e);return new Blob([r])}});return window.newTestSuiteStorage=e,e}case h.CSV:return o.getBrowserFileSystemStandardStorage({baseDir:"spreadsheets",extensions:["csv"],shouldKeepExt:!0,transformFileName:e=>e.toLowerCase()});case h.Screenshot:return o.getBrowserFileSystemStandardStorage({baseDir:"screenshots",extensions:["png"],shouldKeepExt:!0,transformFileName:e=>e.toLowerCase()});case h.Vision:return o.getBrowserFileSystemStandardStorage({baseDir:"visions",extensions:["png"],shouldKeepExt:!0,transformFileName:e=>e.toLowerCase()})}case p.XFile:{const{rootDir:t}=c.getXFile().getCachedConfig();switch(e){case h.Macro:{const e=i.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"macros",extensions:["json"],shouldKeepExt:!1,listFilter:e=>this.getMaxMacroCount(this.strategyType).then(t=>s.forestSlice(t,e)),decode:(t,r)=>{const n=l.fromJSONString(t,m.default.basename(r),{withStatus:!0});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{const r=l.toJSONString(Object.assign(Object.assign({},e),{commands:e.data.commands}),{withStatus:!0});return d.blobToDataURL(new Blob([r]))}});return e}case h.TestSuite:{const e=i.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"testsuites",extensions:["json"],shouldKeepExt:!1,decode:(t,r)=>{const n=u.parseTestSuite(t,{fileName:m.default.basename(r)});return Object.assign(Object.assign({},n),{id:e.filePath(r),path:e.relativePath(r)})},encode:(e,t)=>{const r=u.stringifyTestSuite(e);return d.blobToDataURL(new Blob([r]))}});return e}case h.CSV:return i.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"datasources",extensions:["csv"],shouldKeepExt:!0,allowAbsoluteFilePath:!0,encode:(e,t)=>d.blobToDataURL(new Blob([e]))});case h.Vision:return i.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"images",extensions:["png"],shouldKeepExt:!0,decode:v,encode:(e,t)=>d.blobToDataURL(e)});case h.Screenshot:return i.getNativeFileSystemStandardStorage({rootDir:t,baseDir:"screenshots",extensions:["png"],shouldKeepExt:!0,decode:v,encode:(e,t)=>d.blobToDataURL(e)})}}default:throw new Error(`Unsupported strategy type: '${this.strategyType}'`)}}getMacroStorage(){return this.getStorageForTarget(h.Macro)}getTestSuiteStorage(){return this.getStorageForTarget(h.TestSuite)}getCSVStorage(){return this.getStorageForTarget(h.CSV)}getVisionStorage(){return this.getStorageForTarget(h.Vision)}getScreenshotStorage(){return this.getStorageForTarget(h.Screenshot)}}function v(e,t,r){return"DataURL"!==r||"data:image"===e.substr(0,11)?e:"data:image/png;base64,"+e}t.StorageManager=g,t.getStorageManager=s.singletonGetter((e,t)=>new g(e||p.XFile,t))},136:function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return h}));var n=r(193),a=r.n(n),o=r(101),i=r.n(o),s=(r(10),r(36)),c=new RegExp("^@_KANTU_@"),l=new RegExp("^(__RPA_ENCRYPTED__|__KANTU_ENCRYPTED__)"),u=function(){return s.default.get("config").then((function(e){return{shouldEncrypt:"master_password"===e.shouldEncryptPassword,masterPassword:e.masterPassword}}))},d=function(e){return u().then((function(t){var r=t.shouldEncrypt,n=t.masterPassword;return r?"__RPA_ENCRYPTED__"+function(e,t){var r=a.a.pbkdf2Sync(t,"salt",1,32,"sha512"),n=new i.a.ModeOfOperation.ctr(r);return i.a.utils.hex.fromBytes(n.encrypt(i.a.utils.utf8.toBytes(e)))}("@_KANTU_@"+e,n):e}))},m=function(e){return u().then((function(t){var r=t.shouldEncrypt,n=t.masterPassword;if(!r)return e;var o=function(e,t){var r=a.a.pbkdf2Sync(t,"salt",1,32,"sha512"),n=new i.a.ModeOfOperation.ctr(r);return i.a.utils.utf8.fromBytes(n.decrypt(i.a.utils.hex.toBytes(e)))}(e.replace(l,""),n);if(0!==o.indexOf("@_KANTU_@"))throw new Error("Wrong master password");return o.replace(c,"")})).catch((function(e){throw new Error("password string invalid")}))},p=function(e,t){return t&&"INPUT"===t.tagName.toUpperCase()&&"password"===t.type?d(e):Promise.resolve(e)},h=function(e,t){return l.test(e)?t&&-1===["INPUT","TEXTAREA"].indexOf(t.tagName.toUpperCase())?Promise.resolve(e):m(e):Promise.resolve(e)}},137:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=n(r(1)),i=r(515),s=r(117),c=r(4),l=r(972),u=r(12),d=r(27);var m;r(973),function(e){e.File="file",e.Folder="folder"}(m=t.FileNodeType||(t.FileNodeType={}));class p extends a.default.Component{constructor(){super(...arguments),this.onToggle=(e,t)=>{e.type===m.Folder&&this.props.onToggle(e,t)},this.subnodeComponent=(()=>{const{DndFileNode:e,DndFolderNode:t}=function(e){const t=e=>t=>i.DragSource(e,{beginDrag:e=>({id:e.data.id,isDirectory:e.data.type===m.Folder})},(e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()}))(t),r=t(m.File)((function(e){return a.default.createElement(l.TreeNode,Object.assign({},e,{decorate:u.compose(e.connectDragSource,o)}))})),n=u.compose(t(m.Folder),(s=[m.Folder,m.File],t=>i.DropTarget(s,{drop(t,r,n){const a=t.data.id,o=r.getItem();e.move(o.id,a,o.isDirectory)},canDrop(e,t){const r=e.data.id,{id:n}=t.getItem();return r!==n&&r!==d.posix.dirname(n)&&t.isOver({shallow:!0})}},(e,t)=>({connectDropTarget:e.dropTarget(),highlighted:t.isOver({shallow:!0})&&t.canDrop()}))(t)))((function(e){return a.default.createElement(l.TreeNode,Object.assign({},e,{decorate:u.compose(e.connectDragSource,e.connectDropTarget,o),data:u.safeUpdateIn(["className"],(t="")=>c.cn(t,{"drag-over":e.highlighted}),e.data)}))})),o=e=>e;var s;return{DndFolderNode:n,DndFileNode:r}}({move:(e,t,r)=>{this.props.onMove(e,t,r)}});return(r,n)=>{switch(r.type){case m.File:return e;case m.Folder:return t}}})(),this.renderFileIcon=e=>{switch(e.type){case m.File:return a.default.createElement("img",{src:"./img/code.svg",className:"file-node-icon file-icon"});case m.Folder:return e.folded?a.default.createElement("img",{src:"./img/folder.svg",className:"file-node-icon folder-icon"}):a.default.createElement("img",{src:"./img/folder_expanded.svg",className:"file-node-icon folder-icon expanded"})}},this.renderFileItem=(e,t)=>a.default.createElement("div",{className:"file-node-title"},a.default.createElement("span",null,e.name)),this.renderFileItemExtra=(e,t)=>a.default.createElement(s.Icon,{type:"bars",className:"more-button",onClick:r=>this.props.onContextMenu(e,t,r)})}shouldComponentUpdate(e){return!u.isForestEqual((e,t)=>e.entryPath===t.entryPath&&e.folded===t.folded&&e.type===t.type&&e.className===t.className,this.props.nodes,e.nodes)}render(){const{nodes:e}=this.props,{connectDropTarget:t,highlighted:r}=this.props;return t(a.default.createElement("div",{className:c.cn("file-root",{"drag-over":r})},e.map((e,t)=>{const r=this.subnodeComponent(e,[t]);return a.default.createElement(r,{key:e.id,data:e,paths:[t],commonClass:"file-node",renderIcon:this.renderFileIcon,renderItem:this.renderFileItem,renderItemExtra:this.renderFileItemExtra,subnodeComponent:this.subnodeComponent,onClick:this.props.onClick,onDoubleClick:this.props.onDoubleClick,onContextMenu:this.props.onContextMenu,onToggle:this.onToggle,foldOnClickTitle:!0})})))}}t.InternalFileTree=p,p.propTypes={nodes:o.default.array.isRequired,onMove:o.default.func.isRequired,onClick:o.default.func.isRequired,onDoubleClick:o.default.func.isRequired,onContextMenu:o.default.func.isRequired},t.FileTree=i.DropTarget([m.Folder,m.File],{drop(e,t,r){const n=e.rootPath,a=t.getItem();e.onMove(a.id,n,a.isDirectory)},canDrop(e,t){const r=e.rootPath,{id:n}=t.getItem();return r!==n&&(r!==d.posix.dirname(n)&&t.isOver({shallow:!0}))}},(e,t)=>({connectDropTarget:e.dropTarget(),highlighted:t.isOver({shallow:!0})&&t.canDrop()}))(p)},146:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(157),o=r(357),i=r(504),s=r(505),c=r(506),l=n(r(159)),u=[new o.ProxyManagerViaListenerAPI,new s.ProxyManagerViaPacAPI,new i.ProxyManagerViaSettingsAPI],d=new c.ProxyHttpAuth({getAuth:(e,t)=>m().getAuth(e,t)});function m(){for(let e=0,t=u.length;e<t;e++)if(u[e].isSupported())return u[e];throw new Error("Unable to use proxy")}t.getProxyManager=m,t.setProxy=function(e){return new Promise((t,r)=>{const n=m();n.isControllable(!1).then(t=>{if(!t)throw new Error(l.default.proxy.notControllable);return d.bind(),e?n.setProxy(e):n.reset()}).then(t,r)})},t.parseProxyUrl=function(e,t){const r=new URL(e),n=new URL(e.replace(/\s*socks[45]/i,"http")),o=n.hostname,i=(()=>{switch(r.protocol){case"http:":return a.ProxyScheme.Http;case"https:":return a.ProxyScheme.Https;case"socks4:":return a.ProxyScheme.Socks4;case"socks5:":return a.ProxyScheme.Socks5;default:throw new Error("Invalid proxy protocol")}})(),s=(()=>{if(n.port)return n.port;switch(i){case a.ProxyScheme.Http:return"80";case a.ProxyScheme.Https:return"443";case a.ProxyScheme.Socks4:case a.ProxyScheme.Socks5:return"1080"}})();if(!o||!o.length)throw new Error("No host found in proxy");if(!s||isNaN(parseInt(s,10)))throw new Error("No valid port found in proxy");const{username:c,password:l}=(()=>{if(!t||!t.length)return{};const e=t.indexOf(",");return-1===e?{username:t}:{username:t.substr(0,e),password:t.substr(e+1)}})();return{type:i,host:o,port:s,username:c,password:l}}},153:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(36)),o=r(12);function i(e){return e.split("::").filter(e=>e.length>0)}t.parseKey=i;t.KeyValueData=class{constructor(){this.withOneLock=o.concurrent(1)(e=>new Promise((t,r)=>{try{Promise.resolve(e()).then(t,r)}catch(e){r(e)}}))}get(e){const[t,r]=this.getMainKeyAndSubKeys(e);return a.default.get(t).then((e={})=>o.getIn(r,e))}set(e,t){return this.withOneLock(()=>{const[r,n]=this.getMainKeyAndSubKeys(e);return a.default.get(r).then((e={})=>{const i=o.safeSetIn(n,t,e);return a.default.set(r,i).then(()=>o.getIn(n,i))})})}update(e,t){return this.withOneLock(()=>{const[r,n]=this.getMainKeyAndSubKeys(e);return a.default.get(r).then((e={})=>{const i=o.safeUpdateIn(n,t,e);return a.default.set(r,i).then(()=>o.getIn(n,i))})})}getMainKeyAndSubKeys(e){const t=i(e);return[t[0],t.slice(1)]}}},157:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Http="http",e.Https="https",e.Socks4="socks4",e.Socks5="socks5"}(t.ProxyScheme||(t.ProxyScheme={})),function(e){e.Direct="direct",e.Http="http",e.Https="https",e.Socks4="socks4",e.Socks5="socks"}(t.FirefoxProxyType||(t.FirefoxProxyType={}))},159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={proxy:{notControllable:"The proxy settings are controlled by other app(s) or extension(s). Please disable or uninstall the apps or extensions in conflict"},contentHidden:"Content is hidden during replay"}},16:function(e,t,r){"use strict";r.r(t),r.d(t,"findSameNameMacro",(function(){return B})),r.d(t,"findSamePathMacro",(function(){return X})),r.d(t,"findMacrosInFolder",(function(){return K})),r.d(t,"findSameNameTestSuite",(function(){return $})),r.d(t,"setRoute",(function(){return Y})),r.d(t,"startRecording",(function(){return W})),r.d(t,"stopRecording",(function(){return G})),r.d(t,"startInspecting",(function(){return H})),r.d(t,"stopInspecting",(function(){return z})),r.d(t,"startPlaying",(function(){return q})),r.d(t,"stopPlaying",(function(){return J})),r.d(t,"doneInspecting",(function(){return Z})),r.d(t,"increaseRecordedCount",(function(){return Q})),r.d(t,"appendCommand",(function(){return ee})),r.d(t,"duplicateCommand",(function(){return te})),r.d(t,"insertCommand",(function(){return re})),r.d(t,"updateCommand",(function(){return ne})),r.d(t,"removeCommand",(function(){return ae})),r.d(t,"selectCommand",(function(){return oe})),r.d(t,"cutCommand",(function(){return ie})),r.d(t,"copyCommand",(function(){return se})),r.d(t,"pasteCommand",(function(){return ce})),r.d(t,"normalizeCommands",(function(){return le})),r.d(t,"updateSelectedCommand",(function(){return ue})),r.d(t,"toggleComment",(function(){return de})),r.d(t,"toggleCommentOnSelectedCommand",(function(){return me})),r.d(t,"setSourceError",(function(){return pe})),r.d(t,"setSourceCurrent",(function(){return he})),r.d(t,"saveSourceCodeToEditing",(function(){return fe})),r.d(t,"saveEditingAsExisted",(function(){return ge})),r.d(t,"saveEditingAsNew",(function(){return ve})),r.d(t,"setTestCases",(function(){return be})),r.d(t,"resetEditing",(function(){return ye})),r.d(t,"resetEditingIfNeeded",(function(){return we})),r.d(t,"setEditing",(function(){return Ee})),r.d(t,"editTestCase",(function(){return xe})),r.d(t,"editNewTestCase",(function(){return Se})),r.d(t,"upsertTestCase",(function(){return Ce})),r.d(t,"addTestCases",(function(){return Te})),r.d(t,"removeTestCase",(function(){return _e})),r.d(t,"removeCurrentTestCase",(function(){return Oe})),r.d(t,"setPlayerState",(function(){return ke})),r.d(t,"setTimeoutStatus",(function(){return Pe})),r.d(t,"addPlayerWarningCommandIndex",(function(){return Ie})),r.d(t,"addPlayerErrorCommandIndex",(function(){return Me})),r.d(t,"addLog",(function(){return Ae})),r.d(t,"clearLogs",(function(){return De})),r.d(t,"addScreenshot",(function(){return Ne})),r.d(t,"clearScreenshots",(function(){return Re})),r.d(t,"addVision",(function(){return je})),r.d(t,"clearVisions",(function(){return Le})),r.d(t,"updateConfig",(function(){return Fe})),r.d(t,"setMacrosExtra",(function(){return Ve})),r.d(t,"setTestSuitesExtra",(function(){return Ue})),r.d(t,"updateMacroExtra",(function(){return Be})),r.d(t,"updateMacroPlayStatus",(function(){return Xe})),r.d(t,"updateMacroBreakpoints",(function(){return Ke})),r.d(t,"updateMacroDoneCommandsIndices",(function(){return $e})),r.d(t,"updateMacroErrorCommandsIndices",(function(){return Ye})),r.d(t,"updateMacroWarningCommandsIndices",(function(){return We})),r.d(t,"updateProxy",(function(){return Ge})),r.d(t,"commonPlayerState",(function(){return He})),r.d(t,"playerPlay",(function(){return ze})),r.d(t,"listCSV",(function(){return qe})),r.d(t,"listScreenshots",(function(){return Je})),r.d(t,"listVisions",(function(){return Ze})),r.d(t,"renameVisionImage",(function(){return Qe})),r.d(t,"setTestSuites",(function(){return et})),r.d(t,"addTestSuite",(function(){return tt})),r.d(t,"addTestSuites",(function(){return rt})),r.d(t,"removeTestSuite",(function(){return nt})),r.d(t,"setPlayerMode",(function(){return at})),r.d(t,"runBackup",(function(){return ot})),r.d(t,"setVariables",(function(){return it})),r.d(t,"updateUI",(function(){return st})),r.d(t,"addBreakpoint",(function(){return ct})),r.d(t,"removeBreakpoint",(function(){return lt})),r.d(t,"setEditorActiveTab",(function(){return ut})),r.d(t,"preinstall",(function(){return dt}));var n=r(15),a=r.n(n),o=r(21),i=r(4),s=r(20),c=r(36),l=r(13),u=r(114),d=(r(28),r(358)),m=r(11),p=r.n(m),h=r(50),f=r(69),g=r(34),v=r.n(g),b={"Core/DemoAutofill":{CreationDate:"2020-05-28",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"store",Target:"15",Value:"!TIMEOUT_WAIT"},{Command:"store",Target:"60",Value:"!TIMEOUT_PAGELOAD"},{Command:"open",Target:"https://docs.google.com/forms/d/1cbI5dMRs0-t_IwNzPm6T3lAG_nPgsnJZEA-FEYVARxg/",Value:""},{Command:"click",Target:'//span[contains(text(),"UI.Vision IDE")]',Value:""},{Command:"click",Target:"//*[text()[contains(.,'Web Testing')]]",Value:""},{Command:"click",Target:'//span[contains(text(),"Form Autofilling")]',Value:""},{Command:"click",Target:'//*[text()[contains(.,"General Web Automation")]]',Value:""},{Command:"pause",Target:"500",Value:""},{Command:"captureScreenshot",Target:"AutoFill1stPage${!LOOP}",Value:""},{Command:"clickAndWait",Target:'xpath=//*[@id="mG61Hd"]/div/div/div[3]/div/div/div/span/span',Value:"",Targets:['xpath=//*[@id="mG61Hd"]/div/div/div[3]/div/div/div/span/span','xpath=//*[@id="mG61Hd"]/div[2]/div/div[3]/div/div/div/span/span']},{Command:"type",Target:"xpath=//input[@type='text']",Value:"This is a single line test..."},{Command:"type",Target:"xpath=//textarea",Value:"...and this a multiline test:\nLine2\nLine3"},{Command:"captureScreenshot",Target:"AutoFill2ndPage${!LOOP}",Value:""},{Command:"pause",Target:"1000",Value:""},{Command:"clickAndWait",Target:'xpath=//*[@id="mG61Hd"]/div/div/div[3]/div[1]/div[1]/div[2]/span/span',Value:""},{Command:"captureScreenshot",Target:"AutoFill3rdPage${!LOOP}",Value:""},{Command:"echo",Target:"DemoAutofill macro completed (shown as notification because of #shownotification in the 3rd column)",Value:"#shownotification"},{Command:"comment",Target:"Open form filling tutorial page",Value:""},{Command:"open",Target:"https://ui.vision/rpa/docs/selenium-ide/form-filling",Value:""},{Command:"assertTitle",Target:"*Form Filling*",Value:""}]},"Core/DemoDragDrop":{CreationDate:"2017-10-18",Commands:[{Command:"open",Target:"https://ui.vision/demo/webtest/dragdrop/",Value:""},{Command:"echo",Target:"Reduce replay speed so we can better see what is going on...",Value:""},{Command:"store",Target:"medium",Value:"!replayspeed"},{Command:"dragAndDropToObject",Target:"id=one",Value:"id=bin"},{Command:"dragAndDropToObject",Target:"id=two",Value:"id=bin"},{Command:"dragAndDropToObject",Target:"id=three",Value:"id=bin"},{Command:"dragAndDropToObject",Target:"id=four",Value:"id=bin"},{Command:"dragAndDropToObject",Target:"id=five",Value:"id=bin"}]},"Core/DemoDownload":{CreationDate:"2018-11-23",Commands:[{Command:"store",Target:"60",Value:"!timeout_download"},{Command:"store",Target:"10",Value:"!timeout_wait"},{Command:"executeScript_Sandbox",Target:"var d=new Date(); return d.getFullYear() + '-' +((d.getMonth()+1))+'-' +d.getDate();",Value:"todaydate"},{Command:"echo",Target:"Today is ${todaydate}",Value:""},{Command:"open",Target:"https://ui.vision/demo/filedownload",Value:""},{Command:"onDownload",Target:"DownloadTest1_${todaydate}.exe",Value:"true"},{Command:"store",Target:"${!runtime}",Value:"starttime"},{Command:"click",Target:"linkText=XModules for Windows",Value:""},{Command:"echo",Target:"File name on disk is ${!LAST_DOWNLOADED_FILE_NAME}",Value:"blue"},{Command:"executeScript_Sandbox",Target:"return parseFloat(${!runtime})-parseFloat(${starttime})",Value:"downloadtime"},{Command:"echo",Target:"Download1 (Windows version) took ${downloadtime} seconds",Value:"blue"},{Command:"onDownload",Target:"DownloadTest2_${todaydate}.exe",Value:"true"},{Command:"store",Target:"${!runtime}",Value:"starttime"},{Command:"click",Target:"partialLinkText=for macOS",Value:""},{Command:"echo",Target:"File name on disk is ${!LAST_DOWNLOADED_FILE_NAME}",Value:"green"},{Command:"executeScript_Sandbox",Target:"return parseFloat(${!runtime})-parseFloat(${starttime})",Value:"downloadtime"},{Command:"echo",Target:"Download2 (Mac) took ${downloadtime} seconds",Value:"green"},{Command:"echo",Target:"All done...",Value:""},{Command:"clickAndWait",Target:"linkText=OnDownload command",Value:""}]},"Core/DemoExtract":{CreationDate:"2018-05-28",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"open",Target:"https://ui.vision/demo/executescript",Value:""},{Command:"echo",Target:"Current page URL = ${!URL}",Value:""},{Command:"echo",Target:"Current loop value = ${!LOOP}",Value:""},{Command:"echo",Target:"This macro shows various methods to extract and save data from a website",Value:""},{Command:"storeAttribute",Target:"css=img.responsive-img@src",Value:"mylink"},{Command:"echo",Target:"href=${mylink}",Value:""},{Command:"storeAttribute",Target:"css=img.responsive-img@alt",Value:"myalttext"},{Command:"echo",Target:"alt text = ${myalttext}",Value:""},{Command:"storeAttribute",Target:"//input[@id='sometext']@size",Value:"boxsize"},{Command:"echo",Target:"input box size =${boxsize}",Value:""},{Command:"type",Target:"id=sometext",Value:"This box is ${boxsize} chars wide"},{Command:"executeScript",Target:"document.title = ${boxsize};",Value:""},{Command:"assertTitle",Target:"70",Value:""},{Command:"click",Target:'//*[@id="content"]/div[2]/div/h2[3]',Value:""},{Command:"storeText",Target:'//*[@id="content"]/div[2]/div/h2[3]',Value:"myheader"},{Command:"echo",Target:"header = ${myheader}",Value:""},{Command:"storeTitle",Target:"",Value:"mytitle"},{Command:"echo",Target:"page title = ${mytitle}",Value:""},{Command:"echo",Target:"page title = ${mytitle}",Value:""},{Command:"echo",Target:"page title = ${mytitle}",Value:""},{Command:"echo",Target:"page title = ${mytitle}",Value:""},{Command:"echo",Target:"Now test some extraction with storeValue",Value:""},{Command:"storeValue",Target:"id=sometext",Value:"mytext"},{Command:"select",Target:"id=tesla",Value:"label=Model Y"},{Command:"storeValue",Target:"id=tesla",Value:"mytesla"},{Command:"echo",Target:"The text box contains [${mytext}] and the select box has the value [${mytesla}] selected",Value:""},{Command:"verifyValue",Target:"id=tesla",Value:"y"},{Command:"storeChecked",Target:"name=vehicle",Value:"hasbike"},{Command:"storeChecked",Target:"xpath=(//input[@name='vehicle'])[2]",Value:"hascar"},{Command:"storeChecked",Target:"xpath=(//input[@name='vehicle'])[3]",Value:"hasboat"},{Command:"echo",Target:"User has bike:${hasbike}, car:${hascar}, boat:${hasboat}",Value:"green"},{Command:"comment",Target:"Search and extract directly from the page SOURCE",Value:"y"},{Command:"sourceExtract",Target:"regex=[\\$\\£\\€](\\d+(?:\\.\\d{1,2})?)",Value:"match1"},{Command:"sourceExtract",Target:"regex=[\\$\\£\\€](\\d+(?:\\.\\d{1,2})?)@2",Value:"match2"},{Command:"comment",Target:"You can also extract without regex with the * symbol",Value:"match2b"},{Command:"sourceExtract",Target:"$*<",Value:"match2b"},{Command:"echo",Target:"Coffee costs ${match1} and tea ${match2}",Value:"blue"},{Command:"sourceExtract",Target:"regex=_width: (\\d+)",Value:"match1"},{Command:"sourceExtract",Target:"regex=_width: (\\d+)@1,1",Value:"match1group1"},{Command:"sourceExtract",Target:"regex=_width: (\\d+)@2",Value:"match2"},{Command:"sourceExtract",Target:"regex=_width: (\\d+)@2,1",Value:"match2group1"},{Command:"echo",Target:"match1 = [${MATCH1}] (group1 = [${match1group1}]) match2 =  [${MATCH2}]  (group1 = [${MATCH2GROUP1}])",Value:"blue"},{Command:"comment",Target:"Extract Google Analytics ID",Value:""},{Command:"sourceExtract",Target:"UA-*,",Value:"ga_option1"},{Command:"sourceExtract",Target:"regex=UA-[0-9]+-[0-9]+",Value:"ga_option2"},{Command:"echo",Target:"Google Analytics ID = ${ga_option2}",Value:"pink"},{Command:"comment",Target:"Some assertion test for QA",Value:""},{Command:"if_v2",Target:"${match2group1} != 22",Value:""},{Command:"throwError",Target:"Regex Extraction failed for Match2(1):  ${match2group1}",Value:""},{Command:"end",Target:"",Value:""},{Command:"echo",Target:"Last but not least, taking a screenshot is another way to extract data",Value:""},{Command:"captureScreenshot",Target:"myscreenshot_${mytitle}",Value:""},{Command:"storeImage",Target:'//*[@id="page-header"]/div/div/h1',Value:"pagetitle.png"},{Command:"comment",Target:"Export images to download folder",Value:""},{Command:"localStorageExport",Target:"myscreenshot_${mytitle}.png",Value:""},{Command:"localStorageExport",Target:"pagetitle.png",Value:""}]},"Core/DemoFrames":{CreationDate:"2020-05-27",Commands:[{Command:"open",Target:"https://ui.vision/demo/webtest/frames/",Value:""},{Command:"echo",Target:"Reduce replay speed so we can better see what is going on...",Value:""},{Command:"store",Target:"medium",Value:"!replayspeed"},{Command:"selectFrame",Target:"index=0",Value:""},{Command:"click",Target:"name=mytext1",Value:""},{Command:"type",Target:"name=mytext1",Value:"Frame1 (index=0)"},{Command:"selectFrame",Target:"relative=top",Value:""},{Command:"selectFrame",Target:"index=1",Value:""},{Command:"click",Target:"name=mytext2",Value:""},{Command:"type",Target:"name=mytext2",Value:"Frame2 (index=1)"},{Command:"selectFrame",Target:"relative=top",Value:""},{Command:"selectFrame",Target:"index=2",Value:""},{Command:"click",Target:"name=mytext3",Value:""},{Command:"type",Target:"name=mytext3",Value:"Frame3 (index=2)"},{Command:"selectFrame",Target:"relative=top",Value:""},{Command:"selectFrame",Target:"index=3",Value:""},{Command:"click",Target:"name=mytext4",Value:""},{Command:"type",Target:"name=mytext4",Value:"Frame4 (index=3)"},{Command:"selectFrame",Target:"relative=top",Value:""},{Command:"selectFrame",Target:"index=4",Value:""},{Command:"click",Target:"name=mytext5",Value:""},{Command:"type",Target:"name=mytext5",Value:"Frame5 (index=4)"},{Command:"selectFrame",Target:"relative=top",Value:""},{Command:"selectFrame",Target:"index=2",Value:""},{Command:"type",Target:"name=mytext3",Value:"now testing iframe inside this frame"},{Command:"selectFrame",Target:"index=0",Value:""},{Command:"click",Target:'//span[contains(text(),"UI.Vision IDE")]',Value:""},{Command:"click",Target:"css=input.quantumWizTextinputSimpleinputInput.exportInput",Value:""},{Command:"type",Target:"css=input.quantumWizTextinputSimpleinputInput.exportInput",Value:"iframe in frame: works!"},{Command:"clickAndWait",Target:"xpath=//div[3]/div/div/div/span",Value:"",Targets:['xpath=//*[@id="mG61Hd"]/div[2]/div/div[3]/div/div/div/span',"xpath=//div[3]/div/div/div/span"]},{Command:"type",Target:"name=entry.1572386418",Value:"Form Filling Test Done!"},{Command:"click",Target:'xpath=//*[@id="mG61Hd"]/div/div/div[3]/div[1]/div[1]/div[2]/span/span',Value:""},{Command:"selectFrame",Target:"relative=top",Value:""},{Command:"selectFrame",Target:"index=2",Value:""},{Command:"type",Target:"name=mytext3",Value:"Test completed!"}]},"Core/DemoTakeScreenshots":{CreationDate:"2018-1-25",Commands:[{Command:"open",Target:"https://ui.vision/blog/",Value:""},{Command:"captureEntirePageScreenshot",Target:"rpablog",Value:""},{Command:"clickAndWait",Target:"linkText=read more@POS=1",Value:""},{Command:"captureEntirePageScreenshot",Target:"article1",Value:""},{Command:"open",Target:"https://ui.vision/blog/",Value:""},{Command:"clickAndWait",Target:"linkText=read more@POS=2",Value:""},{Command:"captureEntirePageScreenshot",Target:"article2",Value:""},{Command:"captureScreenshot",Target:"article2_just_viewport",Value:""},{Command:"comment",Target:"take screenshot of an _element_ with storeImage",Value:""},{Command:"storeImage",Target:"partialLinkText=Blog",Value:"blogtitle"}]},"Core/DemoIfElse":{CreationDate:"2018-4-28",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"open",Target:"https://ui.vision/demo/executeScript",Value:""},{Command:"echo",Target:"How to use gotoIf and label(s) for flow control. For a while/endWhile demo, see the DemoSaveCSV macro.",Value:""},{Command:"executeScript",Target:"return (new Date().getHours())",Value:"mytime"},{Command:"echo",Target:"mytime = ${mytime}",Value:""},{Command:"if_v2",Target:"${mytime}  > 16",Value:""},{Command:"echo",Target:"Good afternoon!",Value:""},{Command:"else",Target:"",Value:""},{Command:"echo",Target:"Good morning!",Value:""},{Command:"end",Target:"",Value:""},{Command:"storeAttribute",Target:"//input[@id='sometext-WRONG-ID-TEST']@size",Value:"boxsize"},{Command:"if_v2",Target:'${boxsize} == "#LNF"',Value:""},{Command:"echo",Target:"The xpath was not found. In this case the variable gets filled with #LNF (Locator Not Found).",Value:"blue"},{Command:"storeAttribute",Target:"//input[@id='sometext']@size",Value:"boxsize"},{Command:"echo",Target:"With correct Xpath ID we get: Boxsize = ${boxsize}",Value:"green"},{Command:"end",Target:"",Value:""},{Command:"gotoIf_v2",Target:"${boxsize} > 70",Value:"BOX-TOO-BIG"},{Command:"type",Target:"id=sometext",Value:"This box is ${boxsize} chars wide"},{Command:"executeScript",Target:"document.title = ${boxsize};",Value:""},{Command:"gotoLabel",Target:"END",Value:""},{Command:"label",Target:"BOX-TOO-BIG",Value:""},{Command:"echo",Target:"Input box too big. This is just a test of gotoIf",Value:""},{Command:"executeScript",Target:'document.title = "Just a gotoIf test. This line should not be reached unless you edit the macro"',Value:""},{Command:"label",Target:"END",Value:""},{Command:"echo",Target:"test case completed",Value:""},{Command:"comment",Target:"",Value:""},{Command:"onError",Target:"#goto",Value:"fixerror"},{Command:"type",Target:"id=sometext",Value:"this line works"},{Command:"type",Target:"id=sometextXXXXX",Value:"this line has the wrong ID..."},{Command:"echo",Target:"this line is never reached, because of the error above",Value:"blue"},{Command:"gotoLabel",Target:"end-part2",Value:""},{Command:"label",Target:"fixerror",Value:""},{Command:"echo",Target:"here we can have code that handles the error..",Value:"green"},{Command:"type",Target:"id=sometext",Value:"Fix Error Section: This command works."},{Command:"label",Target:"end-part2",Value:""}]},"Core/DemoIframe":{CreationDate:"2020-8-8",Commands:[{Command:"open",Target:"https://ui.vision/demo/iframes",Value:""},{Command:"click",Target:'//*[@id="content"]/div[2]/div/p[1]',Value:""},{Command:"click",Target:'//*[@id="content"]/div[2]/div/h2[1]',Value:""},{Command:"comment",Target:"First iframe: Embedded Google Doc",Value:""},{Command:"selectFrame",Target:"index=0",Value:""},{Command:"click",Target:'//span[contains(text(),"UI.Vision IDE")]',Value:""},{Command:"click",Target:'//span[contains(text(),"Web Testing")]',Value:""},{Command:"click",Target:'//span[contains(text(),"Form Autofilling")]',Value:""},{Command:"click",Target:'//span[contains(text(),"General Web Automation")]',Value:""},{Command:"clickAndWait",Target:"css=span.quantumWizButtonPaperbuttonLabel.exportLabel",Value:""},{Command:"type",Target:"xpath=//input[@type='text']",Value:"This is the iframe web automation test."},{Command:"click",Target:"xpath=//div[3]/div/div/div/span/span",Value:""},{Command:"click",Target:"xpath=//div[2]/span/span",Value:""},{Command:"comment",Target:"Back to main page (top frame)",Value:""},{Command:"selectFrame",Target:"relative=top",Value:""}]},"Core/DemoImplicitWaiting":{CreationDate:"2019-8-5",Commands:[{Command:"comment",Target:"waitForElementVisible is not part of implicit waiting",Value:""},{Command:"open",Target:"https://ui.vision/demo/waitforelementvisible",Value:""},{Command:"waitForElementVisible",Target:"css=#div1 > h1",Value:""},{Command:"click",Target:"css=#div1 > h1",Value:""},{Command:"store",Target:"20",Value:"!timeout_wait"},{Command:"waitForElementVisible",Target:"css=#div2 > h1",Value:""},{Command:"click",Target:"css=#div2 > h1",Value:""},{Command:"comment",Target:"Implicit waiting: Wait for elements to be loaded  or <timeout_wait> is reached",Value:""},{Command:"open",Target:"https://ui.vision/demo/webtest/implicitwaiting/",Value:""},{Command:"store",Target:"15",Value:"!TIMEOUT_WAIT"},{Command:"assertText",Target:"/html/body/header/center/p[2]",Value:"Use the select box to start the timer..."},{Command:"select",Target:"id=minutesSelect",Value:"label=5 Seconds"},{Command:"echo",Target:"The next element (target) is not available yet... UI.Vision RPA waits for it up to ${!TIMEOUT_WAIT} seconds to appear.",Value:"blue"},{Command:"click",Target:"/html/body/header/center/img",Value:""}]},"Core/DemoCsvReadWithLoop":{CreationDate:"2019-03-23",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"comment",Target:"The file ReadCSVTestData.csv is pre-installed with UI.Vision RPA.",Value:""},{Command:"csvRead",Target:"ReadCSVTestData.csv",Value:""},{Command:"comment",Target:"Call subroutine for the actual form filling",Value:""},{Command:"run",Target:"Sub/Sub_DemoCsvRead_FillForm",Value:""}]},"Core/DemoCsvReadWithWhile":{CreationDate:"2018-1-25",Commands:[{Command:"store",Target:"180",Value:"!timeout_macro"},{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"comment",Target:"The file ReadCSVTestData.csv is pre-installed with UI.Vision RPA.",Value:""},{Command:"csvRead",Target:"ReadCSVTestData.csv",Value:""},{Command:"echo",Target:"Status = ${!csvReadStatus}, line = ${!csvReadLineNumber}",Value:""},{Command:"while_v2",Target:'${!csvReadStatus} == "OK"',Value:""},{Command:"echo",Target:"status = ${!csvReadStatus}, line = ${!csvReadLineNumber}",Value:""},{Command:"comment",Target:"Call subroutine for the actual form filling",Value:""},{Command:"run",Target:"Sub/Sub_DemoCsvRead_FillForm",Value:""},{Command:"executeScript_Sandbox",Target:"return Number(${!csvReadLineNumber})+1",Value:"!csvReadLineNumber"},{Command:"store",Target:"true",Value:"!errorIgnore"},{Command:"echo",Target:"Reading CSV line No.  ${!csvReadLineNumber} ",Value:"!errorIgnore"},{Command:"csvRead",Target:"ReadCSVTestData.csv",Value:""},{Command:"store",Target:"false",Value:"!errorIgnore"},{Command:"end",Target:"",Value:""}]},"Core/DemoCsvReadArray":{CreationDate:"2020-03-23",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"comment",Target:"Create an array and save the content to a CSV file",Value:""},{Command:"executeScript_Sandbox",Target:"var arr = []; for(var x = 0; x < 5; x++){arr[x] = []; for(var y = 0; y < 3; y++){arr[x][y] = (x+1)*(y+1);}}; return arr",Value:"array1"},{Command:"comment",Target:"Manually set two array values ",Value:""},{Command:"executeScript_Sandbox",Target:"var newArr = ${array1}; newArr[0][2] = 'Hello World'; return newArr",Value:"array1"},{Command:"executeScript_Sandbox",Target:"var newArr = ${array1}; newArr[2][1] = 'This is how you set an array value'; return newArr",Value:"array1"},{Command:"csvSaveArray",Target:"array1",Value:"data_from_array.csv"},{Command:"comment",Target:"Read the array again from csv file",Value:""},{Command:"csvReadArray",Target:"data_from_array.csv",Value:"myCSV"},{Command:"echo",Target:"Number of rows = ${!CsvReadMaxRow}",Value:"green"},{Command:"executeScript_Sandbox",Target:"return ${mycsv[0]}.length;",Value:"col"},{Command:"echo",Target:"Number of columns = ${col}",Value:"pink"},{Command:"comment",Target:"loop over all CSV values",Value:""},{Command:"forEach",Target:"myCSV",Value:"row"},{Command:"echo",Target:"col1=${row[0]}, col2=${row[1]}, col3=${row[2]}",Value:"brown"},{Command:"forEach",Target:"row",Value:"elem"},{Command:"echo",Target:"Element=${elem}",Value:"blue"},{Command:"end",Target:"row",Value:"elem"},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"Another way to loop over the array content",Value:""},{Command:"times",Target:"${!CsvReadMaxRow}",Value:""},{Command:"comment",Target:"Substract 1 from !times, as the array index starts with 0",Value:""},{Command:"executeScript_Sandbox",Target:"return ${!times} - 1;",Value:"i"},{Command:"echo",Target:"Row ${i}, 3rd Element => ${myCSV[${i}][2]}",Value:"blue"},{Command:"end",Target:"",Value:""}]},"Core/DemoCsvSave":{CreationDate:"2018-06-01",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"open",Target:"https://ui.vision/demo/csvsave",Value:""},{Command:"executeScript_Sandbox",Target:'var d = new Date(); m = d.getFullYear()+"-"+(d.getMonth()+1)+"-"+ d.getDate()+" "+ d.getHours()+":" + d.getMinutes() + ":" + d.getSeconds(); return m',Value:"timestamp"},{Command:"store",Target:"${timestamp}",Value:"!csvLine"},{Command:"echo",Target:"First column in the CSV is time (${timestamp})",Value:""},{Command:"echo",Target:"Set i = 1 as we start the extraction with the 2nd table cell.",Value:""},{Command:"store",Target:"1",Value:"i"},{Command:"while_v2",Target:"(${i} < 8)",Value:""},{Command:"executeScript",Target:"return Number (${i}) + 1",Value:"i"},{Command:"echo",Target:"Current value of i = ${i}",Value:"i"},{Command:"storeText",Target:'//*[@id="gcw_mainFNGP5XSu6"]/div[2]/table/tbody/tr[2]/td[${i}]/a',Value:"c2"},{Command:"store",Target:"${c2}",Value:"!csvLine"},{Command:"echo",Target:"Extracted Value for i=${i} is exchange rate = ${c2}",Value:""},{Command:"end",Target:"",Value:""},{Command:"echo",Target:"${!csvLine}",Value:""},{Command:"comment",Target:"Append content of !csvLine to CSV file (or create file if none exists)",Value:""},{Command:"csvSave",Target:"CurrencyConverterData",Value:""},{Command:"comment",Target:"If needed, you can download (save) the CSV data from the CSV tab to the the download folder",Value:""},{Command:"localStorageExport",Target:"currencyconverterdata.csv",Value:""}]},"XModules/DemoPDFTest_with_OCR":{CreationDate:"2019-01-18",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"if_v2",Target:'${!browser} =="firefox"',Value:""},{Command:"throwError",Target:"This macro works only in Chrome and Edge - Firefox does not support automating PDF documents yet.",Value:""},{Command:"end",Target:"",Value:""},{Command:"open",Target:"http://download.ui.vision/demo/pdf-test.pdf",Value:""},{Command:"setWindowSize",Target:"800x700",Value:""},{Command:"comment",Target:"Check that PDF is loaded OK",Value:""},{Command:"comment",Target:"Option 1: Check with image search",Value:""},{Command:"visualAssert",Target:"pdftest_salesquote.png@0.35",Value:""},{Command:"comment",Target:"Option 2: Check with text search  search",Value:""},{Command:"store",Target:"ENG",Value:"!ocrlanguage"},{Command:"OCRSearch",Target:"sales quote",Value:"matches"},{Command:"echo",Target:"Number of matches: ${matches}",Value:"green"},{Command:"if_v2",Target:'${matches} == "0"',Value:""},{Command:"throwError",Target:"Something wrong, I can not find the text <sales quote>",Value:""},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"Now extract the quote number and check that it is the correct one",Value:""},{Command:"OCRExtractRelative",Target:"getquotenumber_dpi_96_relative.png@0.30",Value:"q"},{Command:"echo",Target:"Extracted text in pink area: >${q}<",Value:"blue"},{Command:"executeScript",Target:'return ${q}.replace(/( |\\n|\\r)/gm, "")',Value:"q"},{Command:"echo",Target:"Remove space(s) and line break(s): Quote Number: >${q}<",Value:"green"},{Command:"executeScript_Sandbox",Target:'var string = ${q}, substring = "135";  b= string.includes(substring); return b;',Value:"textfound"},{Command:"if_v2",Target:"${textfound} == true",Value:""},{Command:"echo",Target:"Quote number OK",Value:"green"},{Command:"else",Target:"",Value:""},{Command:"throwError",Target:"Wrong quote number",Value:""},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"The X... commands require the RealUser XModule to be installed",Value:""},{Command:"pause",Target:"500",Value:""},{Command:"comment",Target:'Click on the document to give it the focus. For this, we click on the word "SALES QUOTE".',Value:""},{Command:"XClick",Target:"ocr=sales quote",Value:""},{Command:"comment",Target:"Scroll down to next page",Value:""},{Command:"if_v2",Target:'${!os}=="mac"',Value:""},{Command:"comment",Target:"Page scroll in macOS is CMD key + Down",Value:""},{Command:"XType",Target:"${KEY_CMD+KEY_DOWN}",Value:""},{Command:"else",Target:"",Value:""},{Command:"comment",Target:"Page scroll in Windows and Linux is PAGE DOWN key",Value:""},{Command:"XType",Target:"${KEY_PAGE_DOWN}${KEY_PAGE_DOWN}",Value:""},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"Find link image and click it",Value:""},{Command:"comment",Target:"Wait 0.5 seconds for the PDF to complete scrolling. Otherwise if the Xclick image is found while the PDF still scrolls, the click goes to the wrong location.",Value:""},{Command:"pause",Target:"500",Value:""},{Command:"XClick",Target:"ocr=website",Value:""},{Command:"comment",Target:"Check the right page is loaded (here: check logo is there)",Value:""},{Command:"assertElementPresent",Target:'//*[@id="logo"]/img',Value:""}]},"Core/DemoExecuteScript":{CreationDate:"2020-8-1",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"open",Target:"https://ui.vision/demo/executescript",Value:""},{Command:"assertText",Target:'//*[@id="content"]/div[2]/div/h2[1]',Value:"Input box to display some results"},{Command:"verifyText",Target:'//*[@id="content"]/div[2]/div/h2[1]',Value:"Input box to display some results"},{Command:"verifyTitle",Target:"Selenium IDE executeScript Demo Page",Value:""},{Command:"assertTitle",Target:"Selenium IDE executeScript Demo Page",Value:""},{Command:"echo",Target:"executeScript can run Javascript... and store the result in a variable (optional)",Value:""},{Command:"executeScript",Target:"function randomString(length, chars) {\n    var result = '';\n    for (var i = length; i > 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];\n    return result;\n}\n\n//The executeScript script(s) can have multiple lines!\n\n//Demo: Here we generate a random key \nvar s = randomString(8, '0123456789ABCDE') + \"<= Random String\";\n\n//Set the page title to the random key \ndocument.title = s;\n\nreturn s;\n",Value:"s"},{Command:"assertTitle",Target:"${s}",Value:""},{Command:"comment",Target:"Use sourceSearch to assert we have the right Google Analytics Code",Value:""},{Command:"sourceSearch",Target:"UA-86195842-1",Value:"matches"},{Command:"if_v2",Target:"${matches} == 0",Value:""},{Command:"throwError",Target:"Google Analytics ID is wrong!",Value:""},{Command:"end",Target:"",Value:""},{Command:"echo",Target:"First some basic calculations with STORE",Value:""},{Command:"store",Target:"15",Value:"AAA"},{Command:"store",Target:"10",Value:"BBB"},{Command:"executeScript_Sandbox",Target:"return (Number (${AAA}) - Number (${BBB}) )",Value:"CCC"},{Command:"echo",Target:"${CCC}",Value:""},{Command:"executeScript",Target:"document.title = ${CCC};",Value:""},{Command:"assertTitle",Target:"5",Value:""},{Command:"store",Target:"SELenium IDe",Value:"AAA"},{Command:"executeScript_Sandbox",Target:"return ${AAA}.toUpperCase()",Value:"CCC"},{Command:"echo",Target:"${CCC}",Value:""},{Command:"type",Target:"id=sometext",Value:"${CCC}"},{Command:"echo",Target:"Generate TODAYs date in in YYYY-MM-DD format ",Value:""},{Command:"comment",Target:"Create today's date in the YYYY-MM-DD format",Value:""},{Command:"executeScript_Sandbox",Target:"var d = new Date(); \nvar m = ((d.getMonth()+1)<10)?'0'+(d.getMonth()+1):(d.getMonth()+1);\nvar d2 = (d.getDate() <10)?'0'+d.getDate():d.getDate(); \nvar date_today = d.getFullYear()+\"-\"+m+\"-\"+d2; \nreturn date_today",Value:"mydate"},{Command:"echo",Target:"Today is ${mydate}",Value:""},{Command:"echo",Target:"Pick a random item from a list, useful for data-driven testing",Value:""},{Command:"executeScript_Sandbox",Target:"return new Array ('cat','dog','fish','dog','deer','frog','whale','dog','seal','horse','elephant')",Value:"names"},{Command:"executeScript_Sandbox",Target:"return ${names}.length",Value:"len"},{Command:"echo",Target:"array length = ${len}",Value:""},{Command:"executeScript_Sandbox",Target:"return Math.floor(Math.random()*${len})",Value:"num"},{Command:"echo",Target:"num=${num}",Value:""},{Command:"echo",Target:"The next command picks the random item",Value:""},{Command:"executeScript_Sandbox",Target:"return ${names}[${num}]",Value:"myrandomname"},{Command:"store",Target:"Today is ${mydate}, and we draw a ${myrandomname}",Value:"output"},{Command:"echo",Target:"To is ${mydate}, and we draw a ${myrandomname}",Value:""},{Command:"type",Target:"id=sometext",Value:"${output}"},{Command:"if_v2",Target:"parseFloat(${!runtime}) > 20",Value:""},{Command:"throwError",Target:"Runtime too slow (${!runtime} seconds), test failed",Value:""},{Command:"else",Target:"",Value:""},{Command:"echo",Target:"Runtime Ok, test passed!",Value:"green"},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"With @POS you click on the (in this case) 3rd link with the same name. Great for looping over a list of links with the same name.",Value:"green"},{Command:"clickAndWait",Target:"linkText=This link@POS=3",Value:""},{Command:"comment",Target:"Demo: Create array and then loop over it with forEach",Value:""},{Command:"executeScript_Sandbox",Target:'var arr = ["Hello","World", "2020"]; \nreturn arr;',Value:"myarray"},{Command:"forEach",Target:"myarray",Value:"elem"},{Command:"echo",Target:"${elem}",Value:"blue"},{Command:"end",Target:"",Value:""}]},"Core/DemoTabs":{CreationDate:"2017-10-15",Commands:[{Command:"open",Target:"https://ui.vision/demo/tabs",Value:""},{Command:"click",Target:"linkText=Open new web page in new browser tab",Value:""},{Command:"selectWindow",Target:"tab=1",Value:""},{Command:"assertTitle",Target:"*1* TAB1",Value:""},{Command:"type",Target:"id=sometext1",Value:"this is tab 1"},{Command:"click",Target:"linkText=Open yet another web page in a new browser tab",Value:""},{Command:"selectWindow",Target:"tab=2",Value:""},{Command:"assertTitle",Target:"*2* TAB2",Value:""},{Command:"type",Target:"id=sometext2",Value:"And this is tab 2!"},{Command:"selectWindow",Target:"tab=1",Value:""},{Command:"assertTitle",Target:"*1* TAB1",Value:""},{Command:"type",Target:"id=sometext1",Value:"Now back in tab 1 - test done!"},{Command:"comment",Target:"We can also open new tabs",Value:""},{Command:"selectWindow",Target:"tab=open",Value:"https://ui.vision"},{Command:"selectWindow",Target:"tab=open",Value:"https://ocr.space"},{Command:"type",Target:"id=imageUrl",Value:"UI.Vision RPA Tab Test done"}]},"Core/DemoVisualUITest":{CreationDate:"2018-6-26",Commands:[{Command:"open",Target:"https://ui.vision/",Value:""},{Command:"setWindowSize",Target:"1024x768",Value:""},{Command:"visualVerify",Target:"uitest_logo_wide_dpi_96.png@0.70",Value:""},{Command:"visualAssert",Target:"uitest_download_dpi_96.png@0.70",Value:""},{Command:"visualVerify",Target:"uitest_share_dpi_96.png@0.70",Value:""},{Command:"comment",Target:"Resize to iPhone6 screen size",Value:""},{Command:"setWindowSize",Target:"375x768",Value:""},{Command:"visualVerify",Target:"uitest_logo_mobile_dpi_96.png",Value:""},{Command:"comment",Target:"Missing menu is critical, so we use ASSERT (instead of just VERIFY)",Value:""},{Command:"visualAssert",Target:"uitest_hamburger_dpi_96.png",Value:""},{Command:"comment",Target:"Check that Share buttons do not show",Value:""},{Command:"comment",Target:"At this point, page is surely loaded => reduce wait for (normally missing) image",Value:""},{Command:"store",Target:"2",Value:"!timeout_wait"},{Command:"visualSearch",Target:"uitest_share_dpi_96.png@0.70",Value:"count"},{Command:"if_v2",Target:"${count} > 0",Value:""},{Command:"throwError",Target:"Share buttons should NOT show on mobile phones",Value:""},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"Restore default wait (not really needed here, since macro stops now anyway)",Value:""},{Command:"store",Target:"10",Value:"!timeout_wait"},{Command:"comment",Target:"Done, enlarge browser again",Value:""},{Command:"setWindowSize",Target:"1024x768",Value:""}]},"XModules/DemoXType":{CreationDate:"2019-01-28",Commands:[{Command:"store",Target:"medium",Value:"!replayspeed"},{Command:"comment",Target:"Make sure the browser is in the foreground, so it receives the XTYPE keystrokes",Value:""},{Command:"bringBrowserToForeground",Target:"",Value:""},{Command:"open",Target:"https://ui.vision/demo/xtype",Value:""},{Command:"comment",Target:"To save the page, open the browser save dialog with a shortcut",Value:""},{Command:"if_v2",Target:'${!os}=="mac"',Value:""},{Command:"comment",Target:"Save web page in macOS is CMD+S",Value:""},{Command:"XType",Target:"${KEY_CMD+KEY_S}",Value:""},{Command:"else",Target:"",Value:""},{Command:"comment",Target:"Save web page in Windows and Linux is CTRL+S",Value:""},{Command:"XType",Target:"${KEY_CTRL+KEY_S}",Value:""},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"Generate today's date and time ",Value:""},{Command:"executeScript_Sandbox",Target:'var d= new Date(); var m=((d.getMonth()+1)<10)?\'0\'+(d.getMonth()+1):(d.getMonth()+1); m = d.getFullYear()+"-"+m+"-"+d.getDate(); return m',Value:"mydate"},{Command:"executeScript_Sandbox",Target:'return new Date().getHours()+"-" + new Date().getMinutes() + "-" + new Date().getSeconds()',Value:"mytime"},{Command:"echo",Target:"Today is ${mydate}, and the time is ${mytime}",Value:"blue"},{Command:"comment",Target:"Wait for the dialog to appear before sending the next keystrokes",Value:""},{Command:"pause",Target:"2000",Value:""},{Command:"comment",Target:"Send the new file name to the dialog and press ENTER",Value:"blue"},{Command:"XType",Target:"Page_saved_by_UiVision_${mydate}_${mytime}",Value:""},{Command:"XType",Target:"${KEY_ENTER}",Value:""}]},"XModules/DemoXRun":{CreationDate:"2019-09-16",Commands:[{Command:"echo",Target:"This demo macro uses hard-coded paths for the default calculator app. But the correct path depends on your operating system version and language. So the default path in this macro might be wrong and needs to be adjusted.",Value:"blue"},{Command:"if_v2",Target:'${!os}=="mac"',Value:""},{Command:"XRun",Target:"/Applications/Calculator.app/Contents/MacOS/Calculator",Value:""},{Command:"elseif",Target:'${!os}=="linux"',Value:""},{Command:"XRun",Target:"/snap/bin/gnome-calculator",Value:""},{Command:"elseif",Target:'${!os}=="windows"',Value:""},{Command:"XRun",Target:"C:\\Windows\\System32\\calc.exe",Value:""},{Command:"comment",Target:'You find the example PowerShell script for this demo in the UI.Vision docs for "XRunAndWait"',Value:"-executionpolicy bypass -File  c:\\test\\test1.ps1  c:\\test\\test.txt Hello"},{Command:"comment",Target:"XRunAndWait // Powershell.exe ",Value:"-executionpolicy bypass -File  c:\\test\\test1.ps1  c:\\test\\test.txt Hello"},{Command:"comment",Target:"echo // Exitcode = ${!xrun_exitcode}  (Note: The exit code is only captured if you use XRunAndWait)",Value:""},{Command:"else",Target:"",Value:""},{Command:"echo",Target:"This should never happen",Value:""},{Command:"end",Target:"",Value:""},{Command:"echo",Target:"Calculator app launched ",Value:""}]},"XModules/DemoXClick":{CreationDate:"2021-02-01",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"open",Target:"https://ui.vision/demo/draw",Value:""},{Command:"bringBrowserToForeground",Target:"",Value:""},{Command:"click",Target:"linkText=this link",Value:""},{Command:"pause",Target:"1000",Value:""},{Command:"comment",Target:"Check we are on the right page",Value:""},{Command:"visualAssert",Target:"draw_plus1_dpi_96.png",Value:""},{Command:"comment",Target:"Click the plus icon to start a new drawing",Value:""},{Command:"XClick",Target:"draw_plus1_dpi_96.png",Value:""},{Command:"XClick",Target:"draw_create1_dpi_96.png",Value:""},{Command:"comment",Target:"We use a relative click, since the pencil icon can change shape",Value:""},{Command:"XClickRelative",Target:"draw_select_pencil1_dpi_96.png",Value:""},{Command:"XType",Target:"${KEY_ESC}",Value:""},{Command:"XClickRelative",Target:"draw_start1_dpi_96.png",Value:""},{Command:"echo",Target:"Starting point: x=${!imagex} y=${!imagey}",Value:"green"},{Command:"store",Target:"${!imagex}",Value:"x"},{Command:"store",Target:"${!imagey}",Value:"y"},{Command:"comment",Target:"Draw top line ---\x3e",Value:""},{Command:"XMove",Target:"${x},${y}",Value:"#down"},{Command:"executeScript_Sandbox",Target:"return Number (${x}) +100",Value:"x"},{Command:"XMove",Target:"${x},${y}",Value:"#move"},{Command:"XMove",Target:"${x},${y}",Value:"#up"},{Command:"comment",Target:"Draw right line down",Value:""},{Command:"XMove",Target:"${x},${y}",Value:"#down"},{Command:"executeScript_Sandbox",Target:"return Number (${y}) +100",Value:"y"},{Command:"XMove",Target:"${x},${y}",Value:"#move"},{Command:"XMove",Target:"${x},${y}",Value:"#up"},{Command:"comment",Target:"Draw bottom line <---",Value:""},{Command:"XMove",Target:"${x},${y}",Value:"#down"},{Command:"executeScript_Sandbox",Target:"return Number (${x}) - 100",Value:"x"},{Command:"XMove",Target:"${x},${y}",Value:"#move"},{Command:"XMove",Target:"${x},${y}",Value:"#up"},{Command:"comment",Target:"Draw left line up",Value:""},{Command:"XMove",Target:"${x},${y}",Value:"#down"},{Command:"executeScript_Sandbox",Target:"return Number (${y}) - 100",Value:"y"},{Command:"XMove",Target:"${x},${y}",Value:"#move"},{Command:"XMove",Target:"${x},${y}",Value:"#up"},{Command:"comment",Target:"visualVerify // draw_compare_dpi_96.png",Value:""},{Command:"comment",Target:"Add some text...",Value:""},{Command:"XClick",Target:"draw_text1_dpi_96.png",Value:""},{Command:"XType",Target:"${KEY_ESC}",Value:""},{Command:"comment",Target:"Now click on the canvas. This is the place where the text starts.",Value:""},{Command:"executeScript_Sandbox",Target:"return Number (${y}) +180",Value:"y"},{Command:"XClick",Target:"${x},${y}",Value:""},{Command:"comment",Target:"Send keystrokes",Value:""},{Command:"XType",Target:"Demo completed.",Value:""},{Command:"comment",Target:"Click once more on the canvas to close text menu",Value:""},{Command:"executeScript_Sandbox",Target:"return Number (${y}) - 150",Value:"y"},{Command:"XClick",Target:"${x},${y}",Value:""},{Command:"comment",Target:"Confirm that the text is shown. @0.5 overwrites the global confidence level.",Value:""},{Command:"visualAssert",Target:"draw_checkresult1_dpi_96.png@0.4",Value:""},{Command:"echo",Target:"DemoXClick completed",Value:"#shownotification"}]},"XModules/DemoXMove":{CreationDate:"2021-05-17",Commands:[{Command:"comment",Target:"This demo shows *two* methods to select an image from a list of matches",Value:"",Description:""},{Command:"open",Target:"https://ui.vision/demo/draw",Value:"",Description:""},{Command:"clickAndWait",Target:"linkText=this external website",Value:"",Description:""},{Command:"comment",Target:"Move 2nd range slider using #POS method",Value:"",Description:""},{Command:"XMove",Target:"slider_handle_dpi_96.png@0.75#2",Value:"#down",Description:"Press slider handle down"},{Command:"executeScript_Sandbox",Target:"var x = ${!imagex}; return x+200",Value:"xnew",Description:"Calcuate new X position. "},{Command:"XMove",Target:"${xnew}, ${!imagey}",Value:"#up",Description:"Move slider handle and release left mouse button"},{Command:"comment",Target:"Move 3rd slider with AREALIMIT method",Value:"",Description:""},{Command:"click",Target:"xpath=//ion-list[3]/ion-item/div/div/ion-range",Value:"#down",Description:"CLICK is not needed. We used it just to find the XPath for use with visionLimitSearchArea below."},{Command:"pause",Target:"2000",Value:"",Description:""},{Command:"visionLimitSearchArea",Target:"element: xpath=//ion-list[3]/ion-item/div/div/ion-range",Value:"",Description:"Restrict computer vision image search to the HTML tag area"},{Command:"XMove",Target:"slider_handle_dpi_96.png@0.6",Value:"#down",Description:'We do not need to add "#1" because in the new (limited) area there is only one slider handle, so the BEST MATCH option (=without #) is most reliable'},{Command:"XMoveRelative",Target:"slider_red_dpi_96.png@0.6",Value:"#up",Description:""},{Command:"comment",Target:"Confirm slider is in the right position.",Value:"",Description:""},{Command:"storeText",Target:"xpath=//ion-list[3]/ion-list-header/div/ion-badge",Value:"warmth",Description:"Extract slider position"},{Command:"echo",Target:"Slider WARMTH value is: ${warmth}",Value:"red",Description:""},{Command:"assert",Target:"warmth",Value:"2000",Description:"Show error if slider has not the expected value"}]},"XModules_Desktop/DemoXDesktopAutomation":{CreationDate:"2020-02-13",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"echo",Target:"Running DESKTOP image search now",Value:"#shownotification"},{Command:"XDesktopAutomation",Target:"true",Value:""},{Command:"comment",Target:"Limit the search area for better performance",Value:""},{Command:"run",Target:"Sub/Sub_XDesktopAutomation_Area",Value:""},{Command:"comment",Target:"Log button can be greyed out - try both options",Value:""},{Command:"store",Target:"true",Value:"!errorignore"},{Command:"comment",Target:"Log button can have white or grey background",Value:""},{Command:"XClick",Target:"desktop_logstab_white_dpi_96.png@0.5",Value:""},{Command:"store",Target:"false",Value:"!errorignore"},{Command:"if_v2",Target:"${!statusOK} == false",Value:""},{Command:"XClick",Target:"desktop_logstab_grey_dpi_96.png@0.5",Value:""},{Command:"store",Target:"true",Value:"!statusOK"},{Command:"end",Target:"",Value:""},{Command:"comment",Target:"Press Clear button",Value:""},{Command:"XClick",Target:"desktop_clearbutton_dpi_96.png@0.5",Value:""},{Command:"echo",Target:"Log cleared by macro (clear button pressed)",Value:"blue"},{Command:"comment",Target:"Now search and open other tabs",Value:""},{Command:"XClick",Target:"desktop_vartab_dpi_96.png@0.5",Value:""},{Command:"XClick",Target:"desktop_scrtab_dpi_96.png@0.4",Value:""},{Command:"XClick",Target:"desktop_vitab_dpi_96.png@0.4",Value:""},{Command:"comment",Target:"Check that the correct tab is selected",Value:""},{Command:"visualAssert",Target:"desktop_checktab_dpi_96.png@0.55",Value:""}]},"XModules_Desktop/DemoXDesktopAutomation_OCR":{CreationDate:"2020-05-15",Commands:[{Command:"store",Target:"fast",Value:"!replayspeed"},{Command:"comment",Target:"For more information please see https://ui.vision/x/desktop-automation#ocr",Value:""},{Command:"echo",Target:"Running DESKTOP image search now",Value:"#shownotification"},{Command:"XDesktopAutomation",Target:"true",Value:""},{Command:"comment",Target:"Limit the search area for better performance",Value:""},{Command:"run",Target:"Sub/Sub_XDesktopAutomation_Area",Value:""},{Command:"store",Target:"eng",Value:"!OCRlanguage"},{Command:"store",Target:"1",Value:"!OCRengine"},{Command:"comment",Target:'Instead of the word "Logs" we look only for (L)"ogs". There is no need for this. It is done to demo and test the substring search.',Value:""},{Command:"XClick",Target:"ocr=ogs@pos=1",Value:""},{Command:"XClick",Target:"ocr=Clear@pos=1",Value:""},{Command:"echo",Target:'"Clear" button pressed by macro. The button was found at ${!OCRX}, ${!OCRY})',Value:"blue"},{Command:"XClick",Target:"ocr=Screenshots@pos=1",Value:""},{Command:"comment",Target:"Now we use the second OCR Engine. Both work fine here. So this switch is just for test and demo purposes.",Value:""},{Command:"store",Target:"2",Value:"!OCREngine"},{Command:"XClick",Target:"ocr=Visual@pos=1",Value:""},{Command:"comment",Target:"Check the right tab is selected",Value:""},{Command:"visualAssert",Target:"desktop_checktab_dpi_96.png@0.55",Value:""}]},"XModules_Desktop/Sub/Sub_XDesktopAutomation_Area":{CreationDate:"2021-04-29",Commands:[{Command:"comment",Target:"SUBROUTINE used by DemoXDesktopAutomation and DemoXDesktopAutomation_OCR",Value:"",Description:""},{Command:"comment",Target:"It uses two anchor images to define the new search area",Value:"",Description:""},{Command:"visualAssert",Target:"desktop_area_topleft3_dpi_96.png@0.4",Value:"",Description:"Find image to calculate the top left x/y for visionLimitSearchArea "},{Command:"executeScript_Sandbox",Target:"return ${!imagex}-${!imagewidth}/1.5",Value:"x1",Description:"New limited area top left corner = bottom left corner of the anchor image. We use image x/y and image width/height to calculate this value. For X we use /1.5 instead of /2 in the formular below to make the area a bit wider."},{Command:"executeScript_Sandbox",Target:"return ${!imagey}+${!imageheight}/2",Value:"y1",Description:""},{Command:"visualAssert",Target:"desktop_area_bottomright_dpi_96.png",Value:"",Description:"Find image to calculate the bottom right x/y for visionLimitSearchArea."},{Command:"executeScript_Sandbox",Target:"return ${!imagex}+${!imagewidth}/2",Value:"x2",Description:"New Search Area bottom right corner = top right corner of the anchor image."},{Command:"executeScript_Sandbox",Target:"return ${!imagey}-${!imageheight}/2",Value:"y2",Description:""},{Command:"echo",Target:"x1=${x1}, y1=${y1}, x2=${x2}, y2=${y2}",Value:"blue",Description:""},{Command:"visionLimitSearchArea",Target:"area=${x1},${y1},${x2},${y2}",Value:"",Description:""}]},"Core/Sub/Sub_DemoCsvRead_FillForm":{CreationDate:"2020-08-08",Commands:[{Command:"comment",Target:"Subroutine used by DemoCsvReadWithLoop and DemoCsvReadWithWhile",Value:""},{Command:"echo",Target:"Inside subroutine: Status = ${!csvReadStatus}, Line = ${!csvReadLineNumber}",Value:"green"},{Command:"open",Target:"https://docs.google.com/forms/d/e/1FAIpQLScGWVjexH2FNzJqPACzuzBLlTWMJHgLUHjxehtU-2cJxtu6VQ/viewform",Value:""},{Command:"type",Target:"xpath=//input[@type='text']",Value:"${!COL1}_${!csvReadLineNumber}"},{Command:"type",Target:"xpath=//div[3]/div/div/div[2]/div/div/div/div/input",Value:"${!COL2}"},{Command:"type",Target:"xpath=//div[4]/div/div/div[2]/div/div/div/div/input",Value:"${!COL3}"},{Command:"clickAndWait",Target:"xpath=//span/span",Value:""}]}},y=[{creationDate:"2019-05-21",name:"Old_Style_Testsuites_(Deprecated)",fold:!0,macros:[{macro:"Demo/Core/DemoAutofill.json",loops:1},{macro:"Demo/Core/DemoFrames.json",loops:1}]}],w=r(105),E=(r(389),r(390),r(23)),x=r(187),S=r(43),C=r(115),T=r(191),_=r(99),O=r(27),k=r(12),P=r(161),I=(r(324),r(365)),M=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function D(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var N,R=0,j=function(e){e.dispatch;var t=(0,e.getState)().editor,r=t.editing;t.isDraggingCommand||c.default.set("editing",r)},L=function(e){return function(t){t.dispatch;var r=(0,t.getState)();if(!r.editor.isDraggingCommand){var n=e||Object(E.getCurrentMacroId)(r),a=r.editor.macrosExtra[n]||{};return Object(w.getMacroExtraKeyValueData)().update(n,(function(e){return A({},e,a)}))}}},F=function(e){e.dispatch;var t=(0,e.getState)(),r=Object(E.getMacrosExtra)(t);return Object(w.getMacroExtraKeyValueData)().set("",r)},V=(N={},function(e){e.dispatch;var t=(0,e.getState)().config,r=((t=t||{}).size?t.size[t.showSidebar?"with_sidebar":"standard"]:null)||(t.showSidebar?{width:860,height:775}:{width:520,height:775});r.width===N.width&&r.height===N.height||c.default.get("config").then((function(e){(e&&e.showSidebar)!==t.showSidebar&&(r.width===window.outerWidth&&r.height===window.outerHeight||s.default.ask("PANEL_RESIZE_WINDOW",{size:r}))})),c.default.set("config",t),N=r}),U=function(e){return(e||"").toLowerCase()};function B(e,t){return t.find((function(t){return U(t.name)===U(e)}))}function X(e,t){var r=function(e){return U(e).replace(/.json$/,"")};return t.find((function(t){return r(t.relativePath)===r(e)}))}function K(e,t){var r=U(e);return t.filter((function(e){var t=U(e.fullPath);if(0!==t.indexOf(r))return!1;var n=t.substr(r.length).split(/\/|\\/g);return 2===n.length&&""===n[0]}))}function $(e,t){return t.find((function(t){return U(t.name)===U(e)}))}function Y(e){return{type:o.b.SET_ROUTE,data:e}}function W(){return R=0,{types:Object(o.a)("START_RECORDING"),promise:function(){return setTimeout((function(){s.default.ask("PANEL_TRY_TO_RECORD_OPEN_COMMAND")})),s.default.ask("PANEL_START_RECORDING",{})}}}function G(){return{types:Object(o.a)("STOP_RECORDING"),promise:function(){return s.default.ask("PANEL_STOP_RECORDING",{})}}}function H(){return{types:Object(o.a)("START_INSPECTING"),promise:function(){return s.default.ask("PANEL_START_INSPECTING",{})}}}function z(){return{types:Object(o.a)("STOP_INSPECTING"),promise:function(){return s.default.ask("PANEL_STOP_INSPECTING",{})}}}function q(){return{type:o.b.START_PLAYING,data:null}}function J(){return{type:o.b.STOP_PLAYING,data:null}}function Z(){return{type:o.b.DONE_INSPECTING,data:{}}}function Q(){R+=1,s.default.ask("PANEL_UPDATE_BADGE",{type:"record",text:""+R})}function ee(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&Q(),{type:o.b.APPEND_COMMAND,data:{command:Object(u.b)(e)},post:[j,L()]}}function te(e){return{type:o.b.DUPLICATE_COMMAND,data:{index:e},post:[j,L()]}}function re(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r&&Q(),{type:o.b.INSERT_COMMAND,data:{index:t,command:Object(u.b)(e)},post:[j,L()]}}function ne(e,t){return{type:o.b.UPDATE_COMMAND,data:{command:Object(u.b)(e),index:t},post:j}}function ae(e){return{type:o.b.REMOVE_COMMAND,data:{index:e},post:[j,L()]}}function oe(e,t){return{type:o.b.SELECT_COMMAND,data:{index:e,forceClick:t},post:j}}function ie(e){return{type:o.b.CUT_COMMAND,data:{indices:[e]},post:[j,L()]}}function se(e){return{type:o.b.COPY_COMMAND,data:{indices:[e]}}}function ce(e){return{type:o.b.PASTE_COMMAND,data:{index:e},post:[j,L()]}}function le(){return{type:o.b.NORMALIZE_COMMANDS,data:{},post:j}}function ue(e){return{type:o.b.UPDATE_SELECTED_COMMAND,data:e,post:j}}function de(e){return function(t,r){var n=r().editor.editing.commands[e];if(n&&n.cmd&&n.cmd.length){if("comment"===n.cmd){var a=n.target.indexOf(" // ");if(-1===a)return;var o=n.target.substr(0,a);if(!Object(S.isValidCmd)(o))return;var i=n.target.substr(a+" // ".length);return t(ne(A({},n,{cmd:o,target:i}),e))}return t(ne(A({},n,{cmd:"comment",target:n.cmd+" // "+(n.target||"")}),e))}}}function me(){return function(e,t){e(de(t().editor.editing.meta.selectedIndex))}}function pe(e){return{type:o.b.SET_SOURCE_ERROR,data:e}}function he(e){return{type:o.b.SET_SOURCE_CURRENT,data:e}}function fe(e){return function(t,r){var n=r().editor,o=n.editing;if(n.editingSource.pure!==o.current){p()("ACTION, saveSourceCodeToEditing",e);try{var i=Object(h.fromJSONString)(e,"untitled");t(Ee(A({},i.data,{meta:o.meta}))),t(pe(null))}catch(e){a.a.error("There are errors in the source"),t(pe(e.message))}}}}function ge(){return function(e,t){var r=t(),n=r.editor.editing.meta.src.id,a=Object(i.pick)(["commands"],r.editor.editing),s=Object(l.getStorageManager)().getMacroStorage();if(!n)throw new Error("Can't find macro with path '"+n+"'");return a.commands=a.commands.map(u.b),Object(E.hasUnsavedMacro)(r)&&e(Xe(n,null)),s.read(n,"Text").then((function(t){var r=A({},t,{data:a});return e({type:"setCurrentMacro",data:r}),s.write(n,r)})).then((function(){e({type:o.b.SAVE_EDITING_AS_EXISTED,data:null,post:j})}))}}function ve(e){return function(t,r){var n=r(),a=Object(i.pick)(["commands"],n.editor.editing);if(B(e,n.editor.testCases))return Promise.reject(new Error("The macro name already exists!"));var s="/"+e+".json",c=Object(l.getStorageManager)().getMacroStorage().filePath(s),u={id:c,name:e,data:a};return Object(l.getStorageManager)().getMacroStorage().write(s,u).then((function(){return t({type:"setCurrentMacro",data:u}),t({type:o.b.SAVE_EDITING_AS_NEW,data:{id:c,name:e},post:j})}))}}function be(e){var t=e.slice();return t.sort((function(e,t){var r=e.name.toLowerCase(),n=t.name.toLowerCase();return r<n?-1:r===n?0:1})),{type:o.b.SET_TEST_CASES,data:t,post:function(e){var t=e.dispatch,r=(0,e.getState)(),n=Object(E.getMacroFileNodeList)(r);n.length>0&&!r.editor.editing.meta.src&&0===r.editor.editing.commands.length&&t(xe(n[0].fullPath))}}}function ye(){return function(e,t){var r=t(),n=r.editor.editing,a=Object(E.getMacroFileNodeList)(r);n.meta&&!n.meta.src||(0===a.length?e(Se()):e(xe(a[0].fullPath)))}}function we(){return function(e,t){var r=t().editor.editing,n=r.meta.src&&r.meta.src.id;if(!n)return ye()(e,t);e(xe(n))}}function Ee(e){return{type:o.b.SET_EDITING,data:e}}function xe(e){return function(t,r){return Object(l.getStorageManager)().getMacroStorage().read(e,"Text").then((function(r){var n=Object(u.c)(r);t({type:"setCurrentMacro",data:n}),t({type:o.b.EDIT_TEST_CASE,data:{id:e,macro:n},post:j});var a=Object(l.getStorageManager)().getCurrentStrategyType(),i=function(){switch(a){case l.StorageStrategyType.Browser:return I.MiscKey.BrowserModeLastMacroId;case l.StorageStrategyType.XFile:return I.MiscKey.XFileModeLastMacroId;default:throw new Error("Invalid mode: "+a)}}();return Object(I.getMiscData)().set(i,e),n}))}}function Se(){return{type:o.b.EDIT_NEW_TEST_CASE,data:null,post:j}}function Ce(e){return function(t,r){return Object(l.getStorageManager)().getMacroStorage().write(e.name,A({id:Object(i.uid)()},e))}}function Te(e){var t=e.macros,r=e.folder,n=void 0===r?"/":r,a=e.overwrite,o=void 0!==a&&a,s=e.storageStrategyType,c=void 0===s?null:s;return function(e,r){var a=Object(l.getStorageManager)().getStorageForTarget(l.StorageTarget.Macro,c||Object(l.getStorageManager)().getCurrentStrategyType()),s=r(),u="/"===n?"":a.relativePath(n,!0),d=Object(E.getMacroFileNodeList)(s).filter((function(e){var t=a.getPathLib().dirname(e.fullPath),r=a.relativePath(t,!0);return u===r})),m=[],p=[];t.forEach((function(e){o||!d.find((function(t){return t.name===e.name}))?p.push(e):m.push(e)}));var h=p.length,f=t.length-h;if(0===h)return Promise.resolve({passCount:h,failCount:f,failTcs:m});var g=p.map((function(e){return{filePath:O.posix.join(n,e.name+".json"),content:A({},e,{id:Object(i.uid)(),udpateTime:1*new Date})}}));return a.ensureDirectory(n).then((function(){return a.bulkWrite(g)})).then((function(){return{passCount:h,failCount:f,failTcs:m}}))}}function _e(e){return function(t,r){var n=r(),a=n.editor.editing.meta.src&&n.editor.editing.meta.src.id,i=n.editor.testSuites.filter((function(t){return t.cases.find((function(t){return t.testCaseId===e}))}));return i.length>0?Promise.reject(new Error("Can't delete this macro for now, it's currently used in following test suites: "+i.map((function(e){return e.name})))):(t(Xe(e,null)),Object(l.getStorageManager)().getMacroStorage().remove(e).then((function(){t({type:o.b.REMOVE_TEST_CASE,data:{isCurrent:a===e},post:j})})).catch((function(e){return p.a.error(e.stack)})))}}function Oe(){return function(e,t){return _e(t().editor.editing.meta.src.id)(e,t)}}function ke(e){return{type:o.b.SET_PLAYER_STATE,data:e}}function Pe(e){return function(t){t(ke({timeoutStatus:e})),s.default.ask("PANEL_UPDATE_BADGE",{type:"play",text:(e.total-e.past)/1e3+"s"})}}function Ie(e){return function(t,r){var n=r(),a=Object(E.getCurrentMacroId)(n),o=Object(E.getWarningCommandIndices)(n);t(Be(a,{warningCommandIndices:-1===o.indexOf(e)?[].concat(D(o),[e]):o}))}}function Me(e){return function(t,r){var n=r(),a=Object(E.getCurrentMacroId)(n),o=Object(E.getErrorCommandIndices)(n);t(Be(a,{errorCommandIndices:-1===o.indexOf(e)?[].concat(D(o),[e]):o}))}}function Ae(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(n,a){var c=a(),l=r.noStack?[]:Object(C.getMacroCallStack)().toArray(),u={type:e,text:t,options:r,id:Object(i.uid)(),createTime:new Date,stack:l.map((function(e,t){return{macroId:e.resource.id,macroName:e.resource.name,commandIndex:t===l.length-1?c.player.nextCommandIndex:e.runningStatus.nextIndex,isSubroutine:0!==t}}))};return"None"!==c.config.logFilter&&setTimeout((function(){s.default.ask("PANEL_LOG",{log:Object(P.renderLog)(u,!0)})}),0),n({type:o.b.ADD_LOGS,data:[u]})}}function De(){return{type:o.b.CLEAR_LOGS,data:null}}function Ne(e){return{type:o.b.ADD_SCREENSHOT,data:A({},e,{createTime:new Date})}}function Re(){return{type:o.b.CLEAR_SCREENSHOTS,data:null,post:function(){return Object(l.getStorageManager)().getScreenshotStorage().clear()}}}function je(e){return{type:o.b.ADD_VISION,data:A({},e,{createTime:new Date})}}function Le(){return{type:o.b.CLEAR_VISIONS,data:null,post:function(){return Object(l.getStorageManager)().getVisionStorage().clear()}}}function Fe(e){return{type:o.b.UPDATE_CONFIG,data:e,post:V}}function Ve(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=A({shouldPersist:!1},t);return{type:o.b.SET_MACROS_EXTRA,data:e||{},post:r.shouldPersist?F:function(){}}}function Ue(e){return{type:o.b.SET_TEST_SUITES_EXTRA,data:e||{}}}function Be(e,t){return{type:o.b.UPDATE_ONE_MACRO_EXTRA,data:{id:e,extra:t},post:L(e)}}function Xe(e,t){return function(r,n){r(Be(e,{status:t}))}}function Ke(e,t){return function(r,n){r(Be(e,{breakpointIndices:t}))}}function $e(e,t){return function(r,n){r(Be(e,{doneCommandIndices:t}))}}function Ye(e,t){return function(r,n){r(Be(e,{errorCommandIndices:t}))}}function We(e,t){return function(r,n){r(Be(e,{warningCommandIndices:t}))}}function Ge(e){return{type:o.b.UPDATE_PROXY,data:e}}function He(e,t,r,n){var a=e.config,o=Object(i.pick)(["playHighlightElements","playScrollElementsIntoView"],a),s=function(){if(n)return n;if(!r)return e.editor.editing.meta.src?e.editor.editing.meta.src.name:"Untitled";var t=Object(E.getMacroFileNodeList)(e).find((function(e){return e.fullPath===r}));if(!t)throw new Error("can't find macro with id '"+r+"'");return t.name}(),c=A({"!MACRONAME":s,"!TIMEOUT_PAGELOAD":parseFloat(a.timeoutPageLoad),"!TIMEOUT_WAIT":parseFloat(a.timeoutElement),"!TIMEOUT_MACRO":parseFloat(a.timeoutMacro),"!TIMEOUT_DOWNLOAD":parseFloat(a.timeoutDownload),"!OCRLANGUAGE":a.ocrLanguage,"!CVSCOPE":a.cvScope,"!REPLAYSPEED":{0:"FAST",.3:"MEDIUM",2:"SLOW"}[t.postDelay/1e3]||"MEDIUM"},t.overrideScope||{}),l=r?Object(E.getBreakpointsByMacroId)(e,r):Object(E.getBreakpoints)(e),u=Object(i.compose)(Object(i.on)("resources"),i.map,Object(i.on)("extra"))((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A({},e,o,t.commandExtra||{})}))(t);return A({title:s},u,{public:A({},u.public||{},{scope:c}),breakpoints:[].concat(D(l),D(t.breakpoints||[]))})}function ze(e){var t=A({},e,{resources:(e.resources||[]).filter((function(e){return e.cmd&&e.cmd.length>0}))});return function(e,r){return Object(_.default)().saveOrNot({getContent:function(e){return"You must save macro before replay"},okText:"Save",cancelText:"Cancel",autoSaveExisting:!0}).then((function(e){if(e){var n=He(r(),t,t.macroId,t.title);return Object(C.getMacroCallStack)().clear(),Object(C.getMacroCallStack)().call({id:t.macroId,name:n.title,commands:t.resources},{playerState:n,status:T.MacroStatus.Running,nextIndex:t.startIndex,commandResults:[]})}}))}}function qe(){return function(e,t){Object(l.getStorageManager)().getCSVStorage().list().then((function(e){return Promise.all(e.map((function(e){return{name:e.name,size:e.size,fullPath:e.fullPath,createTime:new Date(e.lastModified)}})))})).then((function(t){e({type:o.b.SET_CSV_LIST,data:t})})).catch((function(e){return p.a.error("listCSV error",e),Promise.reject(e)}))}}function Je(){return function(e,t){return Object(l.getStorageManager)().getScreenshotStorage().list().then((function(e){return p()("listScreenshots",e),e.map((function(e){return{name:e.name,fullPath:e.fullPath,createTime:new Date(e.lastModified)}}))})).then((function(t){e({type:o.b.SET_SCREENSHOT_LIST,data:t})})).catch((function(e){return p.a.error("listScreenshots error",e),Promise.reject(e)}))}}function Ze(){return function(e,t){return Object(l.getStorageManager)().getVisionStorage().list().then((function(e){return p()("listVisions",e),e.map((function(e){return{name:e.name,fullPath:e.fullPath,createTime:new Date(e.lastModified)}}))})).then((function(t){e({type:o.b.SET_VISION_LIST,data:t})})).catch((function(e){return p.a.error("listVisions error",e),Promise.reject(e)}))}}function Qe(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(r,n){return Object(i.withFileExtension)(e,(function(t,n){return Object(x.prompt)({title:"Image Name",message:"Note: Please keep the '_dpi_xx' postfix",value:t,keepOpenOnError:!0,selectionEnd:function(){var e=t.match(/_dpi_\d+/i);if(e)return e.index}(),onOk:function(r){var o=Object(i.delay)((function(){return!0}),100);if(r===t)return o;try{Object(i.validateStandardName)(r,!0)}catch(e){throw a.a.error(e.message),e}return Object(l.getStorageManager)().getVisionStorage().exists(n(r)).then((function(t){if(t){var i="'"+n(r)+"' already exists";throw a.a.error(i),new Error(i)}return Object(l.getStorageManager)().getVisionStorage().rename(e,n(r)).then((function(){return o})).catch((function(e){throw a.a.error(e.message),e}))}))}}).then((function(e){return e||Object(l.getStorageManager)().getVisionStorage().remove(n(t)).then((function(){return r(Ze())})).then((function(){return"__kantu_deleted__"}))}))})).then((function(e){if(!/__kantu_deleted__/.test(e))return t&&r(ue({target:e})),r(Ze()),a.a.success("Saved vision as "+e),e}))}}function et(e){return{type:o.b.SET_TEST_SUITES,data:e}}function tt(e){return function(t,r){var n=r();return!!Object(E.getTestSuitesWithAllInfo)(n).find((function(t){return e.name===t.name}))?Promise.reject(new Error("The test suite name '"+e.name+"' already exists!")):Object(l.getStorageManager)().getTestSuiteStorage().write(e.name,A({},e,{id:Object(i.uid)(),updateTime:1*new Date}))}}function rt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(r,n){var a=n(),o=Object(E.getTestSuitesWithAllInfo)(a),s=e.filter((function(e){return!o.find((function(t){return t.name===e.name}))})),c=s.length,u=e.length-c;if(0===c)return Promise.resolve({passCount:c,failCount:u,failTss:[]});var d=Object(l.getStorageManager)().getStorageForTarget(l.StorageTarget.TestSuite,t||Object(l.getStorageManager)().getCurrentStrategyType()),m=s.map((function(e){return{filePath:e.name,content:A({},e,{id:Object(i.uid)(),updateTime:1*new Date})}}));return d.ensureDir().then((function(){return d.bulkWrite(m)})).then((function(){return{passCount:c,failCount:u,failTss:[]}}))}}function nt(e){return function(t,r){var n=r().editor.testSuites.find((function(t){return t.id===e}));if(!n)throw new Error("can't find test suite with id '"+e+"'");return t({type:o.b.UPDATE_TEST_SUITE_STATUS,data:{id:e,extra:{fold:!1,playStatus:{}}}}),Object(l.getStorageManager)().getTestSuiteStorage().remove(n.name)}}function at(e){return{type:o.b.SET_PLAYER_STATE,data:{mode:e}}}function ot(){return function(e,t){var r=t(),n=r.config,a=r.editor,o=n.autoBackupTestCases,i=n.autoBackupTestSuites,s=n.autoBackupScreenshots,c=n.autoBackupCSVFiles,u=n.autoBackupVisionImages,m=Object(l.getStorageManager)();return Promise.all([m.getCSVStorage().list(),m.getScreenshotStorage().list(),m.getVisionStorage().list()]).then((function(e){var t=M(e,3),n=t[0],l=t[1],m=t[2];return Object(d.backup)({csvs:n,screenshots:l,visions:m,macroNodes:Object(E.getMacroFileNodeList)(r),testSuites:a.testSuites,backup:{testCase:o,testSuite:i,screenshot:s,csv:c,vision:u}})})).catch((function(e){p.a.error(e.stack)}))}}function it(e){return e.sort((function(e,t){return e.key<t.key?-1:e.key>t.key?1:0})),{type:o.b.SET_VARIABLE_LIST,data:e}}function st(e){return{type:o.b.UPDATE_UI,data:e}}function ct(e,t){return function(r,n){var a=(n().editor.macrosExtra[e]||{}).breakpointIndices||[],o=-1===a.indexOf(t)?[].concat(D(a),[t]):a;r(Ke(e,o))}}function lt(e,t){return function(r,n){var a=((n().editor.macrosExtra[e]||{}).breakpointIndices||[]).filter((function(e){return e!==t}));r(Ke(e,a))}}function ut(e){return{type:o.b.SET_EDITOR_ACTIVE_TAB,data:e}}function dt(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t,r){var n=function(){return c.default.get("preinstall_info").then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.askedVersions||[],r=v.a.preinstall.version,n=-1!==t.indexOf(r);return!!n||c.default.set("preinstall_info",A({},e,{askedVersions:[].concat(D(t),[r])}))}))};if(!e)return n();p()("PREINSTALL_CSV_LIST",["preinstall/csv/readcsvtestdata.csv"]),p()("PREINSTALL_VISION_LIST",["preinstall/vision/canvas_3dots_verify_dpi_96.png","preinstall/vision/canvas_hydepark_dpi_96.png","preinstall/vision/canvas_hydepark_extract_dpi_96_relative.png","preinstall/vision/canvas_hydepark_verify_dpi_96.png","preinstall/vision/canvas_wyoming_dpi_96.png","preinstall/vision/canvas_wyoming_verify_dpi_96.png","preinstall/vision/democv_checkoverlay.png","preinstall/vision/democv_ocrdone.png","preinstall/vision/democv_share.png","preinstall/vision/democv_startocr.png","preinstall/vision/desktop_area_bottomright_dpi_96.png","preinstall/vision/desktop_area_topleft3_dpi_96.png","preinstall/vision/desktop_checktab_dpi_96.png","preinstall/vision/desktop_clearbutton_dpi_96.png","preinstall/vision/desktop_logstab_grey_dpi_96.png","preinstall/vision/desktop_logstab_white_dpi_96.png","preinstall/vision/desktop_scrtab_dpi_96.png","preinstall/vision/desktop_searcharea_dpi_96_relative.png","preinstall/vision/desktop_vartab_dpi_96.png","preinstall/vision/desktop_vitab_dpi_96.png","preinstall/vision/draw_checkresult1_dpi_96.png","preinstall/vision/draw_create1_dpi_96.png","preinstall/vision/draw_plus1_dpi_96.png","preinstall/vision/draw_select_pencil1_dpi_96.png","preinstall/vision/draw_start1_dpi_96.png","preinstall/vision/draw_text1_dpi_96.png","preinstall/vision/getquotenumber_dpi_96_relative.png","preinstall/vision/pdftest_salesquote.png","preinstall/vision/slider_handle_dpi_96.png","preinstall/vision/slider_red_dpi_96.png","preinstall/vision/uitest_download_dpi_96.png","preinstall/vision/uitest_hamburger_dpi_96.png","preinstall/vision/uitest_logo_mobile_dpi_96.png","preinstall/vision/uitest_logo_wide_dpi_96.png","preinstall/vision/uitest_share_dpi_96.png","preinstall/vision/youtube_play_button.png","preinstall/vision/youtube_video_content_verify.png"]);return Promise.all([function(){if(!b||!Object.keys(b).length)return Promise.resolve();return Object(k.flow)((function(){var e=Object(l.getStorageManager)().getMacroStorage(),t=e.getPathLib(),r=Object.keys(b).map((function(e){return t.join(v.a.preinstall.macroFolder,t.dirname(e))})),n=k.uniqueStrings.apply(void 0,D(r));return k.flow.apply(void 0,D(n.map((function(t){return function(){return e.ensureDirectory(t)}})))).then((function(){return Promise.all(Object.keys(b).map((function(r){var n=t.basename(r),a=e.filePath(t.join(v.a.preinstall.macroFolder,r)),o=JSON.stringify(b[r]),i=Object(h.fromJSONString)(o,n);return e.write(a,i)})))}))}),(function(){var e=y.map((function(e){return Object(f.parseTestSuite)(JSON.stringify(e))}));t(rt(e,l.StorageStrategyType.Browser))}))}(),function(){var e=["preinstall/csv/readcsvtestdata.csv"];if(0===e.length)return Promise.resolve();var r=Object(l.getStorageManager)().getStorageForTarget(l.StorageTarget.CSV,l.StorageStrategyType.Browser);return r.ensureDir().then((function(){var n=e.map((function(e){var t=e.split("/"),n=t[t.length-1];return Object(i.loadCsv)(e).then((function(e){return r.write(n,new Blob([e]))}))}));return Promise.resolve(n).then((function(){return Object(i.delay)((function(){}),3e3)})).then((function(){t(qe())}))}))}(),function(){var e=["preinstall/vision/canvas_3dots_verify_dpi_96.png","preinstall/vision/canvas_hydepark_dpi_96.png","preinstall/vision/canvas_hydepark_extract_dpi_96_relative.png","preinstall/vision/canvas_hydepark_verify_dpi_96.png","preinstall/vision/canvas_wyoming_dpi_96.png","preinstall/vision/canvas_wyoming_verify_dpi_96.png","preinstall/vision/democv_checkoverlay.png","preinstall/vision/democv_ocrdone.png","preinstall/vision/democv_share.png","preinstall/vision/democv_startocr.png","preinstall/vision/desktop_area_bottomright_dpi_96.png","preinstall/vision/desktop_area_topleft3_dpi_96.png","preinstall/vision/desktop_checktab_dpi_96.png","preinstall/vision/desktop_clearbutton_dpi_96.png","preinstall/vision/desktop_logstab_grey_dpi_96.png","preinstall/vision/desktop_logstab_white_dpi_96.png","preinstall/vision/desktop_scrtab_dpi_96.png","preinstall/vision/desktop_searcharea_dpi_96_relative.png","preinstall/vision/desktop_vartab_dpi_96.png","preinstall/vision/desktop_vitab_dpi_96.png","preinstall/vision/draw_checkresult1_dpi_96.png","preinstall/vision/draw_create1_dpi_96.png","preinstall/vision/draw_plus1_dpi_96.png","preinstall/vision/draw_select_pencil1_dpi_96.png","preinstall/vision/draw_start1_dpi_96.png","preinstall/vision/draw_text1_dpi_96.png","preinstall/vision/getquotenumber_dpi_96_relative.png","preinstall/vision/pdftest_salesquote.png","preinstall/vision/slider_handle_dpi_96.png","preinstall/vision/slider_red_dpi_96.png","preinstall/vision/uitest_download_dpi_96.png","preinstall/vision/uitest_hamburger_dpi_96.png","preinstall/vision/uitest_logo_mobile_dpi_96.png","preinstall/vision/uitest_logo_wide_dpi_96.png","preinstall/vision/uitest_share_dpi_96.png","preinstall/vision/youtube_play_button.png","preinstall/vision/youtube_video_content_verify.png"];if(0===e.length)return Promise.resolve();var r=Object(l.getStorageManager)().getStorageForTarget(l.StorageTarget.Vision,l.StorageStrategyType.Browser);return r.ensureDir().then((function(){var n=e.map((function(e){var t=e.split("/"),n=t[t.length-1];return Object(i.loadImage)(e).then((function(e){return r.write(n,e)}))}));return Promise.resolve(n).then((function(){return Object(i.delay)((function(){}),3e3)})).then((function(){t(Ze())}))}))}()]).then(n)}}},161:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderLogType=e=>{switch(e.type){case"reflect":return"[info]";case"error":return e.options&&e.options.ignored?"[error][ignored]":"[error]";default:return`[${e.type}]`}},t.renderLog=(e,r=!1)=>(r?e.createTime.toISOString()+" - ":"")+t.renderLogType(e)+" "+e.text},17:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=e=>e.reduce((e,t)=>(e[t]=t,e),{});t.APP_STATUS=n(["NORMAL","INSPECTOR","RECORDER","PLAYER"]),t.INSPECTOR_STATUS=n(["PENDING","INSPECTING","STOPPED"]),t.RECORDER_STATUS=n(["PENDING","RECORDING","STOPPED"]),t.PLAYER_STATUS=n(["PLAYING","PAUSED","STOPPED"]),t.PLAYER_MODE=n(["TEST_CASE","TEST_SUITE"]),t.CONTENT_SCRIPT_STATUS=n(["NORMAL","RECORDING","INSPECTING","PLAYING"]),t.TEST_CASE_STATUS=n(["NORMAL","SUCCESS","ERROR","ERROR_IN_SUB"]),t.LAST_SCREENSHOT_FILE_NAME="__lastscreenshot",t.LAST_DESKTOP_SCREENSHOT_FILE_NAME="__last_desktop_screenshot",t.UNTITLED_ID="__untitled__"},181:function(e,t){var r=function(){this.dataByFormat={},this.dropEffect="none",this.effectAllowed="all",this.files=[],this.types=[]};r.prototype.clearData=function(e){var t,r,n;e?(delete this.dataByFormat[e],t=this.types,r=e,(n=t.indexOf(r))>=0&&t.splice(n,1)):(this.dataByFormat={},this.types=[])},r.prototype.getData=function(e){return this.dataByFormat[e]},r.prototype.setData=function(e,t){return this.dataByFormat[e]=t,this.types.indexOf(e)<0&&this.types.push(e),!0},r.prototype.setDragImage=function(){},e.exports=function(){if(window.DataTransfer)try{new window.DataTransfer;return window.DataTransfer}catch(e){}return r}()},182:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(184);t.BaseProxyManager=class{constructor(){this.proxy=null,this.registry=n.createListenerRegistry()}getProxy(){return Promise.resolve(this.proxy)}getAuth(e,t){return this.proxy&&this.proxy.username&&this.proxy.host===e&&this.proxy.port===""+t?{username:this.proxy.username,password:this.proxy.password}:null}onChange(e){return this.registry.add("change",e),()=>{this.registry.remove("change",e)}}}},184:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor({process:e,onZero:t,onOne:r}){this.cache={},this.process=e,this.onZero=t||(()=>{}),this.onOne=r||(()=>{})}add(e,t){if(this.cache[e]=this.cache[e]||[],this.cache[e].push(t),1===this.cache[e].length)try{this.onOne(e)}catch(e){console.error("in onOne, "+e.message)}return!0}remove(e,t){if(!this.cache[e])return!1;if(this.cache[e]=this.cache[e].filter(e=>e!==t),0===this.cache[e].length)try{this.onZero(e)}catch(e){console.error("in onZero, "+e.message)}return!0}removeAllWithData(e){Object.keys(this.cache).forEach(t=>{for(let r=this.cache[t].length-1;r>=0;r--)this.cache[t][r]===e&&this.remove(t,this.cache[t][r])})}fire(e,t){return!!this.cache[e]&&(this.cache[e].forEach(r=>{try{this.process(r,t,e)}catch(e){console.error("in process, "+e.message)}}),!0)}has(e){return this.cache[e]&&this.cache[e].length>0}keys(){return Object.keys(this.cache).filter(e=>this.cache[e]&&this.cache[e].length>0)}destroy(){Object.keys(this.cache).forEach(e=>{try{this.onZero(e)}catch(e){console.error("in onZero, "+e.message)}}),this.cache={}}}t.Registry=n,t.createListenerRegistry=function(){return new n({process:(e,t,r)=>{e(t)}})}},185:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MigrateMacroTestSuiteToBrowserFileSystem="20190401_macro_test_suite_to_browser_fs"}(t.MigrationJobType||(t.MigrationJobType={})),function(e){e[e.AlreadyMigrated=0]="AlreadyMigrated",e[e.NotQualified=1]="NotQualified",e[e.Success=2]="Success",e[e.Error=3]="Error",e[e.JobUnknown=4]="JobUnknown"}(t.MigrationResult||(t.MigrationResult={}))},187:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=n(r(18)),i=n(r(1)),s=r(117);class c extends a.default.Component{constructor(){super(...arguments),this.state={value:"",visible:!0},this.onOk=()=>this.props.onOk(this.state.value).then(()=>this.hide()),this.onCancel=()=>this.props.onCancel().then(()=>this.hide())}componentDidMount(){this.setState({value:this.props.value}),setTimeout(()=>this.focus(),100)}componentWillReceiveProps(e){e.value!==this.props.value&&(this.setState({value:e.value}),setTimeout(()=>this.focus(),100))}focus(){const e=this.input;if(e&&e.refs&&e.refs.input){const t=e.refs.input;t.focus(),"text"===this.props.inputType&&(t.selectionStart=void 0!==this.props.selectionStart?this.props.selectionStart:0,t.selectionEnd=void 0!==this.props.selectionEnd?this.props.selectionEnd:t.value.length)}}hide(){this.setState({visible:!1})}render(){return a.default.createElement(s.Modal,{ref:e=>{this.modal=e},visible:this.state.visible,align:"left",title:this.props.title,width:this.props.width,closable:this.props.closable,maskClosable:this.props.closable,okText:this.props.okText,cancelText:this.props.cancelText,onOk:this.onOk,onCancel:this.onCancel},this.props.message&&this.props.message.length?a.default.createElement("pre",{style:{fontFamily:"inherit",marginBottom:"10px",whiteSpace:"pre-wrap"}},this.props.message):null,this.props.noInput?null:a.default.createElement(s.Input,{defaultValue:"",ref:e=>this.input=e,type:this.props.inputType,autosize:!1,placeholder:this.props.placeholder,value:this.state.value,onChange:e=>this.setState({value:e.target.value}),onKeyDown:e=>{13===e.keyCode&&this.onOk()}}))}}t.Prompt=c,c.propTypes={onOk:i.default.func.isRequired,onCancel:i.default.func.isRequired,title:i.default.string,width:i.default.number,message:i.default.string,value:i.default.string,noInput:i.default.bool,inputType:i.default.string,selectionStart:i.default.number,selectionEnd:i.default.number,placeholder:i.default.string,okText:i.default.string,cancelText:i.default.string,keepOpenOnError:i.default.bool},c.defaultProps={width:350,title:"Please input",message:"",value:"",placeholder:"",selectionStart:0,selectionEnd:0,noInput:!1,closable:!0,inputType:"text",okText:"Confirm",cancelText:"Cancel",keepOpenOnError:!1},t.prompt=function(e){return new Promise((t,r)=>{const n=Object.assign(Object.assign({},e),{onOk:n=>new Promise(t=>{t(!e.onOk||e.onOk(n))}).then(()=>(t(n),l(),Promise.resolve(!0)),t=>e.keepOpenOnError?Promise.reject(t):(r(t),!0)),onCancel:()=>new Promise(t=>{t(!e.onCancel||e.onCancel())}).then(()=>(t(null),l(),Promise.resolve(!0)),t=>e.keepOpenOnError?Promise.reject(t):(r(t),!0))}),i=document.createElement("div"),s=document.createElement("div"),l=()=>setTimeout(()=>{i.remove()},1e3);document.body.appendChild(i),i.appendChild(s),o.default.render(a.default.createElement(c,Object.assign({},n)),s)})}},191:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Pending=0]="Pending",e[e.Success=1]="Success",e[e.Failure=2]="Failure",e[e.Warning=3]="Warning"}(n=t.CommandRunningStatus||(t.CommandRunningStatus={})),function(e){e[e.Idle=0]="Idle",e[e.Running=1]="Running",e[e.Calling=2]="Calling",e[e.Finished=3]="Finished",e[e.Error=4]="Error"}(t.MacroStatus||(t.MacroStatus={})),t.getCommandResults=function(e){const{doneIndices:t,errorIndices:r,warningIndices:a,count:o}=e,i=[];for(let e=0;e<o;e++)-1!==t.indexOf(e)?i.push(n.Success):-1!==r.indexOf(e)?i.push(n.Failure):-1!==a.indexOf(e)?i.push(n.Warning):i.push(n.Pending);return i},t.getDoneErrorIndices=function(e){const t=[],r=[],a=[];return e.forEach((e,o)=>{switch(e){case n.Failure:return r.push(o);case n.Warning:return a.push(o);case n.Success:return t.push(o)}}),{doneIndices:t,errorIndices:r,warningIndices:a,count:e.length}}},195:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(117),i=r(62);t.ResourceNotLoaded=function(e){return a.default.createElement("div",{className:"list-not-loaded"},a.default.createElement("p",null,"Started by ",i.stringForRunBy(e.from),"."),a.default.createElement("p",null,e.name," not loaded."),a.default.createElement(o.Button,{type:"primary",onClick:e.showList},"Load now"))}},197:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(153),o=r(12),i=n(r(34));class s extends a.KeyValueData{getAll(){return super.get("").then(e=>e||{})}getMainKeyAndSubKeys(e){const[t,r]=super.getMainKeyAndSubKeys(e);return[s.STORAGE_KEY,[t].concat(r).filter(e=>e&&e.length)]}}t.OcrServerKeyValueData=s,s.STORAGE_KEY="ocr_server_data",t.getOcrServerKeyValueData=o.singletonGetter(()=>new s);class c{constructor(e){this.servers=e.servers,this.resetTime=e.resetTime,this.lastId=null}all(){return Promise.resolve(this.servers)}isAllDown(){return this.validServers().then(({servers:e})=>0===e.length)}randomPick(){return this.validServers().then(({servers:e,serverInfos:t})=>e[l(e.length)])}bestPick(){return this.validServers().then(({servers:e,serverInfos:t})=>{const r=e=>t[e.id]?t[e.id].lastTotalMilliseconds:0;return e.reduce((e,t)=>{if(!e)return t;const n=r(e),a=r(t);switch(Math.sign(n-a)){case 0:return Math.random()>.5?e:t;case 1:return t;case-1:default:return e}})})}reset(){return o.flow(...this.servers.map(e=>()=>t.getOcrServerKeyValueData().set(e.id,null))).then(()=>{})}use(e){if(!this.servers.find(t=>t.id===e))throw new Error(`No server found with id '${e}'`);this.lastId=e}report(e,r){return t.getOcrServerKeyValueData().set(e,r).then(()=>!0)}validServers(){return t.getOcrServerKeyValueData().getAll().then(e=>{const t=(new Date).getTime(),r=this.servers.filter(r=>{const n=e[r.id];return!n||(t-n.lastResponseTimestamp>this.resetTime||!n.lastError&&n.lastTotalMilliseconds<=i.default.ocr.apiHealthyResponseTime)});if(0===r.length)throw new Error("All OCR servers are down");return{servers:r,serverInfos:e}})}}function l(e){return Math.round(Math.random()*e)}t.OcrEndpointPicker=c,t.randomIndex=l,t.getOcrEndpointPicker=o.singletonGetter(()=>new c({servers:i.default.ocr.apiList,resetTime:i.default.ocr.resetTime}))},20:function(e,t,r){"use strict";r.r(t);var n=r(93),a=function(){throw new Error("You are not a top window, not allowed to initialize/use csIpc")},o=window.top===window?Object(n.csInit)():{ask:a,send:a,onAsk:a,destroy:a};t.default=o},21:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(e){return[e+"_REQUEST",e+"_SUCCESS",e+"_FAIL"]},o=function(e){return a(e).map((function(e){return s[e]}))},i=["START_RECORDING","STOP_RECORDING","START_INSPECTING","STOP_INSPECTING"].reduce((function(e,t){return a(t).forEach((function(t){e[t]=t})),e}),{}),s=n({},["SET_ROUTE","SET_EDITOR_ACTIVE_TAB","DONE_INSPECTING","UPDATE_BASE_URL","APPEND_COMMAND","DUPLICATE_COMMAND","INSERT_COMMAND","UPDATE_COMMAND","REMOVE_COMMAND","SELECT_COMMAND","CUT_COMMAND","COPY_COMMAND","PASTE_COMMAND","NORMALIZE_COMMANDS","UPDATE_SELECTED_COMMAND","SAVE_EDITING_AS_EXISTED","SAVE_EDITING_AS_NEW","SET_TEST_CASES","SET_EDITING","EDIT_TEST_CASE","EDIT_NEW_TEST_CASE","ADD_TEST_CASES","RENAME_TEST_CASE","REMOVE_TEST_CASE","UPDATE_TEST_SUITE_STATUS","UPDATE_ONE_MACRO_EXTRA","SET_ONE_MACRO_EXTRA","SET_MACROS_EXTRA","SET_TEST_SUITES_EXTRA","SET_PLAYER_STATE","SET_PLAYER_MODE","SET_TEST_SUITES","UPDATE_TEST_SUITE","ADD_LOGS","CLEAR_LOGS","ADD_SCREENSHOT","CLEAR_SCREENSHOTS","ADD_VISION","CLEAR_VISIONS","START_PLAYING","STOP_PLAYING","SET_CSV_LIST","SET_SCREENSHOT_LIST","SET_VISION_LIST","SET_VARIABLE_LIST","SET_SOURCE_ERROR","SET_SOURCE_CURRENT","UPDATE_CONFIG","UPDATE_UI","UPDATE_PROXY"].reduce((function(e,t){return e[t]=t,e}),{}),i)},22:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4);function a(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{t({$img:n,width:n.width,height:n.height})},n.onerror=e=>{r(e)},n.src=e})}function o(e){return"data:image/svg+xml;base64,"+window.btoa(e)}function i(e){return new Promise((t,r)=>{const n=document.createElement("canvas"),a=n.getContext("2d"),i=document.createElement("img"),s=o(e),c=e.match(/<svg[\s\S]*?width="(.*?)"/m),l=e.match(/<svg[\s\S]*?height="(.*?)"/m),u=parseInt(c[1],10),d=parseInt(l[1],10);i.src=s,i.onload=function(){n.width=u,n.height=d,a.drawImage(i,0,0,u,d),t(n)},i.onerror=function(e){r(e)}})}function s(e,t,r){if(e>255||t>255||r>255)throw"Invalid color component";return(e<<16|t<<8|r).toString(16)}t.getStyle=function(e){if(!e)throw new Error("getStyle: dom does not exist");return getComputedStyle(e)},t.setStyle=function(e,t){if(!e)throw new Error("setStyle: dom does not exist");for(var r=0,n=Object.keys(t),a=n.length;r<a;r++)e.style[n[r]]=t[n[r]];return e},t.pixel=function(e){return-1!==(e+"").indexOf("px")?e:(e||0)+"px"},t.bindDrag=e=>{const{onDragStart:t,onDragEnd:r,onDrag:n,$el:a,preventGlobalClick:o=!0,doc:i=document}=e;let s=!1,c={x:0,y:0};const l=e=>{s=!0,c={x:e.screenX,y:e.screenY},t(e)},u=e=>{if(!s)return;s=!1;const t=e.screenX-c.x,n=e.screenY-c.y;r(e,{dx:t,dy:n})},d=e=>{if(!s)return;const t=e.screenX-c.x,r=e.screenY-c.y;n(e,{dx:t,dy:r}),e.preventDefault(),e.stopPropagation()},m=e=>{e.preventDefault(),e.stopPropagation()};return o&&i.addEventListener("click",m,!0),i.addEventListener("mousemove",d,!0),i.addEventListener("mouseup",u,!0),a.addEventListener("mousedown",l,!0),()=>{i.removeEventListener("click",m,!0),i.removeEventListener("mousemove",d,!0),i.removeEventListener("mouseup",u,!0),a.removeEventListener("mousedown",l,!0)}},t.bindContentEditableChange=e=>{const{onChange:t,doc:r=document}=e;let n=null,a=null;const o=e=>{e.target&&"true"===e.target.contentEditable&&(n=e.target,a=n.innerHTML)},i=e=>{e.target!==n||n&&n.innerHTML!==a&&t(e),n=null,a=null};return r.addEventListener("focus",o,!0),r.addEventListener("blur",i,!0),()=>{r.removeEventListener("focus",o,!0),r.removeEventListener("blur",i,!0)}},t.scrollLeft=function(e){return e.documentElement.scrollLeft},t.scrollTop=function(e){return e.documentElement.scrollTop},t.domText=e=>{const t=e.innerText?e.innerText.trim():"",r=e.textContent,n=r.toUpperCase().indexOf(t.toUpperCase());return-1===n?t:r.substr(n,t.length)},t.isVisible=function(e){if(e===window.document)return!0;if(!e)return!0;const r=window.getComputedStyle(e);return"none"!==r.display&&"0"!==r.opacity&&"hidden"!==r.visibility&&t.isVisible(e.parentNode)},t.cssSelector=function(e){if(!e)return"";if(1!==e.nodeType)return"";if("BODY"===e.tagName)return"body";if(e.id)return"#"+e.id;var r=e.className.split(/\s+/g).filter((function(e){return e&&e.length})),a=Array.from(e.parentNode?e.parentNode.childNodes:[]).filter((function(e){return 1===e.nodeType})),o=a.filter((function(t){return t.tagName===e.tagName})),i=a.filter((function(e){var t=e.className.split(/\s+/g);return n.and(...r.map((function(e){return-1!==t.indexOf(e)})))})),s="";s=1===o.length?"":r.length&&1===i.length?"."+r.join("."):":nth-child("+(1+a.findIndex((function(t){return t===e})))+")";var c=e.tagName.toLowerCase()+s;return t.cssSelector(e.parentNode)+" > "+c},t.isPositionFixed=e=>!(!e||e===document.documentElement||e===document.body)&&("fixed"===getComputedStyle(e).position||t.isPositionFixed(e.parentNode)),t.offset=function(e){if(!e)return{left:0,top:0};var t=e.getBoundingClientRect();return{left:t.left+window.scrollX,top:t.top+window.scrollY}},t.accurateOffset=function e(t){if(!t)return{left:0,top:0};const r=t.ownerDocument;if(!r||t===r.documentElement)return{left:0,top:0};const n=e(t.offsetParent);return{left:n.left+t.offsetLeft,top:n.top+t.offsetTop}},t.preloadImage=a,t.isFirefox=function(){return/Firefox/.test(window.navigator.userAgent)},t.svgNodetoString=function(e){return e.outerHTML},t.svgToBase64=o,t.canvasFromSVG=i,t.imageBlobFromSVG=function(e,t="image/png",r){return i(e).then(e=>new Promise((n,a)=>{try{e.toBlob(n,t,r)}catch(e){a(e)}}))},t.imageDataFromUrl=function(e){return a(e).then(({$img:e,width:t,height:r})=>{const n=document.createElement("canvas");n.width=t,n.height=r;const a=n.getContext("2d");return a.drawImage(e,0,0,t,r),a.getImageData(0,0,t,r)})},t.subImage=function(e,t){return new Promise((r,n)=>{const a=new Image;a.onload=()=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(a,0,0,a.width,a.height,-1*t.x,-1*t.y,a.width,a.height),r(e.toDataURL())},a.src=e})},t.rgbToHex=s,t.getPixel=function(e){const{x:t,y:r,dataUrl:n}=e;return new Promise((e,a)=>{const o=new Image;o.onload=()=>{const n=o.width,i=o.height;if(t<0||r<0||t>n||r>i)return a(new Error(`${t}, ${r} is out of screenshot bound 0, 0 ~ ${n}, ${i}`));const c=document.createElement("canvas");c.width=t+5,c.height=r+5;const l=c.getContext("2d");let u;l.drawImage(o,0,0,t+5,r+5,0,0,t+5,r+5);try{const n=l.getImageData(t,r,1,1).data;u="#"+("000000"+s(n[0],n[1],n[2])).slice(-6),e(u)}catch(e){a(new Error("Failed to get pixel color"+((null==e?void 0:e.message)?`: ${e.message}.`:".")))}},o.src=n})},t.scaleRect=function(e,t){return{x:t*e.x,y:t*e.y,width:t*e.width,height:t*e.height}},t.isEditable=function(e){if("true"===e.contentEditable)return!0;const t=(e.tagName||"").toLowerCase();if(-1===["input","textarea"].indexOf(t))return!1;const r=e.disabled,n=e.readOnly;return!r&&!n},t.hasAncestor=function(e,t){let r=e;for(;r;){if(t(r))return!0;r=r.parentNode}return!1},t.getAncestor=function(e,t){let r=e;for(;r;){if(t(r))return r;r=r.parentNode}return null}},23:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(731),a=r(17),o=r(105),i=r(137),s=r(12),c=r(62);function l(e,r,n,a=!1){const o=a?t.getMacroFolderNodeList(e):t.getMacroFileNodeList(e),i=e=>e.toLowerCase().replace(/\\/g,"/").replace(/\.json$/i,""),s=i(n);return o.find(e=>a===e.isDirectory&&(i(e.fullPath)===s||i(e[r])===s))}function u(e,t,r){return s.treeMap((e,n)=>({id:e.fullPath,type:e.isFile?i.FileNodeType.File:i.FileNodeType.Folder,level:n.length,selected:!1,name:e.name,entryPath:e.fullPath,folded:r(e),className:t(e)}),e)}t.getTestSuitesWithAllInfo=n.createSelector([e=>e.editor.testSuites,e=>e.editor.testSuitesExtra],(e,t)=>e.map(e=>{const r=(e=>e.id)(e),n=t[r||""];return Object.assign(Object.assign({},e),n||{})})),t.getCurrentMacroId=n.createSelector([e=>e.editor.editing.meta.src],e=>e?e.id:a.UNTITLED_ID),t.getBreakpoints=n.createSelector([e=>e.editor.macrosExtra,t.getCurrentMacroId],(e,t)=>(e[t]||{}).breakpointIndices||[]),t.getBreakpointsByMacroId=function(e,t){return(e.editor.macrosExtra[t]||{}).breakpointIndices||[]},t.getDoneCommandIndices=n.createSelector([e=>e.editor.macrosExtra,t.getCurrentMacroId],(e,t)=>(e[t]||{}).doneCommandIndices||[]),t.getWarningCommandIndices=n.createSelector([e=>e.editor.macrosExtra,t.getCurrentMacroId],(e,t)=>(e[t]||{}).warningCommandIndices||[]),t.getErrorCommandIndices=n.createSelector([e=>e.editor.macrosExtra,t.getCurrentMacroId],(e,t)=>(e[t]||{}).errorCommandIndices||[]),t.isFocusOnCommandTable=n.createSelector([e=>e],e=>e.ui.focusArea===c.FocusArea.CommandTable),t.isFocusOnSidebar=n.createSelector([e=>e],e=>e.ui.focusArea===c.FocusArea.Sidebar),t.getConfig=n.createSelector([e=>e.config],s.id),t.getShouldSaveAlternativeLocators=n.createSelector([t.getConfig],e=>!!e.saveAlternativeLocators),t.hasUnsavedMacro=function(e){const{editor:t}=e,{editing:r,editingSource:n,activeTab:a}=t;if(!r.meta.src)return!0;switch(a){case"table_view":{const{hasUnsaved:e}=r.meta||{};return e}case"source_view":return n.original!==n.current;default:throw new Error("Unknown activeTab")}},t.findMacroNodeWithCaseInsensitiveField=l,t.findMacroNodeWithCaseInsensitiveFullPath=function(e,t){return l(e,"fullPath",t)},t.findMacroNodeWithCaseInsensitiveRelativePath=function(e,t){return l(e,"relativePath",t)},t.findMacroFolderWithCaseInsensitiveRelativePath=function(e,t){return l(e,"relativePath",t,!0)},t.editorSelectedCommand=function(e){const{meta:t,commands:r}=e.editor.editing;return t&&-1!==t.selectedIndex&&r[t.selectedIndex]||null},t.editorSelectedCommandIndex=function(e){const{meta:t}=e.editor.editing;return t?t.selectedIndex:null},t.editorCommandCount=function(e){const{commands:t}=e.editor.editing;return t.length},t.entryNodeToFileNodeData=u,t.getEditor=e=>e.editor,t.getMacroFolderStructure=n.createSelector([t.getEditor],e=>e.macroFolderStructure),t.getMacrosExtra=n.createSelector([t.getEditor],e=>e.macrosExtra),t.getMacroFileNodeData=n.createSelector([t.getMacroFolderStructure,t.getMacrosExtra,t.getCurrentMacroId,t.isFocusOnSidebar],(e,t,r,n)=>{const a=e=>{const a=[],i=e.fullPath,s=t[i]&&t[i].status;return a.push((()=>{switch(s){case o.MacroResultStatus.Success:return"success";case o.MacroResultStatus.Error:return"error";case o.MacroResultStatus.ErrorInSub:return"error-in-sub";default:return"normal"}})()),r===i&&a.push("selected"),n||a.push("blur"),a.join(" ")},i=e=>{const r=e.fullPath;return t[r]&&t[r].folded||!1};return e.map(e=>u(e,a,i))}),t.getFilteredMacroFileNodeData=n.createSelector([t.getMacroFileNodeData,e=>e.macroQuery],(e,t)=>{const r=t.trim().toLowerCase();return 0===r.length?e:e.map(e=>{const t=s.treeFilter(e=>-1!==e.name.toLowerCase().indexOf(r),e);return t?s.treeMap(e=>Object.assign(Object.assign({},e),{folded:!1}),t):null}).filter(e=>e)}),t.getMacroFileNodeList=n.createSelector([t.getMacroFolderStructure],e=>s.flatten(e.map(e=>{const t=[];return s.traverseTree(e=>(e.isFile&&t.push(e),s.TraverseTreeResult.Normal),e),t}))),t.getMacroFolderNodeList=n.createSelector([t.getMacroFolderStructure],e=>s.flatten(e.map(e=>{const t=[];return s.traverseTree(e=>(e.isDirectory&&t.push(e),s.TraverseTreeResult.Normal),e),t}))),t.isMacroFolderNodeListEmpty=n.createSelector([t.getMacroFolderNodeList],e=>0===e.length),t.getIndexToInsertRecorded=n.createSelector([e=>e.editor.editing.meta.indexToInsertRecorded],s.id),t.getStatus=n.createSelector([e=>e.status],s.id),t.getShouldLoadResources=n.createSelector([e=>e.from],e=>e===c.RunBy.Manual),t.isPlaying=n.createSelector([t.getStatus,s.id],(e,t)=>e===a.APP_STATUS.PLAYER&&t.player.status===a.PLAYER_STATUS.PLAYING),t.isNoDisplay=n.createSelector([t.isPlaying,s.id],(e,t)=>e&&t.noDisplayInPlay)},27:function(e,t,r){"use strict";r.r(t);var n=r(55);r.d(t,"win32",(function(){return n.win32})),r.d(t,"posix",(function(){return n.posix}));var a=/windows/i.test(window.navigator.userAgent)?n.win32:n.posix;t.default=a},28:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return f}));var n=r(630),a=r.n(n),o=r(4),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var c={STRAIGHT:"STRAIGHT",SINGLE:"SINGLE",LOOP:"LOOP"},l={PLAYING:"PLAYING",PAUSED:"PAUSED",STOPPED:"STOPPED",ERROR:"ERROR"},u={COMPLETE:"COMPLETE",ERROR:"ERROR",MANUAL:"MANUAL"},d=function(e){return null==e},m={startUrl:null,startIndex:null,endIndex:null,nextIndex:null,errorIndex:null,doneIndices:[],mode:c.STRAIGHT,resources:[],status:l.STOPPED},p=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=i({},m),this.toResumePromises={},!t)throw new Error("Player - constructor: must provide opts as 1st argument");if("function"!=typeof t.run)throw new Error("Player - constructor: must provide a run function");if("function"!=typeof t.prepare)throw new Error("Player - constructor: must provide a prepare function");if("function"!=typeof t.handleResult)throw new Error("Player - constructor: must provide a handleResult function");this.__run=t.run,this.__prepare=t.prepare,this.__handle=t.handleResult,this.__setState(r||{})}return s(e,[{key:"play",value:function(e){var t=this;if(!e)throw new Error("Player - play: config should not be empty");if(!e.mode||-1===Object.keys(c).indexOf(e.mode))throw new Error("Player - play: must provide a valid mode, now it is "+e.mode);if(e.mode===c.LOOP&&(!e.loopsStart||e.loopsStart<0||Math.floor(e.loopsStart)!==e.loopsStart||!e.loopsEnd||e.loopsEnd<e.loopsStart||Math.floor(e.loopsEnd)!==e.loopsEnd))throw new Error('Player - play: must provide a valid tuple of "loopsStart" and "loopsEnd" in loop mode, now it is '+e.loopsStart+", "+e.loopsEnd);if(0!==e.resources.length&&(d(e.startIndex)||e.startIndex<0||e.startIndex>=e.resources.length))throw new Error("Player - play: startIndex out of range, now it is "+e.startIndex+", len: "+e.resources.length);if(!d(e.endIndex)&&(e.endIndex<0||e.endIndex>=e.resources.length))throw new Error("Player - play: endIndex out of range, now it is "+e.endIndex+", len: "+e.resources.length);var r=e.nextIndex,n=e.startIndex,a=e.startUrl,o=e.resources,s=e.title,u=e.extra,m=e.doneIndices,p=e.noEndEvent,h=e.token,f=e.isStep,g=e.loopsCursor,v=e.loopsStart,b=e.loopsEnd,y=e.isBackFromCalling,w=e.needDelayAfterLoop,E=e.endIndex||o.length-1,x={token:h,title:s,extra:u,needDelayAfterLoop:w,isBackFromCalling:y,startUrl:a,startIndex:n,endIndex:E,nextIndex:void 0!==r?r:n,errorIndex:null,doneIndices:m||[],mode:e.mode,loopsCursor:1,loopsStart:1,loopsEnd:1,isStep:f||!1,noEndEvent:p||!1,resources:e.resources,breakpoints:e.breakpoints||[],status:l.PLAYING,public:e.public||{},callback:e.callback||function(){},lastPlayConfig:e,playUID:Math.random()};switch(["preDelay","postDelay"].forEach((function(t){d(e[t])||(x[t]=e[t])})),e.mode){case c.STRAIGHT:this.__setState(i({},x));break;case c.SINGLE:this.__setState(i({},x,{endIndex:n}));break;case c.LOOP:this.__setState(i({},x,{loopsStart:v,loopsEnd:b,loopsCursor:void 0!==g?g:v}))}return this.emit("START",{title:s,loopsCursor:this.state.loopsCursor,doneIndices:this.state.doneIndices,extra:this.state.extra,isBackFromCalling:this.state.isBackFromCalling}),Promise.resolve().then((function(){return t.__prepare(t.state)})).then((function(){t.emit("PREPARED",{title:s,loopsCursor:t.state.loopsCursor,doneIndices:t.state.doneIndices,extra:t.state.extra,isBackFromCalling:t.state.isBackFromCalling})})).then((function(){return t.__go(t.state.token||null)}),(function(e){return t.__errLog(e,e.errorIndex)}))}},{key:"pause",value:function(){var e=this;return this.__setState({status:l.PAUSED}),setTimeout((function(){e.emit("PAUSED",{extra:e.state.extra})}),0),this.__createPromiseWaitForResume(this.state.token)}},{key:"resume",value:function(e){this.__setState({status:l.PLAYING,isStep:!!e}),this.emit("RESUMED",{extra:this.state.extra});var t=this.toResumePromises[this.state.token];t&&t.resolve&&t.resolve()}},{key:"stop",value:function(e){this.__end(u.MANUAL,e)}},{key:"stopWithError",value:function(e){this.__errLog(e)}},{key:"jumpTo",value:function(e){var t=this.state.resources;if(e<0||e>=t.length)throw new Error("jumpTo: nextIndex out of range");this.__setState({nextIndex:e})}},{key:"setPostDelay",value:function(e){this.__setState({postDelay:e})}},{key:"getStatus",value:function(){return this.state.status}},{key:"getState",value:function(){return i({},this.state)}},{key:"setState",value:function(e){return this.__setState(e)}},{key:"replayLastConfig",value:function(){var e=this.state.lastPlayConfig;if(!e)throw new Error("No last play config available");return this.play(i({},e,{nextIndex:e.startIndex}))}},{key:"getPlayUID",value:function(){return this.state.playUID}},{key:"checkPlayUID",value:function(e){return this.state.playUID===e}},{key:"__go",value:function(e){var t=this;if(null==e)this.state.token=e=Math.random();else if(e!==this.state.token)return;var r=function(r){return function(){if(e!==t.state.token)throw new Error("token expired");return r.apply(void 0,arguments)}},n=this.state,a=(n.resources,n.nextIndex,n.preDelay);return(a>0?this.__delay((function(){}),a):Promise.resolve()).then((function(){return t.__shouldContinue()})).then((function(n){var a=n.paused,o=n.complete;if(a)throw new Error("player: paused or stopped");if(!o){var i=t.state,s=i.resources,c=i.nextIndex,l=i.startIndex,u=i.loopsCursor,d=i.loopsStart,m=i.loopsEnd;if(c===l){var p={loopsCursor:u,index:c,currentLoop:u-d+1,loops:m-d+1,resource:s[c],extra:t.state.extra};t.emit("LOOP_START",p),u!==d&&t.emit("LOOP_RESTART",p)}return t.emit("TO_PLAY",{index:c,currentLoop:u-d+1,loops:m-d+1,resource:s[c],extra:t.state.extra}),(void 0===t.state.lastBreakpoint&&-1!==t.state.breakpoints.indexOf(c)?(t.__setState({lastBreakpoint:c}),t.emit("BREAKPOINT",{index:c,currentLoop:u-d+1,loops:m-d+1,resource:s[c],extra:t.state.extra}),t.pause()):(t.__setState({lastBreakpoint:void 0}),Promise.resolve())).then((function(){return t.__run(s[c],t.state)})).then(r((function(n){return t.__handle(n,s[c],t.state).then(r((function(e){var r=t.state.loopsCursor;return t.__setNext(e),t.emit("PLAYED_LIST",{indices:t.state.doneIndices,extra:t.state.extra}),r!==t.state.loopsCursor}))).then((function(e){var r=t.state,n=r.postDelay,a=r.needDelayAfterLoop,o=Math.max(n,e&&a?10:0);return o>0?t.__delay((function(){}),o):Promise.resolve()})).then((function(){return t.state.isStep?t.pause().then((function(){return t.__go(e)})):t.__go(e)}))}))).catch(r((function(e){return t.__errLog(e)})))}}))}},{key:"__shouldContinue",value:function(){var e=this.state,t=e.status,r=(e.mode,e.nextIndex),n=e.startIndex,a=e.endIndex;e.token;if(t===l.PAUSED||t===l.STOPPED){var o=this.toResumePromises[this.state.token];return o?o.promise.then((function(){return{}})):{paused:!0}}return t===l.PLAYING&&r>=n&&r<=a?Promise.resolve({paused:!1,complete:!1}):(this.__end(u.COMPLETE),Promise.resolve({complete:!0}))}},{key:"__createPromiseWaitForResume",value:function(e){var t=this,r=new Promise((function(n,a){setTimeout((function(){t.toResumePromises[e]={resolve:n,reject:a,promise:r}}),10)}));return r}},{key:"__createPromiseForStop",value:function(e,t){var r=this,n=new Promise((function(a,o){setTimeout((function(){r.toResumePromises[e]={resolve:a,reject:o,promise:n},o(new Error("Stop reason: "+t))}),10)}));return n}},{key:"__end",value:function(e,t){if(this.state.status!==l.STOPPED){if(-1===Object.keys(u).indexOf(e))throw new Error("Player - __end: invalid reason, "+e);var r=t&&t.silent;this.state.noEndEvent&&e===u.COMPLETE||r||(this.emit("END",{opts:t,reason:e,extra:this.state.extra}),e!==u.ERROR&&this.state.callback(null,e)),e!==u.COMPLETE&&this.__createPromiseForStop(this.state.token,e),this.__setState({status:l.STOPPED})}}},{key:"__errLog",value:function(e,t){if(this.state.status===l.STOPPED)throw new Error(e);throw this.emit("ERROR",{errorIndex:void 0!==t?t:this.state.nextIndex,msg:e&&e.message,extra:this.state.extra,restart:!!e.restart}),this.state.callback(e,null),this.__end(u.ERROR),new Error(e)}},{key:"__setNext",value:function(e){if(void 0!==e&&(e<0||e>this.state.resources.length))throw new Error("invalid nextIndexPassed "+e);var t=this.state,r=t.mode,n=t.doneIndices,a=t.nextIndex,o=t.endIndex,i=t.startIndex,s=t.loopsCursor,l=t.loopsEnd,u=void 0!==e?e:a+1,d=-1===n.indexOf(a)?[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(n),[a]):n,m=s,p=null;r===c.LOOP?u<=o||s>=l?p=u:(m+=1,p=i,d=[]):p=u,this.__setState({loopsCursor:m,nextIndex:p,doneIndices:d})}},{key:"__setState",value:function(e){this.state=i({},this.state,e)}},{key:"__delay",value:function(e,t){var r=this,n=0,a=setInterval((function(){n+=1e3,r.emit("DELAY",{extra:r.state.extra,total:t,past:n})}),1e3);return Object(o.delay)(e,t).then((function(e){return a&&clearInterval(a),e}))}}]),e}();a()(p.prototype),p.C=p.prototype.C={MODE:c,STATUS:l,END_REASON:u};var h={},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=e.name||"testCase";if(delete e.name,Object.keys(e).length>0&&(h[r]=new p(e,t)),!h[r])throw new Error("player not initialized");return h[r]}},30:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(10)),o=n(r(36)),i=r(12),s=r(1005),c=r(16);t.getLicenseService=i.singletonGetter(()=>new s.LicenseService({getVersion:()=>Promise.resolve(a.default.runtime.getManifest().version),getLegacyXModuleStatus:()=>window.store.getState().config.xmodulesStatus,setLegacyXModuleStatus:e=>Promise.resolve(window.store.dispatch(c.updateConfig({xmodulesStatus:e}))),save:e=>o.default.set(s.LicenseService.StorageKey,e).then(()=>{}),read:()=>o.default.get(s.LicenseService.StorageKey).then(e=>null!=e?e:null)}))},32:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(90),o=r(60),i=r(12),s=n(r(27));class c extends a.XModule{getName(){return a.XModuleTypes.XFile}getAPI(){return o.getNativeFileSystemAPI()}initConfig(){return this.getConfig().then(e=>{if(!e.rootDir){const e=o.getNativeFileSystemAPI();return e.getSpecialFolderPath({folder:o.SpecialFolder.UserDesktop}).then(t=>{const r=s.default.join(t,"uivision");return e.ensureDir({path:r}).then(e=>{this.setConfig({rootDir:e?r:t})})}).catch(e=>{if(!/Specified native messaging host not found/.test(e))throw e})}})}sanityCheck(e){return Promise.all([this.getConfig(),this.getAPI().getVersion().then(()=>this.getAPI(),()=>this.getAPI().reconnect()).catch(e=>{throw new Error("xFile is not installed yet")})]).then(([t,r])=>{if(e)return!0;if(!t.rootDir)throw new Error("rootDir is not set");return r.directoryExists({path:t.rootDir}).then(e=>{if(!e)throw new Error(`Directory '${t.rootDir}' doesn't exist`);return!0}).then(()=>{const e=s.default.join(t.rootDir,"__kantu__"+Math.round(100*Math.random()));return r.createDirectory({path:e}).then(t=>{if(!t)throw new Error;return r.removeDirectory({path:e})}).then(e=>{if(!e)throw new Error;return!0}).catch(e=>{throw new Error(`Directory '${t.rootDir}' is not writable`)})})})}checkUpdate(){return Promise.reject(new Error("checkUpdate is not implemented yet"))}checkUpdateLink(e,t){return`https://ui.vision/x/idehelp?help=xfileaccess_updatecheck&xversion=${e}&kantuversion=${t}`}downloadLink(){return"https://ui.vision/x/idehelp?help=xfileaccess_download"}infoLink(){return"https://ui.vision/x/idehelp?help=xfileaccess"}}t.XFile=c,t.getXFile=i.singletonGetter(()=>new c)},324:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(60),o=r(32),i=n(r(27)),s=n(r(11)),c=r(12),l=r(13);class u{constructor(e={}){this.pDirReady=Promise.resolve(!1),this.logsDir="",this.fileName="log.txt",this.waitForStorageManager=()=>Promise.resolve(l.getStorageManager()),this.check(),this.updateLogFileName(),e.waitForStorageManager&&(this.waitForStorageManager=e.waitForStorageManager)}updateLogFileName(){const e=new Date,t=`${e.getFullYear()}${c.pad2digits(e.getMonth()+1)}${c.pad2digits(e.getDate())}`,r=[e.getHours(),e.getMinutes(),e.getSeconds()].map(e=>c.pad2digits(e)).join("");this.fileName=`log-${t}-${r}.txt`}check(){return this.pDirReady=o.getXFile().sanityCheck(!0).then(e=>{if(!e)return!1;const{rootDir:t}=o.getXFile().getCachedConfig();return!!t&&(this.logsDir=i.default.join(t,"logs"),a.getNativeFileSystemAPI().ensureDir({path:this.logsDir}))}),this.pDirReady}log(e){return this.waitForStorageManager().then(t=>!!t.isXFileMode()&&o.getXFile().sanityCheck(!0).then(()=>this.pDirReady).then(t=>!!t&&a.getNativeFileSystemAPI().appendAllText({path:i.default.join(this.logsDir,this.fileName),content:d(e)}),e=>(s.default.warn("Failed to log: ",e.message),!1)))}logWithTime(e){return this.log(`${(new Date).toISOString()} - ${e}`)}logTo(e,t){return this.waitForStorageManager().then(r=>!!r.isXFileMode()&&o.getXFile().sanityCheck(!0).then(r=>{if(!r)return!1;const n=i.default.dirname(e);return a.getNativeFileSystemAPI().ensureDir({path:n}).then(r=>!!r&&a.getNativeFileSystemAPI().appendAllText({path:e,content:d(t)}))},e=>(s.default.warn("Failed to log: ",e.message),!1)))}}function d(e){return 0===e.length?e:"\n"!==e.charAt(e.length-1)?e+"\n":e}t.LogService=u,t.getLogService=c.singletonGetter(()=>new u)},325:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(185),o=r(511),i=r(13),s=r(105),c=n(r(107)),l=r(358),u=r(12);class d{constructor(){this.oldMacros=[]}getMeta(){return{createdAt:new Date("2019-04-01").getTime(),goal:["Migrate macros and test suites from indexedDB storage to Browser File System storage","In order to prepare for an easy support for deep folder structure","Note: the old indexedDB storage WILL NOT be cleared, just in case any user loses his data during migration","The real clean up could be done in future releases, in the form of another migration job"].join(". ")}}getType(){return a.MigrationJobType.MigrateMacroTestSuiteToBrowserFileSystem}previousVersionRange(){return"<=4.0.1"}shouldMigrate(){const e=this.getOldMacroStorage(),t=this.getOldTestSuiteStorage();return Promise.all([e.list().then(e=>e.length),t.list().then(e=>e.length)]).then(([e,t])=>e>0||t>0)}migrate(){const e=()=>this.getOldTestSuiteStorage().readAll().then(e=>(console.log("this.getOldTestSuiteStorage().readAll()",e),c.default.ensureDirectory("/testsuites").then(()=>this.getNewTestSuiteStorage().bulkWrite(e)))).then(()=>!0),t=()=>s.getMacroExtraKeyValueData().getAll().then(e=>(this.oldMacros.forEach(t=>{const r=this.getNewMacroStorage().filePath(t.name),n=t.id;e[n]&&(e[r]=e[n])}),s.getMacroExtraKeyValueData().set("",e)));return(()=>this.getOldMacroStorage().readAll().then(e=>(console.log("this.getOldMacroStorage().readAll()",e),this.oldMacros=e.map(e=>e.content),c.default.ensureDirectory("/macros").then(()=>this.getNewMacroStorage().bulkWrite(e)))).then(()=>!0))().then(()=>e()).then(()=>t()).then(()=>!0)}remedy(){const e=()=>this.getOldTestSuiteStorage().readAll().then(e=>e.map(e=>e.content));return(()=>this.getOldMacroStorage().readAll().then(e=>(this.oldMacros=e.map(e=>e.content),this.oldMacros)))().then(t=>e().then(e=>l.backup({backup:{testCase:!0,testSuite:!0},macroNodes:t,testSuites:e})))}getOldMacroStorage(){return o.getIndexeddbFlatStorage({table:"testCases"})}getOldTestSuiteStorage(){return o.getIndexeddbFlatStorage({table:"testSuites"})}getNewMacroStorage(){return this.getStorageManager().getStorageForTarget(i.StorageTarget.Macro,i.StorageStrategyType.Browser)}getNewTestSuiteStorage(){return this.getStorageManager().getStorageForTarget(i.StorageTarget.TestSuite,i.StorageStrategyType.Browser)}getStorageManager(){return new i.StorageManager(i.StorageStrategyType.Browser,{getMacros:()=>this.oldMacros,getMaxMacroCount:()=>Promise.resolve(1/0)})}}t.MigrateMacroTestSuiteToBrowserFileSystem=d,t.getMigrateMacroTestSuiteToBrowserFileSystem=u.singletonGetter(()=>new d)},329:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={ara:{lang:"ara",name:"Arabic",short:"AR"},chs:{lang:"chs",name:"ChineseSimplified",short:"简"},cht:{lang:"cht",name:"ChineseTraditional",short:"繁"},ce:{lang:"ce",name:"Czech",short:"CS"},dan:{lang:"dan",name:"Danish",short:"DA"},dut:{lang:"dut",name:"Dutch",short:"NL"},eng:{lang:"eng",name:"English",short:"EN"},fin:{lang:"fin",name:"Finnish",short:"FI"},fre:{lang:"fre",name:"French",short:"FR"},ger:{lang:"ger",name:"German",short:"DE"},gre:{lang:"gre",name:"Greek",short:"EL"},hun:{lang:"hun",name:"Hungarian",short:"HU"},ita:{lang:"ita",name:"Italian",short:"IT"},jpn:{lang:"jpn",name:"Japanese",short:"JP"},kor:{lang:"kor",name:"Korean",short:"KO"},nor:{lang:"nor",name:"Norwegian",short:"NN"},pol:{lang:"pol",name:"Polish",short:"PL"},por:{lang:"por",name:"Portuguese",short:"PT"},rus:{lang:"rus",name:"Russian",short:"RU"},spa:{lang:"spa",name:"Spanish",short:"ES"},swe:{lang:"swe",name:"Swedish",short:"SV"},tur:{lang:"tur",name:"Turkish",short:"TR"}};t.languages=n,t.isValidOCRLanguage=function(e){return"string"==typeof e&&!!n[e.toLowerCase()]}},330:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(36)),o=r(1029),i=r(12),s=n(r(11)),c=()=>{const e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}};t.getOcrCommandCounter=i.singletonGetter(e=>new o.PersistentCounter(Object.assign(Object.assign({},e),{read:()=>(s.default("getOcrCommandCounter - read"),a.default.get("OCR_CONVERSIONS_PER_DAY").then(t=>{return t?(r=c(),n=t.day,r.year!==n.year||r.month!==n.month||r.date!==n.date?e.initial:t.count):e.initial;var r,n})),write:e=>(s.default("getOcrCommandCounter - write",e),a.default.set("OCR_CONVERSIONS_PER_DAY",{day:c(),count:e}).then(()=>{}))})))},34:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});n(r(10)).default.isFirefox();t.default={preinstall:{version:"5.8.8",macroFolder:"/Demo"},urlAfterUpgrade:"https://ui.vision/x/idehelp?help=k_update",urlAfterInstall:"https://ui.vision/x/idehelp?help=k_welcome",urlAfterUninstall:"https://ui.vision/x/idehelp?help=k_why",performanceLimit:{fileCount:1/0},xmodulesLimit:{unregistered:{ocrCommandCount:100,xCommandCount:25,xFileMacroCount:10,proxyExecCount:5,upgradeUrl:"https://ui.vision/x/idehelp?help=k_xupgrade"},free:{ocrCommandCount:250,xCommandCount:1/0,xFileMacroCount:20,proxyExecCount:10,upgradeUrl:"https://ui.vision/x/idehelp?help=k_xupgradepro"},pro:{ocrCommandCount:500,xCommandCount:1/0,xFileMacroCount:1/0,proxyExecCount:1/0,upgradeUrl:"https://ui.vision/x/idehelp?help=k_xupgrade_contactsupport"}},xfile:{minVersionToReadBigFile:"1.0.10"},ocr:{apiList:[{id:"1",key:"kantu_only_53b8",url:"https://apipro1.ocr.space/parse/image"},{id:"2",key:"kantu_only_53b8",url:"https://apipro2.ocr.space/parse/image"},{id:"3",key:"kantu_only_53b8",url:"https://apipro3.ocr.space/parse/image"}],apiTimeout:6e4,singleApiTimeout:3e4,apiHealthyResponseTime:2e4,resetTime:864e5},license:{api:{url:"https://license1.ocr.space/api/status"}},icons:{normal:"logo38.png",inverted:"inverted_logo_38.png"},forceMigrationRemedy:!1,iframePostMessageTimeout:500,ui:{commandItemHeight:35},commandRunner:{sendKeysMaxCharCount:1e3}}},344:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MethodTypeInvocationNames=["get_version","get_desktop_dpi","get_image_info","capture_desktop","search_image","search_desktop","get_max_file_range","get_file_size","read_file_range"]},345:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(97);class a extends n.NativeMessagingHost{constructor(){super(a.HOST_NAME)}}t.KantuCVHost=a,a.HOST_NAME="com.a9t9.kantu.cv"},346:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){const t=new Uint8Array([65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47]),r=new Uint8Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);function n(e,t,n){if(n>4)throw new Error("maxLength should be in range [0, 4].");const a=new Uint8Array(4);for(let o=0;o<n;++o){const n=e.charCodeAt(t+o),i=r[n];if(255===i)return;a[o]=i}return(a[0]<<18)+(a[1]<<12)+(a[2]<<6)+(a[3]<<0)}function a(e,t,r){e[t+0]=r>>16&255,e[t+1]=r>>8&255,e[t+2]=255&r}e.encode=function(e){const r=e.length,n=function(e){let t=e/3*4;return t+=e%3!=0?4:0,t}(r),a=r%3,o=r-a,i=new Uint8Array(n);let s,c=0;for(s=0;s<o;s+=3)i[c+0]=t[(252&e[s])>>2],i[c+1]=t[(3&e[s])<<4|(240&e[s+1])>>4],i[c+2]=t[(15&e[s+1])<<2|(192&e[s+2])>>6],i[c+3]=t[63&e[s+2]],c+=4;switch(s=o,a){case 2:i[c+0]=t[(252&e[s])>>2],i[c+1]=t[(3&e[s])<<4|(240&e[s+1])>>4],i[c+2]=t[(15&e[s+1])<<2],i[c+3]=61,c+=4;break;case 1:i[c+0]=t[(252&e[s])>>2],i[c+1]=t[(3&e[s])<<4],i[c+2]=61,i[c+3]=61,c+=4}return new TextDecoder("ascii").decode(i)},e.decode=function(e){const t=e.length;if(t%4!=0)return;let r=0;t>0&&61==e.charCodeAt(t-1)&&(++r,t>1&&61==e.charCodeAt(t-2)&&++r);const o=-4&t-r,i=new Uint8Array(6*t/8-r);let s,c=0,l=0;for(;c<o;){if(s=n(e,c,4),void 0===s)return;a(i,l,s),c+=4,l+=3}if(r>0){if(s=n(e,c,4-r),void 0===s)return;switch(r){case 1:i[l+0]=s>>16&255,i[l+1]=s>>8&255;break;case 2:i[l+0]=s>>16&255}}return i}}(t.base64||(t.base64={}))},349:function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(350),o=r(181);function i(){}function s(e,t,r){if("function"==typeof t&&(r=t,t=null),!e||"object"!==(void 0===e?"undefined":n(e)))throw new Error("Expected first parameter to be a targetElement. Instead got: "+e);return{targetElement:e,eventProperties:t||{},configCallback:r||i}}function c(e,t,r,n,o,i){t.forEach((function(t){var s=a.createEvent(t,o,n);!function(e,t,r){t&&(t.length<2?r&&t(e):t(e,e.type))}(s,i,t===r),e.dispatchEvent(s)}))}var l=function(){this.lastDragSource=null,this.lastDataTransfer=null,this.pendingActionsQueue=[]};l.prototype._queue=function(e){this.pendingActionsQueue.push(e),1===this.pendingActionsQueue.length&&this._queueExecuteNext()},l.prototype._queueExecuteNext=function(){if(0!==this.pendingActionsQueue.length){var e=this,t=this.pendingActionsQueue[0],r=function(){e.pendingActionsQueue.shift(),e._queueExecuteNext()};0===t.length?(t.call(this),r()):t.call(this,r)}},l.prototype.dragStart=function(e,t,r){var n=s(e,t,r),a=["mousedown","dragstart","drag"],i=new o;return this._queue((function(){c(n.targetElement,a,"drag",i,n.eventProperties,n.configCallback),this.lastDragSource=e,this.lastDataTransfer=i})),this},l.prototype.dragEnter=function(e,t,r){var n=s(e,t,r),a=["mousemove","mouseover","dragenter"];return this._queue((function(){c(n.targetElement,a,"dragenter",this.lastDataTransfer,n.eventProperties,n.configCallback)})),this},l.prototype.dragOver=function(e,t,r){var n=s(e,t,r),a=["mousemove","mouseover","dragover"];return this._queue((function(){c(n.targetElement,a,"drag",this.lastDataTransfer,n.eventProperties,n.configCallback)})),this},l.prototype.dragLeave=function(e,t,r){var n=s(e,t,r),a=["mousemove","mouseover","dragleave"];return this._queue((function(){c(n.targetElement,a,"dragleave",this.lastDataTransfer,n.eventProperties,n.configCallback)})),this},l.prototype.drop=function(e,t,r){var n=s(e,t,r),a=["mousemove","mouseup","drop"],o=["dragend"];return this._queue((function(){c(n.targetElement,a,"drop",this.lastDataTransfer,n.eventProperties,n.configCallback),this.lastDragSource&&c(this.lastDragSource,o,"drop",this.lastDataTransfer,n.eventProperties,n.configCallback)})),this},l.prototype.then=function(e){return this._queue((function(){e.call(this)})),this},l.prototype.delay=function(e){return this._queue((function(t){window.setTimeout(t,e)})),this},e.exports=l},350:function(e,t,r){var n=r(181),a=["drag","dragstart","dragenter","dragover","dragend","drop","dragleave"];function o(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function i(e,t,r){var n;switch(t){case"MouseEvent":(n=document.createEvent("MouseEvent")).initEvent(e,!0,!0);break;default:(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,0)}return r&&o(n,r),n}function s(e,t,r){if(/Firefox/.test(window.navigator.userAgent))return i(e,t,r);try{return function(e,t,r){var n=window[t],a={view:window,bubbles:!0,cancelable:!0};o(a,r);var i=new n(e,a);return o(i,r),i}(e,t,r)}catch(n){return i(e,t,r)}}var c={createEvent:function(e,t,r){var o="CustomEvent";return e.match(/^mouse/)?o="MouseEvent":e.match(/^(drag|drop)/)&&(o="DragEvent"),a.indexOf(e)>-1&&(t.dataTransfer=r||new n),s(e,o,t)}};e.exports=c},357:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(157),a=r(182);function o(e){return Object.assign(Object.assign({},e),{type:e.type===n.ProxyScheme.Socks5?n.FirefoxProxyType.Socks5:e.type})}t.convertToFirefoxProxyInfo=o;class i extends a.BaseProxyManager{constructor(){super(),this.unbind=()=>{},this.isBound=!1}isSupported(){return"undefined"!=typeof browser&&browser.proxy&&browser.proxy.onRequest}isControllable(e){return Promise.resolve(!0)}setProxy(e){return this.bind(),this.proxy=e,this.notifyProxyChange(),Promise.resolve()}reset(){return this.proxy=null,this.notifyProxyChange(),Promise.resolve()}notifyProxyChange(){setTimeout(()=>{this.registry.fire("change",this.proxy)},10)}bind(){if(this.isBound)return;this.isBound=!0;const e=this.onProxyRequest.bind(this);browser.proxy.onRequest.addListener(e,{urls:["<all_urls>"]}),this.unbind=()=>browser.proxy.onRequest.removeListener(e)}onProxyRequest(e){return this.proxy?o(this.proxy):{type:n.FirefoxProxyType.Direct}}}t.ProxyManagerViaListenerAPI=i},358:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(70)),o=n(r(142)),i=r(4),s=r(50),c=r(69),l=r(13),u=r(27),d=r(374);t.backup=function(e){const{backup:t,macroNodes:r,testSuites:n,screenshots:m,csvs:p,visions:h}=e,f=new o.default,g=[];if(t.testCase&&r&&r.length){const t=f.folder(d.ZipFolders.Macros);r.forEach(r=>{const n=u.posix.dirname(r.relativePath),a=u.posix.basename(r.relativePath),o=((e,t)=>{if("."===e)return t;return e.split(u.posix.sep).reduce((e,t)=>e.folder(t),t)})(n,t);g.push(l.getStorageManager().getMacroStorage().read(r.fullPath,"Text").then(t=>{const r=t;o.file(a,s.toJSONString({name:r.name,commands:r.data.commands},{ignoreTargetOptions:!!e.ignoreMacroTargetOptions}))}))})}if(t.testSuite&&n&&n.length){const e=f.folder(d.ZipFolders.TestSuites),t=i.nameFactory();n.forEach(r=>{const n=t(r.name);e.file(`${n}.json`,c.stringifyTestSuite(r))})}if(t.screenshot&&m&&m.length){const e=f.folder(d.ZipFolders.Screenshots),t=l.getStorageManager().getScreenshotStorage();m.forEach(r=>{g.push(t.read(r.fullPath,"ArrayBuffer").then(t=>{e.file(r.name,t,{binary:!0})}))})}if(t.vision&&h&&h.length){const e=f.folder(d.ZipFolders.Visions),t=l.getStorageManager().getVisionStorage();h.forEach(r=>{g.push(t.read(r.fullPath,"ArrayBuffer").then(t=>{e.file(r.name,t,{binary:!0})}))})}if(t.csv&&p&&p.length){const e=f.folder(d.ZipFolders.Csvs),t=l.getStorageManager().getCSVStorage();p.forEach(r=>{g.push(t.read(r.fullPath,"Text").then(t=>e.file(r.name,t)))})}return Promise.all(g).then(()=>{f.generateAsync({type:"blob"}).then((function(e){a.default.saveAs(e,"uivision_backup.zip")}))})}},359:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(12);var a;!function(e){e.GetVersion="getVersion",e.GetDPI="getDPI",e.SetDirectory="setDirectory",e.SaveScreenshot="saveScreenshot"}(a||(a={}));class o{reconnect(){return Promise.resolve(this)}getVersion(){return this.sendMessage(a.GetVersion)}getDpi(){return this.sendMessage(a.GetDPI)}captureDesktop(){return this.sendMessage(a.SaveScreenshot)}changeDirectory(e){return this.sendMessage(a.SaveScreenshot,{current:e})}sendMessage(e,t={}){return new Promise((r,n)=>{chrome.runtime.sendNativeMessage(o.HostName,Object.assign(Object.assign({},t),{command:e}),t=>{if(t&&t.result)r(t[o.FieldNameMapping[e]]);else{let e=t&&t.error;e=e||"Unknown error",n(new Error(e))}})})}}t.NativeScreenCapture=o,o.HostName="com.github.teamdocs.kcmd",o.FieldNameMapping={[a.GetVersion]:"version",[a.GetDPI]:"dpi",[a.SetDirectory]:"directory",[a.SaveScreenshot]:"file"},t.getNativeScreenCapture=n.singletonGetter(()=>new o)},36:function(e,t,r){"use strict";r.r(t);var n=r(10),a=r.n(n),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var i=a.a.storage.local,s={get:function(e){return i.get(e).then((function(t){return t[e]}))},set:function(e,t){return i.set(function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e,t)).then((function(){return!0}))},remove:function(e){return i.remove(e).then((function(){return!0}))},clear:function(){return i.clear().then((function(){return!0}))},addListener:function(e){a.a.storage.onChanged.addListener((function(t,r){var n=Object.keys(t).map((function(e){return o({},t[e],{key:e})}));e(n)}))}};t.default=s},360:function(e,t,r){var n=r(349);function a(e,t,r){return e[t].apply(e,r)}var o={dragStart:function(e,t,r){return a(new n,"dragStart",arguments)},dragEnter:function(e,t,r){return a(new n,"dragEnter",arguments)},dragOver:function(e,t,r){return a(new n,"dragOver",arguments)},dragLeave:function(e,t,r){return a(new n,"dragLeave",arguments)},drop:function(e,t,r){return a(new n,"drop",arguments)},delay:function(e,t,r){return a(new n,"delay",arguments)},triggerDragEvent:function(e,t){var r=function e(t){if(null==t)return"null";if(null==t.parentElement)return"/"+t.tagName;for(var r=t.parentElement.children,n=0,a=0,o=!1,i=0;i<r.length;i++)r[i].tagName!=t.tagName||o?r[i].tagName==t.tagName&&a++:(n++,a++),r[i]==t&&(o=!0);return a>1?e(t.parentElement)+"/"+t.tagName+"["+n+"]":e(t.parentElement)+"/"+t.tagName},n="                                                    function simulateDragDrop(sourceNode, destinationNode){      function createCustomEvent(type) {                               var event = new CustomEvent('CustomEvent');                  event.initCustomEvent(type, true, true, null);               event.dataTransfer = {                                           data: {                                                      },                                                           setData: function(type, val) {                                   this.data[type] = val;                                   },                                                           getData: function(type) {                                        return this.data[type];                                  }                                                        };                                                           return event;                                            }                                                            function dispatchEvent(node, type, event) {                      if (node.dispatchEvent) {                                        return node.dispatchEvent(event);                        }                                                            if (node.fireEvent) {                                            return node.fireEvent('on' + type, event);               }                                                        }                                                            var event = createCustomEvent('dragstart');                  dispatchEvent(sourceNode, 'dragstart', event);                                                                            var dropEvent = createCustomEvent('drop');                   dropEvent.dataTransfer = event.dataTransfer;                 dispatchEvent(destinationNode, 'drop', dropEvent);                                                                        var dragEndEvent = createCustomEvent('dragend');             dragEndEvent.dataTransfer = event.dataTransfer;              dispatchEvent(sourceNode, 'dragend', dragEndEvent);      }                                                            simulateDragDrop(document.evaluate('"+r(e)+"', document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue, document.evaluate('"+r(t)+"', document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue);  ",a=window.document,o=a.createElement("script");o.type="text/javascript",o.text=n,a.body.appendChild(o)},DataTransfer:r(181),DragDropAction:r(349),eventFactory:r(350)};e.exports=o},361:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(512),a=r(513),o=r(325),i=r(12);class s extends n.MigrationService{constructor(){super({storage:{get:e=>a.getMigrationKeyValueData().get(e),set:(e,t)=>a.getMigrationKeyValueData().set(e,t).then(()=>!0),getAll:()=>a.getMigrationKeyValueData().getAll().then(e=>Object.keys(e).map(t=>e[t]))},jobs:[o.getMigrateMacroTestSuiteToBrowserFileSystem()]})}}t.KantuMigrationService=s,t.getKantuMigrationService=i.singletonGetter(()=>new s)},365:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(153),a=r(12);!function(e){e.BrowserModeLastMacroId="browser_mode_last_macro_id",e.XFileModeLastMacroId="xfile_mode_last_macro_id"}(t.MiscKey||(t.MiscKey={}));class o extends n.KeyValueData{getMainKeyAndSubKeys(e){const[t,r]=super.getMainKeyAndSubKeys(e);return[o.STORAGE_KEY,[t].concat(r).filter(e=>e&&e.length)]}}t.MiscData=o,o.STORAGE_KEY="misc_data",t.getMiscData=a.singletonGetter(()=>new o)},374:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Macros="macros",e.TestSuites="testsuites",e.Screenshots="screenshots",e.Csvs="datasources",e.Visions="images"}(t.ZipFolders||(t.ZipFolders={}))},389:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(153),a=r(12);class o extends n.KeyValueData{getAll(){return super.get("")}getMainKeyAndSubKeys(e){const[t,r]=super.getMainKeyAndSubKeys(e);return[o.STORAGE_KEY,[t].concat(r).filter(e=>e&&e.length)]}}t.TestSuiteExtraKeyValueData=o,o.STORAGE_KEY="test_suite_extra",t.getTestSuiteExtraKeyValueData=a.singletonGetter(()=>new o)},390:function(e,t,r){"use strict";r.r(t),r.d(t,"normalizeTestSuite",(function(){return s}));var n=r(4),a=r(12),o=r(92),i={table:o.default.testSuites,list:function(){return o.default.testSuites.toArray()},insert:function(e){if(!e.name)throw new Error("Model TestSuite - insert: missing name");if(!Array.isArray(e.cases))throw new Error("Model TestSuite - insert: cases should an array");return e.updateTime=1*new Date,e.id=Object(n.uid)(),o.default.testSuites.add(e)},bulkInsert:function(e){var t=e.map((function(e){if(!e.name)throw new Error("Model TestSuite - insert: missing name");if(!Array.isArray(e.cases))throw new Error("Model TestSuite - insert: cases should an array");return e.updateTime=1*new Date,e.id=Object(n.uid)(),e}));return o.default.testSuites.bulkAdd(t)},update:function(e,t){return o.default.testSuites.update(e,t)},remove:function(e){return o.default.testSuites.delete(e)}};function s(e){return Object(a.pickIfExist)(["id","name","cases"],e)}t.default=i},393:function(e,t,r){"use strict";r.r(t),r.d(t,"resizeWindow",(function(){return l})),r.d(t,"resizeViewport",(function(){return u})),r.d(t,"resizeViewportOfTab",(function(){return d})),r.d(t,"getWindowSize",(function(){return m})),r.d(t,"getFocusedWindowSize",(function(){return p}));var n=r(10),a=r.n(n),o=r(4),i=r(11),s=r.n(i),c=function(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=o||r<e-r-n;if(s()("calcOffset",e,r,n,a,o),i)return r;if(!i){return n+r-a}};function l(e,t){var r=screen.availWidth,n=screen.availHeight,o=screen.availLeft,i=screen.availTop;return a.a.windows.get(e).then((function(s){var l=s.left,u=s.top,d=s.width,m=s.height;return a.a.windows.update(e,t).then((function(s){var p=c(r,o,l,d,s.width),h=c(n,i,u,m,s.height,!0);a.a.windows.update(e,{left:p,top:h});var f={width:s.width,height:s.height};return{actual:f,desired:t,diff:["width","height"].filter((function(e){return f[e]!==t[e]}))}}))}))}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=2;return s()("resizeViewport, ROUND",r),m(e).then((function(a){h(a);var i=a.window.width-a.viewport.width,c=a.window.height-a.viewport.height,d={width:i+t.width,height:c+t.height};return s()("size set to",d),l(e,d).then((function(){return m(e)})).then((function(a){h(a);var i={actual:a.viewport,desired:t,diff:["width","height"].filter((function(e){return a.viewport[e]!==t[e]}))};return 0===i.diff.length||r>=n?i:Object(o.delay)((function(){}),0).then((function(){return u(e,t,r+1)}))}))}))}function d(e,t){return a.a.tabs.get(e).then((function(e){return u(e.windowId,t)}))}function m(e){return a.a.windows.get(e,{populate:!0}).then((function(e){var t=e.tabs.find((function(e){return e.active}));return{window:{width:e.width,height:e.height,left:e.left,top:e.top},viewport:{width:t.width,height:t.height}}}))}function p(){return a.a.windows.getLastFocused().then((function(e){return m(e.id)}))}function h(e){s()(e.window,e.viewport),s()("dx = ",e.window.width-e.viewport.width),s()("dy = ",e.window.height-e.viewport.height)}},402:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BeforeRun="before_run",e.BeforeResume="before_resume",e.AfterReturn="after_return"}(t.CallStackEvent||(t.CallStackEvent={}))},404:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Counter=class{constructor(e={}){this.n=0;const{initial:t,getMax:r,onMax:n}=e;if("function"!=typeof r)throw new Error("'getMax' function is required");if("function"!=typeof n)throw new Error("onMax callback is required");this.initial=t||0,this.getMax=r,this.onMax=n,this.reset()}reset(){this.n=this.initial}get(){return this.n}getMaximum(){return this.getMax()}check(){const e=this.getMax();return!(this.n+1>e)||(this.onMax(this.n,e,this.initial),!1)}inc(){const e=this.getMax();return this.n<e?(this.n+=1,!0):(this.onMax(this.n,e,this.initial),!1)}}},41:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(117),i=n(r(1088)),s=r(12),c=r(13),l=r(12),u=r(187),d=n(r(11)),m=r(16),p=r(23),h=r(137),f=r(389),g=r(390),v=r(4),b=r(50),y=r(62),w=r(365),E=r(17),x=n(r(99)),S=n(r(70)),C=r(43),T=n(r(142)),_=n(r(34)),O=r(30);function k(e){const{entryPath:t,isDirectory:r,getNewFilePath:n}=e,a=c.getStorageManager().getMacroStorage(),o=a.entryPath(t,r);return r?a.listR(o).then(e=>{const t=e.map(e=>s.flatternTree(e));return s.flatten(t).map(e=>e.fullPath).reduce((e,t)=>(e[t]=n(t),e),{})}):Promise.resolve({[o]:n(o)})}function P(e){return k(e).then(r=>Promise.resolve(e.run()).then(()=>s.delay(()=>{},1e3)).then(()=>{e.dispatch(t.Actions.updateMacroIdsInTestSuites(r))}))}function I(e){const{dispatch:r,getState:n,fullPath:a,message:o,switchToIt:i=!0}=e;return s.until("node shows up",()=>{const e=n(),{macroFolderStructure:t}=n().editor,r=p.getMacroFileNodeList(e),o=s.flatten(t.map(s.flatternTree)).find(e=>e.fullPath===a),i=r.find(e=>e.fullPath===a);return{pass:!!o&&!!i,result:o}},100,1e4).then(()=>{i&&r(m.editTestCase(a)),r(t.Actions.ensureTreeNodeUnfoldedForCurrentMacroNode())},e=>{d.default.error(e),M({dispatch:r,getState:n,message:o})})}function M(e){const{dispatch:t,getState:r,message:n}=e,{config:a}=r(),{storageMode:i,xmodulesStatus:s="unregistered"}=a;if(i!==c.StorageStrategyType.XFile)return;if(O.getLicenseService().isProLicense()||O.getLicenseService().isPlayerLicense())return;const l=(()=>{if(O.getLicenseService().hasNoLicense())return`${O.getLicenseService().getMaxXFileMacros()} macro/folder limit in free version`;if(O.getLicenseService().isPersonalLicense())return`${O.getLicenseService().getMaxXFileMacros()} macro/folder limit in PRO1 version`;throw new Error("Unknown cases")})();o.Modal.warn({title:"Please upgrade your XModule plan",content:`${n}, but not displayed due to ${l}`,okText:"OK",onOk:()=>{t(m.updateUI({showSettings:!0,settingsTab:"register"}))}})}function A(e,t){return{type:e,data:t}}function D(e){return e}t.getMacroIdChanges=k,t.withMacroIdChanges=P,t.checkNodeShowUp=I,t.fileFolderNotShown=M,t.ActionFactories={setNoDisplayInPlay:e=>t=>A(e,t),setFrom:e=>t=>(r,n)=>{const{from:a}=n();t===y.RunBy.Manual&&a!==y.RunBy.Manual&&c.getStorageManager().emit(c.StorageManagerEvent.ForceReload),r(A(e,t))},setIsLoadingMacros:e=>t=>A(e,t),setCurrentMacro:e=>t=>A(e,t),copyCurrentCommand:e=>()=>(e,t)=>{const{selectedIndex:r}=t().editor.editing.meta;-1!==r&&e(m.copyCommand(r))},cutCurrentCommand:e=>()=>(e,t)=>{const{selectedIndex:r}=t().editor.editing.meta;-1!==r&&e(m.cutCommand(r))},pasteAtCurrentCommand:e=>()=>(e,t)=>{const{selectedIndex:r}=t().editor.editing.meta;-1!==r&&e(m.pasteCommand(r))},selectNextCommand:e=>()=>(e,t)=>{const{meta:r,commands:n}=t().editor.editing,{selectedIndex:a}=r;a<n.length-1&&e(m.selectCommand(a+1,!0))},selectPrevCommand:e=>()=>(e,t)=>{const{meta:r,commands:n}=t().editor.editing,{selectedIndex:a}=r;a>0&&e(m.selectCommand(a-1,!0))},moveCommands:e=>(t,r)=>A(e,{startIndex:t,endIndex:r}),setIsDraggingCommand:e=>t=>A(e,t),setMacroFolderStructure:e=>t=>A(e,t),setTestSuiteFolderStructure:e=>t=>A(e,t),macroCreateFolder:e=>e=>(t,r)=>{const n=c.getStorageManager().getMacroStorage(),a=n.getPathLib(),i=n.dirPath(e.dir);return u.prompt({width:400,title:"Create folder as..",message:"",value:"",placeholder:"Folder name",selectionStart:0,selectionEnd:0,okText:"Create",cancelText:"Cancel",onCancel:()=>Promise.resolve(!0),onOk:e=>{const s=a.join(i,v.sanitizeFileName(e));return n.directoryExists(s).then(n=>{if(n){const t=`'${e}' already exists`;throw o.message.error(t),new Error(t)}return c.getStorageManager().getMacroStorage().createDirectory(s).then(()=>(o.message.success(`Created folder '${e}'`),I({getState:r,dispatch:t,fullPath:s,switchToIt:!1,message:"Folder created"}),!0),e=>{d.default.error(e);const t="Failed to create folder: "+e.message;throw o.message.error(t),new Error(t)})})}})},macroDeleteFolder:e=>e=>(t,r)=>{const{dir:n}=e,i=c.getStorageManager().getMacroStorage();if(confirm(`Sure to delete ${n} and all its content?`))return k({entryPath:i.dirPath(n),isDirectory:!0,getNewFilePath:e=>e}).then(e=>{const t=r(),n=p.getTestSuitesWithAllInfo(t),a=Object.keys(e),o=[];if(a.forEach(e=>{n.forEach(t=>{t.cases.find(t=>t.testCaseId===e)&&o.push({macroPath:i.relativePath(e),testSuiteName:t.name})})}),o.length>0){const e=3,t=o.slice(0,e).map(e=>`"${e.macroPath}" is still used in test suite "${e.testSuiteName}"`).join("\n"),r=o.length<=e?"":`\n...\n(And ${o.length-1} more macro references)`;throw new Error(t+r)}}).then(()=>i.remove(n,!0)).catch(e=>{o.Modal.warn({title:"Failed to delete folder",content:e.message.split("\n").map(e=>a.default.createElement("li",null,e)),okText:"OK"})})},macroMoveEntry:e=>e=>(t,r)=>{const n=c.getStorageManager().getMacroStorage(),a=n.getPathLib();return P({dispatch:t,getNewFilePath:t=>{const r=a.basename(e.entryId),o=n.dirPath(e.entryId),i=a.relative(t,o);return a.join(e.dirId,r,i)},run:()=>n.move(e.entryId,e.dirId,e.isSourceDirectory,!0),entryPath:e.entryId,isDirectory:e.isSourceDirectory}).catch(e=>{o.message.error(e.message)})},macroRenameFolder:e=>e=>(t,r)=>{const{dir:n}=e,a=c.getStorageManager().getMacroStorage(),i=a.getPathLib(),s=a.dirPath(n),l=i.basename(s),p=i.dirname(s),h=r().editor.editing.meta.src.id,f=0===h.indexOf(s+i.sep);return u.prompt({width:400,title:"Rename the folder as..",message:"",value:l,placeholder:"Folder name",selectionStart:0,selectionEnd:l.length,okText:"Rename",cancelText:"Cancel",onCancel:()=>Promise.resolve(!0),onOk:e=>{const n=i.join(p,v.sanitizeFileName(e));return a.directoryExists(n).then(c=>{if(c){const t=`'${e}' already exists`;throw o.message.error(t),new Error(t)}return P({dispatch:t,isDirectory:!0,entryPath:s,getNewFilePath:e=>{const t=i.relative(e,s);return i.join(n,t)},run:()=>a.moveDirectory(s,n).then(()=>{if(o.message.success(`Renamed to '${e}'`),I({getState:r,dispatch:t,fullPath:n,switchToIt:!1,message:"Folder renamed"}),f){const e=h.replace(s,n);t(m.editTestCase(e))}},e=>{d.default.error(e);const t="Failed to rename: "+e.message;throw o.message.error(t),new Error(t)})}).then(()=>!0)})}})},macroCreateFile:e=>e=>(t,r)=>{const{dir:n}=e,a=c.getStorageManager().getMacroStorage(),i=a.getPathLib();return u.prompt({width:400,title:"Create new macro as..",message:"",value:"",placeholder:"Macro name",selectionStart:0,selectionEnd:0,okText:"Confirm",cancelText:"Cancel",onCancel:()=>Promise.resolve(!0),onOk:e=>{const s=i.join(n,`${v.sanitizeFileName(e)}.json`),c=a.filePath(s);return a.fileExists(c).then(n=>{if(n){const t=`'${e}' already exists`;throw o.message.error(t),new Error(t)}return a.write(s,{name:e,data:{commands:[]}}).then(()=>(o.message.success(`Created macro '${e}'`),I({getState:r,dispatch:t,fullPath:c,message:"New macro created"}),!0),e=>{d.default.error(e);const t="Failed to create macro: "+e.message;throw o.message.error(t),new Error(t)})})}})},ensureTreeNodeUnfoldedForCurrentMacroNode:e=>e=>{const t=Object.assign({scrollIntoView:!0},e||{});return(e,r)=>{const n=r(),a=p.getCurrentMacroId(n),o=p.getMacrosExtra(n),c=p.getMacroFileNodeData(n),u=s.ancestorsInNodesList(e=>e.id===a,c),d=()=>{t.scrollIntoView&&setTimeout(()=>{const e=s.normalizeHtmlId(a),t=document.getElementById(e);t&&i.default(t,{behavior:"smooth",block:"nearest"})},100)};if(!u||!u.length)return d();const h=u.map(e=>s.safeUpdateIn([e.id],e=>Object.assign(Object.assign({},e||{}),{folded:!1}))),f=l.compose(...h)(o);e(m.setMacrosExtra(f,{shouldPersist:!0})),d()}},updateMacroIdsInTestSuites:e=>e=>(r,n)=>{const a=n(),o=p.getTestSuitesWithAllInfo(a);Object.keys(e).forEach(n=>{const a=e[n];o.forEach(e=>{const o=e.cases.reduce((e,t,r)=>(t.testCaseId===n&&e.push(r),e),[]);if(0===o.length)return;const i=l.compose(...o.map(e=>s.setIn([e,"testCaseId"],a)))(e.cases);r(t.Actions.updateTestSuite(e.id,{cases:i}))})})},updateTestSuite:e=>(t,r)=>(n,a)=>{const o=a(),i=p.getTestSuitesWithAllInfo(o),s=i.find(e=>e.id===t);if(!s)return;const l="function"==typeof r?r(s):r,u=l.name&&s.name!==l.name;if(u){if(!!i.find(e=>e.id!==t&&e.name===l.name))return Promise.reject(new Error(`The test suite name '${l.name}' already exists!`))}const d=Object.assign(Object.assign({},s),l),m=c.getStorageManager().getTestSuiteStorage(),h=u?l.name:s.name,v=u?m.rename(s.name,l.name):Promise.resolve(),b=u&&c.getStorageManager().isXFileMode()?f.getTestSuiteExtraKeyValueData().set(t,{fold:!1,playStatus:{}}):f.getTestSuiteExtraKeyValueData().set(t,{fold:d.fold,playStatus:d.playStatus||{}});return n({type:e,data:{id:t,updated:g.normalizeTestSuite(d)}}),u&&c.getStorageManager().isXFileMode()?n({type:"UPDATE_TEST_SUITE_STATUS",data:{id:t,extra:{fold:!1,playStatus:{}}}}):n({type:"UPDATE_TEST_SUITE_STATUS",data:{id:t,extra:{fold:d.fold,playStatus:d.playStatus||{}}}}),Promise.all([v,b]).then(()=>m.write(h,d))},renameTestCase:e=>(t,r)=>(n,a)=>{const o=c.getStorageManager().getMacroStorage(),i=o.getPathLib(),s=a().editor.editing.meta.src.id,l=o.filePath(i.join(i.dirname(r),v.sanitizeFileName(t)));return o.fileExists(r).then(e=>{if(!e)throw new Error(`No macro found with id '${r}'!`);return o.fileExists(l).then(e=>{if(e)throw new Error("The macro name already exists!")})}).then(()=>(c.getStorageManager().isXFileMode()&&n(m.updateMacroPlayStatus(r,null)),P({dispatch:n,entryPath:r,isDirectory:!1,getNewFilePath:e=>l,run:()=>c.getStorageManager().getMacroStorage().rename(r,l).then(()=>{s===r&&n({type:e,data:t,post:m.saveEditing})})}).then(()=>{s===r&&n(m.editTestCase(l)),I({getState:a,dispatch:n,fullPath:l,switchToIt:!1,message:"Macro renamed"})})))},duplicateTestCase:e=>e=>(t,r)=>{const n=c.getStorageManager().getMacroStorage(),a=n.getPathLib(),i=a.dirname(e.fullPath),s=e=>a.join(i,`${e}.json`);return v.uniqueName(e.name,{generate:(e,t=1)=>{const r=/-(\d+)$/;return e.match(r)?e.replace(r,(e,r)=>`-${parseInt(r,10)+t}`):`${e}-${t}`},check:e=>n.fileExists(s(e)).then(e=>!e)}).then(a=>u.prompt({width:400,title:"Duplicate macro as..",message:"",value:a,placeholder:"Macro name",selectionStart:0,selectionEnd:a.length,okText:"Duplicate",cancelText:"Cancel",onCancel:()=>Promise.resolve(!0),onOk:a=>{const i=n.filePath(s(v.sanitizeFileName(a)));return n.fileExists(i).then(s=>{if(s){const e=`'${a}' already exists`;throw o.message.error(e),new Error(e)}return n.copy(e.fullPath,i,!1,!1).then(()=>(o.message.success(`Successfully duplicated as '${a}'`),I({getState:r,dispatch:t,fullPath:i,message:"Macro duplicated"}),!0),e=>{d.default.error(e);const t="Failed to duplicate macro: "+e.message;throw o.message.error(t),new Error(t)})})}}))},duplicateVisionImage:e=>e=>(t,r)=>{const n=c.getStorageManager().getVisionStorage(),a=n.getPathLib(),i=a.dirname(e),s=e=>a.join(i,e);return v.uniqueName(e,{generate:(e,t=1)=>{const r=/-(\d+)$/;return e.match(r)?e.replace(r,(e,r)=>`-${parseInt(r,10)+t}`):`${e}-${t}`},check:e=>n.fileExists(s(e)).then(e=>!e)}).then(r=>u.prompt({width:400,title:"Duplicate vision image as..",message:"",value:r,placeholder:"Macro name",selectionStart:0,selectionEnd:r.length,okText:"Duplicate",cancelText:"Cancel",onCancel:()=>Promise.resolve(!0),onOk:r=>{const a=n.filePath(s(v.sanitizeFileName(r)));return n.fileExists(a).then(i=>{if(i){const e=`'${r}' already exists`;throw o.message.error(e),new Error(e)}return n.copy(e,a,!1,!1).then(()=>(o.message.success(`Successfully duplicated as '${r}'`),t(m.listVisions()),!0),e=>{d.default.error(e);const t="Failed to duplicate vision image: "+e.message;throw o.message.error(t),new Error(t)})})}}))},selectInitialMacro:e=>e=>(t,r)=>{const n=(()=>{switch(e){case c.StorageStrategyType.Browser:return w.MiscKey.BrowserModeLastMacroId;case c.StorageStrategyType.XFile:return w.MiscKey.XFileModeLastMacroId;default:throw new Error(`Invalid mode: ${e}`)}})();return w.getMiscData().get(n).then(e=>{const t=r(),a=e?p.findMacroNodeWithCaseInsensitiveFullPath(t,e):null;if(d.default("selectInitialMacro",n,e,a,t),a)return e;const o=p.getMacroFolderNodeList(t),i=s.findNodeInForest(e=>e.isFile,o);return i?i.fullPath:null}).then(e=>{t(e?m.editTestCase(e):m.editNewTestCase())})},editMacroByOffset:e=>e=>(r,n)=>{const a=n();if(a.ui.isSaving)return;const o=p.getFilteredMacroFileNodeData(a),i=p.getCurrentMacroId(a);if(i===E.UNTITLED_ID)return;const c=s.nodeByOffset({offset:e,tree:o,isTargetQualified:e=>e.id===i,isCandidateQualified:e=>e.type===h.FileNodeType.File});return c?r(m.editTestCase(c.id)).then(()=>{r(t.Actions.ensureTreeNodeUnfoldedForCurrentMacroNode({scrollIntoView:!0}))}):void 0},setMacroQuery:e=>t=>A(e,t),setIndexToInsertRecorded:e=>t=>A(e,t),toggleRecorderSkipOpen:e=>t=>A(e,t),scrollToCommandAtIndex:e=>e=>()=>{const t=document.querySelector(".table-wrapper"),r=_.default.ui.commandItemHeight;if(!t)return;const n=t.clientHeight,a=t.scrollTop,o=r*(e+3)>a+n;r*e<a?t.scrollTop=r*e:o&&(t.scrollTop=r*(e+3)-n)},gotoLineInMacro:e=>(e,r)=>(n,a)=>{const o=a(),i=p.getCurrentMacroId(o);(e===i?()=>Promise.resolve(!0):()=>x.default({dispatch:n,getState:a}).saveOrNot({cancelText:"Cancel"}))().then(a=>{if(a)return Promise.resolve(n(m.editTestCase(e))).then(()=>{n(m.selectCommand(r,!0)),n(t.Actions.scrollToCommandAtIndex(r))})}).catch(e=>{d.default.warn(e)})},downloadMacroAsJson:e=>e=>(r,n)=>c.getStorageManager().getMacroStorage().read(e,"Text").then(a=>{const o=a,i=()=>{const e=b.toJSONString({name:o.name,commands:o.data.commands},{ignoreTargetOptions:p.getShouldSaveAlternativeLocators(n())}),t=new Blob([e],{type:"text/plain;charset=utf-8"});S.default.saveAs(t,`${o.name}.json`,!0)};return(()=>{const e=o.data.commands.filter(e=>{var t;return!!C.canCommandReadImage(e.cmd)&&(null===(t=C.parseImageTarget(e.target))||void 0===t?void 0:t.fileName)}),t=o.data.commands.filter(e=>C.canCommandReadCsv(e.cmd)),r=o.data.commands.filter(e=>C.canCommandRunMacro(e.cmd));return 0!==e.length||0!==t.length||0!==r.length})()?u.prompt({width:400,title:"Export as zip instead?",message:"This macro contains images/csv.\nDo you want to use the ZIP export option instead?",noInput:!0,closable:!1,okText:"ZIP",cancelText:"JSON",onCancel:()=>(i(),Promise.resolve(!0)),onOk:()=>(r(t.Actions.downloadMacroAsZip(e)),Promise.resolve(!0))}).then(()=>{}):i()}),downloadMacroAsHTML:e=>e=>(t,r)=>c.getStorageManager().getMacroStorage().read(e,"Text").then(e=>{const t=e,r=b.toHtml({name:t.name,commands:t.data.commands}),n=new Blob([r],{type:"text/plain;charset=utf-8"});S.default.saveAs(n,`${t.name}.html`,!0)}),downloadMacroAsZip:e=>e=>(t,r)=>{const n=new T.default,a=e=>t(m.addLog("warning",e)),o={},i={},l={},u=(e,t)=>{const d=c.getStorageManager().getMacroStorage(),m=d.getPathLib();return d.read(e,"Text").then(h=>{const f=h,g=s.clone(f),v=f.data.commands.filter(e=>C.canCommandReadImage(e.cmd)),y=f.data.commands.filter(e=>C.canCommandReadCsv(e.cmd)),w=[];f.data.commands.forEach((e,t)=>{C.canCommandRunMacro(e.cmd)&&(w.push(e),g.data.commands[t].target=m.basename(e.target))}),Promise.all([...v.map(e=>{var t;const r=null===(t=C.parseImageTarget(e.target))||void 0===t?void 0:t.fileName;return!r||o[r]?Promise.resolve():(o[r]=!0,c.getStorageManager().getVisionStorage().read(r,"ArrayBuffer").then(e=>{n.file(r,e,{binary:!0})}).catch(e=>{a(`Failed to add ${r} into zip: ${e.message}`)}))}),...y.map(e=>{const t=e.target;return!t||i[t]?Promise.resolve():(i[t]=!0,c.getStorageManager().getCSVStorage().read(t,"Text").then(e=>{n.file(t,e)}).catch(e=>{a(`Failed to add ${t} into zip: ${e.message}`)}))}),...w.map(t=>{const n=s.resolvePath(d.getPathLib(),d.relativePath(e),t.target),a=p.findMacroNodeWithCaseInsensitiveRelativePath(r(),n),o=a?a.fullPath:n;return l[o]?Promise.resolve():u(o,!0)})]).then(()=>{if(n.file(g.name+".json",b.toJSONString({name:g.name,commands:g.data.commands})),!t)return n.generateAsync({type:"blob"}).then(e=>S.default.saveAs(e,`${g.name}.zip`))})})};return u(e).catch(e=>{a(`Failed to save zip file: ${e.message}`)})},readFilesAndImportTestCases:e=>e=>{const{type:t,process:r,folder:n,files:a}=e;return(e,i)=>{const l=Array.from(a);if(!l||!l.length)return;const u=(e,t,r,n)=>{const a="text"===r?new Blob([n]):n;return e.fileExists(t).then(r=>r?{error:`${t} already exists`}:e.write(t,a).then(()=>({fileName:t})).catch(e=>({error:`Failed to save ${t}: ${e.message}`})))};Promise.all(l.map(e=>new Promise((n,a)=>{const o=new FileReader;switch(o.onload=t=>{var a;const o=null===(a=t.target)||void 0===a?void 0:a.result;new Promise(t=>t(r(o,e.name,e))).then(t=>{if(!t||!t.macros.length)return n({err:new Error("Failed to parse macro"),fileName:e.name});const{macros:r,images:a=[],csvs:o=[]}=t;n({data:{macros:r,images:a,csvs:o}})}).catch(t=>{n({err:t,fileName:e.name})})},t){case"text":return o.readAsText(e);case"data_url":return o.readAsDataURL(e);case"binary_string":return o.readAsBinaryString(e);case"array_buffer":return o.readAsArrayBuffer(e)}}))).then(t=>{const r=t.filter(e=>e.data),a=t.filter(e=>e.err);return Promise.all(r.map(e=>(e=>Promise.all([Promise.all(e.csvs.map(e=>u(c.getStorageManager().getCSVStorage(),e.fileName,"text",e.content))),Promise.all(e.images.map(e=>u(c.getStorageManager().getVisionStorage(),e.fileName,"blob",e.content)))]).then(t=>{const[r,n]=t;return Promise.resolve({macros:e.macros,csvImported:r.filter(e=>e.fileName).map(e=>e.fileName),pngImported:n.filter(e=>e.fileName).map(e=>e.fileName),errors:[...r.filter(e=>e.error).map(e=>e.error),...n.filter(e=>e.error).map(e=>e.error)]})}))(e.data))).then(t=>e(m.addTestCases({folder:n,macros:s.flatten(r.map(e=>e.data.macros))})).then(({passCount:r,failCount:n,failTcs:i})=>{o.message.info([`${r} macro${r>1?"s":""} imported!`,`${a.length+n} macro${a.length+n>1?"s":""} failed!`].join(", "),3),a.forEach(t=>{e(m.addLog("error",`in parsing ${t.fileName}: ${t.err.message}`))}),i.forEach(t=>{e(m.addLog("error",`duplicated macro name: ${t.name}`,{noStack:!0}))});const c=s.flatten(t.map(e=>e.csvImported)),l=s.flatten(t.map(e=>e.pngImported)),u=s.flatten(t.map(e=>e.errors)),d=s.flatten(t.map(e=>e.macros)).filter(e=>!i.find(t=>t.name==e.name)).map(e=>e.name);d.length>0&&e(m.addLog("info",`${d.length} ${d.length>1?"macros":"macro"} imported:\n${d.join("\n")}`)),c.length>0&&(e(m.addLog("info",`${c.length} CSV imported:\n${c.join("\n")}`)),e(m.listCSV())),l.length>0&&(e(m.addLog("info",`${l.length} PNG imported:\n${l.join("\n")}`)),e(m.listVisions())),u.length>0&&e(m.addLog("error",`${u.length} ${u.length>1?"errors":"error"} in importing csv/png:\n${u.join("\n")}`))})).catch(t=>{e(m.addLog("error",t.message,{noStack:!0}))})})}},importMacroHtml:e=>(e,r)=>(n,a)=>{n(t.Actions.readFilesAndImportTestCases({folder:r,files:e,process:(e,t)=>({macros:[b.fromHtml(e)],csvs:[],images:[]}),type:"text"}))},importMacroJsonOrZipFiles:e=>(e,r)=>(n,a)=>{n(t.Actions.readFilesAndImportTestCases({files:e,folder:r,process:(e,t,r)=>{if(/.json$/i.test(t)){const r=v.arrayBufferToString(e);return Promise.resolve({macros:[b.fromJSONString(r,t)],csvs:[],images:[]})}return T.default.loadAsync(e).then(e=>{const t=[],r=[],n=[];if(e.forEach((e,a)=>{switch(s.getExtName(e).toLowerCase()){case".csv":r.push(a.async("text").then(t=>({content:t,fileName:e})));break;case".png":n.push(a.async("blob").then(t=>({content:t,fileName:e})));break;case".json":t.push(a.async("text").then(t=>({content:t,fileName:e})))}}),0===t.length)throw new Error("No json file found in zip");return Promise.all([Promise.all(t),Promise.all(r),Promise.all(n)]).then(e=>({macros:e[0].map(e=>b.fromJSONString(e.content,e.fileName)),csvs:e[1],images:e[2]}))})},type:"array_buffer"}))}},t.ActionTypes=s.objMap((e,t)=>t,t.ActionFactories),t.Actions=s.objMap((e,r,n)=>e(t.ActionTypes[r]),t.ActionFactories),t.createAction=A,t.createThunkAction=D},42:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Browser="browser",e.Desktop="desktop",e.DesktopScreenCapture="desktop_screen_capture"}(n=t.ComputerVisionType||(t.ComputerVisionType={})),t.isCVTypeForDesktop=function(e){return e===n.Desktop||e===n.DesktopScreenCapture}},43:function(e,t,r){"use strict";function n(e){switch(e){case"echo":case"open":case"pause":case"waitForPageToLoad":case"assertAlert":case"assertConfirmation":case"assertPrompt":case"answerOnNextPrompt":case"store":case"storeTitle":case"assertTitle":case"verifyTitle":case"selectWindow":case"captureScreenshot":case"captureDesktopScreenshot":case"refresh":case"deleteAllCookies":case"label":case"gotoLabel":case"csvRead":case"csvReadArray":case"csvSave":case"csvSaveArray":case"captureEntirePageScreenshot":case"onDownload":case"throwError":case"comment":case"onError":case"sourceSearch":case"sourceExtract":case"localStorageExport":case"visionLimitSearchArea":case"visionLimitSearchAreaRelative":case"visualGetPixelColor":case"bringBrowserToForeground":case"bringIDEandBrowserToBackground":case"setWindowSize":case"prompt":case"XRun":case"XRunAndWait":case"XDesktopAutomation":case"setProxy":case"run":case"executeScript":case"executeScript_Sandbox":case"do":case"repeatIf":case"else":case"elseif":case"end":case"if_v2":case"while_v2":case"gotoIf_v2":case"times":case"forEach":return!1;default:return!0}}Object.defineProperty(t,"__esModule",{value:!0}),t.availableCommands=(()=>{const e=["open","click","clickAndWait","select","selectAndWait","addSelection","removeSelection","type","pause","waitForPageToLoad","selectFrame","assertAlert","assertConfirmation","assertPrompt","answerOnNextPrompt","store","storeText","storeTitle","storeAttribute","storeXpathCount","assertText","assertTitle","clickAt","echo","mouseOver","verifyText","verifyTitle","sendKeys","dragAndDropToObject","selectWindow","captureScreenshot","captureDesktopScreenshot","refresh","assert","assertElementPresent","assertElementNotPresent","assertEditable","assertNotEditable","verify","verifyElementPresent","verifyElementNotPresent","verifyEditable","verifyNotEditable","deleteAllCookies","label","gotoLabel","csvRead","csvReadArray","csvSave","csvSaveArray","storeValue","assertValue","verifyValue","storeChecked","captureEntirePageScreenshot","onDownload","throwError","comment","waitForElementVisible","waitForElementNotVisible","waitForElementPresent","waitForElementNotPresent","onError","sourceSearch","sourceExtract","storeImage","localStorageExport","visionLimitSearchArea","visionLimitSearchAreaRelative","visualSearch","visualVerify","visualAssert","visualGetPixelColor","editContent","bringBrowserToForeground","bringIDEandBrowserToBackground","setWindowSize","prompt","XRun","XRunAndWait","XClick","XClickRelative","XType","XMove","XMoveRelative","XMouseWheel","XDesktopAutomation","OCRSearch","OCRExtract","OCRExtractRelative","setProxy","run","executeScript","executeScript_Sandbox","check","uncheck","assertChecked","assertNotChecked","verifyChecked","verifyNotChecked","do","repeatIf","else","elseif","end","if_v2","while_v2","gotoIf_v2","times","forEach","break","continue"];return e.sort((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:1),e})(),t.normalizeCommandName=function(e){if(!e)return"";const r=e.toLowerCase(),n=t.availableCommands.map(e=>e.toLowerCase()).findIndex(e=>e===r);return-1===n?e:t.availableCommands[n]},t.commandText=function(e){switch(e){case"if":case"while":case"gotoIf":return e+"_v1_deprecated";case"storeEval":case"endif":case"endwhile":case"resize":return e+"_deprecated";default:return e}},t.isValidCmd=function(e){return-1!==t.availableCommands.indexOf(e)},t.isExtensionResourceOnlyCommand=function(e){switch(e){case"if":case"while":case"gotoIf":case"if_v2":case"while_v2":case"gotoIf_v2":case"executeScript_Sandbox":case"run":case"store":case"echo":case"prompt":case"throwError":case"pause":case"localStorageExport":return!0;default:return!1}},t.canCommandReadImage=function(e){switch(e){case"visualSearch":case"visualVerify":case"visualAssert":case"XClick":case"XClickRelative":case"XMove":case"XMoveRelative":case"OCRExtract":case"OCRExtractRelative":return!0;default:return!1}},t.canCommandReadCsv=function(e){switch(e){case"csvRead":case"csvReadArray":return!0;default:return!1}},t.canCommandRunMacro=function(e){switch(e){case"run":return!0;default:return!1}},t.doesCommandSupportTargetOptions=function(e){switch(e){case"click":case"clickAndWait":case"select":case"selectAndWait":case"type":case"mouseOver":case"verifyText":case"sendKeys":case"dragAndDropToObject":case"assertElementPresent":case"assertEditable":case"assertNotEditable":case"verifyElementPresent":case"verifyEditable":case"verifyNotEditable":case"storeValue":case"assertValue":case"verifyValue":case"storeChecked":case"waitForElementVisible":case"waitForElementPresent":case"XClick":case"XClickRelative":case"XMove":case"XMoveRelative":case"check":case"uncheck":case"assertChecked":case"assertNotChecked":case"verifyChecked":case"verifyNotChecked":return!0;default:return!1}},t.canCommandFind=n,t.canCommandSelect=function(e){const t=n(e);if(t)return t;switch(e){case"visualGetPixelColor":return!0;default:return!1}},t.indentCreatedByCommand=function(e){switch(e){case"if":case"if_v2":case"while":case"while_v2":case"do":case"times":case"forEach":return{selfIndent:0,nextIndent:1};case"else":case"elseif":return{selfIndent:-1,nextIndent:1};case"end":case"endif":case"endwhile":case"repeatIf":return{selfIndent:-1,nextIndent:0};default:return{selfIndent:0,nextIndent:0}}},t.parseImageTarget=function(e){if(!e||!e.length)return null;const t=e.match(/^([^@#]+?\.png)(?:@([\d.]+))?(?:#(\d+))?(?:\[([^\]]+)\])?$/);return t?{fileName:t[1],confidence:t[2]?parseFloat(t[2]):void 0,index:t[3]?parseInt(t[3])-1:void 0,imageUrl:t[4]}:null}},431:function(e,t,r){var n={"./af":202,"./af.js":202,"./ar":203,"./ar-dz":204,"./ar-dz.js":204,"./ar-kw":205,"./ar-kw.js":205,"./ar-ly":206,"./ar-ly.js":206,"./ar-ma":207,"./ar-ma.js":207,"./ar-sa":208,"./ar-sa.js":208,"./ar-tn":209,"./ar-tn.js":209,"./ar.js":203,"./az":210,"./az.js":210,"./be":211,"./be.js":211,"./bg":212,"./bg.js":212,"./bm":213,"./bm.js":213,"./bn":214,"./bn.js":214,"./bo":215,"./bo.js":215,"./br":216,"./br.js":216,"./bs":217,"./bs.js":217,"./ca":218,"./ca.js":218,"./cs":219,"./cs.js":219,"./cv":220,"./cv.js":220,"./cy":221,"./cy.js":221,"./da":222,"./da.js":222,"./de":223,"./de-at":224,"./de-at.js":224,"./de-ch":225,"./de-ch.js":225,"./de.js":223,"./dv":226,"./dv.js":226,"./el":227,"./el.js":227,"./en-au":228,"./en-au.js":228,"./en-ca":229,"./en-ca.js":229,"./en-gb":230,"./en-gb.js":230,"./en-ie":231,"./en-ie.js":231,"./en-nz":232,"./en-nz.js":232,"./eo":233,"./eo.js":233,"./es":234,"./es-do":235,"./es-do.js":235,"./es-us":236,"./es-us.js":236,"./es.js":234,"./et":237,"./et.js":237,"./eu":238,"./eu.js":238,"./fa":239,"./fa.js":239,"./fi":240,"./fi.js":240,"./fo":241,"./fo.js":241,"./fr":242,"./fr-ca":243,"./fr-ca.js":243,"./fr-ch":244,"./fr-ch.js":244,"./fr.js":242,"./fy":245,"./fy.js":245,"./gd":246,"./gd.js":246,"./gl":247,"./gl.js":247,"./gom-latn":248,"./gom-latn.js":248,"./gu":249,"./gu.js":249,"./he":250,"./he.js":250,"./hi":251,"./hi.js":251,"./hr":252,"./hr.js":252,"./hu":253,"./hu.js":253,"./hy-am":254,"./hy-am.js":254,"./id":255,"./id.js":255,"./is":256,"./is.js":256,"./it":257,"./it.js":257,"./ja":258,"./ja.js":258,"./jv":259,"./jv.js":259,"./ka":260,"./ka.js":260,"./kk":261,"./kk.js":261,"./km":262,"./km.js":262,"./kn":263,"./kn.js":263,"./ko":264,"./ko.js":264,"./ky":265,"./ky.js":265,"./lb":266,"./lb.js":266,"./lo":267,"./lo.js":267,"./lt":268,"./lt.js":268,"./lv":269,"./lv.js":269,"./me":270,"./me.js":270,"./mi":271,"./mi.js":271,"./mk":272,"./mk.js":272,"./ml":273,"./ml.js":273,"./mr":274,"./mr.js":274,"./ms":275,"./ms-my":276,"./ms-my.js":276,"./ms.js":275,"./mt":277,"./mt.js":277,"./my":278,"./my.js":278,"./nb":279,"./nb.js":279,"./ne":280,"./ne.js":280,"./nl":281,"./nl-be":282,"./nl-be.js":282,"./nl.js":281,"./nn":283,"./nn.js":283,"./pa-in":284,"./pa-in.js":284,"./pl":285,"./pl.js":285,"./pt":286,"./pt-br":287,"./pt-br.js":287,"./pt.js":286,"./ro":288,"./ro.js":288,"./ru":289,"./ru.js":289,"./sd":290,"./sd.js":290,"./se":291,"./se.js":291,"./si":292,"./si.js":292,"./sk":293,"./sk.js":293,"./sl":294,"./sl.js":294,"./sq":295,"./sq.js":295,"./sr":296,"./sr-cyrl":297,"./sr-cyrl.js":297,"./sr.js":296,"./ss":298,"./ss.js":298,"./sv":299,"./sv.js":299,"./sw":300,"./sw.js":300,"./ta":301,"./ta.js":301,"./te":302,"./te.js":302,"./tet":303,"./tet.js":303,"./th":304,"./th.js":304,"./tl-ph":305,"./tl-ph.js":305,"./tlh":306,"./tlh.js":306,"./tr":307,"./tr.js":307,"./tzl":308,"./tzl.js":308,"./tzm":309,"./tzm-latn":310,"./tzm-latn.js":310,"./tzm.js":309,"./uk":311,"./uk.js":311,"./ur":312,"./ur.js":312,"./uz":313,"./uz-latn":314,"./uz-latn.js":314,"./uz.js":313,"./vi":315,"./vi.js":315,"./x-pseudo":316,"./x-pseudo.js":316,"./yo":317,"./yo.js":317,"./zh-cn":169,"./zh-cn.js":169,"./zh-hk":318,"./zh-hk.js":318,"./zh-tw":319,"./zh-tw.js":319};function a(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=o,e.exports=a,a.id=431},482:function(e,t){},49:function(e,t,r){"use strict";r(11);var n=r(100),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){var e=Array.from(arguments),t=e.length;if(t<=0)return{};if(1===t)return e[0];var r=e[0],n=e.slice(1);return n.reduce((function(e,t){for(var r=0,n=Object.keys(t),a=n.length;r<a;r++)e[n[r]]=t[n[r]];return e}),r)},i=(Array.isArray,function(e){return e}),s=function(e){return(e||[]).reduce((function(e,t){return e&&t}),!0)},c=function(e){return-1!==(e+"").indexOf("px")?e:(e||0)+"px"},l=function(e,t){if(!e)throw new Error("getStyle: dom does not exist");return getComputedStyle(e)[t]},u=function(e,t){if(!e)throw new Error("setStyle: dom does not exist");for(var r=0,n=Object.keys(t),a=n.length;r<a;r++)e.style[n[r]]=t[n[r]];return e},d=function(e,t){var r="inline"===l(e,"display");return t.reduce((function(t,n){var a=r&&-1!==["width","height"].indexOf(n)?e.getClientRects()[0][n]:l(e,n);return t+parseInt(a||"0",10)}),0)},m=function(e,t){if(!e)return{left:0,top:0};var r=e.getBoundingClientRect(),n=t?i:c;return{left:n(r.left+window.scrollX),top:n(r.top+window.scrollY)}},p=function e(t,r){return!!r&&(t===r||e(t,r.parentNode))},h=function e(t){if(1!==t.nodeType)return"";if("BODY"===t.tagName)return"body";if(t.id)return"#"+t.id;var r=(t.getAttribute("class")||"").split(/\s+/g).filter((function(e){return e&&e.length})),n=Array.from(t.parentNode.childNodes).filter((function(e){return 1===e.nodeType})),a=n.filter((function(e){return e.tagName===t.tagName})),o=n.filter((function(e){var t=(e.getAttribute("class")||"").split(/\s+/g);return s(r.map((function(e){return-1!==t.indexOf(e)})))})),i="";i=1===a.length?"":r.length&&1===o.length?"."+r.join("."):":nth-child("+(1+n.findIndex((function(e){return e===t})))+")";var c=t.tagName.toLowerCase()+i;return e(t.parentNode)+" > "+c},f=function(e){if(!e)return null;if(3===e.nodeType)return"@text";var t=function(e){return Array.from(e.parentNode.childNodes).filter((function(t){return t.nodeType===e.nodeType&&t.tagName===e.tagName})).reduce((function(t,r,n){return null!==t?t:r===e?n+1:t}),null)}(e),r=(Array.from(e.parentNode.childNodes).filter((function(t){return t.nodeType===e.nodeType&&t.tagName===e.tagName})).length,e.tagName.toLowerCase());return t>1?r+"["+t+"]":r},g=function(e,t,r){var n=function e(t,r,n){return t?r?r.parentNode?"BODY"===r.tagName?["html","body"].concat(n):r.id?['*[@id="'+r.id+'"]'].concat(n):e(t,r.parentNode,[f(r)].concat(n)):["html"].concat(n):3===t.nodeType?e(t.parentNode):e(t,t,[]):null}(e,t,r);return("html"===n[0]?"/":"//")+n.join("/")},v=function(e){if(e.indexOf("'")<0)return"'"+e+"'";if(e.indexOf('"')<0)return'"'+e+'"';for(var t="concat(",r="",n=!1;!n;){var a=e.indexOf("'"),o=e.indexOf('"');if(a<0){t+="'"+e+"'",n=!0;break}if(o<0){t+='"'+e+'"',n=!0;break}o<a?(t+="'"+(r=e.substring(0,a))+"'",e=e.substring(r.length)):(t+='"'+(r=e.substring(0,o))+'"',e=e.substring(r.length)),t+=","}return t+=")"},b=function(e){var t=e.innerText&&e.innerText.trim(),r=e.textContent,n=r.toUpperCase().indexOf(t.toUpperCase());return r.substr(n,t.length)},y=function(e,t){var r=e.getAttribute("id"),o=e.getAttribute("name"),i="a"===e.tagName.toLowerCase(),s=function(){try{return b(e)}catch(e){return null}}(),c=(Array.from(e.classList),[]);if(i&&s&&s.length){var l=[].slice.call(document.getElementsByTagName("a")).filter((function(e){return b(e)===s})).findIndex((function(t){return t===e}));-1!==l&&c.push(0===l?"linkText="+s:"linkText="+s+"@POS="+(l+1))}r&&r.length&&c.push("id="+r),o&&o.length&&c.push("name="+o),c.push("xpath="+g(e));var u=function(e){function t(e,t,r){for(var n="//"+e+"[",a=0;a<t.length;a++){a>0&&(n+=" and ");var o=t[a];n+="@"+o+"="+v(r[o])}return n+="]"}try{var r=["id","name","value","type","action","onclick"],a=0;if(e.attributes){var o=e.attributes,i={};for(a=0;a<o.length;a++){var s=o[a];i[s.name]=s.value}var c=[];for(a=0;a<r.length;a++){var l=r[a];if(null!=i[l]){c.push(l);var u=t(e.nodeName.toLowerCase(),c,i);if(e===Object(n.b)(u))return u}}}}catch(e){}return null}(e);u&&c.push("xpath="+u);var d=function(e){var t="",r=e;try{for(;null!==r;){var a="/"+(t=(null!=r.parentNode?"/"+f(r):"BODY"===r.tagName?"html/body":"/"+r.nodeName.toLowerCase())+t);if(e===Object(n.b)(a))return a;r=r.parentNode}}catch(e){}return null}(e);d&&c.push("xpath="+d),c.push("css="+h(e));var m=function(e,t){for(var r=function(r,a){var o=function(){try{return Object(n.a)(e[r])}catch(e){return null}}();if(t===o)return{v:e[r]}},o=0,i=e.length;o<i;o++){var s=r(o);if("object"===(void 0===s?"undefined":a(s)))return s.v}return null}(c,e);return t?{target:m,targetOptions:c}:m};t.a={offset:m,setStyle:u,selector:h,xpath:g,atXPath:function(e,t){var r=function(e){return e&&e.toLowerCase()},n=/^([a-zA-Z0-9]+)(\[(\d+)\])?$/;return e.reduce((function(e,t){if(!e)return e;if(!e.childNodes||!e.childNodes.length)return null;var a=t.match(n),o=a[1],i=a[3]?parseInt(a[3],10):1;return Array.from(e.childNodes).filter((function(e){return 1===e.nodeType&&r(e.tagName)===r(o)}))[i-1]}),t)},domText:b,getLocator:y,getFrameLocator:function(e,t){if(function(e){var t=1*new Date+""+Math.random();try{return e[t]="asd","asd"===e[t]}catch(e){return!1}}(e)){var r=e.frameElement,n=y(r);if(/^id=/.test(n)||/^name=/.test(n))return n}for(var a=0,o=t.frames.length;a<o;a++)if(t.frames[a]===e)return"index="+a;throw new Error("Frame locator not found")},maskFactory:function(){var e=[],t="__mask__"+1*new Date+Math.round(1e3*Math.random())+"__",r=1,n={position:"absolute",zIndex:"999",display:"none",boxSizing:"border-box",backgroundColor:"red",opacity:.5,pointerEvents:"none"};return{gen:function(a,s){var d=document.createElement("div");return a=s?o({},n,a||{},function(e,t){var r=m(e,t),n="inline"===l(e,"display"),a=n?e.getClientRects()[0].width:l(e,"width"),s=n?e.getClientRects()[0].height:l(e,"height"),u=t?i:c;return o({width:u(a),height:u(s)},r)}(s)):o({},n,a||{}),u(d,a),d.id=t+r++,e.push(d),d},clear:function(){for(var t=0,r=e.length;t<r;t++){var n=e[t];n&&n.parentNode&&n.parentNode.removeChild(n)}}}},showMaskOver:function(e,t){var r=m(t),n=d(t,["width","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"]),a=d(t,["height","paddingTop","paddingBottom","borderTopWidth"," borderBottomWidth"]);u(e,o(r,{width:c(n),height:c(a),display:"block"}))},inDom:p,isVisible:function e(t){if(t===window.document)return!0;if(!t)return!0;var r=window.getComputedStyle(t);return"none"!==r.display&&"0"!==r.opacity&&"hidden"!==r.visibility&&e(t.parentNode)},parentWithTag:function(e,t){for(var r=e.toLowerCase(),n=t;n;){if(n.tagName.toLowerCase()===r)return n;n=n.parentNode}return null},parentWithClass:function(e,t){for(var r=t;r;){if(void 0!==r.classList&&r.classList.contains(e))return r;r=r.parentNode}return null}}},50:function(e,t,r){"use strict";r.r(t),r.d(t,"toHtml",(function(){return p})),r.d(t,"generateEmptyHtml",(function(){return h})),r.d(t,"toHtmlDataUri",(function(){return f})),r.d(t,"fromHtml",(function(){return g})),r.d(t,"fromJSONString",(function(){return v})),r.d(t,"toJSONString",(function(){return b})),r.d(t,"toJSONDataUri",(function(){return y})),r.d(t,"toBookmarkData",(function(){return w})),r.d(t,"generateMacroEntryHtml",(function(){return E}));r(108);var n=r(66),a=r.n(n),o=r(83),i=r.n(o),s=r(104),c=r.n(s),l=r(43),u=r(13),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function m(e){var t=e.name,r=e.baseUrl,n=e.commandTrs,a=e.noImport;return'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n<head profile="http://selenium-ide.openqa.org/profiles/test-case">\n<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n'+(a?"":'<link rel="selenium.base" href="'+r+'" />')+"\n<title>"+t+"</title>\n</head>\n<body>\n"+(a?"<h3>Starting Browser and UI.Vision...</h3>":'\n    <table cellpadding="1" cellspacing="1" border="1">\n    <thead>\n    <tr><td rowspan="1" colspan="3">'+t+"</td></tr>\n    </thead><tbody>\n    "+n.join("\n")+"\n    </tbody></table>\n  ")+"\n<script>\n(function() {\n  var isExtensionLoaded = function () {\n    const $root = document.documentElement\n    return !!$root && !!$root.getAttribute('data-kantu')\n  }\n  var increaseCountInUrl = function (max) {\n    var url   = new URL(window.location.href)\n    var count = 1 + (parseInt(url.searchParams.get('reload') || 0))\n\n    url.searchParams.set('reload', count)\n    var nextUrl = url.toString()\n\n    var shouldStop = count > max\n    return [shouldStop, !shouldStop ? nextUrl : null]\n  }\n  var run = function () {\n    try {\n      var evt = new CustomEvent('kantuSaveAndRunMacro', {\n        detail: {\n          html: document.documentElement.outerHTML,\n          noImport: "+(a||"false")+",\n          storageMode: '"+Object(u.getStorageManager)().getCurrentStrategyType()+"'\n        }\n      })\n\n      window.dispatchEvent(evt)\n      var intervalTimer = setInterval(() => window.dispatchEvent(evt), 1000);\n\n      if (window.location.protocol === 'file:') {\n        var onInvokeSuccess = function () {\n          clearTimeout(timer)\n          clearTimeout(reloadTimer)\n          clearInterval(intervalTimer)\n          window.removeEventListener('kantuInvokeSuccess', onInvokeSuccess)\n        }\n        var timer = setTimeout(function () {\n          alert('Error #203: It seems you need to turn on *Allow access to file URLs* for Kantu in your browser extension settings.')\n        }, 8000)\n\n        window.addEventListener('kantuInvokeSuccess', onInvokeSuccess)\n      }\n    } catch (e) {\n      alert('Kantu Bookmarklet error: ' + e.toString());\n    }\n  }\n  var reloadTimer = null\n  var main = function () {\n    if (isExtensionLoaded())  return run()\n\n    var MAX_TRY   = 3\n    var INTERVAL  = 1000\n    var tuple     = increaseCountInUrl(MAX_TRY)\n\n    if (tuple[0]) {\n      return alert('Error #204: It seems UI.Vision RPA is not installed yet - or you need to turn on *Allow access to file URLs* for UI.Vision RPA in your browser extension settings.')\n    } else {\n      reloadTimer = setTimeout(function () {\n        window.location.href = tuple[1]\n      }, INTERVAL)\n    }\n  }\n\n  setTimeout(main, 500)\n})();\n<\/script>\n</body>\n</html>\n  "}function p(e){var t=e.name,r=e.commands.map((function(e){return d({},e)})),n=r.find((function(e){return"open"===e.cmd}));return n&&(n.target=n.target),m({name:t,commandTrs:r.map((function(e){return"open"===e.cmd&&(e.target=e.target),"\n      <tr>\n        <td>"+(e.cmd||"")+"</td>\n        <td>"+(e.target||"")+"</td>\n        <td>"+(e.value||"")+"</td>\n      </tr>\n    "})),baseUrl:""})}function h(){return m({name:"UI.Vision Autostart Page",commandTrs:[],baseUrl:"",noImport:!0})}function f(e){return t=p(e),"data:text/html;base64,"+window.btoa(unescape(encodeURIComponent(t)));var t}function g(e){var t=i()("<div>"+e+"</div>"),r=t.find("link"),n=t.find("title"),a=t.find("tbody > tr"),o=r&&r.attr("href"),s=n.text();if(!s||!s.length)throw new Error("fromHtml: missing title");return{name:s,data:{commands:[].slice.call(a).map((function(e){var t=i()(e),r=t[0].outerHtml;t.find("datalist").remove();var n,a,s=t.children(),u=s.eq(0),d=s.eq(1),m=s.eq(2),p=Object(l.normalizeCommandName)(u&&u.text()),h=m&&m.text(),f=d&&d.text();if(!p||!p.length)throw new Error("missing cmd in "+r);return"open"===p&&(f=o&&o.length&&!/:\/\//.test(f)?(n=o,a=f,new c.a(a,n).toString()):f),{cmd:p,target:f,value:h}}))}}}function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a()(e.replace(/^\s*/,"")),o=t?t.replace(/\.json$/i,""):n.Name||"__imported__";if(n.macros)throw new Error("This is a test suite, not a macro");if(!Array.isArray(n.Commands))throw new Error("'Commands' field must be an array");var i=n.Commands.map((function(e){var t={cmd:Object(l.normalizeCommandName)(e.Command),target:e.Target,value:e.Value,description:e.Description||""};return Array.isArray(e.Targets)&&(t.targetOptions=e.Targets),t}));return d({name:o,data:{commands:i}},r.withStatus&&n.status?{status:n.status}:{},r.withId&&n.id?{id:n.id}:{})}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(){var e=new Date;return[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-")},n=d({Name:e.name,CreationDate:r(),Commands:e.commands.map((function(e){return{Command:e.cmd,Target:e.target||"",Value:e.value||"",Targets:t.ignoreTargetOptions?e.targetOptions:void 0,Description:e.description||""}}))},t.withStatus&&e.status?{status:e.status}:{},t.withId&&e.id?{id:e.id}:{});return JSON.stringify(n,null,2)}function y(e){return t=b(e),"data:text/json;base64,"+window.btoa(unescape(encodeURIComponent(t)));var t}function w(e){var t=e.path,r=e.bookmarkTitle;if(!t)throw new Error("path is required to generate bookmark for macro");if(!r)throw new Error("bookmarkTitle is required to generate bookmark for macro");return{title:r,url:("javascript:\n      (function() {\n        try {\n          var evt = new CustomEvent('kantuRunMacro', {\n            detail: {\n              name: "+JSON.stringify(t.replace(/\.json$/i,""))+",\n              from: 'bookmark',\n              storageMode: '"+Object(u.getStorageManager)().getCurrentStrategyType()+"',\n              closeRPA: 1\n            }\n          });\n          window.dispatchEvent(evt);\n        } catch (e) {\n          alert('UI.Vision RPA Bookmarklet error: ' + e.toString());\n        }\n      })();\n    ").replace(/\n\s*/g,"")}}function E(e){return'<!doctype html>\n<html lang="en">\n  <head>\n    <title>UI.Vision Shortcut Page</title>\n  </head>\n  <body>\n    <h3>Command line:</h3>\n    <a id="run" href="ui.vision.html?direct=1&savelog=log.txt&macro='+e+'">Click here</a>\n    <br>\n    <br>\n\t\x3c!-- To start another macro just edit this HTML file and change the macro name in the command line above^. --\x3e\n\t\x3c!-- For more command line parameters see https://ui.vision/rpa/docs#cmd --\x3e\n    <script>\n      window.location.href = document.getElementById("run").getAttribute("href");\n    <\/script>\n  </body>\n</html>\n'}},504:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(182);class a extends n.BaseProxyManager{constructor(){super(),this.isBound=!1}isSupported(){return"undefined"!=typeof chrome&&chrome.proxy&&chrome.proxy.settings&&chrome.proxy.settings.onChange}isControllable(e){return new Promise((t,r)=>{chrome.proxy.settings.get({incognito:!!e},e=>{if(chrome.runtime.lastError)return r(chrome.runtime.lastError);const{levelOfControl:n}=e,a=-1!==["controllable_by_this_extension","controlled_by_this_extension"].indexOf(n);t(a)})})}setProxy(e){return this.bindProxyChange(),this.proxy=e,new Promise((t,r)=>{chrome.proxy.settings.set({value:{mode:"fixed_servers",rules:{singleProxy:{scheme:e.type,host:e.host,port:parseInt(e.port,10)}}}},()=>{if(chrome.runtime.lastError)return r(chrome.runtime.lastError);t()})})}reset(){return new Promise((e,t)=>{chrome.proxy.settings.set({value:{mode:"direct"}},()=>{if(chrome.runtime.lastError)return t(chrome.runtime.lastError);e()})})}bindProxyChange(){this.isBound||(this.isBound=!0,chrome.proxy.settings.onChange.addListener(e=>{const t=this.fromChromeDetails(e);this.setLocalProxyIfIsNew(t),this.registry.fire("change",t)}))}fetchProxyFromSettings(){return new Promise((e,t)=>{chrome.proxy.settings.get({incognito:!1},r=>{if(chrome.runtime.lastError)return t(chrome.runtime.lastError);const n=this.fromChromeDetails(r);this.setLocalProxyIfIsNew(n),this.registry.fire("change",n),e()})})}fromChromeDetails(e){if("fixed_servers"!==e.value.mode||!e.value.rules||!e.value.rules.singleProxy)return null;const t=e.value.rules.singleProxy;return{host:t.host,port:""+t.port,type:t.scheme}}setLocalProxyIfIsNew(e){var t,r;(null==e?void 0:e.host)===(null===(t=this.proxy)||void 0===t?void 0:t.host)&&(null==e?void 0:e.port)===(null===(r=this.proxy)||void 0===r?void 0:r.port)||(this.proxy=e)}}t.ProxyManagerViaSettingsAPI=a},505:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(182),o=r(357),i=n(r(20)),s=n(r(11)),c=r(12);class l extends a.BaseProxyManager{constructor(){super(),this.unbind=()=>{},this.isBound=!1}isSupported(){return"undefined"!=typeof browser&&browser.proxy&&browser.proxy.register}isControllable(){return Promise.resolve(!0)}setProxy(e){return this.bind(),this.proxy=e,this.notifyProxyChange(),browser.runtime.sendMessage({cmd:"SET_PROXY",data:e?o.convertToFirefoxProxyInfo(e):null},{toProxyScript:!0}).then(()=>c.delay(()=>{},1e3))}reset(){return this.proxy=null,this.notifyProxyChange(),i.default.ask("PANEL_SET_PROXY_FOR_PAC",{proxy:null}).then(()=>c.delay(()=>{},1e3))}getAuth(e,t){return this.proxy&&this.proxy.username&&this.proxy.host===e&&this.proxy.port===t?{username:this.proxy.username,password:this.proxy.password}:null}notifyProxyChange(){setTimeout(()=>{this.registry.fire("change",this.proxy)},10)}bind(){if(this.isBound)return;this.isBound=!0;const e=e=>{"PROXY_LOG"===e.type&&s.default("PROXY_LOG",e)};browser.proxy.register("firefox_pac.js"),browser.runtime.onMessage.addListener(e),this.unbind=()=>{browser.proxy.unregister(),browser.runtime.onMessage.removeListener(e)}}}t.ProxyManagerViaPacAPI=l},506:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(10));t.ProxyHttpAuth=class{constructor(e){this.unbindListener=()=>{},this.bound=!1,this.getAuth=e.getAuth}bind(){if(this.bound)return;this.bound=!0;const e=this.onAuthRequired.bind(this);a.default.webRequest.onAuthRequired.addListener(e,{urls:["<all_urls>"]},["blocking"]),this.unbindListener=()=>a.default.webRequest.onAuthRequired.removeListener(e)}unbind(){this.bound&&(this.unbindListener(),this.bound=!1)}onAuthRequired(e){if(!e.isProxy)return{};const t=this.getAuth(e.challenger.host,""+e.challenger.port);return t?{authCredentials:t}:{}}}},511:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(76),o=n(r(92)),i=r(4),s=r(12);class c extends a.FlatStorage{constructor(e){super(),this.displayedCount=0,this.totalCount=0;const t=e.table;if(!o.default.tables.find(e=>e.name===t))throw new Error(`Unknown indexeddb table name '${t}'`);this.table=o.default.table(e.table)}getDisplayCount(){return this.displayedCount}getTotalCount(){return this.totalCount}__list(){return Promise.resolve(this.table.toArray()).then(e=>(this.totalCount=e.length,this.displayedCount=e.length,e.map(e=>({dir:"",fileName:e.name,lastModified:new Date,size:"unknown"}))))}exists(e){return Promise.resolve(this.table.where("name").equals(e).toArray()).then(e=>e.length>0)}read(e,t){if("Text"!==t)throw new Error(`ReadFileType '${t}' is not supported in indexeddb storage`);return this.findByName(e)}readAll(e="Text",t){return Promise.resolve(this.table.toArray()).then(e=>e.map(e=>({fileName:e.name,content:e})))}__write(e,t){return this.findByName(e).catch(()=>null).then(e=>{if(e){const r=this.normalize(Object.assign(Object.assign({},e),t));return delete r.id,this.table.update(e.id,r)}{const e=this.normalize(Object.assign({id:i.uid()},t));return this.table.add(e)}}).then(()=>{})}__overwrite(e,t){return this.write(e,t)}__clear(){return Promise.resolve(this.table.clear())}__remove(e){return this.findByName(e).then(e=>this.table.delete(e.id))}__rename(e,t){return this.findByName(e).then(e=>this.table.update(e.id,{name:t})).then(()=>{})}__copy(e,t){return this.findByName(e).then(e=>(delete e.id,e.name=t,this.__write(t,e)))}ensureDir(){return Promise.resolve()}findByName(e){return Promise.resolve(this.table.where("name").equals(e).first()).then(t=>{if(!t)throw new Error(`indexeddb storage: Item with name '${e}' is not found`);return t})}normalize(e){return e}dataToString(e){return JSON.stringify(e)}}t.IndexeddbFlatStorage=c,t.getIndexeddbFlatStorage=s.singletonGetterByKey(e=>e.table,e=>new c(e))},512:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(135)),o=r(185),i=r(12);t.MigrationService=class{constructor(e){this.storage=e.storage,this.jobs=e.jobs}isMigrated(e){return this.storage.get(e).then(e=>!!e)}getRecords(){return this.storage.getAll()}runType(e){return this.isMigrated(e).then(t=>{if(t)return o.MigrationResult.AlreadyMigrated;const r=this.findJob(e);return r?r.shouldMigrate().then(e=>e?r.migrate().then(()=>o.MigrationResult.Success):o.MigrationResult.NotQualified):o.MigrationResult.JobUnknown}).catch(e=>(console.error(e),o.MigrationResult.Error)).then(t=>t!==o.MigrationResult.Success?Promise.resolve(t):this.storage.set(e,{result:t,id:i.uid(),runAt:(new Date).getTime(),jobType:e}).then(()=>t))}runAll(e,t){const r=this.jobs.filter(t=>a.default.satisfies(e,t.previousVersionRange()));return i.flow(...r.map(e=>{const t=e.getType();return()=>this.runType(t).then(e=>({type:t,result:e}))})).then(e=>e.reduce((e,t)=>(e[t.type]=t.result,e),{}))}findJob(e){return this.jobs.find(t=>t.getType()===e)}}},513:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(153),a=r(12);class o extends n.KeyValueData{getAll(){return super.get("")}getMainKeyAndSubKeys(e){const[t,r]=super.getMainKeyAndSubKeys(e);return[o.STORAGE_KEY,[t].concat(r).filter(e=>e&&e.length)]}}t.MigrationKeyValueData=o,o.STORAGE_KEY="migration_records",t.getMigrationKeyValueData=a.singletonGetter(()=>new o)},523:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(1006)),o=n(r(34)),i=r(12);function s(e,t){switch(e.status){case"key_not_found":return{licenseKey:t,status:"key_not_found"};case"off":return{licenseKey:t,status:"off",type:e.product};case"on":return{licenseKey:t,status:"on",type:e.product,name:e.data1a,upgradeUrl:e.data1b,maxOcrCalls:parseInt(e.data2b)}}}t.isNetworkError=function(e){return"Network Error"===e.message},t.convertToLicenseInfo=s,t.checkLicense=function(e){const t=i.urlWithQueries(o.default.license.api.url,{version:e.version,licensekey:e.licenseKey});return a.default.get(t).then(t=>s(t.data,e.licenseKey)).catch(e=>{if(e.response)throw new Error(e.response.data);return Promise.reject(e)})}},58:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(1023),o=r(12),i=r(1024),s=r(393),c=n(r(11));!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Middle=2]="Middle"}(t.MouseButton||(t.MouseButton={})),function(e){e[e.Move=0]="Move",e[e.Down=1]="Down",e[e.Up=2]="Up",e[e.Click=3]="Click",e[e.DoubleClick=4]="DoubleClick",e[e.CtrlClick=5]="CtrlClick",e[e.ShiftClick=6]="ShiftClick",e[e.TripleClick=7]="TripleClick"}(t.MouseEventType||(t.MouseEventType={})),t.getNativeXYAPI=o.singletonGetter(()=>{const e=new i.KantuXYHost;let t=e.connectAsync().catch(e=>{throw c.default.warn("pReady - error",e),e});const r=a.MethodTypeInvocationNames.reduce((n,a)=>(n[o.snakeToCamel(a)]=n=>t.then(()=>e.invokeAsync(a,n).catch(e=>{throw r.reconnect().catch(()=>{}),e})),n),{reconnect:()=>(e.disconnect(),t=e.connectAsync(),t.then(()=>r)),getScalingFactor:()=>r.getScreenBackingScaleFactor().then(e=>window.devicePixelRatio/e),sendViewportMouseEvent:(e,t)=>{const n=r;return Promise.all([t.getViewportRectInScreen(),s.getFocusedWindowSize(),n.getScalingFactor()]).then(t=>{const r=t[0],a=(t[1],t[2]),o=r.x,i=r.y;return n.sendMouseEvent({type:e.type,button:e.button,x:e.x*a+o*a,y:e.y*a+i*a})}).catch(e=>(console.error(e),!1))}});return r})},60:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(124),o=r(125),i=r(12),s=n(r(11)),c=n(r(27)),l=r(126),u=r(127),d=r(4),m=n(r(135)),p=n(r(34));!function(e){e[e.UserProfile=0]="UserProfile",e[e.UserDesktop=1]="UserDesktop"}(t.SpecialFolder||(t.SpecialFolder={})),t.getNativeFileSystemAPI=i.singletonGetter(()=>{const e=new o.KantuFileAccessHost;let t=e.connectAsync().catch(e=>{throw s.default.warn("pReady - error",e),e}),r=0;const n=a.MethodTypeInvocationNames.reduce((a,o)=>{const s=i.snakeToCamel(o);return a[s]||(a[s]=a=>t.then(()=>(r+=1,e.invokeAsync(o,a))).then(e=>(r-=1,e),e=>{throw r-=1,n.reconnect().catch(()=>{}),e})),a},{reconnect:()=>i.until("pendingRequestCount === 0",()=>({pass:0===r,result:!0})).then(()=>(s.default("FileSystem - reconnect",(new Error).stack),e.disconnect(),t=e.connectAsync(),t.then(()=>n))),getEntries:e=>{const t=n;return t.getFileSystemEntries(e).then(r=>{const{errorCode:n,entries:a}=r;return e.brief?Promise.resolve({errorCode:n,entries:a.map(e=>({name:e,length:0,isDirectory:!1,lastWriteTime:0}))}):Promise.all(a.map(r=>{const n=c.default.join(e.path,r);return t.getFileSystemEntryInfo({path:n}).then(e=>({name:r,length:e.length,isDirectory:e.isDirectory,lastWriteTime:e.lastWriteTime}))})).then(e=>({errorCode:n,entries:e}))})},ensureDir:e=>{const t=n;return t.directoryExists({path:e.path}).then(r=>!!r||t.ensureDir({path:c.default.dirname(e.path)}).then(r=>!!r&&t.createDirectory({path:e.path}))).catch(e=>!1)},readBigFile:e=>{const t=n;return t.getFileSize(e).then(r=>{if(0===r)return new Uint8Array(0);const n=[],a=o=>t.readFileRange({path:e.path,rangeStart:o}).then(e=>{const t=u.base64.decode(e.buffer);if(t)for(let e=0;e<t.length;e++)n.push(t[e]);return e.rangeEnd<=o||e.rangeEnd>=r?new Uint8Array(n):a(e.rangeEnd)});return a(0)})},isReadBigFileSupported:()=>n.getVersion().then(e=>!m.default.lt(e,p.default.xfile.minVersionToReadBigFile)),readAllTextCompat:e=>{const t=n;return t.isReadBigFileSupported().then(r=>r?t.readBigFile(e).then(e=>({errorCode:0,content:l.utf8.decode(e)})):t.readAllText(e))},readAllBytesCompat:e=>{const t=n;return t.isReadBigFileSupported().then(r=>r?t.readBigFile(e).then(e=>d.blobToDataURL(new Blob([e])).then(e=>({errorCode:0,content:e}))):t.readAllBytes(e))}});return n})},619:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(117),i=n(r(1));class s extends a.default.Component{constructor(){super(...arguments),this.state={isEditing:!1,value:""},this.edit=()=>{this.setState({isEditing:!0}),setTimeout(()=>{const e=this.$input&&this.$input.refs&&this.$input.refs.input;if(e){e.focus();const t=this.props.getSelection(this.state.value,e);e.selectionStart=t?t.start:0,e.selectionEnd=t?t.end:e.value.length}},100)},this.submit=()=>{this.props.checkValue(this.state.value).then(e=>{e&&(this.setState({isEditing:!1}),this.props.onChange(this.state.value).catch(e=>this.setState({value:this.props.value})))})},this.reset=()=>{this.setState({isEditing:!1,value:this.props.value})}}componentDidMount(){this.setState({value:this.props.value})}componentWillReceiveProps(e){e.value!==this.props.value&&this.setState({value:e.value})}render(){return this.state.isEditing?a.default.createElement(o.Input,{defaultValue:"",autosize:!0,ref:e=>{this.$input=e},value:this.state.value,onChange:e=>this.setState({value:e.target.value}),onBlur:this.reset,onKeyDown:e=>13===e.keyCode?this.submit():27===e.keyCode?this.reset():void 0}):a.default.createElement("span",null,this.props.value,a.default.createElement(o.Icon,{type:"edit",style:{marginLeft:"10px",cursor:"pointer"},onClick:this.edit}))}}t.default=s,s.propTypes={value:i.default.string.isRequired,onChange:i.default.func.isRequired,checkValue:i.default.func.isRequired,getSelection:i.default.func},s.defaultProps={getSelection:()=>null}},62:function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(17));var o,i;!function(e){e.Html="html",e.Bookmark="bookmark",e.Manual="manual"}(o=t.RunBy||(t.RunBy={})),t.stringForRunBy=function(e){switch(e){case o.Bookmark:return"bookmark";case o.Html:return"command line";case o.Manual:return"manual"}},function(e){e.Unknown="unknown",e.Sidebar="sidebar",e.CommandTable="command_table",e.CodeSource="code_source"}(i=t.FocusArea||(t.FocusArea={})),t.newTestCaseEditing={commands:[],meta:{src:null,hasUnsaved:!0,selectedIndex:-1}},t.initialState={status:a.APP_STATUS.NORMAL,recorderStatus:a.RECORDER_STATUS.STOPPED,inspectorStatus:a.INSPECTOR_STATUS.STOPPED,isLoadingMacros:!1,from:o.Manual,noDisplayInPlay:!1,editor:{testSuites:[],testCases:[],currentMacro:null,macrosExtra:{},macroFolderStructure:[],testSuitesExtra:{},testSuitesFolderStructure:[],editing:Object.assign({},t.newTestCaseEditing),editingSource:{original:null,pure:null,current:null,error:null},clipboard:{commands:[]},activeTab:"table_view",isDraggingCommand:!1},player:{mode:a.PLAYER_MODE.TEST_CASE,status:a.PLAYER_STATUS.STOPPED,stopReason:null,currentLoop:0,loops:0,nextCommandIndex:null,playInterval:0,timeoutStatus:{type:null,total:null,past:null}},recorder:{skipOpen:!1},variables:[],logs:[],screenshots:[],csvs:[],visions:[],config:{},proxy:null,ui:{focusArea:i.Unknown},macroQuery:""}},620:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(12),i=n(r(11));class s{constructor(e){this.targets=[],i.default("Create observer",e),this.observer=new IntersectionObserver(this.handleObserve.bind(this),e)}observe(e,t){this.targets.push({el:e,run:t,done:!1}),this.observer.observe(e)}remove(e){const t=this.targets.findIndex(t=>t.el===e);-1!==t&&this.targets.splice(t,1)}handleObserve(e){e.forEach(e=>{if(e.intersectionRatio<=0)return;const t=e.target,r=this.targets.findIndex(e=>e.el===t);-1===r||this.targets[r].done||(this.targets[r].run(),this.targets[r].done=!0)})}}t.IntersectionObserverManager=s,t.getIntersectionObserverManager=o.singletonGetterByKey(e=>e,(e,t)=>new s(t));class c extends a.default.Component{constructor(){super(...arguments),this.el=null,this.manager=null,this.state={url:"",isLoading:!1}}componentWillMount(){this.manager=t.getIntersectionObserverManager(this.props.type,{root:this.props.root,rootMargin:"20px",threshold:.01})}componentWillUnmount(){this.el&&this.manager&&this.manager.remove(this.el)}startObserve(e){this.manager&&this.manager.observe(e,()=>{this.getUrl()})}getSizeString(e){return"number"==typeof e?e+"px":e}getImageStyle(){return Object.assign(Object.assign(Object.assign({},this.props.width?{width:this.getSizeString(this.props.width)}:{}),this.props.height?{height:this.getSizeString(this.props.height)}:{}),{backgroundImage:`url(${this.state.url})`,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center center"})}getUrl(){return this.setState({isLoading:!0}),this.props.getUrl().then(e=>{this.setState({url:e,isLoading:!1})})}render(){return a.default.createElement("div",{className:"lazy-image",style:this.getImageStyle(),ref:e=>{this.el=e,e&&this.startObserve(e)}})}}t.LazyImage=c},63:function(e,t,r){"use strict";r.r(t),r.d(t,"postMessage",(function(){return o})),r.d(t,"onMessage",(function(){return i}));var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a="SELENIUM_IDE_CS_MSG",o=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"*",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;return new Promise((function(i,s){if(!e||!e.postMessage)throw new Error("csPostMessage: targetWin is not a window");if(!t||!t.addEventListener||!t.removeEventListener)throw new Error("csPostMessage: myWin is not a window",t);var c=Math.random();t.addEventListener("message",(function e(r){if(r.data&&r.data.type===a&&!r.data.isRequest&&r.data.secret===c){t.removeEventListener("message",e);var n=r.data,o=n.payload,l=n.error;if(l)return s(new Error(l));if(void 0!==o)return i(o);s(new Error("csPostMessage: No payload nor error found"))}})),e.postMessage({type:"SELENIUM_IDE_CS_MSG",secret:c,payload:r,isRequest:!0},n),setTimeout((function(){s(new Error("csPostMessage: timeout "+o+" ms"))}),o)}))},i=function(e,t){if(!e||!e.addEventListener||!e.removeEventListener)throw new Error("csOnMessage: not a window",e);var r=function(e){if(e&&e.data&&e.data.type===a&&e.data.isRequest&&e.data.secret){var r={type:a,secret:e.data.secret};new Promise((function(r,n){var a=void 0;try{a=t(e.data.payload,{source:e.source})}catch(e){n(e)}void 0!==a&&r(a)})).then((function(t){e.source.postMessage(n({},r,{payload:t}),"*")}),(function(t){e.source.postMessage(n({},r,{error:t.message}),"*")}))}};return e.addEventListener("message",r),function(){return e.removeEventListener("message",r)}}},641:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(12),o=r(13),i=n(r(11)),s=r(4);function c(e,t){return{name:e.name,commands:a.flatten(e.commands.map(e=>l(e,t)))}}function l(e,t){if("open"===e.command)return[{cmd:"open",target:u(t,e.target),value:""}];if(function(e){switch(e){case"open":case"select":case"type":case"pause":case"addSelection":case"answerOnNextPrompt":case"assertAlert":case"assertChecked":case"assertConfirmation":case"assertEditable":case"assertElementPresent":case"assertElementNotPresent":case"assertNotEditable":case"assertNotChecked":case"assertPrompt":case"assertTitle":case"assertText":case"assertValue":case"check":case"click":case"clickAt":case"do":case"dragAndDropToObject":case"echo":case"editContent":case"else":case"elseIf":case"end":case"executeAsyncScript":case"executeScript":case"forEach":case"mouseOver":case"repeatIf":case"removeSelection":case"run":case"select":case"selectFrame":case"sendKeys":case"setWindowSize":case"store":case"storeAttribute":case"storeText":case"storeTitle":case"storeValue":case"storeXpathCount":case"times":case"uncheck":case"verifyChecked":case"verifyText":case"verifyTitle":case"verifyValue":case"verifyEditable":case"verifyElementPresent":case"verifyElementNotPresent":case"verifyNotChecked":case"verifyNotEditable":case"waitForElementVisible":case"waitForElementNotVisible":case"waitForElementPresent":case"waitForElementNotPresent":return!0;default:return!1}}(e.command))return[Object.assign({cmd:e.command,target:e.target,value:e.value},e.targets?{targetOptions:e.targets.map(e=>e[0])}:{})];const r=function(e){switch(e.command){case"runScript":return[{cmd:"executeScript",target:e.target,value:""}];case"if":return[{cmd:"if_v2",target:e.target,value:e.value}];case"while":return[{cmd:"while_v2",target:e.target,value:e.value}];default:return[]}}(e);return r.length>0?r:[{cmd:"comment",target:`${e.command} // ${e.target}`,value:e.value}]}function u(e,t){if(/^https?:\/\//.test(t))return t;if("/"===t.charAt(0)){return new URL(e).origin+t}return e+t}t.importSideProject=function(e){const t=s.sanitizeFileName(e.name),r=o.getStorageManager().getMacroStorage(),n=r.getPathLib();return a.uniqueName(t,{check:e=>r.directoryExists(e).then(e=>!e)}).then(t=>r.createDirectory(t).then(()=>Promise.all(e.tests.map(a=>{a.name=s.sanitizeFileName(a.name);const o=n.join(t,a.name+".json"),l=c(a,e.url);return r.write(o,{name:l.name,data:{commands:l.commands}}).then(()=>!0,e=>(i.default(e),e.message))})).then(e=>({successCount:e.filter(e=>e&&"boolean"==typeof e).length,errorCount:e.filter(e=>"string"==typeof e).length,errors:e.filter(e=>"string"==typeof e),ignoreCount:0}))).then(r=>({projectName:e.name,folderName:t,macros:r,suites:{successCount:0,ignoreCount:e.suites.length,errorCount:0,errors:[]}})))},t.convertSideMacro=c,t.convertSideCommand=l},642:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(142)),o=r(13),i=r(12),s=r(50),c=r(374);function l(e){e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)}function u(e){const t=e.path.split("/").filter(e=>"."!==e),r=t.slice(1).join("/"),n=""===t[t.length-1],[a,i]=(()=>{switch(t[0]){case c.ZipFolders.Macros:return[e.manager.getMacroStorage(),o.StorageTarget.Macro];case c.ZipFolders.TestSuites:return[e.manager.getTestSuiteStorage(),o.StorageTarget.TestSuite];case c.ZipFolders.Csvs:return[e.manager.getCSVStorage(),o.StorageTarget.CSV];case c.ZipFolders.Screenshots:return[e.manager.getScreenshotStorage(),o.StorageTarget.Screenshot];case c.ZipFolders.Visions:return[e.manager.getVisionStorage(),o.StorageTarget.Vision];default:return[null,null]}})();return a?{storage:a,target:i,dir:n,relativePath:r}:null}t.restoreBackup=function(e){const t=o.getStorageManager(e.storage);return a.default.loadAsync(e.file).then(e=>{const r=[],n=[];e.forEach((e,t)=>{t.dir?n.push(t):r.push(t)}),l(r),l(n);return i.flow(...n.map(e=>{const r=u({manager:t,path:e.name});return r&&"."!==r.relativePath&&""!==r.relativePath?()=>r.storage.directoryExists(r.relativePath).then(e=>{if(!e)return r.storage.createDirectory(r.relativePath).then(()=>{})}):()=>Promise.resolve()})).then(()=>i.flow(...r.map(e=>{const r=u({manager:t,path:e.name});if(!r)return()=>Promise.resolve();switch(r.target){case o.StorageTarget.Macro:return()=>e.async("text").then(e=>r.storage.write(r.relativePath,s.fromJSONString(e))).then(()=>r.target);case o.StorageTarget.Screenshot:case o.StorageTarget.Vision:case o.StorageTarget.CSV:return()=>e.async("blob").then(e=>r.storage.write(r.relativePath,e)).then(()=>r.target);default:return()=>Promise.resolve()}})).then(e=>({count:{macro:e.filter(e=>e===o.StorageTarget.Macro).length,testSuite:e.filter(e=>e===o.StorageTarget.TestSuite).length,screenshot:e.filter(e=>e===o.StorageTarget.Screenshot).length,vision:e.filter(e=>e===o.StorageTarget.Vision).length,csv:e.filter(e=>e===o.StorageTarget.CSV).length}})))})},t.sortZipObjectsInline=l,t.sortZipObjects=function(e){const t=[...e];return l(t),t},t.getStorageAndPath=u},644:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=n(r(18)),i=r(117),s=r(1087),c=r(12);r(1059);const l=r(4);class u extends a.default.Component{constructor(e){super(e),this.state={text:"",shouldShowOptions:!1},this.getDropDownElementId=c.singletonGetter(()=>"dropdown_"+s.v1()),this.onFocus=()=>{this.props.disabled||this.setState({shouldShowOptions:!0})},this.onBlur=()=>{setTimeout(()=>{this.setState({shouldShowOptions:!1})},100)},this.onToggle=()=>{this.props.disabled||(this.state.shouldShowOptions?this.onBlur():(this.onFocus(),this.focusOnTextInput()))},this.onKeyDown=e=>{switch(e.keyCode){case 13:case 27:this.setState({shouldShowOptions:!1})}},this.onTextChange=e=>{const t=e.target.value;this.setState({text:t,shouldShowOptions:!0}),this.props.onChange(t)},this.onItemClick=(e,t,r)=>{var n;const a=null!==(n=this.props.stringifyOption(t))&&void 0!==n?n:this.props.getId(t,r);this.setState({text:a,shouldShowOptions:!1}),this.focusOnTextInput(),this.props.onChange(a)},this.container=a.default.createRef(),this.input=a.default.createRef()}componentDidMount(){this.props.value&&this.setState({text:this.props.value})}componentDidUpdate(e){var t;this.props.value!==e.value&&this.setState({text:null!==(t=this.props.value)&&void 0!==t?t:""})}focusOnTextInput(){if(!this.input.current)return;this.input.current.refs.input.focus()}getDropDownContainer(){const e="drop_down_container",t=document.getElementById(e);if(t)return t;const r=document.createElement("div");return r.id=e,document.body.appendChild(r),r}getDropDownMountPoint(){const e=this.getDropDownElementId(),t=document.getElementById(e);if(t)return t;const r=document.createElement("div");return r.id=e,r.className="drop-down",this.getDropDownContainer().appendChild(r),r}renderOneOption(e,t,r){var n;const{getId:o,stringifyOption:i}=this.props,s=this.props.OptionItem,c=o(e,t);if(s)return a.default.createElement(s,{value:e,key:c});const l=null!==(n=null==i?void 0:i(e))&&void 0!==n?n:c;return a.default.createElement(d,{key:c,item:e,index:t,text:l,selected:r,onItemClick:this.onItemClick})}renderOptions(){if(!this.state.shouldShowOptions)return null;const e=this.container.current;if(!e)return null;const t=e.getBoundingClientRect(),r={position:"absolute",left:t.left,top:t.top+t.height+3};this.props.dropdownAutoWidth||(r.width=t.width);const n=a.default.createElement("div",{className:"option-list",style:r},this.props.options.map((e,t)=>this.renderOneOption(e,t,this.state.text===this.props.stringifyOption(e))));return o.default.createPortal(n,this.getDropDownMountPoint())}render(){return a.default.createElement("div",{className:l.cn("select-input",{opened:this.state.shouldShowOptions}),ref:this.container},a.default.createElement(i.Input,{ref:this.input,disabled:this.props.disabled,placeholder:this.props.placeholder,value:this.state.text,onFocus:this.onFocus,onBlur:this.onBlur,onClick:this.onFocus,onChange:this.onTextChange,onKeyDown:this.onKeyDown}),a.default.createElement("span",{className:"arrow-icon ant-select-arrow",onClick:this.onToggle}),this.renderOptions())}}t.SelectInput=u,u.defaultProps={disabled:!1,dropdownAutoWidth:!1};class d extends a.default.Component{constructor(){super(...arguments),this.onClick=e=>{this.props.onItemClick(e,this.props.item,this.props.index)}}render(){return a.default.createElement("div",{className:l.cn("plain-text-option",{selected:this.props.selected}),onMouseDown:this.onClick},this.props.text)}}},645:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=n(r(1)),i=r(18),s=r(117),c=r(12),l=r(515),u=r(43),d=r(4);var m;!function(e){e.Command="command"}(m||(m={}));class p extends a.default.Component{constructor(){super(...arguments),this.onClick=e=>{this.props.onClick(e,this.props.command)},this.onContextMenu=e=>{this.props.onContextMenu(e,this.props.command)}}render(){const{index:e,command:t,editable:r,isDragging:n,connectDropTarget:o,connectDragSource:i}=this.props,l=c.compose(i,o),m=t.description&&t.description.length>0;return l(a.default.createElement("div",Object.assign({},this.props.attributes,{style:this.props.style,className:d.cn(this.props.className||"",{dragging:n}),onClick:this.onClick,onContextMenu:this.onContextMenu}),a.default.createElement("div",{className:"row-col index-col"},e),a.default.createElement("div",{className:"row-col command-col",title:u.commandText(t.cmd)},c.repeatStr(2*t.indent," "),u.commandText(t.cmd)),a.default.createElement("div",{className:"row-col target-col",title:t.target,onMouseEnter:e=>this.props.onMouseEnterTarget(e,t),onMouseLeave:e=>this.props.onMouseLeaveTarget(e,t)},t.target),a.default.createElement("div",{className:"row-col value-col",title:t.value},t.value),a.default.createElement("div",{className:"row-col op-col"},m?a.default.createElement(s.Tooltip,{title:t.description},a.default.createElement(s.Button,{disabled:!r,type:"primary",shape:"circle",size:"small",onClick:e=>{this.props.onToggleComment(e,t),e.stopPropagation()}},"//")):a.default.createElement(s.Button,{disabled:!r,shape:"circle",size:"small",onClick:e=>{this.props.onToggleComment(e,t),e.stopPropagation()}},"//"),a.default.createElement(s.Button,{disabled:!r,shape:"circle",size:"small",onClick:e=>{this.props.onDuplicate(e,t),e.stopPropagation()}},a.default.createElement(s.Icon,{type:"plus"})))))}}p.propTypes={style:o.default.object,className:o.default.string,attributes:o.default.object,command:o.default.object.isRequired,editable:o.default.bool.isRequired,onClick:o.default.func.isRequired,onContextMenu:o.default.func.isRequired,onMouseEnterTarget:o.default.func.isRequired,onMouseLeaveTarget:o.default.func.isRequired,onToggleComment:o.default.func.isRequired,onDuplicate:o.default.func.isRequired,onMoveCommand:o.default.func.isRequired,onDragStart:o.default.func.isRequired,onDragEnd:o.default.func.isRequired},p.defaultProps={style:{},attributes:{},className:""},t.CommandItem=c.compose(l.DragSource(m.Command,{beginDrag:e=>({index:e.command.realIndex}),isDragging:(e,t)=>t.getItem().index===e.command.realIndex},(e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()})),l.DropTarget(m.Command,{hover:(e,t,r)=>{if(!r)return;const n=t.getItem().index,a=e.command.realIndex;if(n===a)return;const o=i.findDOMNode(r).getBoundingClientRect(),s=o.height/2,c=t.getClientOffset();if(!c)return;const l=c.y-o.top;n<a&&l<s||n>a&&l>s||(e.onMoveCommand(n,a),t.getItem().index=a)}},e=>({connectDropTarget:e.dropTarget()})))(p)},646:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(117),i=r(76);class s extends a.default.PureComponent{render(){const e={columns:[{title:"Name",dataIndex:"name",key:"name"},{title:"Size",dataIndex:"size",key:"size",render:e=>i.readableSize(e)},{title:"Last Modified",dataIndex:"createTime",key:"createTime",render:e=>{const t=e=>e>=10?""+e:"0"+e;return`${e.getFullYear()}/${t(e.getMonth()+1)}/${t(e.getDate())} ${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`}},{title:"Action",key:"ops",width:100,render:(e,t,r)=>a.default.createElement("div",null,a.default.createElement(o.Button,{size:"small",shape:"circle",onClick:e=>{this.props.viewCSV(t)}},a.default.createElement(o.Icon,{type:"eye-o"})),a.default.createElement(o.Button,{size:"small",type:"primary",shape:"circle",onClick:()=>{this.props.downloadCSV(t)}},a.default.createElement(o.Icon,{type:"download"})),a.default.createElement(o.Popconfirm,{title:"Sure to delete?",okText:"Delete",onConfirm:()=>{this.props.removeCSV(t)}},a.default.createElement(o.Button,{size:"small",type:"danger",shape:"circle"},a.default.createElement(o.Icon,{type:"close"}))))}],dataSource:this.props.list,pagination:!1,bordered:!0,size:"middle",rowKey:"fullPath",onRowClick:()=>{},rowClassName:()=>""};return a.default.createElement(o.Table,Object.assign({},e))}}t.CsvList=s},647:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(117),i=r(620),s=n(r(619)),c=r(13);class l extends a.default.PureComponent{render(){if(!this.props.intersectRoot)return null;const e=[{title:"Image",dataIndex:"fullPath",key:"fullPath",width:116,render:e=>a.default.createElement(i.LazyImage,{type:"vision",root:this.props.intersectRoot,width:100,height:100,defaultUrl:"",getUrl:()=>c.getStorageManager().getVisionStorage().getLink(e)})},{title:"Name",dataIndex:"name",key:"name",render:(e,t)=>a.default.createElement("div",{className:"vision-name-1",id:e},a.default.createElement(s.default,{value:t.name,onChange:e=>Promise.resolve(this.props.renameVision(t.name,e)),checkValue:e=>this.props.isNameValid(e),getSelection:(e,t)=>{const r=/(?:_dpi_\d+)?\.png$/i.exec(e);return r?{start:0,end:r.index}:null}}))},{title:"Action",key:"ops",width:100,render:(e,t,r)=>a.default.createElement("div",{className:"vision-actions"},a.default.createElement(o.Button,{size:"small",shape:"circle",onClick:e=>{this.props.viewVision(t.name)}},a.default.createElement(o.Icon,{type:"eye-o"})),a.default.createElement(o.Dropdown,{overlay:a.default.createElement(o.Menu,{onClick:({key:e})=>{switch(e){case"duplicate":return this.props.duplicateVision(t.name);case"name_to_target":return this.props.copyNameToTarget(t.name);case"delete":return this.props.deleteVision(t.name)}}},a.default.createElement(o.Menu.Item,{key:"duplicate"},"Duplicate"),a.default.createElement(o.Menu.Item,{key:"name_to_target"},"Add name to target box"),a.default.createElement(o.Menu.Divider,null),a.default.createElement(o.Menu.Item,{key:"delete"},"Delete"))},a.default.createElement(o.Button,{size:"small",shape:"circle"},a.default.createElement(o.Icon,{type:"bars"}))))}],t=(this.props.query||"").toLowerCase().trim(),r={columns:e,dataSource:this.props.visions.filter(e=>0===t.length||-1!==e.name.toLowerCase().indexOf(t)),pagination:!1,bordered:!0,size:"middle",rowKey:e=>e.fullPath+"__"+e.createTime.getTime(),onRowClick:()=>{},rowClassName:()=>""};return a.default.createElement(o.Table,Object.assign({},r))}}t.VisionList=l},648:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=r(620),i=r(13);class s extends a.default.PureComponent{render(){return a.default.createElement("ul",{className:"screenshot-content"},this.props.screenshots.map((e,t)=>a.default.createElement("li",{key:e.createTime+"_"+e.createTime},a.default.createElement("span",{className:"timestamp"},e.createTime&&e.createTime.toLocaleString()," - ",a.default.createElement("span",{className:"filename"},decodeURIComponent(e.name))),a.default.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),this.props.downloadScreenshot(e.name,e.fullPath)}},a.default.createElement(o.LazyImage,{type:"screenshot",root:this.props.intersectRoot,width:200,height:200,defaultUrl:"",getUrl:()=>i.getStorageManager().getScreenshotStorage().getLink(e.fullPath)})))))}}t.ScreenshotList=s},69:function(e,t,r){"use strict";r.r(t),r.d(t,"stringifyTestSuite",(function(){return c})),r.d(t,"parseTestSuite",(function(){return l})),r.d(t,"validateTestSuiteText",(function(){return u})),r.d(t,"toBookmarkData",(function(){return d})),r.d(t,"toHtml",(function(){return m}));r(108);var n=r(66),a=r.n(n),o=r(4),i=r(13),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=s({creationDate:Object(o.formatDate)(new Date),name:e.name,macros:e.cases.map((function(e){var t=parseInt(e.loops,10);return{macro:e.testCaseId,loops:t}}))},t.withFold?{fold:!!e.fold}:{},t.withId&&e.id?{id:e.id}:{},t.withPlayStatus&&e.playStatus?{playStatus:e.playStatus}:{});return JSON.stringify(r,null,2)},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a()(e.replace(/^\s*/,""));if("string"!=typeof r.name||0===r.name.length)throw new Error("name must be a string");if(!Array.isArray(r.macros))throw new Error("macros must be an array");var n=r.macros.map((function(e){return("number"!=typeof e.loops||e.loops<1)&&(e.loops=1),{testCaseId:e.macro,loops:e.loops}})),o=s({cases:n,name:t.fileName?t.fileName.replace(/\.json$/i,""):r.name},t.withFold?{fold:void 0===r.fold||r.fold}:{},t.withId&&r.id?{id:r.id}:{},t.withPlayStatus&&r.playStatus?{playStatus:r.playStatus}:{});return o},u=l,d=function(e){var t=e.name,r=e.bookmarkTitle;if(!t)throw new Error("name is required to generate bookmark for test suite");if(!r)throw new Error("bookmarkTitle is required to generate bookmark for test suite");return{title:r,url:("javascript:\n      (function() {\n        try {\n          var evt = new CustomEvent('kantuRunTestSuite', {\n            detail: {\n              name: '"+t+"',\n              from: 'bookmark',\n              storageMode: '"+Object(i.getStorageManager)().getCurrentStrategyType()+"',\n              closeRPA: 1\n            }\n          });\n          window.dispatchEvent(evt);\n        } catch (e) {\n          alert('UI.Vision RPA Bookmarklet error: ' + e.toString());\n        }\n      })();\n    ").replace(/\n\s*/g,"")}},m=function(e){var t=e.name;return'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n<head>\n<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n<title>'+t+"</title>\n</head>\n<body>\n<h1>"+t+"</h1>\n<script>\n(function() {\n  var isExtensionLoaded = function () {\n    const $root = document.documentElement\n    return !!$root && !!$root.getAttribute('data-kantu')\n  }\n  var increaseCountInUrl = function (max) {\n    var url   = new URL(window.location.href)\n    var count = 1 + (url.searchParams.get('reload') || 0)\n\n    url.searchParams.set('reload', count)\n    var nextUrl = url.toString()\n\n    var shouldStop = count > max\n    return [shouldStop, !shouldStop ? nextUrl : null]\n  }\n  var run = function () {\n    try {\n      var evt = new CustomEvent('kantuRunTestSuite', { detail: { name: '"+t+"', from: 'html', storageMode: '"+Object(i.getStorageManager)().getCurrentStrategyType()+"' } })\n\n      window.dispatchEvent(evt)\n      var intervalTimer = setInterval(() => window.dispatchEvent(evt), 1000);\n\n      if (window.location.protocol === 'file:') {\n        var onInvokeSuccess = function () {\n          clearTimeout(timer)\n          clearTimeout(reloadTimer)\n          clearInterval(intervalTimer)\n          window.removeEventListener('kantuInvokeSuccess', onInvokeSuccess)\n        }\n        var timer = setTimeout(function () {\n          alert('Error #201: It seems you need to turn on *Allow access to file URLs* for Kantu in your browser extension settings.')\n        }, 8000)\n\n        window.addEventListener('kantuInvokeSuccess', onInvokeSuccess)\n      }\n    } catch (e) {\n      alert('UI.Vision RPA Bookmarklet error: ' + e.toString());\n    }\n  }\n  var main = function () {\n    if (isExtensionLoaded())  return run()\n\n    var MAX_TRY   = 3\n    var INTERVAL  = 1000\n    var tuple     = increaseCountInUrl(MAX_TRY)\n\n    if (tuple[0]) {\n      return alert('Error #202: It seems UI.Vision RPA is not installed yet, *or* you need to turn on *Allow access to file URLs* for UI.Vision RPA.')\n    } else {\n      setTimeout(function () {\n        window.location.href = tuple[1]\n      }, INTERVAL)\n    }\n  }\n\n  main()\n})();\n<\/script>\n</body>\n</html>\n  "}},70:function(e,t,r){var n,a=a||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,r=function(){return e.URL||e.webkitURL||e},n="moz-extension:"===window.location.protocol?function(){var e=t.createElementNS("http://www.w3.org/1999/xhtml","iframe");e.id="downloadFrame",e.style.visibility="hidden",e.style.position="absolute",e.style.left="-999px",t.body.appendChild(e);var r=e.contentDocument.createElement("a");return setTimeout((function(){e.contentDocument.body.appendChild(r)})),r}():t.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in n,o=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},c=function(e){setTimeout((function(){"string"==typeof e?r().revokeObjectURL(e):e.remove()}),4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=function(t,u,d){d||(t=l(t));var m,p=this,h="application/octet-stream"===t.type,f=function(){!function(e,t,r){for(var n=(t=[].concat(t)).length;n--;){var a=e["on"+t[n]];if("function"==typeof a)try{a.call(e,r||e)}catch(e){s(e)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,a)return m=r().createObjectURL(t),void setTimeout((function(){var e,t;n.href=m,n.download=u,e=n,t=new MouseEvent("click"),e.dispatchEvent(t),f(),c(m),p.readyState=p.DONE}));!function(){if((i||h&&o)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,f()},n.readAsDataURL(t),void(p.readyState=p.INIT)}(m||(m=r().createObjectURL(t)),h)?e.location.href=m:e.open(m,"_blank")||(e.location.href=m);p.readyState=p.DONE,f(),c(m)}()},d=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=l(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(e,t,r){return new u(e,t||e.name||"download",r)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */e.exports?e.exports.saveAs=a:null!==r(551)&&null!==r(433)&&(void 0===(n=function(){return a}.call(t,r,t,e))||(e.exports=n))},71:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=n(r(18)),i=n(r(1)),s=r(117),c=n(r(406)),l=r(12);var u,d;!function(e){e.Divider="divider",e.Button="button"}(u=t.MenuItemType||(t.MenuItemType={})),function(e){e[e.Hidden=0]="Hidden",e[e.Transparent=1]="Transparent",e[e.Visible=2]="Visible"}(d=t.ContextMenuDisplayStatus||(t.ContextMenuDisplayStatus={}));class m extends a.default.Component{constructor(){super(...arguments),this.$container=null,this.state={isCollectingSize:!1,status:d.Transparent,size:{width:0,height:0}},this.hide=()=>{this.props.onHide()},this.onClick=e=>{const t=this.findMenuItem(e.key);if(t)switch(t.type){case u.Button:{const{context:r,onClick:n}=t.data;try{n(e.domEvent,r)}catch(e){console.warn(e)}finally{this.hide()}break}case u.Divider:}}}findMenuItem(e){return this.props.menuItems.find((t,r)=>this.getId(t,r)===e)}getId(e,t){return e.id+"_"+t}getContextMenuStyle(){const{status:e}=this.state,t=(()=>{switch(e){case d.Hidden:return{display:"none"};case d.Transparent:return{top:0,left:0,visibility:"hidden"};case d.Visible:{const e=l.pointToFitRect({bound:{x:0,y:0,width:window.innerWidth,height:window.innerHeight},size:this.state.size,point:{x:this.props.x,y:this.props.y}});return{top:e.y+"px",left:e.x+"px"}}}})();return Object.assign(Object.assign({},{position:"fixed"}),t)}collectSize(){this.setState({isCollectingSize:!0}),setTimeout(()=>{this.$container&&this.setState({isCollectingSize:!1,status:d.Visible,size:{width:this.$container.offsetWidth,height:this.$container.offsetHeight}})},100)}componentDidMount(){this.state.isCollectingSize||this.state.status!==d.Transparent||this.collectSize()}render(){return a.default.createElement("div",{ref:e=>{this.$container=e},style:this.getContextMenuStyle(),className:"context-menu"},a.default.createElement(c.default,{onClickOutside:this.hide},a.default.createElement(s.Menu,{onClick:this.onClick,style:{width:this.props.width+"px"},mode:"vertical",selectable:!1},this.props.menuItems.map((e,t)=>{switch(e.type){case u.Divider:return a.default.createElement(s.Menu.Divider,{key:this.getId(e,t)});case u.Button:return a.default.createElement(s.Menu.Item,{key:this.getId(e,t),disabled:!!e.disabled},e.data.content);default:return null}}))))}}t.ContextMenu=m,m.propTypes={menuItems:i.default.array.isRequired,onHide:i.default.func.isRequired,width:i.default.number},m.defaultProps={width:230},t.showContextMenu=function(e){const t=document.createElement("div");(function(){const e="__kantu_context_menus__",t=document.getElementById(e);if(t)return t;const r=document.createElement("div");return r.id=e,document.body.appendChild(r),r})().appendChild(t),setTimeout(()=>{o.default.render(a.default.createElement(m,Object.assign({},e,{onHide:()=>{setTimeout(()=>{t.remove()}),e.onHide()}})),t)},20)}},74:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(90),a=r(91),o=r(12);class i extends n.XModule{getName(){return n.XModuleTypes.XDesktop}getAPI(){return a.getNativeCVAPI()}initConfig(){return this.getConfig()}sanityCheck(){return Promise.all([this.getConfig(),this.getAPI().getVersion().then(()=>this.getAPI(),()=>this.getAPI().reconnect()).catch(e=>{throw new Error("Error #301: Visual Desktop Automation XModule is not installed yet")})]).then(()=>!0)}checkUpdate(){return Promise.reject(new Error("checkUpdate is not implemented yet"))}checkUpdateLink(e,t){return`https://ui.vision/x/idehelp?help=xdesktop_updatecheck&xversion=${e}&kantuversion=${t}`}downloadLink(){return"https://ui.vision/x/idehelp?help=xdesktop_download"}infoLink(){return"https://ui.vision/x/idehelp?help=xdesktop"}}t.XDesktop=i,t.getXDesktop=o.singletonGetter(()=>new i)},75:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(90),a=r(12),o=r(359);class i extends n.XModule{getName(){return n.XModuleTypes.XScreenCapture}getAPI(){return o.getNativeScreenCapture()}initConfig(){return this.getConfig()}sanityCheck(){return Promise.all([this.getConfig(),this.getAPI().getVersion().catch(e=>{throw new Error("Error #301: Screen Capture XModule is not installed yet")})]).then(()=>!0)}checkUpdate(){return Promise.reject(new Error("checkUpdate is not implemented yet"))}checkUpdateLink(e,t){return`https://ui.vision/x/idehelp?help=xscreencapture_updatecheck&xversion=${e}&kantuversion=${t}`}downloadLink(){return"https://ui.vision/x/idehelp?help=xscreencapture_download"}infoLink(){return"https://ui.vision/x/idehelp?help=xscreencapture"}}t.XScreenCapture=i,t.getXScreenCapture=a.singletonGetter(()=>new i)},76:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(81)),o=r(79),i=r(4),s=r(12);var c;!function(e){e.ListChanged="list_changed",e.FilesChanged="files_changed"}(c=t.FlatStorageEvent||(t.FlatStorageEvent={}));class l extends a.default{constructor(e={}){super(),this.encode=(e,t)=>e,this.decode=(e,t)=>e,this.emitListChanged=o(()=>{this.list().then(e=>{this.emit(c.ListChanged,e)})},100),this.changedFileNames=[],this.__emitFilesChanged=o(()=>{const e=this.changedFileNames;return this.changedFileNames=[],Promise.all(e.map(e=>this.read(e,"Text").catch(()=>null))).then(t=>{if(0===t.length)return;const r=t.map((t,r)=>({content:t,fileName:e[r]})).filter(e=>!!e.content);this.emit(c.FilesChanged,r)})},100),e.decode&&(this.decode=e.decode),e.encode&&(this.encode=e.encode)}list(){return this.__list().then(e=>(e.sort((e,t)=>{const r=e.fileName.toLowerCase(),n=t.fileName.toLowerCase();return r<n?-1:r>n?1:0}),e))}readAll(e="Text",t){return this.list().then(t=>Promise.all(t.map(t=>this.read(t.fileName,e).then(e=>({content:e,fileName:t.fileName})))))}bulkWrite(e){return Promise.all(e.map(e=>this.write(e.fileName,e.content))).then(()=>{})}write(e,t){return this.exists(e).then(r=>this.__write(e,t).then(()=>{r||this.emitListChanged(),this.emitFilesChanged([e])}))}overwrite(e,t){return this.__overwrite(e,t).then(()=>{this.emitFilesChanged([e])})}clear(){return this.__clear().then(()=>{this.emitListChanged()})}remove(e){return this.__remove(e).then(()=>{this.emitListChanged()})}rename(e,t){return this.__rename(e,t).then(()=>{this.emitListChanged(),this.emitFilesChanged([t])})}copy(e,t){return(t&&t.length?Promise.resolve(t):s.uniqueName(e,{generate:(e,t=1)=>{const r=/-(\d+)$/;return e.match(r)?e.replace(r,(e,r)=>`-${parseInt(r,10)+t}`):`${e}-${t}`},check:e=>this.exists(e).then(e=>!e),postfixReg:/(_relative)?\.\w+$/})).then(t=>this.__copy(e,t).then(()=>{this.emitListChanged(),this.emitFilesChanged([t])}))}emitFilesChanged(e){this.changedFileNames=e.reduce((e,t)=>(-1===e.indexOf(t)&&e.push(t),e),this.changedFileNames),this.__emitFilesChanged()}}t.FlatStorage=l,t.readableSize=e=>e<1024?e+" byte":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",t.checkFileName=function(e){i.withFileExtension(e,t=>{try{i.validateStandardName(t,!0)}catch(t){throw new Error(`Invalid file name '${e}'. File name `+t.message)}return t})}},84:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Enterprise="ui-ee",e.Personal="ui-personal",e.Player="ui-player",e.Pro="ui-pro"}(t.LicenseType||(t.LicenseType={})),function(e){e[e.Replay=0]="Replay",e[e.Record=1]="Record",e[e.Edit=2]="Edit"}(t.Feature||(t.Feature={}))},87:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){let t,r,n;!function(e){e.DisplayVisualResult="display_visual_result",e.DisplayOcrResult="display_ocr_result",e.Capture="capture"}(t=e.RequestType||(e.RequestType={})),function(e){e[e.Storage=0]="Storage",e[e.HardDrive=1]="HardDrive",e[e.CV=2]="CV",e[e.DataUrl=3]="DataUrl"}(r=e.ImageSource||(e.ImageSource={})),function(e){e[e.Match=0]="Match",e[e.Reference=1]="Reference",e[e.BestMatch=2]="BestMatch",e[e.ReferenceOfBestMatch=3]="ReferenceOfBestMatch"}(n=e.RectType||(e.RectType={}))}(t.DesktopScreenshot||(t.DesktopScreenshot={}))},88:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(90),a=r(58),o=r(12);class i extends n.XModule{getName(){return n.XModuleTypes.XUserIO}getAPI(){return a.getNativeXYAPI()}initConfig(){return this.getConfig()}sanityCheck(){return Promise.all([this.getConfig(),this.getAPI().getVersion().then(()=>this.getAPI(),()=>this.getAPI().reconnect()).catch(e=>{throw new Error("Error #301: RealUser Simulation XModule is not installed yet")})]).then(()=>!0)}checkUpdate(){return Promise.reject(new Error("checkUpdate is not implemented yet"))}checkUpdateLink(e,t){return`https://ui.vision/x/idehelp?help=xclick_updatecheck&xversion=${e}&kantuversion=${t}`}downloadLink(){return"https://ui.vision/x/idehelp?help=xclick_download"}infoLink(){return"https://ui.vision/x/idehelp?help=xclick"}}t.XUserIO=i,t.getXUserIO=o.singletonGetter(()=>new i)},89:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(81)),o=r(79),i=r(12),s=r(27),c=r(122);var l,u;!function(e){e.ListChanged="list_changed",e.FilesChanged="files_changed"}(l=t.StorageEvent||(t.StorageEvent={})),function(e){e[e.Unknown=0]="Unknown",e[e.NonExistent=1]="NonExistent",e[e.File=2]="File",e[e.Directory=3]="Directory"}(u=t.EntryStatus||(t.EntryStatus={}));class d extends a.default{constructor(e={}){super(),this.encode=(e,t)=>e,this.decode=(e,t)=>e,this.displayedCount=0,this.totalCount=0,this.listFilter=e=>e,this.emitListChanged=o(()=>{this.list("/").then(e=>{this.emit(l.ListChanged,e)})},100),this.changedFileNames=[],this.__emitFilesChanged=o(()=>{const e=this.changedFileNames;return this.changedFileNames=[],Promise.all(e.map(e=>this.read(e,"Text").catch(()=>null))).then(t=>{if(0===t.length)return;const r=t.map((t,r)=>({content:t,fileName:e[r]})).filter(e=>!!e.content);this.emit(l.FilesChanged,r)})},100),e.decode&&(this.decode=e.decode),e.encode&&(this.encode=e.encode),e.listFilter&&(this.listFilter=e.listFilter)}getPathLib(){return this.isWin32Path()?s.win32:s.posix}relativePath(e,t){const r=t?this.dirPath(e):this.filePath(e),n=this.dirPath("/");return this.getPathLib().relative(n,r)}entryPath(e,t){return t?this.dirPath(e):this.filePath(e)}list(e="/",t=!1){return this.__list(e,t).then(e=>this.sortEntries(e))}listR(e="/"){const t=e=>this.list(e,!1).then(e=>Promise.all(e.map(e=>e.isDirectory?t(e.fullPath):Promise.resolve(null))).then(t=>this.sortEntries(e.map((e,r)=>Object.assign(Object.assign({},e),{children:t[r]||[]})))));return t(e).then(t=>"/"!==e?t:Promise.resolve(this.listFilter(t)).then(e=>(this.totalCount=i.sum(...t.map(i.nodeCount)),this.displayedCount=i.sum(...e.map(i.nodeCount)),e)))}getDisplayCount(){return this.displayedCount}getTotalCount(){return this.totalCount}exists(e){return this.stat(e).then(({isFile:e,isDirectory:t})=>e||t,()=>!1)}fileExists(e){return this.stat(e).then(e=>e.isFile,()=>!1)}directoryExists(e){return this.stat(e,!0).then(e=>e.isDirectory,()=>!1)}readR(e,t="Text",r){return this.listR(e).then(e=>Promise.all(e.map(e=>{if(e.isFile)return this.read(e.fullPath,t).then(t=>[{content:t,filePath:e.fullPath}]);if(e.isDirectory)return this.readR(e.fullPath,t);throw new Error("Not file or directory")})).then(e=>i.flatten(e)))}write(e,t){return this.exists(e).then(r=>this.__write(e,t).then(()=>{r||this.emitListChanged(),this.emitFilesChanged([e])}))}overwrite(e,t){return this.__overwrite(e,t).then(()=>{this.emitFilesChanged([e])})}bulkWrite(e){return Promise.all(e.map(e=>this.write(e.filePath,e.content))).then(()=>{})}removeFile(e){return this.__removeFile(e).then(()=>{this.emitListChanged()})}removeEmptyDirectory(e){return this.__removeEmptyDirectory(e).then(()=>{this.emitListChanged()})}removeDirectory(e){return this.remove(e,!0)}remove(e,t){return this.stat(e,t).then(e=>{if(e.isFile)return this.removeFile(e.fullPath);if(e.isDirectory)return this.list(e.fullPath).then(t=>Promise.all(t.map(e=>this.remove(e.fullPath,e.isDirectory))).then(()=>this.removeEmptyDirectory(e.fullPath)));throw new Error("Not file or directory")})}clear(){return this.list("/").then(e=>Promise.all(e.map(e=>this.remove(e.fullPath))).then(()=>{}))}moveFile(e,t){return this.__moveFile(e,t).then(()=>{this.emitListChanged()})}copyFile(e,t){return this.__copyFile(e,t).then(()=>{this.emitListChanged()})}moveDirectory(e,t){return this.move(e,t,!0,!0)}copyDirectory(e,t){return this.copy(e,t,!0,!0)}move(e,t,r,n){const a=this.entryPath(e,r),o=this.entryPath(t,n);if(a===o)throw new Error("move: src should not be the same as dst");if(this.getPathLib().dirname(a)===o)throw new Error("move: cannot move to original dir");if(r&&n&&this.isTargetInSourceDirectory(t,e))throw new Error("Cannot move a directory into its sub directory");return this.copy(e,t,r,n).then(()=>this.remove(e,r))}copy(e,t,r,n){const a=this.getPathLib().dirname(e)===this.getPathLib().dirname(t);if(e===t)throw new Error("copy: dst should not be the same as src");return Promise.all([this.getEntryStatus(e,r),this.getEntryStatus(t,n),a?Promise.resolve(u.Directory):this.getEntryStatus(this.getPathLib().dirname(t),!0)]).then(r=>{const[n,a,o]=r;if(o!==u.Directory)throw new c.ENOTDIR(this.getPathLib().dirname(t));switch(n){case u.NonExistent:throw new c.ENOENT(e);case u.Unknown:throw new Error(`source (${e}) exists but is neither a file nor a directory`);case u.File:switch(a){case u.File:throw new c.EEXIST(t);case u.Unknown:throw new Error(`dst '${t}' is neither a file nor directory`);case u.Directory:{const r=this.getPathLib().resolve(t,this.getPathLib().basename(e));return this.copyFile(e,r)}case u.NonExistent:return this.copyFile(e,t)}case u.Directory:switch(a){case u.File:throw new Error(`dst '${t}' is an existing file, but src '${e}' is a directory`);case u.Unknown:throw new Error(`dst '${t}' is neither a file nor directory`);case u.Directory:{if(this.isTargetInSourceDirectory(t,e))throw new Error("Cannot copy a directory into its sub directory");const r=this.getPathLib().resolve(t,this.getPathLib().basename(e));return this.ensureDirectory(r).then(()=>this.copyAllInDirectory(e,r))}case u.NonExistent:return this.ensureDirectory(t).then(()=>this.copyAllInDirectory(e,t))}}})}createDirectory(e){return this.mkdir(e,!1)}ensureDirectory(e){return this.getEntryStatus(e,!0).then(t=>{switch(t){case u.File:case u.Unknown:throw new c.EEXIST;case u.Directory:return;case u.NonExistent:return this.mkdir(e,!0)}})}ensureDir(){return this.ensureDirectory("/")}rename(e,t){return this.move(e,t)}readAll(e="Text",t){return this.list("/").then(r=>Promise.all(r.filter(e=>e.isFile).map(t=>this.read(t.fullPath,e).then(e=>({content:e,fileName:t.name})).catch(e=>({fileName:t.name,fullFilePath:t.fullPath,error:new Error(`Error in parsing ${t.fullPath}:\n${e.message}`)})))).then(e=>{const r=e.filter(e=>e.error);return t&&t(r),e.filter(e=>e.content)}))}isTargetInSourceDirectory(e,t){const r=this.dirPath(e),n=this.dirPath(t),a=this.getPathLib().sep;return-1===this.getPathLib().relative(n,r).split(a).indexOf("..")}sortEntries(e){const t=[...e];return t.sort((e,t)=>{if(e.isDirectory&&t.isFile)return-1;if(e.isFile&&t.isDirectory)return 1;const r=e.name.toLowerCase(),n=t.name.toLowerCase();return r<n?-1:r>n?1:0}),t}copyAllInDirectory(e,t){return this.list(e).then(e=>Promise.all(e.map(e=>{if(e.isFile)return this.copyFile(e.fullPath,this.getPathLib().resolve(t,e.name));if(e.isDirectory){const r=this.getPathLib().resolve(t,e.name);return this.ensureDirectory(r).then(()=>this.copyAllInDirectory(e.fullPath,r))}return Promise.resolve()})).then(()=>{}))}mkdir(e,t=!1){return(()=>t?Promise.resolve():this.getEntryStatus(e,!0).then(t=>{if(t!==u.NonExistent)throw new c.EEXIST(e)}))().then(()=>{const t=this.getPathLib().dirname(e);return"/"===t?this.__createDirectory(e):this.getEntryStatus(t,!0).then(r=>{switch(r){case u.File:case u.Unknown:throw new c.EEXIST(t);case u.Directory:return this.__createDirectory(e);case u.NonExistent:return this.mkdir(t,!0).then(()=>this.__createDirectory(e))}})}).then(()=>{this.emitListChanged()})}getEntryStatus(e,t){return this.stat(e,t).then(e=>e.isFile?u.File:e.isDirectory?u.Directory:u.NonExistent,e=>u.NonExistent)}emitFilesChanged(e){this.changedFileNames=e.reduce((e,t)=>(-1===e.indexOf(t)&&e.push(t),e),this.changedFileNames),this.__emitFilesChanged()}}t.StandardStorage=d},90:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(36));!function(e){e.XFile="xFile",e.XUserIO="xClick",e.XDesktop="xDesktop",e.XScreenCapture="xScreenCapture"}(t.XModuleTypes||(t.XModuleTypes={}));t.XModule=class{constructor(){this.cachedConfig={},this.initConfig()}getVersion(){return this.getAPI().reconnect().catch(e=>{throw new Error(`${this.getName()} is not installed yet`)}).then(e=>e.getVersion().then(e=>({version:e,installed:!0}))).catch(e=>({installed:!1}))}setConfig(e){return this.cachedConfig=Object.assign(Object.assign({},this.cachedConfig),e),this.getConfig().then(t=>{const r=Object.assign(Object.assign({},t),e);return a.default.set(this.getStoreKey(),r).then(e=>(e&&(this.cachedConfig=r),e))})}getConfig(){return a.default.get(this.getStoreKey()).then(e=>(this.cachedConfig=e||{},this.cachedConfig))}getCachedConfig(){return this.cachedConfig}getStoreKey(){return this.getName().toLowerCase()}}},91:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(344),o=r(12),i=r(345),s=r(346),c=r(4),l=r(22),u=n(r(11)),d=n(r(27));function m(e){switch(e.errorCode){case 0:return e;case 2:throw new Error("Cannot find green and/or pink boxes");case 3:throw new Error("Pattern image contains green box but does not contain pink box");case 4:throw new Error("Pattern image contains more than one green box");case 5:throw new Error("Pattern image contains more than one pink box");case 1:throw new Error("Unspecified error has occured");default:throw new Error(`Unknown error code ${e.errorCode}`)}}function p(e,t,r){const n=e.width,a=e.height,o=e.data,i=new Uint8Array(n*a*3);for(let e=0;e<a;++e)for(let t=0;t<n;++t){const r=e*n+t,a=3*r,s=4*r;i[a+0]=o[s+0],i[a+1]=o[s+1],i[a+2]=o[s+2]}return{width:n,height:a,dpiX:t,dpiY:r,data:s.base64.encode(i)}}function h(e,t,r){return l.imageDataFromUrl(e).then(e=>p(e,t,r))}t.getNativeCVAPI=o.singletonGetter(()=>{const e=new i.KantuCVHost;let t=e.connectAsync().catch(e=>{throw u.default.warn("pReady - error",e),e});const r=a.MethodTypeInvocationNames.reduce((n,a)=>{const i=o.snakeToCamel(a);return n[i]=n=>t.then(()=>e.invokeAsync(a,n).catch(e=>{if(r.reconnect().catch(()=>{}),"captureDesktop"===i){const e=n.path;if(e&&/[\\/]/.test(e))throw new Error(`Failed to captureDesktop, please confirm directory exists at '${d.default.dirname(e)}'`)}throw e})),n},{reconnect:()=>(e.disconnect(),t=e.connectAsync(),t.then(()=>r)),searchDesktopWithGuard:e=>r.searchDesktop(e).then(m),getImageFromDataUrl:(e,t)=>r.getImageInfo({content:(e=>{const t=e.indexOf("base64,");return-1===t?e:e.substr(t+"base64,".length)})(e)}).then(r=>{const n=r.dpiX||t||96,a=r.dpiY||t||96;return h(e,n,a)}),readFileAsArrayBuffer:e=>{const t=r,n=(e,r=1/0,a=0,o=[])=>t.readFileRange({rangeStart:a,path:e}).then(t=>{const a=t.rangeEnd>t.rangeStart?o.concat([t.buffer]):o;return t.rangeEnd>=r||t.rangeEnd<=t.rangeStart?a:n(e,r,t.rangeEnd,a)});return t.getFileSize({path:e}).then(t=>n(e,t,0,[])).then(e=>o.concatUint8Array(...e.map(e=>new Uint8Array(c.dataURItoArrayBuffer(e)))).buffer)},readFileAsBlob:e=>r.readFileAsArrayBuffer(e).then(e=>new Blob([e])),readFileAsDataURL:(e,t=!0)=>r.readFileAsBlob(e).then(e=>c.blobToDataURL(e,t)),readFileAsText:e=>r.readFileAsBlob(e).then(e=>c.blobToText(e)),readFileAsBinaryString:e=>r.readFileAsArrayBuffer(e).then(e=>c.arrayBufferToString(e))});return r}),t.guardSearchResult=m,t.convertImageSearchResult=function(e,t=1,r){const{errorCode:n,containsGreenPinkBoxes:a,regions:o}=e;return o.map(e=>(e=>{var n,a;const o=null!==(n=null==r?void 0:r.x)&&void 0!==n?n:0,i=null!==(a=null==r?void 0:r.y)&&void 0!==a?a:0;return e.relativeRect?{matched:{offsetLeft:t*e.relativeRect.x-t*o,offsetTop:t*e.relativeRect.y-t*i,viewportLeft:t*e.relativeRect.x,viewportTop:t*e.relativeRect.y,pageLeft:t*e.relativeRect.x,pageTop:t*e.relativeRect.y,width:t*e.relativeRect.width,height:t*e.relativeRect.height,score:e.score},reference:{offsetLeft:t*e.matchedRect.x-t*o,offsetTop:t*e.matchedRect.y-t*i,viewportLeft:t*e.matchedRect.x,viewportTop:t*e.matchedRect.y,pageLeft:t*e.matchedRect.x,pageTop:t*e.matchedRect.y,width:t*e.matchedRect.width,height:t*e.matchedRect.height,score:e.score}}:{matched:{offsetLeft:t*e.matchedRect.x-t*o,offsetTop:t*e.matchedRect.y-t*i,viewportLeft:t*e.matchedRect.x,viewportTop:t*e.matchedRect.y,pageLeft:t*e.matchedRect.x,pageTop:t*e.matchedRect.y,width:t*e.matchedRect.width,height:t*e.matchedRect.height,score:e.score},reference:null}})(e))},t.serializeImageData=p,t.serializeDataUrl=h},92:function(e,t,r){"use strict";r.r(t);var n=r(395),a=new(r.n(n).a)("selenium-ide");a.version(1).stores({testCases:"id,name,updateTime"}),a.version(2).stores({testCases:"id,name,updateTime",testSuites:"id,name,updateTime"}),a.open(),t.default=a},95:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Timer="timer",e.LoopTimer="loop_timer",e.Countdown="countdown"}(t.MacroInspector||(t.MacroInspector={}))},96:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(95),a=r(1030),o=r(1031),i=r(1032),s=r(12);var c;!function(e){e[e.Constructor=0]="Constructor",e[e.Restart=1]="Restart"}(c=t.MacroParamsProviderType||(t.MacroParamsProviderType={}));class l extends a.Monitor{constructor(e){super({[n.MacroInspector.Timer]:e=>new o.Timer,[n.MacroInspector.LoopTimer]:e=>new o.Timer,[n.MacroInspector.Countdown]:t=>{const r=e(c.Constructor,n.MacroInspector.Countdown,t,!1)[0];return new i.Countdown(r)}},(t,r,n)=>e(c.Restart,t,r,n))}}t.MacroMonitor=l,t.getMacroMonitor=s.singletonGetter(e=>new l(e))},97:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e,t,r,n){this.requestObject={id:e,method:t,params:r},this.callback=n}get request(){return this.requestObject}}t.NativeMessagingHost=class{constructor(e){this.internalHostName=e,this.nextInvocationId=1,this.queue=new Array,this.handleMessage=this.handleMessage.bind(this),this.handleDisconnect=this.handleDisconnect.bind(this)}processResponse(e,t,r){let n=void 0;for(let t=0;t<this.queue.length;++t){const r=this.queue[t];if(r.request.id===e){n=r.callback,this.queue.splice(t,1);break}}n&&n(t,r)}handleMessage(e){const t=e;"number"==typeof t.id&&this.processResponse(t.id,t.result,t.error)}handleDisconnect(){this.disconnect()}get hostName(){return this.internalHostName}connectAsync(){return this.port||(this.port=chrome.runtime.connectNative(this.hostName),this.port.onMessage.addListener(this.handleMessage),this.port.onDisconnect.addListener(this.handleDisconnect)),this.invokeAsync("get_version",void 0)}disconnect(){const e=chrome.runtime.lastError&&chrome.runtime.lastError.message||"Disconnected";this.port&&(this.port.disconnect(),this.port=void 0);const t=this.queue.map(e=>e.request.id);for(const r of t)this.processResponse(r,void 0,{message:e});this.queue=new Array}invoke(e,t,r){if(!this.port)return void r(void 0,{message:"Disconnected"});const a=this.nextInvocationId++,o=new n(a,e,t,r);this.queue.push(o),this.port.postMessage(o.request)}invokeAsync(e,t){return new Promise((r,n)=>{this.invoke(e,t,(e,t)=>{chrome.runtime.lastError&&(t=new Error(chrome.runtime.lastError.message)),t?n(t):r(e)})})}}},972:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(0)),o=n(r(1)),i=r(4),s=r(12),c=r(137);class l extends a.default.Component{constructor(){super(...arguments),this.state={},this.onClick=e=>{const{data:t,onClick:r,paths:n,foldOnClickTitle:a}=this.props;r&&r(t,n,e),a&&t.type===c.FileNodeType.Folder&&this.onToggle(e)},this.onDoubleClick=e=>{const{data:t,onDoubleClick:r,paths:n}=this.props;r&&r(t,n,e)},this.onContextMenu=e=>{const{data:t,onContextMenu:r,paths:n}=this.props;r&&r(t,n,e)},this.onToggle=e=>{e.stopPropagation();const{data:t,onToggle:r,paths:n}=this.props;r&&r(t,n,e)}}render(){const{decorate:e=(e=>e)}=this.props;return e(a.default.createElement("div",{id:s.normalizeHtmlId(this.props.data.id),className:i.cn("tree-node",this.props.commonClass,this.props.data.className)},a.default.createElement("div",{className:"tree-node-content",onClick:this.onClick,onDoubleClick:this.onDoubleClick,onContextMenu:this.onContextMenu},a.default.createElement("div",{className:"tree-node-icon-wrapper",onClick:this.onToggle},this.renderIcon()),a.default.createElement("div",{className:"tree-node-item-wrapper"},this.renderItem()),this.renderItemExtra()),a.default.createElement("div",{className:"tree-node-children"},this.renderSubnodes())))}renderIcon(){const{renderIcon:e,data:t,paths:r}=this.props;return"function"==typeof e?e(t,r):this.defaultRenderIcon(t)}renderItem(){const{renderItem:e,data:t,paths:r}=this.props;return"function"==typeof e?e(t,r):this.defaultRenderItem(t)}renderItemExtra(){const{renderItemExtra:e,data:t,paths:r}=this.props;return"function"==typeof e?e(t,r):null}defaultRenderIcon(e){return a.default.createElement("div",{className:i.cn("node-icon")},e.folded?"C":"O")}defaultRenderItem(e){return e.text||`node at level ${e.level}`}renderSubnodes(){const{data:e,paths:t,subnodeComponent:r=(()=>l)}=this.props,n=s.without(["data","paths"],this.props);return e.type!==c.FileNodeType.Folder||e.folded?null:(e.children||[]).map((e,o)=>{const i=r(e,[...t,o]);return a.default.createElement(i,Object.assign({key:o},n,{data:e,paths:[...t,o]}))})}}t.TreeNode=l,l.propTypes={data:o.default.object.isRequired,renderItem:o.default.func.isRequired,renderIcon:o.default.func.isRequired,renderItemExtra:o.default.func,decorate:o.default.func,onClick:o.default.func.isRequired,onDoubleClick:o.default.func.isRequired,onContextMenu:o.default.func.isRequired,onToggle:o.default.func.isRequired,className:o.default.string}},973:function(e,t,r){var n=r(974);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(133)(n,a);n.locals&&(e.exports=n.locals)},974:function(e,t,r){(e.exports=r(132)(void 0)).push([e.i,'.file-root{padding-top:10px;font-size:14px;line-height:18px}.file-root.drag-over{background:#d5d6f9}.file-root .tree-node-content{position:relative;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:5px 10px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.file-root .tree-node-content,.file-root .tree-node-content .tree-node-icon-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.file-root .tree-node-content .tree-node-icon-wrapper{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:5px;width:20px}.file-root .tree-node-content .more-button{display:none;position:absolute;top:50%;right:10px;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.file-root .tree-node-content:hover .more-button{display:block}.file-root .file-node.drag-over{background:#d5d6f9}.file-root .file-node.success>.tree-node-content{background:#d1ffd8}.file-root .file-node.success.blur>.tree-node-content{background:rgba(209,255,216,.6)}.file-root .file-node.error>.tree-node-content{background:#f7c1c1}.file-root .file-node.error.blur>.tree-node-content{background:hsla(0,77%,86%,.6)}.file-root .file-node.error-in-sub>.tree-node-content{background:#f8cf9d}.file-root .file-node.error-in-sub.blur>.tree-node-content{background:hsla(33,87%,79%,.6)}.file-root .file-node.selected>.tree-node-content{background:#fdffd1}.file-root .file-node.selected.blur>.tree-node-content{background:rgba(253,255,209,.6)}.file-root .file-node.selected.error-in-sub>.tree-node-content,.file-root .file-node.selected.error>.tree-node-content,.file-root .file-node.selected.success>.tree-node-content{position:relative}.file-root .file-node.selected.error-in-sub>.tree-node-content:after,.file-root .file-node.selected.error>.tree-node-content:after,.file-root .file-node.selected.success>.tree-node-content:after{content:"";position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none}.file-root .file-node.selected.error>.tree-node-content:after{border:4px solid #f7c1c1}.file-root .file-node.selected.error.blur>.tree-node-content:after{border-color:hsla(0,77%,86%,.6)}.file-root .file-node.selected.error-in-sub>.tree-node-content:after{border:4px solid #f8cf9d}.file-root .file-node.selected.error-in-sub.blur>.tree-node-content:after{border-color:hsla(33,87%,79%,.6)}.file-root .file-node.selected.success>.tree-node-content:after{border:4px solid #d1ffd8}.file-root .file-node.selected.success.blur>.tree-node-content:after{border-color:rgba(209,255,216,.6)}.file-root .file-node .file-icon,.file-root .file-node .folder-icon{height:16px}.file-root .tree-node .tree-node .tree-node-content{padding-left:25px}.file-root .tree-node .tree-node .tree-node .tree-node-content{padding-left:40px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:55px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:70px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:85px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:100px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:115px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:130px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:145px}.file-root .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node .tree-node-content{padding-left:160px}',""])},976:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.StackError=n;t.Stack=class{constructor(e){this.list=[],e&&e.length&&(this.list=e)}clear(){this.list=[]}toArray(){return[...this.list]}getCount(){return this.list.length}isEmpty(){return 0===this.getCount()}contains(e){return!!this.list.find(t=>t===e)}push(e){this.list.push(e)}peek(){return this.guardNotEmpty(),this.list[this.getCount()-1]}bottom(){return this.guardNotEmpty(),this.list[0]}pop(){return this.guardNotEmpty(),this.list.pop()}guardNotEmpty(){if(this.isEmpty())throw new n("empty stack")}}},99:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return S}));var n=r(56),a=r.n(n),o=r(15),i=r.n(o),s=r(29),c=r.n(s),l=r(0),u=r.n(l),d=r(18),m=r.n(d),p=r(16),h=r(23),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=function(e){function t(){var e,r,n;v(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return r=n=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.state={name:null},b(n,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),g(t,[{key:"componentDidMount",value:function(){var e=this;this.props.name&&this.setState({name:this.props.name}),setTimeout((function(){var t=e.inputSaveTestCase.refs.input;t.focus(),t.selectionStart=t.selectionEnd=t.value.length}),100)}},{key:"render",value:function(){var e=this;return u.a.createElement(a.a,{title:"Save macro as..",okText:"Save",cancelText:"Cancel",visible:!0,onOk:function(){return e.props.onOk(e.state.name)},onCancel:this.props.onCancel,className:"save-modal"},u.a.createElement(c.a,{style:{width:"100%"},onKeyDown:function(t){13===t.keyCode&&e.props.onOk(e.state.name)},onChange:function(t){return e.setState({name:t.target.value})},value:this.state.name||"",placeholder:"macro name",ref:function(t){e.inputSaveTestCase=t}}))}}]),t}(u.a.Component),w=function(e){var t=e.editor.editing.meta.src;return t&&t.name&&t.name.length?t.name:"Untitled"},E=function(e,t){var r=function(){var e="save_test_case_container",t=document.getElementById(e);if(t)return t;var r=document.createElement("div");return r.id=e,document.body.appendChild(r),r}();return!!e.getState().editor.editing.meta.src?e.dispatch(Object(p.saveEditingAsExisted)()).then((function(){return!0})):new Promise((function(n,a){m.a.render(u.a.createElement(y,{name:t,onOk:function(t){return e.dispatch(Object(p.saveEditingAsNew)(t)).then((function(){i.a.success("successfully saved!",1.5),n(!0)}),(function(e){i.a.error(e.message,1.5),a(e)}))},onCancel:function(){return n(!1)}}),r)})).then((function(e){return m.a.unmountComponentAtNode(r),e})).catch((function(e){throw console.error(e.message),e}))},x=void 0;function S(e){if(x)return x;if(!e)throw new Error("must provide store");return x=function(e){var t=function(t){return e.dispatch(Object(p.updateUI)({isSaving:!0})),new Promise((function(e){e(t())})).finally((function(){e.dispatch(Object(p.updateUI)({isSaving:!1}))}))};return{saveOrNot:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getState(),o=Object(h.hasUnsavedMacro)(n),i=!!n.editor.editing.meta.src,s=f({getTitle:function(e){return'Unsaved changes in macro "'+e.macroName+'"'},getContent:function(e){return"Do you want to discard or save these changes?"},okText:"Save",cancelText:"Discard"},r||{});return t((function(){return o?i&&r.autoSaveExisting?E(e):new Promise((function(t,r){var o=w(n);a.a.confirm({title:s.getTitle({macroName:o}),content:s.getContent({macroName:o}),okText:s.okText,cancelText:s.cancelText,onOk:function(){return E(e).then(t,r),Promise.resolve(!0)},onCancel:function(){return t(!1),Promise.resolve(!0)}})})):Promise.resolve(!0)}))},save:function(r){var n=e.getState(),a=Object(h.hasUnsavedMacro)(n);return t((function(){return a?E(e,r):Promise.resolve(!0)}))}}}(e)}}});